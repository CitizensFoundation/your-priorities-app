<div hidden=""by-polymer-bundler=""><dom-module id="yp-post-card-add"assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">:host{margin-top:8px;margin-bottom:8px;width:100%;}.postCard{width:100%;min-height:75px;margin-top:8px;padding:16px;background-color:var(--large-button-add-color, var(--accent-color, #000));color:#FFF;font-size:16px;cursor:pointer;margin-bottom:8px;text-align:center;max-width:310px;outline-color:var(--accent-color);}iron-icon{height:80px;width:80px;color:#FFF;}.header{padding:0;margin:0;padding-top:16px;}.icon{--iron-icon-height:140px;--iron-icon-width:140px;}.half{width:50%;}paper-fab{}.addText{padding-left:0;padding-right:8px;}iron-icon{width:64px;height:64px;margin-right:8px;margin-left:0;}.addNewIdeaText{font-size:26px;color:#FFF;font-family:var(--app-normal-font-family, Roboto);}.closed{font-size:22px;}paper-card[disabled]{background-color:#888;cursor:initial;}iron-icon[disabled]{}@media (max-width: 420px){:host{margin-top:0;}.postCard{width:100%;margin-left:0;margin-right:0;margin-bottom:4px;padding:16px;}.addNewIdeaText{font-size:24px;width:auto;}iron-icon{height:48px;width:48px;}.closed{font-size:20px;}}@media (max-width: 420px){.postCard{max-width:300px;}}[hidden]{display:none !important;}.container{width:100%;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><div class="layout vertical center-center container"><paper-card disabled$="[[disabled]]"elevation="[[elevation]]"aria-disabled="[[disabled]]"role="button"aria-label="[[t('post.add_new')]]"tabindex="0"on-keydown="_keyDown"class="postCard"on-tap="_newPost"><div class="layout horizontal center-center addNewIdeaText"><iron-icon disabled$="[[disabled]]"icon="lightbulb-outline"></iron-icon><div class="flex addText"hidden$="[[disabled]]"><template is="dom-if"if="[[!group.configuration.alternativeTextForNewIdeaButton]]">[[t('post.add_new')]]</template><template is="dom-if"if="[[group.configuration.alternativeTextForNewIdeaButton]]"><yp-magic-text content-id="[[group.id]]"extra-id="[[index]]"text-only=""content="[[group.configuration.alternativeTextForNewIdeaButton]]"content-language="[[group.language]]"class="ratingName"text-type="alternativeTextForNewIdeaButton"></yp-magic-text></template></div><div class="flex addText closed"hidden$="[[!disabled]]"><template is="dom-if"if="[[!group.configuration.alternativeTextForNewIdeaButtonClosed]]">[[t('closedForNewPosts')]]</template><template is="dom-if"if="[[group.configuration.alternativeTextForNewIdeaButtonClosed]]"><yp-magic-text content-id="[[group.id]]"extra-id="[[index]]"text-only=""content="[[group.configuration.alternativeTextForNewIdeaButtonClosed]]"content-language="[[group.language]]"class="ratingName"text-type="alternativeTextForNewIdeaButtonClosed"></yp-magic-text></template></div></div></paper-card></div></template><script>Polymer({is:"yp-post-card-add",properties:{elevation:{type:Number},disabled:{type:Boolean},group:Object},_keyDown:function(e){13===e.keyCode&&this._newPost()},_newPost:function(){this.disabled||this.fire("new-post")},behaviors:[Polymer.ypLanguageBehavior]})</script></dom-module><dom-module id="yp-post-list-item"assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">.card-actions{}.post-name{margin:0;padding:16px;padding-top:20px;padding-bottom:8px;cursor:pointer;vertical-align:middle !important;font-size:1.25rem;background-color:#fff;color:#000;letter-spacing:.0125em;font-weight:var(--app-header-font-weight, 500);font-family:var(--app-header-font-family, Roboto);}.postNameContainer{width:100%;}.postCardCursor{cursor:pointer;}.postCard{background-color:#fff;@apply --layout-horizontal;}:host{display:block;@apply --layout-vertical;}.postCard{height:100px;width:895px;border-radius:4px;}.postCard[hide-post-cover]{height:190px;}.postCard[hide-post-cover][hide-actions]{height:165px;}.postCard[hide-post-cover][hide-description]{height:140px;}.postCard[hide-description]{height:372px;}.postCard[hide-description][hide-actions]{height:331px;}.postCard[hide-description][hide-post-cover][hide-actions]{height:110px;}.postCard[hide-actions]{height:402px;}.postCard[mini]{width:210px;height:100%;margin:0;padding-top:0;padding-bottom:0;}yp-post-cover-media{width:178px;height:100px;}yp-post-cover-media[mini]{width:210px;height:118px;min-height:118px;}.post-name[mini]{padding:16px;}.description{font-size:17px;padding:16px;padding-top:0;cursor:pointer;color:#555;}.postActions{position:absolute;right:20px;bottom:0;margin:0;}.shareIcon{position:absolute;left:8px;bottom:2px;--paper-share-button-icon-color:#656565;--paper-share-button-icon-height:46px;--paper-share-button-icon-width:46px;text-align:right;width:48px;height:48px;}.customRatings{position:absolute;bottom:10px;right:6px;}@media (max-width: 960px){.customRatings{bottom:12px;}:host{width:100%;max-width:423px;}.description[has-custom-ratings]{padding-bottom:28px;}.postCard{margin-left:0;margin-right:0;padding-left:0;padding-right:0;width:100%;height:100%;}.postCard[mini]{width:210px;height:100%;}.card{margin-left:0;margin-right:0;padding-left:0;padding-right:0;width:100%;height:100%;}.card[mini]{width:210px;height:100%;}yp-post-cover-media{width:100%;height:230px;}yp-post-cover-media[mini]{width:210px;height:118px;min-height:118px;}.card{height:100%;padding-bottom:48px;}.postCard{height:100% !important;}yp-post-cover-media[audio-cover]{width:100%;height:100px;}}@media (max-width: 420px){yp-post-cover-media{height:225px;}yp-post-cover-media[audio-cover]{height:100px;}}@media (max-width: 375px){yp-post-cover-media{height:207px;}yp-post-cover-media[audio-cover]{height:100px;}}@media (max-width: 360px){yp-post-cover-media{height:200px;}yp-post-cover-media[audio-cover]{height:90px;}}@media (max-width: 320px){yp-post-cover-media{height:180px;}yp-post-cover-media[audio-cover]{height:90px;}}[hidden]{display:none !important;}a{text-decoration:none;}.share[mini]{display:none;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-logged-in="_userLoggedIn"></lite-signal><iron-media-query query="(min-width: 600px)"query-matches="{{wide}}"></iron-media-query><paper-material mini$="[[mini]]"hide-post-cover$="[[post.Group.configuration.hidePostCover]]"hide-description$="[[post.Group.configuration.hidePostDescription]]"hide-actions$="[[post.Group.configuration.hidePostActionsInGrid]]"audio-cover$="[[isAudioCover]]"class="card postCard layout vertical"elevation="[[elevation]]"animated=""><div class="layout vertical"><a href="[[_getPostLink(post)]]"id="theMainA"on-tap="_savePostToBackCache"><div class="layout horizontal"><yp-post-cover-media mini$="[[mini]]"top-radius=""audio-cover$="[[isAudioCover]]"alt-tag="[[post.name]]"post="[[post]]"hidden$="[[post.Group.configuration.hidePostCover]]"></yp-post-cover-media><div class="layout vertical"><div class="postNameContainer"><div class="post-name"mini$="[[mini]]"id="postName"><yp-magic-text id="postNameMagicText"text-type="postName"content-language="[[post.language]]"on-tap="goToPostIfNotHeader"text-only=""content="[[postName]]"content-id="[[post.id]]"></yp-magic-text></div></div><template is="dom-if"if="[[!post.Group.configuration.usePostTagsForPostListItems]]"><template is="dom-if"if="[[!post.public_data.structuredAnswersJson]]"><yp-magic-text class="description layout horizontal"has-custom-ratings$="[[post.Group.configuration.customRatings]]"hidden$="[[hideDescription]]"text-type="postContent"content-language="[[post.language]]"on-tap="goToPostIfNotHeader"remove-urls=""text-only=""content="[[post.description]]"content-id="[[post.id]]"truncate="200"></yp-magic-text></template><template is="dom-if"if="[[post.public_data.structuredAnswersJson]]"><yp-magic-text id="description"text-type="postContent"content-language="[[post.language]]"hidden$="[[hideDescription]]"content="[[structuredAnswersFormatted]]"remove-urls=""disable-translation=""skip-sanitize=""content-id="[[post.id]]"class="description"truncate="120"></yp-magic-text></template></template><template is="dom-if"if="[[post.Group.configuration.usePostTagsForPostListItems]]"><yp-post-tags post="[[post]]"></yp-post-tags></template></div></div></a><div hidden$="[[post.Group.configuration.hidePostActionsInGrid]]"on-tap="_onBottomClick"><template is="dom-if"if="[[!mini]]"><div class="share"hidden=""blah$="[[post.Group.configuration.hideSharing]]"><paper-share-button on-share-tap="_shareTap"class="shareIcon"less-margin$="[[post.Group.configuration.hideDownVoteForPost]]"endorsed$="[[isEndorsed]]"horizontal-align="right"id="shareButton"whatsapp="[[post.Group.configuration.allowWhatsAppSharing]]"title$="[[t('post.shareInfo')]]"facebook=""email=""twitter=""popup-enabled=""url="[[fullPostUrl]]"></paper-share-button></div><template is="dom-if"if="[[post.Group.configuration.customRatings]]"><yp-post-ratings-info class="customRatings"post="[[post]]"></yp-post-ratings-info></template><template is="dom-if"if="[[!post.Group.configuration.customRatings]]"><yp-post-actions floating=""class="postActions"elevation="-1"endorse-mode="[[endorseMode]]"post="[[post]]"hidden$="[[mini]]"></yp-post-actions></template></template></div></div></paper-material><lite-signal on-lite-signal-yp-auto-translate="_autoTranslateEvent"></lite-signal><yp-ajax hidden=""id="translatedSurveyAjax"on-response="_translatedSurveyResponse"></yp-ajax></template><script>Polymer({is:"yp-post-list-item",behaviors:[Polymer.ypLanguageBehavior,Polymer.YpPostBehavior,Polymer.AccessHelpers,Polymer.ypLoggedInUserBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypTruncateBehavior,Polymer.ypGotoBehavior,Polymer.YpPostSurveyTranslationBehavior],properties:{hideDescription:{type:Boolean,computed:"_hideDescription(mini, post)"},selectedMenuItem:{type:String},elevation:{type:Number,value:1},post:{type:Object,observer:"_postChanged"},hasPostAccess:{type:Boolean,value:!1,notify:!0,computed:"_hasPostAccess(post, gotAdminRights)"},mini:{type:Boolean,value:!1},isAudioCover:{type:Boolean,value:!1}},_onBottomClick:function(o){o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation()},clickOnA:function(){this.$.theMainA&&this.$.theMainA.click()},_savePostToBackCache:function(){this.post&&(window.appGlobals.cachedPostItem=this.post)},_getPostLink:function(o){if(o)return o.Group.configuration&&o.Group.configuration.disablePostPageLink?"#":o.Group.configuration&&o.Group.configuration.resourceLibraryLinkMode?o.description.trim():"/post/"+o.id;console.warn("Trying to get empty post link")},_shareTap:function(o,t){window.appGlobals.activity("postShareCardOpen",t.brand,this.post?this.post.id:-1)},_hideDescription:function(o,t){return o||t&&t.Group.configuration&&t.Group.configuration.hidePostDescription},_hasPostAccess:function(o){return!!o&&this.checkPostAccess(o)},goToPostIfNotHeader:function(){this.post.Group.configuration&&this.post.Group.configuration.disablePostPageLink?console.log("goToPostDisabled"):this.post.Group.configuration&&this.post.Group.configuration.resourceLibraryLinkMode||this.goToPost(null,null,null,this.post)},_postChanged:function(o){o&&("audio"===o.cover_media_type?this.set("isAudioCover",!0):this.set("isAudioCover",!1),this._getSurveyTranslationsIfNeeded())},updateDescriptionIfEmpty:function(o){this.post.description&&""!=this.post.description||this.set("post.description",o)},_refresh:function(){Polymer.dom(document).querySelector("yp-app").getDialogAsync("postEdit",function(o){o.selected=0,this.fire("refresh")}.bind(this))},_openReport:function(){window.appGlobals.activity("open","post.report"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("apiActionDialog",function(o){o.setup("/api/posts/"+this.post.id+"/report",this.t("reportConfirmation"),this._onReport.bind(this),this.t("post.report"),"PUT"),o.open()}.bind(this))},_onReport:function(){window.appGlobals.notifyUserViaToast(this.t("post.report")+": "+this.post.name)}})</script></dom-module><dom-module id="yp-posts-filter"assetpath="../yp-posts-filter/"><template><style include="iron-flex iron-flex-alignment">:host{padding-bottom:0 !important;margin-bottom:0 !important;}paper-menu-button{padding:0;margin:0;}paper-button, paper-item{font-family:var(--app-normal-font-family, Roboto);}.filterIcon{padding-right:8px;}.filterIconTransform{-moz-transform:scaleY(-1);-o-transform:scaleY(-1);-webkit-transform:scaleY(-1);transform:scaleY(-1);filter:FlipV;-ms-filter:"FlipV";}.dropdown-trigger{margin-bottom:16px;margin-left:16px;}.clear-search-trigger{width:55px;height:55px;margin-bottom:16px;}paper-item{min-height:32px;}.subTitle{font-size:22px;margin-top:10px;margin-right:8px;}#filterDropdown{padding-left:0;margin-left:0;}#dropDownTrigger{background-color:#fff;margin-left:16px;color:#111;}@media (max-width: 600px){.subTitle{font-size:17px;padding-top:0;margin-top:16px;}.dropdown-trigger{padding-left:0;margin-left:0;margin-bottom:0;margin-top:0;}.clear-search-trigger{width:50px;height:50px;margin-top:5px;margin-bottom:0;margin-top:0;}paper-button{}#dropDownTrigger{margin-left:0;margin-right:0;}}paper-dropdown-menu{padding-left:8px;padding-right:8px;}.filterHeader{margin-top:16px;padding-bottom:0;margin-bottom:0;font-weight:bold;font-size:18px;}.categoriesDropdownMenu{padding-left:16px;parring-right:16px;}.dropdownIcon{color:#000;margin-right:8px;margin-left:8px;}.catImage{width:24px;height:24px;margin-right:8px;}.filterText{margin-right:8px;}.dropDownContent, #mainListMenu, .categoriesDropdownMenu, .catDropDown{background-color:#fff !important;}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><template is="dom-if"if="[[group]]"><div class="layout horizontal center-center mainContainer wrap"><template is="dom-if"if="[[showFilter]]"><paper-menu-button id="filterDropdown"class="selected-items"icon="sort"vertical-align="auto"horizontal-align="right"><paper-button raised=""title$="[[t('filterIdeas')]]"id="dropDownTrigger"icon="sort"slot="dropdown-trigger"><iron-icon icon="sort"class="dropdownIcon"></iron-icon><div class="filterText">[[filterText]]</div></paper-button><div slot="dropdown-content"class="layout vertical dropDownContent"><div><div class="filterHeader layout horizontal center-center">[[filterText]]</div><template is="dom-if"if="[[categoriesWithCount]]"restamp=""><div class="layout vertical"><paper-dropdown-menu class="dropdown-content wrap categoriesDropdownMenu"><paper-listbox slot="dropdown-content"id="categoryMenu"class="catDropDown"attr-for-selected="data-category-id"on-iron-select="_changeCategory"><paper-item data-category-id="-1"name="-1"><iron-icon icon="select-all"class="filterIcon"></iron-icon><span>[[t('categories.the_all')]] ([[allPostCount]])</span></paper-item><template is="dom-repeat"items="[[categoriesWithCount]]"as="category"><paper-item data-category-id$="[[category.id]]"data-category-name$="[[category.name]]"><iron-image sizing="cover"class="catImage"height="24"width="24"src="[[_categoryImageSrc(category)]]"></iron-image>[[category.name]] ([[category.count]])</paper-item></template></paper-listbox></paper-dropdown-menu></div></template><div class="layout horizontal center-center"><yp-ajax id="categoriesWithCountAjax"on-response="_categoriesCountResponse"></yp-ajax></div><paper-listbox slot="dropdown-content"id="mainListMenu"on-iron-select="_changeFilter"><paper-item data-filter="top"><iron-icon icon="trending-up"class="filterIcon"></iron-icon><span>[[t('post.top')]]</span></paper-item><paper-item data-filter="newest"hidden$="[[group.configuration.hideNewestFromFilter]]"><iron-icon icon="new-releases"class="filterIcon"></iron-icon><span>[[t('post.newest')]]</span></paper-item><paper-item data-filter="most_debated"><iron-icon icon="chat-bubble-outline"class="filterIcon"></iron-icon><span>[[t('post.most_debated')]]</span></paper-item><paper-item data-filter="random"><iron-icon icon="cached"class="filterIcon"></iron-icon><span>[[t('post.random')]]</span></paper-item></paper-listbox></div></div></paper-menu-button></template><template is="dom-if"if="[[searchingFor]]"><paper-icon-button aria-label$="[[t('clearSearchInput')]]"icon="clear"on-tap="_clearSearch"class="clear-search-trigger"></paper-icon-button></template></div><template is="dom-if"if="[[group.configuration.customFilterText]]"><yp-magic-text hidden=""id="customFilterTextId"content-id="[[group.id]]"text-only=""content="[[group.configuration.customFilterText]]"content-language="[[group.language]]"on-new-translation="_updateFilterText"text-type="customFilterText"></yp-magic-text></template></template></template><script>Polymer({is:"yp-posts-filter",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypGotoBehavior,Polymer.ypMediaFormatsBehavior],properties:{filter:{type:String,value:"newest",notify:!0,observer:"_filterChanged"},filterText:{type:String,computed:"_filterText(group, customFilterText)"},customFilterText:{type:String,value:null},filterName:{type:String},categoryId:{type:String,notify:!0,observer:"_categoryIdChanged"},categoryName:{type:String},group:{type:Object,observer:"_groupChanged"},subTitle:{type:String,value:"",notify:!0},searchingFor:{type:String,value:null,notify:!0,observer:"_searchingForChanged"},showFilter:{type:Boolean,value:!0},postsCount:{type:Number,notify:!0},tabName:{type:String,observer:"_tabNameChanged"},categoriesWithCount:{type:Array,value:null},allPostCount:{type:Number,value:0}},_filterText:function(t,e){return t&&e?e:t&&t.configuration&&t.configuration.customFilterText?t.configuration.customFilterText:this.t("filterIdeas")},_updateFilterText:function(){this.async(function(){var t=this.$$("#customFilterTextId");t&&t.finalContent&&this.set("customFilterText",t.finalContent)})},observers:["_listLanguageChanged(language)"],_getCategoryCount:function(e,t){var i=__.find(t,function(t){return t.category_id==e});return i?i.count:0},_oldCategory:function(t){return!t||t.id<804},_categoriesCountResponse:function(t,e){var i=e.response.categoriesCount;this.set("allPostCount",e.response.allPostCount);var r=[];__.each(this.group.Categories,function(t){t.count=this._getCategoryCount(t.id,i),0<t.count&&r.push(t)}.bind(this)),1<r.length?(this.set("categoriesWithCount",r),this.async(function(){var t=this.$$("#categoryMenu");t?this.categoryId?t.selected=this.categoryId:t.selected="-1":console.error("Cant set category menu")})):console.warn("Unexpected categories count")},_openDropDown:function(){var t=this.$$("#dropDownTrigger");t&&t.click()},_searchingForChanged:function(){this.showFilter=!0},_clearSearch:function(){this.set("searchingFor",null),this.set("filter","newest"),this._updateAfterFiltering()},openFilter:function(){window.appGlobals.activity("open","filter")},_filterChanged:function(t){t&&(this.filterName="post."+this.filter,this._updateTitle())},_categoryIdChanged:function(t){t&&this._updateTitle()},_listLanguageChanged:function(t){t&&this.t&&this._updateTitle()},searchFor:function(t){this.set("searchingFor",t);var e="/group/"+this.group.id+"/open/"+this.group.name+"/search/"+this.searchingFor;window.appGlobals.activity("change","filter",e),this.redirectTo(e),this.fire("refresh-group")},_updateTitle:function(){if(this.searchingFor)this.set("subTitle",this.t("post.searchingFor")+this.searchingFor);else{var t,e=this.t(this.filterName);t=this.categoryName?this.categoryName:this.t("categories.the_all");this.t("short_word.in");this._ifCategories()?this.set("subTitle",e+" - "+t):this.set("subTitle",e)}},_changeFilter:function(t,e){this.set("filter",e.item.dataset.filter),this._updateAfterFiltering()},_changeCategory:function(t,e){var i=this.categoryId,r=e.item.dataset.categoryId;"-1"!=r?(this.set("categoryId",r),this.categoryName=e.item.dataset.categoryName):(this.set("categoryId",null),this.categoryName=null,this.$$("#categoryMenu").selected=null),this._updateTitle(),i!==this.categoryId&&this._updateAfterFiltering()},buildPostsUrlPath:function(){var t="/group/"+this.group.id+"/"+this.tabName;return this.filter&&(t+="/posts/"+this.filter),this.categoryId&&(t+="/"+this.categoryId+"/"+this.categoryName),t},_updateAfterFiltering:function(){this.filter||this.set("filter","newest");var t=this.buildPostsUrlPath();window.appGlobals.activity("change","filter",t),this.fire("refresh-group")},_ifCategories:function(){return!!this.group&&(this.group.Categories&&0<this.group.Categories.length)},resetSelection:function(){this.async(function(){this.$$("#categoryMenu")&&(this.$$("#categoryMenu").selected=null),this.$$("#mainListMenu")?this.$$("#mainListMenu").selected=null:console.error("Cant find mainListMenu menu")},100)},_tabNameChanged:function(){0},_setupCategories:function(e,i){this.set("categoriesWithCount",null),this.async(function(){var t=this.$$("#categoriesWithCountAjax");t?(t.url="/api/groups/"+e.id+"/categories_count/"+i,t.generateRequest()):console.error("Can't find categories ajax.")},100)},_groupChanged:function(t){this.set("categoriesWithCount",null),this.set("allPostCount",0),t&&(this._updateTitle(),t.Categories&&0<t.Categories.length&&this._setupCategories(t,this.tabName),this.resetSelection())},_categoryItems:function(){return this.group.Categories?this.splitArray(this.group.Categories,7):[]},_categoryImageSrc:function(t){return this.getImageFormatUrl(t.CategoryIconImages,0)},splitArray:function(t,e){return t.chunk(e)}})</script></dom-module><dom-module id="yp-post-list"assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">:host{}.container{@apply --layout-horizontal;@apply --layout-wrap;}.postsFilter{padding-left:16px;height:36px;}.objectives{padding-bottom:40px;max-width:432px;}.description{padding:12px;}yp-post-card{padding-bottom:52px;}#outerRegion{position:relative;@apply --layout-vertical;}#scrollableRegion{}iron-list{height:100vh;}yp-ajax{padding-top:48px;}yp-posts-filter{margin-bottom:8px;margin-left:8px;margin-top:16px;}#ironList{}.searchButton{padding:8px;margin:8px;}.searchContainer{margin-top:8px;}yp-posts-filter{padding-right:16px;}.half{width:50%;}.searchBox{--paper-input-container-label:{font-size:23px;color:#555;font-family:var(--app-normal-font-family, Roboto);};font-family:var(--app-normal-font-family, Roboto);margin-bottom:22px;margin-right:8px;}@media (max-width: 800px){.searchBox{--paper-input-container-label:{font-size:18px;};margin-bottom:8px;}.searchBox{margin-top:8px;}.half{width:100%;}.searchContainer{@apply --layout-center-center;margin-top:0;}.postsFilter{padding-left:16px;width:215px !important;}}.noIdeas{background-color:#FFF;max-width:200px;padding:16px;margin:16px;margin-top:32px;}.noIdeasText{font-weight:bold;}.card{padding:0;padding-top:8px;}.card[wide-padding]{padding:16px !important;}.card[desktop-list]{padding:0 !important;padding-top:16px !important;}#searchInput{margin-left:8px;}[hidden]{display:none !important;}:focus{}.largeAjax{position:absolute;bottom:32px;}a{text-decoration:none;}.card[is-last-item]{padding-bottom:100px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><iron-media-query query="(min-width: 1024px)"query-matches="{{wide}}"></iron-media-query><iron-a11y-keys id="a11y"target="[[searchTarget]]"keys="enter"on-keys-pressed="_search"></iron-a11y-keys><div class="layout vertical center-center topMost"><div class="searchContainer layout horizontal center-center wrap"hidden$="[[group.configuration.hidePostFilterAndSearch]]"><div class="layout horizontal center-center"><yp-posts-filter on-tap="_tapOnFilter"sub-title="{{subTitle}}"class="filter"id="postsFilter"tab-name="[[statusFilter]]"on-refresh-group="_refreshGroupFromFilter"group="[[group]]"filter="{{filter}}"searching-for="{{searchingFor}}"category-id="{{categoryId}}"category-name="{{categoryName}}"posts-count="{{postsCount}}"></yp-posts-filter></div><div class="layout horizontal center-center"><paper-input id="searchInput"label$="[[t('searchFor')]]"value="{{searchingFor}}"class="searchBox"></paper-input><paper-icon-button aria-label$="[[t('startSearch')]]"icon="search"on-tap="_search"hidsden$="[[!showSearchIcon]]"></paper-icon-button></div></div><template is="dom-if"if="[[noPosts]]"restamp=""><div class="layout horiztonal center-center"><paper-material class="noIdeas layout horizontal center-center"elevation="2"hidden$="[[group.configuration.allPostsBlockedByDefault]]"><div class="noIdeasText">[[t('noIdeasHere')]]</div></paper-material></div></template><div class="layout horizontal center-center"><iron-list id="ironList"selection-enabled=""scroll-offset="[[scrollOffset]]"on-selected-item-changed="_selectedItemChanged"items="[[posts]]"as="post"scroll-target="document"grid$="[[wideNotListFormat]]"role="list"><template><div wide-padding$="[[wide]]"desktop-list$="[[desktopListFormat]]"class="card layout vertical center-center"is-last-item$="[[_isLastItem(index)]]"aria-label="[[post.name]]"role="listitem"aria-level="2"tabindex$="[[tabIndex]]"><template is="dom-if"if="[[cardListFormat]]"><yp-post-card id="postCard[[post.id]]"on-refresh="_refreshPost"class="card"post="[[post]]"on-mouseover="cardMouseOver"on-mouseout="cardMouseOut"></yp-post-card></template><template is="dom-if"if="[[desktopListFormat]]"><yp-post-list-item id="postCard[[post.id]]"on-refresh="_refreshPost"class="card"post="[[post]]"on-mouseover="cardMouseOver"on-mouseout="cardMouseOut"></yp-post-list-item></template><template is="dom-if"if="[[galleryListFormat]]"><yp-post-list-gallery-item id="postCard[[post.id]]"on-refresh="_refreshPost"class="card"post="[[post]]"on-mouseover="cardMouseOver"on-mouseout="cardMouseOut"></yp-post-list-gallery-item></template></div></template></iron-list></div><div class="layout horizontal center-center largeAjax"><yp-ajax id="ajax"large-spinner=""on-response="_postsResponse"></yp-ajax><yp-ajax id="refreshPost"on-response="_refreshPostResponse"></yp-ajax></div></div></template><script>Polymer({is:"yp-post-list",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypIronListBehavior],properties:{wide:Boolean,categories:{type:Array},subTitle:{type:String,notify:!0},defaultCategories:{type:Boolean,value:!1},posts:{type:Array,value:null,notify:!0},groupId:{type:Number,observer:"_groupIdChanged"},userId:{type:Number},group:{type:Object,notify:!0,observer:"_groupChanged"},filter:{type:String,value:"newest",observer:"_filterChanged"},statusFilter:{type:String,value:"open",notify:!0},categoryId:{type:String,observer:"_categoryIdChanged"},postsCount:{type:Number,notify:!0},searchTarget:{type:Object,computed:"_searchTarget(noPosts)"},categoryName:{type:String},searchingFor:{type:String,value:null,observer:"_searchingForChanged"},selectedCategoryName:{type:String},selectedTab:{type:String,observer:"_selectedTabChanged"},tabCounterId:{type:String},oldestPostAt:{type:Date},noPosts:{type:Boolean,value:!1},wideListOffset:{type:Number,value:610},listOffset:{type:String,value:"500px"},showSearchIcon:{type:Boolean,value:!1},randomSeed:{type:Number,value:null},scrollOffset:{type:Number,computed:"_scrollOffset(wide, group, selectedTab)"},desktopListFormat:{type:Boolean,computed:"_desktopListFormat(wide, group, posts)"},cardListFormat:{type:Boolean,computed:"_cardListFormat(desktopListFormat, galleryListFormat, wide, group, posts)"},galleryListFormat:{type:Boolean,computed:"_galleryListFormat(wide, group, posts)"},wideNotListFormat:{type:Boolean,computed:"_wideNotListFormat(wide, desktopListFormat, galleryListFormat, group, posts)"}},_isLastItem:function(t){return this.posts&&t>=this.posts.length-1},_wideNotListFormat:function(t,e,o){return!0===(t&&!e&&!o)},_cardListFormat:function(t,e){return!0==(!t&&!e)},_desktopListFormat:function(t,e){return!0===(t&&e&&e.configuration&&e.configuration.usePostListFormatOnDesktop)},_galleryListFormat:function(t,e){return!0===(e&&e.configuration&&e.configuration.galleryMode)},_selectedItemChanged:function(t,e){if(e&&e.value){var o=this.$$("#postCard"+e.value.id);o&&o.clickOnA()}},_refreshPost:function(t,e){this.$.refreshPost.url="/api/posts/"+e.id,this.$.refreshPost.generateRequest()},_refreshPostResponse:function(t,e){for(var o=e.response,s=0;s<this.posts.length;s++)if(this.posts[s].id==o.id){this.set("posts."+s,o),window.appGlobals.updatePostInCache(o),this.async(function(){this.$$("#ironList").fire("iron-resize")});break}},_getPostLink:function(t){if(t)return t.Group.configuration&&t.Group.configuration.disablePostPageLink?"#":t.Group.configuration&&t.Group.configuration.resourceLibraryLinkMode?t.description.trim():"/post/"+t.id;console.warn("Trying to get empty post link")},_scrollOffset:function(t,e){var o=this.$$("iron-list");if(o){var s=o.offsetTop;return s-=75,0<o.offsetTop&&0<s?console.info("Post list scroll offset: "+s):(s=t?550:700,e&&e.configuration&&(e.configuration.hideAllTabs&&(s-=60),e.configuration.hideNewPost&&(s-=100),e.configuration.hidePostFilterAndSearch&&(s-=100)),console.info("Post list (manual) scroll offset: "+s)),s}return console.warn("No list for scroll offset"),null},_tapOnFilter:function(){window.appGlobals.activity("click","filter")},_searchTarget:function(t){t||this.async(function(){return this.$$("#searchInput")})},_selectedTabChanged:function(){this.statusFilter},_search:function(){window.appGlobals.activity("click","search"),this.searchingFor&&""!=this.searchingFor&&this._refreshGroupFromFilter()},cardMouseOver:function(t){t.currentTarget.elevation=4},cardMouseOut:function(t){t.currentTarget.elevation=1},buildPostsUrlPath:function(){return this.$.postsFilter.buildPostsUrlPath()},_searchingForChanged:function(t){this.set("moreToLoad",!0),t&&""!=t?this.set("showSearchIcon",!0):this.set("showSearchIcon",!1)},_filterChanged:function(){this.set("moreToLoad",!0)},_categoryIdChanged:function(){this.set("moreToLoad",!0)},scrollToPost:function(t){t&&this.posts?(console.info("Scrolling to post: "+t.id),this.$$("#ironList").scrollToItem(t),document.dispatchEvent(new CustomEvent("lite-signal",{bubbles:!0,compose:!0,detail:{name:"yp-refresh-activities-scroll-threshold",data:{}}}))):console.error("No post id on goToPostId")},_groupIdChanged:function(){},_groupChanged:function(t){this.set("posts",null),this.set("noPosts",!1),this.set("randomSeed",Math.random()),t&&(this.set("moreToLoad",!0),window.appGlobals.originalQueryParameters&&window.appGlobals.originalQueryParameters.categoryId?(this.set("categoryId",window.appGlobals.originalQueryParameters.categoryId),window.appGlobals.originalQueryParameters.categoryId=void 0):this.set("categoryId",null),t.configuration&&t.configuration.forcePostSortMethodAs&&-1<["oldest","newest","top","most_debated","random","alphabetical"].indexOf(t.configuration.forcePostSortMethodAs)?this.set("filter",t.configuration.forcePostSortMethodAs):t.configuration&&null!=t.configuration.canAddNewPosts?!0===t.configuration.canAddNewPosts?this.set("filter","newest"):!1===t.configuration.canAddNewPosts&&!1===t.configuration.canVote?this.set("filter","top"):this.set("filter","random"):this.filter||this.set("filter","newest"),this._loadMoreData())},_refreshGroupFromFilter:function(){this.set("posts",null),this.set("moreToLoad",!0),this._loadMoreData()},_loadMoreData:function(){var t,e;this.moreToLoad&&this.group&&(console.info("_loadMoreData for groupId: "+this.groupId+" statusFilter: "+this.statusFilter),this.set("moreToLoad",!1),this.set("noPosts",!1),e=this.userId?(t=this.userId+"/posts","users"):(t=this.groupId,"groups"),this.searchingFor?this.$$("#ajax").url="/api/"+e+"/"+t+"/search/"+this.searchingFor:(this.$$("#ajax").url="/api/"+e+"/"+t+"/posts/"+this.filter,this.categoryId?this.$$("#ajax").url+="/"+this.categoryId:this.$$("#ajax").url+="/null",this.$$("#ajax").url+="/"+this.statusFilter),this.$$("#ajax").url+="?offset="+(null!=this.posts?this.posts.length:0),"random"==this.filter&&this.randomSeed&&(this.$$("#ajax").url+="&randomSeed="+this.randomSeed),this.$$("#ajax").generateRequest())},_postsResponse:function(t,e){var o=e.response.posts;if(this.set("postsCount",e.response.totalPostsCount),this.fire("yp-post-count",{tabCounterId:this.tabCounterId,count:this.postsCount}),this.posts)for(var s=0;s<o.length;s++)this.push("posts",o[s]);else this.set("posts",o);0!=o.length||null!=this.posts&&0!=this.posts.length||this.async(function(){this.set("noPosts",!0)},250),0<o.length?this.set("noPosts",!1):this.searchingFor&&""!=this.searchingFor&&this.set("noPosts",!1),this.async(function(){var t=this.$$("#postsFilter");t&&t._updateTitle()},20),this.async(function(){this.$$("#ironList").fire("iron-resize")}),0<o.length&&o.length!=this.postsCount&&this.set("moreToLoad",!0),document.dispatchEvent(new CustomEvent("lite-signal",{bubbles:!0,compose:!0,detail:{name:"yp-refresh-activities-scroll-threshold",data:{}}})),this._processCategories(),this._checkForMultipleLanguages(o),window.appGlobals.addPostsToCacheLater(o)},_checkForMultipleLanguages:function(t){if(!localStorage.getItem("dontPromptForAutoTranslation")&&!sessionStorage.getItem("dontPromptForAutoTranslation")){var e=null,o=!1;t.forEach(function(t){t.language&&!o&&(e||"??"===t.language?e&&e!==t.language&&"??"!==t.language&&(o=!0,console.info("Multiple post languages: "+e+" and "+t.language)):(e=t.language,t.description))}),o&&Polymer.dom(document).querySelector("yp-app").getDialogAsync("autoTranslateDialog",function(t){t.openLaterIfAutoTranslationEnabled()}.bind(this))}},_processCategories:function(){if(this.categoryId&&this.group)for(var t=0;t<this.group.Categories.length;t++)this.group.Categories[t].id==this.categoryId&&(this.selectedCategoryName=this.group.Categories[t].name);else this.selectedCategoryName="categories.all"}})</script></dom-module></div><dom-module id="yp-group"><template><style include="iron-flex iron-flex-alignment">.objectives{padding-bottom:40px;max-width:432px;}.description{padding:12px;}yp-ajax{background-color:var(--primary-background-color);}.counterInfo{font-size:11px;}.topContainer{margin-top:16px;}.createFab{position:fixed;bottom:24px;right:28px;background-color:var(--accent-color);color:#FFF;--paper-fab-iron-icon:{color:var(--icon-general-color, #FFF);height:40px;width:40px;};}.createFab[is-map]{right:inherit;left:28px;}paper-tab{--paper-tabs:{font-family:var(--app-normal-font-family, Roboto);};font-family:var(--app-normal-font-family, Roboto);}.createFab[wide-layout]{width:72px;height:72px;--paper-fab-iron-icon:{color:var(--icon-general-color, #FFF);width:50px;height:50px;};}.createFabContainer[wide-layout] .createFab{}.topArea{background-color:var(--primary-background-color);background-image:var(--top-area-background-image, none);height:300px;}.tabs{width:1100px;padding-top:8px;padding-bottom:8px;}.tabs .tab{width:250px;}.largeAddButton{margin-bottom:4px;}@media (max-width: 1000px){.tabs{font-size:15px;}.topArea{height:auto;background-image:none;}}@media (max-width: 600px){.tabs{font-size:14px;word-wrap:break-word !important;}.tabs[has-non-open-posts]{font-size:14px;}.counterInfo[has-non-open-posts]{font-size:9px;}.tabs .tab{word-wrap:break-word !important;}.largeAddButton[is-apple]{margin-top:32px;}.largeAddButton[is-ipad]{margin-top:48px;}}@media (max-width: 380px){.tabs{font-size:14px;width:360px;}paper-tab{}}@media (max-width: 320px){.tabs{font-size:13px;}paper-tab{}}.tabSubTitle{font-size:13px;}.minHeightSection{min-height:450px;}.tabContainer[hide]{display:none;}[hidden]{display:none !important;}</style><div id="topContainer"><div id="topArea"class="large-card-wrapper layout horizontal center-center topArea"hidden$="[[group.configuration.hideGroupHeader]]"><yp-group-card-large id="groupCard"class="largeCard"group="[[group]]"on-update-group="_refreshAjax"></yp-group-card-large></div><div class="largeAddButton layout horizontal center-center"is-apple$="[[isOldiOs]]"is-ipad$="[[isIpad]]"hidden$="[[group.configuration.hideNewPost]]"><yp-post-card-add group="[[group]]"disabled="[[disableNewPosts]]"on-new-post="_newPost"elevation="2"role="button"aria-label="Add idea"></yp-post-card-add></div><div class="layout horizontal center-center tabContainer"hide$="[[group.configuration.hideAllTabs]]"hidden$="[[group.configuration.hideGroupLevelTabs]]"><paper-tabs scrollable$="[[shouldScrollTabs]]"id="paperTabs"has-non-open-posts$="[[hasNonOpenPosts]]"class="tabs"selected="{{selectedTab}}"attr-for-selected="name"focused=""><paper-tab id="tab1"name="open"><div class="layout vertical center-center tabCounterContainer"><div hidden$="[[isTabOpen]]">[[t('posts.open')]]</div><div hidden$="[[!isTabOpen]]"class="tabSubTitsle">[[tabOpenSubTitle]]</div><div class="counterInfo"has-non-open-posts$="[[hasNonOpenPosts]]"id="tabCountOpen"></div></div></paper-tab><template is="dom-if"if="[[hasNonOpenPosts]]"><paper-tab name="in_progress"><div class="layout vertical center-center tabCounterContainer"><div>[[t('posts.inProgress')]]</div><div hidden$="[[!isTabInProgress]]"class="tabSubTitle">[[tabInProgressSubTitle]]</div><div hidden$="[[isTabInProgress]]"has-non-open-posts$="[[hasNonOpenPosts]]"class="counterInfo"id="tabCountInProgress"></div></div></paper-tab><paper-tab name="successful"><div class="layout vertical center-center tabCounterContainer"><div>[[t('posts.successful')]]</div><div hidden$="[[!isTabSuccessful]]"class="tabSubTitle">[[tabSuccessfulSubTitle]]</div><div hidden$="[[isTabSuccessful]]"has-non-open-posts$="[[hasNonOpenPosts]]"class="counterInfo"id="tabCountSuccessful"></div></div></paper-tab><paper-tab name="failed"><div class="layout vertical center-center tabCounterContainer"><div>[[t('posts.failed')]]</div><div hidden$="[[!isTabFailed]]"class="tabSubTitle">[[tabFailedSubTitle]]</div><div hidden$="[[isTabFailed]]"has-non-open-posts$="[[hasNonOpenPosts]]"class="counterInfo"id="tabCountFailed"></div></div></paper-tab></template><paper-tab name="news"hidden$="[[group.configuration.hideNewsfeeds]]">[[t('news')]]</paper-tab><paper-tab name="map"hidden$="[[locationHidden]]">[[t('posts.map')]]</paper-tab></paper-tabs></div><iron-pages id="tabPages"class="tabPages"selected="{{selectedTab}}"attr-for-selected="name"entry-animation="fade-in-animation"exit-animation="fade-out-animation"><section name="open"role="main"aria-label$="[[t('posts.posts')]]"><div class="layout horizontal center-center"><yp-post-list id="openPostList"sub-title="{{tabOpenSubTitle}}"selected-tab="[[selectedTab]]"list-route="[[listRoute]]"status-filter="open"tab-counter-id="tabCountOpen"searching-for="[[searchingFor]]"group="[[group]]"group-id="[[lastValidGroupId]]"></yp-post-list></div></section><section name="news"class="minHeightSection"><template is="dom-if"if="[[newsTabSelected]]"><ac-activities id="groupActivities"disable-new-posts="[[disableNewPosts]]"selected-tab="[[selectedTab]]"list-route="[[listRoute]]"group-id="[[group.id]]"></ac-activities></template></section><template is="dom-if"if="[[hasNonOpenPosts]]"><section name="in_progress"><div class="layout horizontal center-center"><yp-post-list id="inProgressPostList"sub-title="{{tabInProgressSubTitle}}"selected-tab="[[selectedTab]]"list-route="[[listRoute]]"status-filter="in_progress"tab-counter-id="tabCountInProgress"searching-for="[[searchingFor]]"group="[[group]]"group-id="[[lastValidGroupId]]"></yp-post-list></div></section><section name="successful"><div class="layout horizontal center-center"><yp-post-list id="successfulPostList"sub-title="{{tabSuccessfulSubTitle}}"selected-tab="[[selectedTab]]"list-route="[[listRoute]]"status-filter="successful"tab-counter-id="tabCountSuccessful"searching-for="[[searchingFor]]"group="[[group]]"group-id="[[lastValidGroupId]]"></yp-post-list></div></section><section name="failed"><div class="layout horizontal center-center"><yp-post-list id="failedPostList"sub-title="{{tabFailedSubTitle}}"selected-tab="[[selectedTab]]"list-route="[[listRoute]]"status-filter="failed"tab-counter-id="tabCountFailed"searching-for="[[searchingFor]]"group="[[group]]"group-id="[[lastValidGroupId]]"></yp-post-list></div></section></template><section name="map"hidden$="[[locationHidden]]"class="minHeightSection"><template is="dom-if"if="[[mapActive]]"restamp=""><yp-post-map id="postsMap"group-id="[[group.id]]"></yp-post-map></template></section></iron-pages></div><template is="dom-if"if="[[!disableNewPosts]]"restamp=""><div class="create-fab-wrapper layout horizontal end-justified createFabContainer"hidden$="[[disableNewPosts]]"><paper-fab class="createFab"icon="[[createFabIcon]]"elevation="5"is-map$="[[mapActive]]"wide-layout$="{{wideWidth}}"title$="[[t('post.new')]]"on-tap="_newPost"></paper-fab></div></template><iron-scroll-threshold id="scrollTheshold"lower-threshold="550"on-lower-threshold="_loadMoreData"scroll-target="document"></iron-scroll-threshold><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-yp-refresh-group-posts="_refreshGroupPosts"></lite-signal><lite-signal on-lite-signal-yp-refresh-activities-scroll-threshold="_clearScrollThreshold"></lite-signal><iron-media-query query="(min-width: 1024px)"query-matches="{{wideWidth}}"></iron-media-query><iron-media-query query="(max-width: 700px)"query-matches="{{phoneWidth}}"></iron-media-query><app-route route="{{idRoute}}"pattern="/:id"data="{{idRouteData}}"tail="{{tabRoute}}"></app-route><app-route route="{{tabRoute}}"pattern="/:tabName"data="{{tabRouteData}}"tail="{{listRoute}}"></app-route><div class="layout horizontal center-center"><yp-ajax large-spinner=""id="ajax"on-response="_groupResponse"></yp-ajax><yp-ajax id="ajaxCheckNonOpenPosts"on-response="_nonOpenPosts"></yp-ajax><yp-ajax id="pagesAjax"on-response="_pagesResponse"></yp-ajax><yp-ajax hidden=""id="configurationAjax"on-response="_configurationAjaxResponse"></yp-ajax></div></template><script>Polymer({is:"yp-group",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypThemeBehavior,Polymer.AccessHelpers,Polymer.YpNewsTabSelected,Polymer.ypDetectOldiOs,Polymer.ypGotoBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypNumberFormatBehavior,Polymer.ypGroupBaseBehaviors],listeners:{"yp-post-count":"_updateTabPostCount","yp-post-new":"_newPost"},_afterRefreshGroup:function(){this.group&&this.group.is_group_folder&&-1===window.location.href.indexOf("/group_folder/")&&this.redirectTo("/group_folder/"+this.group.id)}})</script></dom-module>