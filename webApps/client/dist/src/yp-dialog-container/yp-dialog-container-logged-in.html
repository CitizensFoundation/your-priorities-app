<div hidden=""by-polymer-bundler=""><dom-module id="ac-notification-selection"assetpath="../ac-notifications/"><template><style include="iron-flex iron-flex-alignment">.half{width:50%;}.notificationName{padding-top:16px;font-size:16px;font-weight:bold;margin-bottom:8px;padding-bottom:4px;color:#333;border-bottom:solid 1px #ddd;}.notificationSub{color:#888;}paper-radio-button{padding-top:8px;padding-bottom:8px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><div class="layout vertical"><div class="notificationName">[[name]]</div><div class="layout horizontal wrap"><div class="layout vertical half"><div class="notificationSub">[[t('notification.method')]]</div><div class="layout horizontal"><paper-radio-group id="notificationMethodGroup"name="method"class="method"attr-for-selected="enum-value"selected="{{method}}"><template is="dom-repeat"items="[[availableMethods]]"><paper-radio-button enum-value$="[[item.enumValue]]">[[item.name]]</paper-radio-button></template></paper-radio-group></div></div><div class="layout vertical half"><div class="notificationSub">[[t('notification.frequency')]]</div><div class="layout horizontal"><paper-radio-group id="notificationFrequencyGroup"name="frequency"attr-for-selected="enum-value"class="frequency"selected="{{frequency}}"><template is="dom-repeat"items="[[availableFrequencies]]"><paper-radio-button disabled$="[[_isDelayed(item)]]"enum-value$="[[item.enumValue]]">[[item.name]]</paper-radio-button></template></paper-radio-group></div></div></div></div></template><script>Polymer({is:"ac-notification-selection",behaviors:[Polymer.ypLanguageBehavior],properties:{name:String,setting:{type:Object,notify:!0,observer:"_settingChanged"},frequency:{type:Number,notify:!0,observer:"_frequencyChanged"},method:{type:Number,notify:!0,observer:"_methodChanged"},availableFrequencies:{type:Array,computed:"_getAvailableFrequencies(language, method)"},availableMethods:{type:Object,computed:"_availableMethods(language)"}},_availableMethods:function(e){return e?[{name:this.t("notification.muted"),enumValue:0},{name:this.t("notification.browser"),enumValue:1},{name:this.t("notification.email"),enumValue:2}]:[]},_methodChanged:function(e){e=parseInt(e),this.setting.method!=e&&this.set("setting.method",e)},_frequencyChanged:function(e){e=parseInt(e),this.setting.frequency!=e&&this.set("setting.frequency",e)},_settingChanged:function(e){e&&(this.set("method",e.method),this.set("frequency",e.frequency))},_isDelayed:function(e){return 0<e.enumValue},_getAvailableFrequencies:function(e,t){var n=[];return e&&t&&0!=t&&(1==t?(this.set("frequency",0),n=[{name:this.t("notification.asItHappens"),enumValue:0}]):2==t&&(n=[{name:this.t("notification.asItHappens"),enumValue:0},{name:this.t("notification.hourly"),enumValue:1},{name:this.t("notification.daily"),enumValue:2},{name:this.t("notification.weekly"),enumValue:3},{name:this.t("notification.monthly"),enumValue:5}])),n}})</script></dom-module><dom-module id="ac-notification-settings"assetpath="../ac-notifications/"><template><style include="iron-flex iron-flex-alignment"></style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><ac-notification-selection name="[[t('notification.myPosts')]]"setting="{{notificationsSettings.my_posts}}"></ac-notification-selection><ac-notification-selection name="[[t('notification.myPostsEndorsements')]]"setting="{{notificationsSettings.my_posts_endorsements}}"></ac-notification-selection><ac-notification-selection name="[[t('notification.myPoints')]]"setting="{{notificationsSettings.my_points}}"></ac-notification-selection><ac-notification-selection name="[[t('notification.myPointEndorsements')]]"setting="{{notificationsSettings.my_points_endorsements}}"></ac-notification-selection><ac-notification-selection name="[[t('notification.allCommunity')]]"setting="{{notificationsSettings.all_community}}"></ac-notification-selection><ac-notification-selection name="[[t('notification.allGroup')]]"setting="{{notificationsSettings.all_group}}"></ac-notification-selection></template><script>Polymer({is:"ac-notification-settings",behaviors:[Polymer.ypLanguageBehavior],properties:{notificationsSettings:{type:Object,notify:!0,observer:"_notificationsSettingsChanged"}},observers:["settingsStarChanged(notificationsSettings.*)"],_notificationsSettingsChanged:function(){},settingsStarChanged:function(){this.fire("yp-notifications-changed",this.notificationsSettings)}})</script></dom-module><dom-module id="yp-user-edit"assetpath="../yp-user/"><template><style include="iron-flex iron-flex-alignment">.container{height:100%;min-height:350px;}.additionalSettings{margin-top:16px;}.icon{padding-right:8px;}h2{padding-top:16px;}#deleteUser{max-width:250px;margin-top:16px;color:#F00;}.disconnectButtons{margin-top:8px;max-width:250px;}yp-language-selector{margin-bottom:8px;}paper-button{text-align:center;}.ssn{margin-top:0;margin-bottom:4px;font-weight:400;}[hidden]{display:none !important;}.tempApiKeyContainer{margin-top:16px;margin-bottom:16px;padding-bottom:8px;padding-top:8px;}.temporaryApiKeyInformation{color:#F00;font-size:16px;margin-bottom:8px;}.apiKey{font-size:16px;padding-right:8px;padding-top:12px;font-weight:bold;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog name="userEdit"id="editDialog"title="[[editHeaderText]]"double-width=""icon="face"action="[[action]]"on-iron-form-response="_editResponse"method="[[method]]"params="[[params]]"save-text="[[saveText]]"toast-text="[[toastText]]"><div class="container"><div class="layout vertical wrap container"><paper-input id="name"name="name"type="text"label="[[t('Name')]]"value="{{user.name}}"maxlength="50"char-counter=""></paper-input><div class="ssn"hidden$="[[!user.ssn]]">[[t('ssn')]]: [[user.ssn]]</div><paper-input id="email"name="email"type="text"label="[[t('Email')]]"value="{{user.email}}"></paper-input><div class="layout horizontal wrap"><div class="layout vertical additionalSettings"><yp-file-upload id="profileImageUpload"raised="true"multi="false"target="/api/images?itemType=user-profile"method="POST"on-success="_profileImageUploaded"><iron-icon class="icon"icon="photo-camera"></iron-icon><span>[[t('image.profile.upload')]]</span></yp-file-upload></div><div class="layout vertical additionalSettings"hidden=""><yp-file-upload id="headerImageUpload"raised="true"multi="false"target="/api/images?itemType=user-header"method="POST"on-success="_headerImageUploaded"><iron-icon class="icon"icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload></div></div><yp-language-selector name="defaultLocale"auto-translate-option-disabled=""selected-locale="{{user.default_locale}}"></yp-language-selector><paper-button hidden$="[[user.profile_data.hasApiKey]]"raised=""class="disconnectButtons"on-tap="_createApiKey">[[t('createApiKey')]]</paper-button><paper-button hidden$="[[!user.profile_data.hasApiKey]]"raised=""class="disconnectButtons"on-tap="_reCreateApiKey">[[t('reCreateApiKey')]]</paper-button><div class="layout vertical tempApiKeyContainer"hidden$="[[!currentApiKey]]"><div class="temporaryApiKeyInformation">[[t('showingApiKeyOnce')]]</div><div class="layout horizontal"><div class="apiKey">[[currentApiKey]]</div><paper-button raised=""on-tap="_copyApiKey">[[t('copyApiKey')]]</paper-button></div></div><paper-button hidden$="[[!user.facebook_id]]"class="disconnectButtons"raised=""on-tap="_disconnectFromFacebookLogin">[[t('disconnectFromFacebookLogin')]]</paper-button><paper-button hidden$="[[!user.ssn]]"raised=""class="disconnectButtons"on-tap="_disconnectFromSamlLogin">[[t('disconnectFromSamlLogin')]]</paper-button><paper-button id="deleteUser"raised=""on-tap="_deleteOrAnonymizeUser">[[t('deleteOrAnonymizeUser')]]</paper-button><input type="hidden"name="uploadedProfileImageId"value="[[uploadedProfileImageId]]"> <input type="hidden"name="uploadedHeaderImageId"value="[[uploadedHeaderImageId]]"><h2>[[t('user.notifications')]]</h2><ac-notification-settings notifications-settings="{{notificationSettings}}"></ac-notification-settings><input type="hidden"name="notifications_settings"value="[[encodedUserNotificationSettings]]"><yp-ajax id="disconnectFacebookLoginAjax"method="DELETE"url="/api/users/disconnectFacebookLogin"on-response="_disconnectFacebookLoginResponse"></yp-ajax><yp-ajax id="disconnectSamlLoginAjax"method="DELETE"url="/api/users/disconnectSamlLogin"on-response="_disconnectSamlLoginResponse"></yp-ajax><yp-ajax id="createApiKeyAjax"method="POST"url="/api/users/createApiKey"on-response="_apiKeyCreateResponse"></yp-ajax></div></div></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-user-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior],properties:{action:{type:String,value:"/api/users"},user:{type:Object,observer:"_userChanged"},params:{type:String},method:{type:String},currentApiKey:{type:String,value:null},selected:{type:Number,value:0},encodedUserNotificationSettings:{type:String,observer:"_encodedUserNotificationSettingsChanged"},uploadedProfileImageId:{type:String},uploadedHeaderImageId:{type:String},notificationSettings:{type:Object,notify:!0,observer:"_notificationSettingsChanged"}},listeners:{"yp-notifications-changed":"_setNotificationSettings"},_editResponse:function(e,t){t.response.duplicateEmail&&Polymer.dom(document).querySelector("yp-app").getDialogAsync("errorDialog",function(e){e.showErrorDialog(this.t("emailAlreadyRegisterred"))}.bind(this))},_checkIfValidEmail:function(){return this.user&&this.user.email&&!(-1<this.user.email.indexOf("@citizens.is")&&-1<this.user.email.indexOf("anonymous"))},_disconnectFromFacebookLogin:function(){this._checkIfValidEmail()?Polymer.dom(document).querySelector("yp-app").getDialogAsync("confirmationDialog",function(e){e.open(this.t("areYouSureYouWantToDisconnectFacebookLogin"),this._reallyDisconnectFromFacebookLogin.bind(this),!0)}.bind(this)):Polymer.dom(document).querySelector("yp-app").getDialogAsync("errorDialog",function(e){e.showErrorDialog(this.t("cantDisconnectFromFacebookWithoutValidEmail"))}.bind(this))},_reallyDisconnectFromFacebookLogin:function(){this.$.disconnectFacebookLoginAjax.body={},this.$.disconnectFacebookLoginAjax.generateRequest()},_disconnectFromSamlLogin:function(){this._checkIfValidEmail()?Polymer.dom(document).querySelector("yp-app").getDialogAsync("confirmationDialog",function(e){e.open(this.t("areYouSureYouWantToDisconnectSamlLogin"),this._reallyDisconnectFromSamlLogin.bind(this),!0)}.bind(this)):Polymer.dom(document).querySelector("yp-app").getDialogAsync("errorDialog",function(e){e.showErrorDialog(this.t("cantDisconnectFromSamlWithoutValidEmail"))}.bind(this))},_reallyDisconnectFromSamlLogin:function(){this.$.disconnectSamlLoginAjax.body={},this.$.disconnectSamlLoginAjax.generateRequest()},_disconnectFacebookLoginResponse:function(){this.set("user.facebook_id",null),window.appGlobals.notifyUserViaToast(this.t("disconnectedFacebookLoginFor")+" "+this.user.email)},_disconnectSamlLoginResponse:function(){this.set("user.ssn",null),window.appGlobals.notifyUserViaToast(this.t("disconnectedSamlLoginFor")+" "+this.user.email)},_setNotificationSettings:function(e,t){this.set("notificationSettings",t),this.set("encodedUserNotificationSettings",this._encodeNotificationsSettings(this.notificationSettings))},_notificationSettingsChanged:function(){this.set("encodedUserNotificationSettings",this._encodeNotificationsSettings(this.notificationSettings))},_encodedUserNotificationSettingsChanged:function(){},_encodeNotificationsSettings:function(e){return JSON.stringify(e)},_userChanged:function(e){this.set("notificationSettings",e.notifications_settings)},_profileImageUploaded:function(e,t){var i=JSON.parse(t.xhr.response);this.set("uploadedProfileImageId",i.id)},_headerImageUploaded:function(e,t){var i=JSON.parse(t.xhr.response);this.set("uploadedHeaderImageId",i.id)},_customRedirect:function(){window.appUser.checkLogin()},_copyApiKey:function(){navigator.clipboard.writeText(this.currentApiKey)},_clear:function(){this.set("user",{name:"",email:"",access:2}),this.set("uploadedProfileImageId",null),this.set("uploadedHeaderImageId",null),this.$.headerImageUpload.clear(),this.$.profileImageUpload.clear()},setup:function(e,t,i,o){this.set("user",e),this.set("new",t),this.set("refreshFunction",i),o&&this.set("selected",1),this._setupTranslation()},_setupTranslation:function(){this.new?(this.editHeaderText=this.t("user.new"),this.toastText=this.t("userToastCreated"),this.set("saveText",this.t("create"))):(this.set("saveText",this.t("save")),this.editHeaderText=this.t("user.edit"),this.toastText=this.t("userToastUpdated"))},_createApiKey:function(){window.appGlobals.activity("open","user.createApiKey"),this.$.createApiKeyAjax.body={},this.$.createApiKeyAjax.generateRequest()},_apiKeyCreateResponse:function(e){this.set("currentApiKey",e.detail.response.apiKey),this.set("user.profile_data.hasApiKey",!0)},_reCreateApiKey:function(){window.appGlobals.activity("open","user.reCreateApiKey"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("apiActionDialog",function(e){e.setup("/api/users/createApiKey",this.t("areYouSureYouWantToRecreateApiKey"),this._apiKeyCreateResponse.bind(this),this.t("recreate"),"POST"),e.open()}.bind(this))},_deleteOrAnonymizeUser:function(){Polymer.dom(document).querySelector("yp-app").getDialogAsync("userDeleteOrAnonymize",function(e){e.open()}.bind(this))}})</script><dom-module id="yp-user-delete-or-anonymize"assetpath="../yp-user/"><template><style include="iron-flex iron-flex-alignment">:host{}paper-dialog{padding-left:8px;padding-right:8px;background-color:#fff;max-width:450px;}.buttons{margin-top:16px;margin-bottom:4px;text-align:center;}.boldButton{font-weight:bold;}.header{font-size:22px;color:#F00;font-weight:bold;}@media (max-width: 480px){}@media (max-width: 320px){}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><paper-dialog id="dialog"modal=""><div class="header layout horizontal center-center"><div>{{t('deleteOrAnonymizeUser')}}</div></div><div class="helpInfo">{{t('anonymizeUserInfo')}}</div><div class="helpInfo">{{t('deleteUserInfo')}}</div><div class="buttons layout vertical center-center"><div class="layout horizontal ajaxElements"><yp-ajax id="deleteUserAjax"use-spinner=""on-response="_completed"method="DELETE"url="/api/users/delete_current_user"></yp-ajax><yp-ajax id="anonymizeAjax"use-spinner=""on-response="_completed"method="DELETE"url="/api/users/anonymize_current_user"></yp-ajax></div><div class="layout horizontal center-center"><paper-button dialog-dismiss="">[[t('cancel')]]</paper-button><paper-button raised=""class="boldButton"on-tap="_deleteUser">[[t('deleteAccount')]]</paper-button><paper-button raised=""class="boldButton"on-tap="_anonymizeUser">[[t('anonymizeAccount')]]</paper-button></div></div></paper-dialog></template></dom-module><script>Polymer({is:"yp-user-delete-or-anonymize",behaviors:[Polymer.ypLanguageBehavior],_deleteUser:function(){Polymer.dom(document).querySelector("yp-app").getDialogAsync("confirmationDialog",function(e){e.open(this.t("areYouSureYouWantToDeleteUser"),this._deleteUserFinalWarning.bind(this),!0)}.bind(this))},_deleteUserFinalWarning:function(){this.async(function(){Polymer.dom(document).querySelector("yp-app").getDialogAsync("confirmationDialog",function(e){e.open(this.t("areYouReallySureYouWantToDeleteUser"),this._deleteUserForReal.bind(this),!0)}.bind(this))})},_anonymizeUser:function(){Polymer.dom(document).querySelector("yp-app").getDialogAsync("confirmationDialog",function(e){e.open(this.t("areYouSureYouWantToAnonymizeUser"),this._anonymizeUserFinalWarning.bind(this),!0)}.bind(this))},_anonymizeUserFinalWarning:function(){this.async(function(){Polymer.dom(document).querySelector("yp-app").getDialogAsync("confirmationDialog",function(e){e.open(this.t("areYouReallySureYouWantToAnonymizeUser"),this._anonymizeUserForReal.bind(this),!0)}.bind(this))})},_deleteUserForReal:function(){this.$.deleteUserAjax.body={},this.$.deleteUserAjax.generateRequest()},_anonymizeUserForReal:function(){this.$.anonymizeAjax.body={},this.$.anonymizeAjax.generateRequest()},open:function(){this.$.dialog.open()},_completed:function(){this.$.dialog.close(),window.location="/"}})</script><dom-module id="yp-confirmation-dialog"><template><style include="iron-flex iron-flex-alignment">paper-dialog{background-color:#FFF;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><paper-dialog id="confirmationDialog"><div>[[confirmationText]]</div><div class="buttons"><paper-button hidden$="[[hideCancel]]"on-tap="_reset"dialog-dismiss="">[[t('cancel')]]</paper-button><paper-button dialog-confirm=""on-tap="_confirm">[[t('confirm')]]</paper-button></div></paper-dialog></template><script>Polymer({is:"yp-confirmation-dialog",behaviors:[Polymer.ypLanguageBehavior],properties:{confirmationText:{type:String},onConfirmedFunction:{type:Function,value:null},useFinalWarning:Boolean,haveIssuedFinalWarning:Boolean,hideCancel:{type:Boolean,value:!1}},_reset:function(){this.set("confirmationText",null),this.set("onConfirmedFunction",null),this.haveIssuedFinalWarning=!1,this.useFinalWarning=!1,this.set("hideCancel",!1)},open:function(n,i,e,t,o){this.set("confirmationText",n),this.set("onConfirmedFunction",i),this.$$("#confirmationDialog").modal=!!e,this.$$("#confirmationDialog").open(),this.useFinalWarning=!!t,this.haveIssuedFinalWarning=!1,o?this.set("hideCancel",!0):this.set("hideCancel",!1)},_confirm:function(){this.useFinalWarning&&!this.haveIssuedFinalWarning?(this.haveIssuedFinalWarning=!0,this.$.confirmationDialog.close(),this.set("confirmationText",this.t("finalDeleteWarning")),this.async(function(){this.$.confirmationDialog.open()})):this.onConfirmedFunction&&(this.onConfirmedFunction(),this._reset())}})</script></dom-module><dom-module id="ac-notification-toast"assetpath="../ac-notifications/"><template><style include="iron-flex iron-flex-alignment">.text{margin:16px;}.icon{--iron-icon-height:32px;--iron-icon-width:32px;min-width:32px;min-height:32px;}.text[large-font]{margin:8px;font-size:16px;margin-left:12px;}[hidden]{display:none !important;}</style><paper-toast id="toast"duration="5000"><div class="layout vertical"><yp-user-with-organization class="layout horizontal self-end"user="[[user]]"hidden$="[[!user]]"></yp-user-with-organization><div class="layout horizontal"><iron-icon class="icon"hidden$="[[!icon]]"icon="[[icon]]"></iron-icon><div class="text"large-font$="[[largerFont]]">[[notificationText]]</div></div></div></paper-toast></template><script>Polymer({is:"ac-notification-toast",properties:{user:{type:Object,value:null},notificationText:{type:String,value:null},icon:{type:String,value:null},largerFont:{type:Boolean,value:!1}},open:function(t,e,i,n,o,s){this.set("notificationText",e),i||this.set("user",t),n?this.set("icon",n):this.set("icon",null),s?this.set("largerFont",!0):this.set("largerFont",!1),this.$.toast.close(),this.async(function(){o&&(this.$.toast.duration=o),this.$.toast.open()})}})</script></dom-module></div>