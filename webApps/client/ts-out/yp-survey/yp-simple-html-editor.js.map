{"version":3,"file":"yp-simple-html-editor.js","sourceRoot":"","sources":["../../src/yp-survey/yp-simple-html-editor.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/ban-ts-ignore */\nimport { html, css, PropertyValueMap } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\nimport { YpBaseElement } from \"../common/yp-base-element.js\";\nimport { ShadowStyles } from \"../common/ShadowStyles.js\";\n\nimport \"@material/web/iconbutton/filled-tonal-icon-button.js\";\n\n@customElement(\"yp-simple-html-editor\")\nexport class YpSimpleHtmlEditor extends YpBaseElement {\n  @property({ type: Object })\n  question: YpStructuredQuestionData = { maxLength: 0, text: \"\" };\n\n  @property({ type: Number })\n  index: number | undefined;\n\n  @property({ type: Boolean })\n  useSmallFont = false;\n\n  @property({ type: String })\n  value = \"\";\n\n  @property({ type: Number })\n  characterCount = 0;\n\n  @property({ type: Boolean })\n  hasFocus = false;\n\n  @property({ type: Boolean })\n  allowFirefoxFocusHack = true;\n\n  @property({ type: Boolean })\n  showErrorLine = false;\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        :host {\n          display: inline-block;\n          margin-top: 8px;\n          width: 100%;\n        }\n\n        #htmlEditor {\n          background-color: var(--md-sys-color-surface);\n          color: var(--md-sys-color-on-surface);\n          width: 100%;\n          height: 300px;\n          border-top: 1px solid var(--md-sys-color-primary);\n          border-bottom: 1px solid var(--md-sys-color-primary);\n          outline: none;\n          overflow: auto;\n          padding-top: 8px;\n          padding-bottom: 8px;\n          transition: border-bottom-color 0.1s;\n        }\n\n        #htmlEditor:focus {\n          border-bottom: 2px solid var(--md-sys-color-primary);\n        }\n\n        #htmlEditor[has-error] {\n          border-bottom: 2px solid #dd2c00 !important;\n        }\n\n        .characterCounter {\n          font-size: 12px;\n          text-align: right;\n          width: 100%;\n          transition: color 0.1s;\n          margin-top: 1px;\n        }\n\n        .characterCounter[has-focus] {\n          margin-top: 0px;\n        }\n\n        .characterCounter[has-error] {\n          color: var(--md-sys-color-error);\n        }\n\n        filled-tonal-icon-button {\n          margin-left: 4px;\n          margin-right: 4px;\n        }\n\n        @media (max-width: 800px) {\n          #htmlEditor {\n            height: 220px;\n          }\n        }\n      `,\n    ];\n  }\n\n  override render() {\n    return html`\n      <div class=\"layout horizontal wrap\">\n        <div class=\"layout horizontal\">\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatBold\")}\"\n            @mousedown=\"${this._toggleBold}\"\n            ><md-icon>format_bold</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatItalic\")}\"\n            @mousedown=\"${this._toggleItalic}\"\n            ><md-icon>format_italic</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatUnderline\")}\"\n            @mousedown=\"${this._toggleUnderline}\"\n            ><md-icon>format_underlined</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatListBullets\")}\"\n            @mousedown=\"${this._toggleListBullets}\"\n            ><md-icon>format_list_bulleted</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatListNumbered\")}\"\n            @mousedown=\"${this._toggleListNumbers}\"\n            ><md-icon>format_list_numbered</md-icon></filled-tonal-icon-button\n          >\n        </div>\n        <div class=\"layout horizontal\">\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatLeft\")}\"\n            @mousedown=\"${this._toggleAlignLeft}\"\n            ><md-icon>format_align_left</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatCenter\")}\"\n            @mousedown=\"${this._toggleAlignCenter}\"\n            ><md-icon>format_align_center</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatRight\")}\"\n            @mousedown=\"${this._toggleAlignRight}\"\n            ><md-icon>format_align_right</md-icon></filled-tonal-icon-button\n          >\n        </div>\n\n        <div class=\"layout horizontal\">\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatH1\")}\"\n            @mousedown=\"${this._toggleH1}\"\n            ><md-icon>format_h1</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatH2\")}\"\n            @mousedown=\"${this._toggleH2}\"\n            ><md-icon>format_h2</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatH3\")}\"\n            @mousedown=\"${this._toggleH3}\"\n            ><md-icon>format_h3</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatH4\")}\"\n            @mousedown=\"${this._toggleH4}\"\n            ><md-icon>format_h4</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatH5\")}\"\n            @mousedown=\"${this._toggleH5}\"\n            ><md-icon>format_h5</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatH6\")}\"\n            @mousedown=\"${this._toggleH6}\"\n            ><md-icon>format_h6</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatP\")}\"\n            @mousedown=\"${this._toggleP}\"\n            ><md-icon>format_paragraph</md-icon></filled-tonal-icon-button\n          >\n          <filled-tonal-icon-button\n            aria-label=\"${this.t(\"formatClear\")}\"\n            @mousedown=\"${this._clearFormat}\"\n            ><md-icon>format_clear</md-icon></filled-tonal-icon-button\n          >\n        </div>\n      </div>\n      <div\n        id=\"htmlEditor\"\n        ?has-error=\"${this.showErrorLine}\"\n        @focus=\"${this._setFocus}\"\n        @blur=\"${this._setBlur}\"\n        contenteditable=\"true\"\n        spellcheck=\"false\"\n        @keydown=\"${this._keydown}\"\n        @paste=\"${this._paste}\"\n        @click=\"${this._changed}\"\n        @keyup=\"${this._changed}\"\n        @changed=\"${this._changed}\"\n      ></div>\n      <div\n        ?has-focus=\"${this.hasFocus}\"\n        ?has-error=\"${this.showErrorLine}\"\n        class=\"layout end characterCounter\"\n      >\n        ${this.characterCount}<span ?hidden=\"${!this.question.maxLength}\"\n          >/${this.question.maxLength}</span\n        >\n      </div>\n    `;\n  }\n  _setFocus() {\n    this.hasFocus = true;\n\n    if (this._isFirefox() && this.allowFirefoxFocusHack) {\n      setTimeout(() => {\n        this.allowFirefoxFocusHack = false;\n        (this.shadowRoot!.querySelector(\n          \"#htmlEditor\"\n        ) as HTMLInputElement)!.blur();\n        (this.shadowRoot!.querySelector(\n          \"#htmlEditor\"\n        ) as HTMLInputElement)!.focus();\n        setTimeout(() => {\n          this.allowFirefoxFocusHack = true;\n        }, 150);\n      });\n    }\n  }\n\n  override connectedCallback(): void {\n    super.connectedCallback();\n  }\n\n  protected override firstUpdated(_changedProperties: PropertyValueMap<any> | Map<PropertyKey, unknown>): void {\n    super.firstUpdated(_changedProperties);\n    this.setRichValue(this.value);\n  }\n\n  _setBlur(event: CustomEvent) {\n    //TODO: Fix blinking on using the icon buttons\n    this.hasFocus = false;\n  }\n\n  setRichValue(value: string) {\n    this.value = value;\n    this.shadowRoot!.querySelector(\"#htmlEditor\")!.innerHTML = this.value;\n  }\n\n  _updateCharacterCounter() {\n    const textContent =\n      this.shadowRoot!.querySelector(\"#htmlEditor\")!.textContent;\n\n    if (textContent) {\n      this.characterCount = textContent.length;\n    } else {\n      this.characterCount = 0;\n    }\n  }\n\n  _keydown(event: KeyboardEvent) {\n    this._updateCharacterCounter();\n    this.showErrorLine = false;\n\n    if (this.question.maxLength) {\n      const allowedKeyCodes = [8, 37, 38, 39, 40];\n      const allowedKeyCodesWithCtrlKey = [65, 90, 86, 67, 88, 8];\n      const isAllowedKey = allowedKeyCodes.includes(event.keyCode);\n      const isShortcut =\n        event.ctrlKey && allowedKeyCodesWithCtrlKey.includes(event.keyCode);\n      const isAllowedAction = isAllowedKey || isShortcut;\n\n      if (isAllowedAction) {\n        return;\n      }\n\n      if (this.characterCount >= this.question.maxLength) {\n        event.preventDefault();\n      }\n    }\n  }\n\n  _paste(event: ClipboardEvent | CustomEvent) {\n    if (this.question.maxLength) {\n      //@ts-ignore\n      const clipboardData = event.clipboardData || window.clipboardData;\n      const pastedText = clipboardData.getData(\"text/plain\");\n      //@ts-ignore\n      const content = event.target.textContent;\n      const contentLength = content.length;\n      //@ts-ignore\n      const selectedText = window.getSelection().toString();\n      const allowedPasteLength =\n        this.question.maxLength - contentLength + selectedText.length;\n      const slicedPasteText = pastedText.substring(0, allowedPasteLength);\n\n      event.preventDefault();\n\n      this._masterCommand(\"insertHTML\", false, slicedPasteText);\n    }\n\n    setTimeout(() => {\n      this._updateCharacterCounter();\n    });\n  }\n\n  _changed() {\n    this.value = this.shadowRoot!.querySelector(\"#htmlEditor\")!.innerHTML;\n    this._updateCharacterCounter();\n    this.fire('change', { value: this.value, index: this.index })\n  }\n\n  validate() {\n    if (this.question.required) {\n      if (this.value && this.value.length > 0) {\n        this.showErrorLine = false;\n        return true;\n      } else {\n        this.showErrorLine = true;\n        return false;\n      }\n    } else {\n      this.showErrorLine = false;\n      return true;\n    }\n  }\n\n  _isSafariOrIe11() {\n    return (\n      (navigator.userAgent.indexOf(\"Safari\") > -1 &&\n        navigator.userAgent.indexOf(\"Chrome\") === -1 &&\n        navigator.userAgent.indexOf(\"iPhone\") === -1 &&\n        navigator.userAgent.indexOf(\"iPad\") === -1) ||\n      /Trident.*rv[ :]*11\\./.test(navigator.userAgent)\n    );\n  }\n\n  _isFirefox() {\n    return navigator.userAgent.indexOf(\"Firefox\") > -1;\n  }\n\n  _clearFormat() {\n    this._masterCommand(\"removeFormat\");\n    this._masterCommand(\"formatBlock\", false, \"p\");\n  }\n\n  _clearFormatM() {\n    if (this._isSafariOrIe11()) this._clearFormat();\n  }\n\n  _toggleH1() {\n    this._masterCommand(\"formatBlock\", false, \"h1\");\n  }\n\n  _toggleH1M() {\n    if (this._isSafariOrIe11()) this._toggleH1();\n  }\n\n  _toggleH2() {\n    this._masterCommand(\"formatBlock\", false, \"h2\");\n  }\n\n  _toggleH2M() {\n    if (this._isSafariOrIe11()) this._toggleH2();\n  }\n\n  _toggleH3() {\n    this._masterCommand(\"formatBlock\", false, \"h3\");\n  }\n\n  _toggleH3M() {\n    if (this._isSafariOrIe11()) this._toggleH3();\n  }\n\n  _toggleH4() {\n    this._masterCommand(\"formatBlock\", false, \"h4\");\n  }\n\n  _toggleH4M() {\n    if (this._isSafariOrIe11()) this._toggleH4();\n  }\n\n  _toggleH5() {\n    this._masterCommand(\"formatBlock\", false, \"h5\");\n  }\n\n  _toggleH5M() {\n    if (this._isSafariOrIe11()) this._toggleH5();\n  }\n\n  _toggleH6() {\n    this._masterCommand(\"formatBlock\", false, \"h6\");\n  }\n\n  _toggleH6M() {\n    if (this._isSafariOrIe11()) this._toggleH6();\n  }\n\n  _toggleP() {\n    this._masterCommand(\"formatBlock\", false, \"p\");\n  }\n\n  _togglePM() {\n    if (this._isSafariOrIe11()) this._toggleP();\n  }\n\n  _toggleAlignLeft() {\n    this._masterCommand(\"JustifyLeft\", false, \"\");\n  }\n\n  _toggleAlignLeftM() {\n    if (this._isSafariOrIe11()) this._toggleAlignLeft();\n  }\n\n  _toggleAlignRight() {\n    this._masterCommand(\"JustifyRight\", false, \"\");\n  }\n\n  _toggleAlignRightM() {\n    if (this._isSafariOrIe11()) this._toggleAlignRight();\n  }\n\n  _toggleAlignCenter() {\n    this._masterCommand(\"JustifyCenter\", false, \"\");\n  }\n\n  _toggleAlignCenterM() {\n    if (this._isSafariOrIe11()) this._toggleAlignCenter();\n  }\n\n  _toggleAlignJustify() {\n    this._masterCommand(\"JustifyFull\", false, \"\");\n  }\n\n  _toggleAlignJustifyM() {\n    if (this._isSafariOrIe11()) this._toggleAlignJustify();\n  }\n\n  _toggleBold() {\n    this._masterCommand(\"bold\");\n  }\n\n  _toggleBoldM() {\n    if (this._isSafariOrIe11()) this._toggleBold();\n  }\n\n  _toggleItalic() {\n    this._masterCommand(\"italic\");\n  }\n\n  _toggleItalicM() {\n    if (this._isSafariOrIe11()) this._toggleItalic();\n  }\n\n  _toggleUnderline() {\n    this._masterCommand(\"underline\");\n  }\n\n  _toggleUnderlineM() {\n    if (this._isSafariOrIe11()) this._toggleUnderline();\n  }\n\n  _toggleListBullets() {\n    this._masterCommand(\"insertUnorderedList\");\n  }\n\n  _toggleListBulletsM() {\n    if (this._isSafariOrIe11()) this._toggleListBullets();\n  }\n\n  _toggleListNumbers() {\n    this._masterCommand(\"insertOrderedList\");\n  }\n\n  _toggleListNumbersM() {\n    if (this._isSafariOrIe11()) this._toggleListNumbers();\n  }\n\n  _masterCommand(commandName: string, showDefaultUI = false, value = \"\") {\n    document.execCommand(commandName, showDefaultUI, value);\n    this._changed();\n  }\n  /*\n  ready() {\n    if (window.i18nTranslation) {\n      this.language = window.locale;\n    }\n\n    super.ready();\n  }\n  */\n}\n"]}