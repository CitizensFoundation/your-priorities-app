{"version":3,"file":"yp-theme-color-input.js","sourceRoot":"","sources":["../../src/yp-theme/yp-theme-color-input.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, css, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\nimport \"@material/web/textfield/outlined-text-field.js\";\nimport { MdOutlinedTextField } from \"@material/web/textfield/outlined-text-field.js\";\n\nimport \"vanilla-colorful\";\n\nimport { YpBaseElement } from \"../common/yp-base-element.js\";\n\n@customElement(\"yp-theme-color-input\")\nexport class YpThemeColorInput extends YpBaseElement {\n  @property({ type: String })\n  color: string | undefined;\n\n  @property({ type: String })\n  label!: string;\n\n  @property({ type: Boolean })\n  disableSelection: boolean | undefined = false;\n\n  private isColorPickerActive: boolean = false;\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        md-outlined-select,\n        md-outlined-text-field {\n          width: 100%;\n          margin-bottom: 16px;\n          margin-top: 16px;\n        }\n\n        .container {\n          position: relative;\n        }\n\n        .clearButton {\n          position: absolute;\n          left: -36px;\n          top: 14px;\n          opacity: 0.5;\n        }\n\n        hex-color-picker {\n          position: absolute;\n          top: -136px;\n          right: 0;\n          opacity: 1 !important;\n        }\n      `,\n    ];\n  }\n\n  isValidHex(color: string | undefined) {\n    if (color) {\n      return /^#([0-9A-F]{3}){1,2}$/i.test(color);\n    } else {\n      return false;\n    }\n  }\n\n  handleColorInput(event: CustomEvent) {\n    const inputValue = (event.target as MdOutlinedTextField).value;\n    const isValidHex = /^[0-9A-Fa-f]{0,6}$/.test(inputValue);\n    if (isValidHex && inputValue.length === 6) {\n      this.color = inputValue.replace(\"#\", \"\");\n      this.fire(\"input\", { color: `${this.color}` });\n    } else {\n      (event.target as MdOutlinedTextField)!.value = this.color || \"\";\n    }\n    console.error(`Invalid color: ${inputValue}`);\n  }\n\n  _onPaste(event: ClipboardEvent): void {\n    event.preventDefault();\n    let pastedText: string = \"\";\n    if (event.clipboardData && event.clipboardData.getData) {\n      pastedText = event.clipboardData.getData(\"text/plain\");\n    }\n    // Removing any non-hexadecimal characters from the pasted text\n    const sanitizedText = pastedText.replace(/[^0-9A-Fa-f]/g, \"\");\n\n    // Checking if the sanitized text is a valid hex color code\n    if (this.isValidHex(`#${sanitizedText}`)) {\n      this.color = sanitizedText;\n      this.fire(\"input\", { color: `#${this.color}` });\n    }\n  }\n\n  openPalette() {\n    const picker = this.shadowRoot!.querySelector(\"hex-color-picker\");\n    picker!.hidden = false;\n    this.isColorPickerActive = false;\n\n    picker!.addEventListener(\n      \"mousedown\",\n      () => (this.isColorPickerActive = true)\n    );\n    picker!.addEventListener(\n      \"mouseup\",\n      () => (this.isColorPickerActive = false)\n    );\n\n    setTimeout(\n      () => document.addEventListener(\"click\", this.handleOutsideClick, true),\n      0\n    );\n  }\n\n  handleOutsideClick = (event: MouseEvent) => {\n    if (!this.isColorPickerActive) {\n      const path = event.composedPath();\n      const picker = this.shadowRoot!.querySelector(\"hex-color-picker\");\n\n      // Check if the click was inside the picker\n      const clickInsidePicker = path.includes(picker!);\n\n      // If the click was not inside the picker and the picker was active, close it\n      if (!clickInsidePicker) {\n        this.closePalette();\n      }\n    }\n  };\n\n  closePalette() {\n    const picker = this.shadowRoot!.querySelector(\"hex-color-picker\");\n    if (picker) {\n      picker.hidden = true;\n      document.removeEventListener(\"click\", this.handleOutsideClick, true);\n    }\n  }\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    document.removeEventListener(\"click\", this.handleOutsideClick, true);\n\n    // Clean up event listeners added to the color picker\n    const picker = this.shadowRoot!.querySelector(\"hex-color-picker\");\n    if (picker) {\n      picker.removeEventListener(\n        \"mousedown\",\n        () => (this.isColorPickerActive = true)\n      );\n      picker.removeEventListener(\n        \"mouseup\",\n        () => (this.isColorPickerActive = false)\n      );\n    }\n  }\n\n  handleKeyDown(event: KeyboardEvent) {\n    // Allow backspace, tab, end, home, left arrow, right arrow, delete\n    const allowedKeys = [\n      \"Backspace\",\n      \"Tab\",\n      \"End\",\n      \"Home\",\n      \"ArrowLeft\",\n      \"ArrowRight\",\n      \"Delete\",\n    ];\n\n    if (allowedKeys.includes(event.key)) {\n      return; // Do not interfere with navigation/control keys\n    }\n\n    // Check if the key is a valid hexadecimal character\n    const isHexDigit = /^[0-9A-Fa-f]$/.test(event.key);\n    if (!isHexDigit) {\n      event.preventDefault(); // Prevent the key press if it's not a valid hex digit\n    }\n  }\n\n  handleColorChanged(event: CustomEvent) {\n    this.color = event.detail.value.replace(\"#\", \"\");\n    this.fire(\"input\", { color: `${this.color}` });\n  }\n\n  clearColor() {\n    this.color = undefined;\n    this.fire(\"input\", { color: undefined });\n  }\n\n  override render() {\n    return html`\n      <div class=\"container\">\n        <md-outlined-text-field\n          .label=\"${this.label}\"\n          maxlength=\"6\"\n          trailing-icon\n          @paste=\"${this._onPaste}\"\n          prefix-text=\"#\"\n          pattern=\"^[0-9A-Fa-f]{0,6}$\"\n          .value=\"${this.color || \"\"}\"\n          ?disabled=\"${this.disableSelection}\"\n          @change=\"${this.handleColorInput}\"\n          @keydown=\"${this.handleKeyDown}\"\n          class=\"mainInput\"\n        >\n          <md-icon-button @click=\"${this.openPalette}\" slot=\"trailing-icon\">\n            <md-icon>palette</md-icon>\n          </md-icon-button>\n        </md-outlined-text-field>\n\n        <md-icon-button\n          ?hidden=\"${!this.color}\"\n          @click=\"${this.clearColor}\"\n          class=\"clearButton\"\n        >\n          <md-icon>delete</md-icon>\n        </md-icon-button>\n\n        <hex-color-picker\n          hidden\n          @color-changed=\"${this.handleColorChanged}\"\n          .color=\"${this.color || \"#000000\"}\"\n        ></hex-color-picker>\n      </div>\n    `;\n  }\n}\n"]}