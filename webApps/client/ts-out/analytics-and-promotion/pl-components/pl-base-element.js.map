{"version":3,"file":"pl-base-element.js","sourceRoot":"","sources":["../../../src/analytics-and-promotion/pl-components/pl-base-element.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, css } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { Layouts } from 'lit-flexbox-literals';\nimport { PlausibleStyles } from './plausibleStyles';\n\nexport class PlausibleBaseElement extends LitElement {\n  @property({ type: String })\n  language = 'en';\n\n  @property({ type: Boolean })\n  rtl = false;\n\n  @property({ type: Boolean })\n  wide = false;\n\n override connectedCallback() {\n    super.connectedCallback();\n    this.addGlobalListener('language-loaded', this._languageEvent.bind(this));\n\n    if (\n      window.appGlobals &&\n      window.appGlobals.i18nTranslation &&\n      window.appGlobals.locale\n    ) {\n      this.language = window.appGlobals.locale;\n      this._setupRtl();\n    } else {\n      this.language = 'en';\n    }\n\n    this.installMediaQueryWatcher(`(min-width: 900px)`, matches => {\n      this.wide = matches;\n    });\n  }\n\n\n  installMediaQueryWatcher = (mediaQuery: string, layoutChangedCallback: (mediaQueryMatches: boolean) => void) => {\n    let mql = window.matchMedia(mediaQuery);\n    mql.addListener((e) => layoutChangedCallback(e.matches));\n    layoutChangedCallback(mql.matches);\n  };\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this.removeGlobalListener(\n      'language-loaded',\n      this._languageEvent.bind(this)\n    );\n  }\n\n  override updated(changedProperties: Map<string | number | symbol, unknown>): void {\n    if (changedProperties.has('language')) {\n      this.languageChanged();\n    }\n  }\n\n  static get rtlLanguages() {\n    return ['fa', 'ar', 'ar_EG'];\n  }\n\n  languageChanged() {\n    // Do nothing, override if needed\n  }\n\n  _setupRtl() {\n    if (PlausibleBaseElement.rtlLanguages.indexOf(this.language) > -1) {\n      this.rtl = true;\n    } else {\n      this.rtl = false;\n    }\n  }\n\n  static override get styles() {\n    return [\n      PlausibleStyles,\n      css`\n        [hidden] {\n          display: none !important;\n        }\n      `,\n    ];\n  }\n\n  _languageEvent(event: CustomEvent) {\n    this.language = event.detail.language;\n    window.appGlobals.locale = event.detail.language;\n    if (this.rtl !== undefined) {\n      this._setupRtl();\n    }\n  }\n\n  fire(\n    eventName: string,\n    data: object | string | boolean | number | null = {},\n    target: LitElement | Document = this\n  ) {\n    const event = new CustomEvent(eventName, {\n      detail: data,\n      bubbles: true,\n      composed: true,\n    });\n    target.dispatchEvent(event);\n  }\n\n  fireGlobal(\n    eventName: string,\n    data: object | string | boolean | number | null = {}\n  ) {\n    this.fire(eventName, data, document);\n  }\n\n  addListener(\n    name: string,\n    callback: Function,\n    target: LitElement | Document = this\n  ) {\n    target.addEventListener(name, callback as EventListener, false);\n  }\n\n  addGlobalListener(name: string, callback: Function) {\n    this.addListener(name, callback, document);\n  }\n\n  removeListener(\n    name: string,\n    callback: Function,\n    target: LitElement | Document = this\n  ) {\n    target.removeEventListener(name, callback as EventListener);\n  }\n\n  removeGlobalListener(name: string, callback: Function) {\n    this.removeListener(name, callback, document);\n  }\n\n  t(...args: Array<string>): string {\n    const key = args[0];\n    if (window.appGlobals && window.appGlobals.i18nTranslation) {\n      let translation = window.appGlobals.i18nTranslation.t(key);\n      if (!translation) translation = '';\n      return translation;\n    } else {\n      return key;\n    }\n  }\n\n  getTooltipText(item: PlausibleListItemData): string | undefined {\n    if (item.tooltipTextToken) {\n      return this.t(item.tooltipTextToken);\n    } else {\n      return undefined;\n    }\n  }\n\n  renderIcon(item: PlausibleListItemData): string | undefined {\n    if (item.icon) {\n      return \"icon\";\n    } else {\n      return undefined;\n    }\n  }\n\n  $$(id: string): HTMLElement | null {\n    return this.shadowRoot ? this.shadowRoot.querySelector(id) : null;\n  }\n}\n"]}