{"version":3,"file":"aoi-new-idea-dialog.js","sourceRoot":"","sources":["../../../src/allOurIdeas/survey/aoi-new-idea-dialog.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html, nothing } from \"lit\";\nimport { property, customElement, query, queryAll } from \"lit/decorators.js\";\nimport { YpBaseElement } from \"../../common/yp-base-element.js\";\n\nimport \"@material/web/dialog/dialog.js\";\nimport { MdDialog } from \"@material/web/dialog/dialog.js\";\n\nimport \"@material/web/button/elevated-button.js\";\nimport \"@material/web/button/outlined-button.js\";\nimport \"@material/web/button/text-button.js\";\nimport \"@material/web/progress/circular-progress.js\";\n\nimport \"@material/web/textfield/filled-text-field.js\";\nimport { SharedStyles } from \"./SharedStyles\";\nimport { YpGenerateAiImage } from \"../../common/yp-generate-ai-image.js\";\nimport { AoiAdminServerApi } from \"../../admin/allOurIdeas/AoiAdminServerApi.js\";\nimport { MdOutlinedTextField } from \"@material/web/textfield/outlined-text-field.js\";\nimport { AoiGenerateAiLogos } from \"../../admin/allOurIdeas/aoiGenerateAiLogos.js\";\n\nimport \"../../yp-magic-text/yp-magic-text.js\";\n\n@customElement(\"aoi-new-idea-dialog\")\nexport class AoiNewIdeaDialog extends YpGenerateAiImage {\n  @property({ type: Object })\n  earl!: AoiEarlData;\n\n  @property({ type: Number })\n  groupId!: number;\n\n  @property({ type: Object })\n  question!: AoiQuestionData;\n\n  @property({ type: Object })\n  choice: AoiChoiceData | undefined;\n\n  @property({ type: Object })\n  group!: YpGroupData;\n\n  @property({ type: Boolean })\n  haveAddedIdea = false;\n\n  @query(\"#ideaText\")\n  ideaText!: HTMLInputElement;\n\n  @query(\"#dialog\")\n  override dialog!: MdDialog;\n\n  serverApi: AoiAdminServerApi;\n  imageGenerator!: AoiGenerateAiLogos;\n\n  constructor() {\n    super();\n    this.serverApi = new AoiAdminServerApi();\n  }\n\n  override async connectedCallback() {\n    super.connectedCallback();\n    this.imageGenerator = new AoiGenerateAiLogos(this.themeColor);\n  }\n\n  override disconnectedCallback(): void {\n    super.disconnectedCallback();\n  }\n\n  async submitIdea() {\n    window.appGlobals.activity(`New Idea - submit`);\n    this.currentError = undefined;\n    this.submitting = true;\n    let addIdeaResponse;\n    try {\n      addIdeaResponse = await window.aoiServerApi.submitIdea(\n        this.groupId,\n        this.question.id,\n        this.ideaText.value\n      );\n    } catch (error: any) {\n      console.error(error);\n    }\n    this.submitting = false;\n    if (!addIdeaResponse || addIdeaResponse.error) {\n      this.currentError = this.t(\"An error occurred. Please try again.\");\n      window.appGlobals.activity(`New Idea - general error`);\n    } else if (addIdeaResponse.flagged) {\n      this.currentError = this.t(\n        \"Your idea has been flagged as inappropriate. Please try again.\"\n      );\n      window.appGlobals.activity(`New Idea - moderation flag`);\n    } else {\n      this.ideaText.value = \"\";\n      if (addIdeaResponse.active) {\n        this.choice = addIdeaResponse.choice;\n        this.haveAddedIdea = true;\n        this.fire(\"display-snackbar\", this.t(\"yourIdeaHasBeenAdded\"));\n        this.generateAiIcon();\n      } else {\n        if (!this.earl.configuration?.allowAnswersNotForVoting) {\n          this.fire(\n            \"display-snackbar\",\n            this.t(\"New ideas will be reviewed for originality and compliance with terms of service prior to posting.\")\n          );\n        } else {\n          this.fire(\n            \"display-snackbar\",\n            this.t(\"newIdeasNotAllowedForVotingThankYou\")\n          );\n        }\n        this.fire(\"new-idea-added\");\n        this.dialog.close();\n      }\n      window.appGlobals.activity(`New Idea - added`);\n    }\n\n  }\n\n  override scrollUp() {\n    //await this.updateComplete;\n    setTimeout(() => {\n      //@ts-ignore\n      (this.$$(\"#dialog\") as MdDialog).contentElement.scrollTop = 0;\n    }, 100);\n  }\n\n  override async open() {\n    this.reset();\n    window.appGlobals.activity(`New Idea - open`);\n    this.dialog.show();\n    await this.updateComplete;\n    if (this.ideaText)\n      this.ideaText.value = \"\"\n  }\n\n  override cancel() {\n    this.dialog.close();\n    window.appGlobals.activity(`New Idea - cancel`);\n  }\n\n  reset() {\n    this.currentError = undefined;\n    this.haveAddedIdea = false;\n    this.choice = undefined;\n    this.imageGenerator = new AoiGenerateAiLogos(this.themeColor);\n  }\n\n  close() {\n    this.dialog.close();\n    window.appGlobals.activity(`New Idea - close`);\n  }\n\n  textAreaKeyDownIdea(e: any) {\n    if (e.keyCode === 13 && !e.shiftKey) {\n      e.preventDefault();\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  static override get styles() {\n    return [\n      super.styles,\n      SharedStyles,\n      css`\n        :host {\n          --md-dialog-container-color: var(--md-sys-color-surface);\n        }\n        md-dialog[showing-fullscreen] {\n          /* hack: private! */\n          --_container-max-block-size: 100dvh;\n          --md-dialog-container-inset-block-start: 0px;\n        }\n\n        md-circular-progress {\n          margin-right: 16px;\n          --md-circular-progress-size: 40px;\n        }\n\n        .indexNumber {\n          margin-top: 12px;\n          font-size: 20px;\n          margin-left: 8px;\n          margin-right: 8px;\n          color: var(--md-sys-color-on-surface);\n        }\n\n        .newIdeasNotAllowedForVotingInfo {\n          margin-top: 8px;\n          margin-bottom: 8px;\n          font-size: 12px;\n          font-style: italic;\n          color: var(--md-sys-color-on-surface);\n        }\n\n        .cancelButton {\n        }\n\n        .header {\n          text-align: center;\n        }\n\n        #dialog {\n          width: 100%;\n        }\n\n        #ideaText {\n          margin-top: 8px;\n          width: 500px;\n        }\n\n        .questionTitle {\n          margin-top: 0;\n          margin-bottom: 16px;\n          padding: 16px;\n          font-size: 16px;\n          line-height: 1.4;\n        }\n\n        md-filled-field {\n          padding: 8px;\n          margin-bottom: 8px;\n          border-radius: 12px;\n        }\n\n        .submitButton {\n          margin-left: 8px;\n        }\n\n        .aiIconInfo {\n          font-size: 12px;\n          padding: 8px;\n          font-style: italic;\n          max-width: 350px;\n          text-align: center;\n        }\n\n        .error {\n          color: var(--md-sys-color-error);\n          font-size: 16px;\n          margin: 8px;\n        }\n\n        .genIconSpinner {\n          width: 100px;\n          height: 100px;\n          margin-left: 0;\n          margin-right: -8px;\n        }\n\n        yp-magic-text {\n        }\n\n        .iconImage,\n        .iconImageRight {\n          width: 100px;\n          height: 100px;\n          margin-left: 0;\n          margin-right: -8px;\n          border-radius: 70px;\n        }\n\n        .iconImageRight {\n        }\n\n        .closeIcon {\n        }\n\n        .deleteIcon {\n          position: absolute;\n          right: 6px;\n          bottom: 16px;\n          height: 32px;\n          width: 32px;\n        }\n\n        .iconContainer md-elevated-button {\n          margin: 8px;\n          width: 400px;\n          max-width: 400px;\n          max-height: 120px;\n          height: 120px;\n          white-space: normal;\n          font-size: 16px;\n          --md-elevated-button-container-height: 120px !important;\n          --md-elevated-button-hover-label-text-color: var(\n            --md-sys-color-on-primary-container\n          );\n        }\n\n        @supports (white-space: collapse balance) {\n          .iconContainer md-elevated-button {\n            white-space: collapse balance;\n          }\n        }\n\n        .iconContainer {\n          position: relative;\n        }\n\n        #aiStyleInput {\n          margin-bottom: 16px;\n        }\n\n        .generateIconButton {\n          max-width: 250px;\n        }\n\n        .iconGenerationBottomSpinner {\n          margin-top: 16px;\n          width: 200px;\n        }\n\n        @media (max-width: 960px) {\n          #dialog {\n            --_fullscreen-header-block-size: 74px;\n          }\n\n          .footer {\n            margin-bottom: 8px;\n          }\n\n          .aiIconInfo {\n            max-width: 100%;\n          }\n\n          .genIconSpinner {\n            width: 75px;\n            height: 75px;\n            margin-left: 0;\n            margin-right: -8px;\n          }\n\n          .iconContainer md-elevated-button {\n            width: 90vh;\n            max-width: 90vh;\n            font-size: 15px;\n          }\n\n          .generateIconButton {\n            max-width: 220px;\n          }\n\n          .iconImage,\n          .iconImageRight {\n            width: 75px;\n            height: 75px;\n            border-radius: 45px;\n          }\n\n          .questionTitle {\n            margin-top: 16px;\n            margin-bottom: 12px;\n          }\n\n          .cancelButton {\n            margin-right: 32px;\n          }\n\n          .header {\n            padding: 8px;\n            font-size: 22px;\n          }\n\n          #ideaText {\n            width: 95%;\n          }\n        }\n      `,\n    ];\n  }\n  async generateAiIcon() {\n    this.imageGenerator.collectionType = \"group\";\n    this.imageGenerator.collectionId = this.groupId!;\n\n    if (this.choice) {\n      try {\n        if (!this.choice.data) {\n          this.choice.data = {} as any;\n        }\n        this.choice.data.isGeneratingImage = true;\n        const { imageUrl, error } = (await this.imageGenerator.generateIcon(\n          this.choice.data.content,\n          this.group.configuration.theme?.iconPrompt || this.finalPrompt\n        )) as unknown as { imageUrl: string; error: string };\n\n        this.choice.data.isGeneratingImage = undefined;\n\n        if (error) {\n          console.error(error);\n        } else {\n          await this.serverApi.updateGroupChoice(\n            this.groupId!,\n            this.question.id!,\n            this.choice.id,\n            {\n              content: this.choice.data.content,\n              imageUrl,\n              choiceId: this.choice.id,\n            }\n          );\n\n          this.choice.data.imageUrl = imageUrl;\n\n          this.requestUpdate();\n        }\n      } catch (e) {\n        this.choice.data.isGeneratingImage = false;\n        console.error(e);\n      }\n    } else {\n      console.error(\"no choice\");\n      return;\n    }\n  }\n\n  get tempPrompt() {\n    return `\n      Name: ${this.name}\n      Description: ${this.description}\n      Image style: ${this.styleText.value}\n\n      Do not include text or labels in the image except if the user asks for it in the image style.\n    `;\n  }\n\n  regenerateIcon() {\n    this.choice!.data!.imageUrl = undefined;\n    this.requestUpdate();\n    this.generateAiIcon();\n  }\n\n  renderAnswer() {\n    if (this.choice) {\n      return html`\n        <div class=\"iconContainer\">\n          <md-elevated-button\n            id=\"leftAnswerButton\"\n            class=\"leftAnswer\"\n            trailing-icon\n          >\n            ${this.renderIcon()}\n            <yp-magic-text\n              id=\"answerText\"\n              .contentId=\"${this.groupId}\"\n              .extraId=\"${this.choice.data.choiceId}\"\n              textOnly\n              truncate=\"140\"\n              .content=\"${this.choice.data.content}\"\n              .contentLanguage=\"${this.group.language}\"\n              textType=\"aoiChoiceContent\"\n            ></yp-magic-text>\n          </md-elevated-button>\n          <md-filled-tonal-icon-button\n            ?hidden=\"${!this.choice.data.imageUrl}\"\n            @click=\"${this.regenerateIcon}\"\n            class=\"deleteIcon\"\n            ><md-icon class=\"closeIcon\"\n              >cycle</md-icon\n            ></md-filled-tonal-icon-button\n          >\n        </div>\n      `;\n    } else {\n      return nothing;\n    }\n  }\n\n  renderIcon() {\n    if (this.choice!.data.isGeneratingImage) {\n      return html`\n        <md-circular-progress\n          class=\"genIconSpinner\"\n          slot=\"icon\"\n          indeterminate\n        ></md-circular-progress>\n      `;\n    } else if (this.choice!.data.imageUrl) {\n      return html` <img\n        class=\"iconImage\"\n        src=\"${this.choice!.data.imageUrl}\"\n        alt=\"icon\"\n        slot=\"icon\"\n        ?hidden=\"${!this.choice!.data.imageUrl}\"\n      />`;\n    } else {\n      return nothing;\n    }\n  }\n\n  override renderContent() {\n    return html`\n      <div class=\"questionTitle\">\n        <yp-magic-text\n          id=\"answerText\"\n          .contentId=\"${this.group.id}\"\n          .extraId=\"${this.question.id}\"\n          textOnly\n          truncate=\"400\"\n          .content=\"${this.question.name}\"\n          .contentLanguage=\"${this.group.language}\"\n          textType=\"aoiQuestionName\"\n        ></yp-magic-text>\n      </div>\n      ${this.earl.configuration!.allowAnswersNotForVoting\n        ? html`\n            <div class=\"newIdeasNotAllowedForVotingInfo layout horizontal center-center\">\n              ${this.t(\"newIdeasNotAllowedForVotingInfo\")}\n            </div>\n          `\n        : nothing}\n      ${this.haveAddedIdea && this.choice\n        ? html`\n            <div class=\"layout vertical center-center\">\n              ${this.renderAnswer()}\n              <div class=\"aiIconInfo\">${this.t(\"aiIconInfo\")}</div>\n            </div>\n          `\n        : html`\n            <div class=\"layout vertical center-center\">\n              <md-filled-text-field\n                id=\"ideaText\"\n                type=\"textarea\"\n                @keydown=\"${this.textAreaKeyDownIdea}\"\n                maxLength=\"140\"\n                .rows=\"${this.wide ? 3 : 5}\"\n                label=\"${this.t(\"Your own answer\")}\"\n              >\n              </md-filled-text-field>\n              <div class=\"error\" ?hidden=\"${!this.currentError}\">\n                ${this.currentError}\n              </div>\n            </div>\n          `}\n    `;\n  }\n\n  override renderFooter() {\n    if (this.haveAddedIdea && this.choice) {\n      return html`<div class=\"layout horizontal footer\">\n        <div class=\"flex\"></div>\n        <md-text-button class=\"closeButton\" @click=\"${this.close}\">\n          ${this.choice?.data.isGeneratingImage ? this.t('closeAndGenerateIconInBackground') : this.t('close')}\n        </md-text-button>\n      </div> `;\n    } else {\n      return html` <div class=\"layout horizontal footer\">\n        <md-circular-progress\n          ?hidden=\"${!this.submitting}\"\n          indeterminate\n        ></md-circular-progress>\n        <md-text-button\n          class=\"cancelButton\"\n          @click=\"${this.cancel}\"\n          ?disabled=\"${this.submitting}\"\n        >\n          ${this.t(\"Cancel\")}\n        </md-text-button>\n        <md-outlined-button\n          class=\"submitButton\"\n          @click=\"${this.submitIdea}\"\n          ?disabled=\"${this.submitting}\"\n        >\n          ${this.t(\"Submit Idea\")}\n        </md-outlined-button>\n      </div>`;\n    }\n  }\n\n  override render() {\n    return html`<md-dialog ?fullscreen=\"${!this.wide}\" id=\"dialog\">\n      <div slot=\"content\">${this.renderContent()}</div>\n      <div slot=\"actions\">${this.renderFooter()}</div>\n    </md-dialog> `;\n  }\n}\n"]}