{"version":3,"file":"aoi-llm-explain-dialog.js","sourceRoot":"","sources":["../../../src/allOurIdeas/survey/aoi-llm-explain-dialog.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html } from \"lit\";\nimport { property, customElement, query, queryAll } from \"lit/decorators.js\";\nimport { YpBaseElement } from \"../../common/yp-base-element.js\";\n\nimport \"@material/web/dialog/dialog.js\";\nimport { MdDialog } from \"@material/web/dialog/dialog.js\";\n\nimport \"@material/web/button/elevated-button.js\";\nimport \"@material/web/button/outlined-button.js\";\nimport \"@material/web/button/text-button.js\";\nimport \"@material/web/progress/circular-progress.js\";\n\nimport \"@material/web/textfield/filled-text-field.js\";\nimport { SharedStyles } from \"./SharedStyles.js\";\nimport { YpChatbotBase } from \"../../yp-llms/yp-chatbot-base.js\";\nimport { AoiServerApi } from \"./AoiServerApi.js\";\n\n@customElement(\"aoi-llm-explain-dialog\")\nexport class AoiLlmExplainDialog extends YpChatbotBase {\n  @property({ type: Object })\n  earl!: AoiEarlData;\n\n  @property({ type: Number })\n  groupId!: number;\n\n  @property({ type: Object })\n  question!: AoiQuestionData;\n\n  @property({ type: String })\n  leftAnswer!: string;\n\n  @property({ type: String })\n  rightAnswer!: string;\n\n  @property({ type: String })\n  currentError: string | undefined;\n\n  @property({ type: String })\n  override defaultInfoMessage =\n    \"I'm your All Our Ideas AI assitant ready to explain anything connected to this project.\";\n\n  serverApi!: AoiServerApi;\n\n  haveSentFirstQuestion = false;\n\n  override setupServerApi(): void {\n    this.serverApi = new AoiServerApi();\n  }\n\n  override async connectedCallback() {\n    super.connectedCallback();\n    this.addEventListener(\"yp-ws-opened\", this.sendFirstQuestion);\n  }\n\n  override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this.removeEventListener(\"yp-ws-opened\", this.sendFirstQuestion);\n  }\n\n  async sendFirstQuestion() {\n    const firstMessage =`**Here is the question:**\\n${this.question.name}\\n\\n**First Answer:** \\n ${this.leftAnswer}\\n\\n**Second Answer:**\\n ${this.rightAnswer}\\n`;\n\n    this.addChatBotElement({\n      sender: 'you',\n      type: 'start',\n      message: firstMessage,\n    });\n\n    this.addThinkingChatBotMessage();\n\n    await this.serverApi.llmAnswerConverstation(\n      this.groupId,\n      this.wsClientId,\n      this.simplifiedChatLog,\n    );\n\n  }\n\n  @query(\"#dialog\")\n  dialog!: MdDialog;\n\n  override async sendChatMessage() {\n    const message = this.chatInputField!.value;\n\n    if (message.length === 0) return;\n\n    //this.ws.send(message);\n    this.chatInputField!.value = '';\n    this.sendButton!.disabled = false;\n    //this.sendButton!.innerHTML = this.t('Thinking...');\n    setTimeout(() => {\n      this.chatInputField!.blur();\n    });\n\n\n    this.addChatBotElement({\n      sender: 'you',\n      type: 'start',\n      message: message,\n    });\n\n    this.addThinkingChatBotMessage();\n\n    await this.serverApi.llmAnswerConverstation(\n      this.groupId,\n      this.wsClientId,\n      this.simplifiedChatLog,\n    );\n  }\n\n  open() {\n    this.dialog.show();\n    this.currentError = undefined;\n    window.appGlobals.activity(`Llm explain - open`);\n  }\n\n  cancel() {\n    this.dialog.close();\n    window.appGlobals.activity(`Llm explain - cancel`);\n    this.fire(\"closed\");\n  }\n\n  textAreaKeyDown(e: KeyboardEvent) {\n    if (e.keyCode === 13 && !e.shiftKey) {\n      e.preventDefault();\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  static override get styles() {\n    return [\n      ...super.styles,\n      SharedStyles,\n      css`\n        :host {\n          --md-dialog-container-color: var(--md-sys-color-surface);\n        }\n        md-dialog[showing-fullscreen] {\n          /* hack: private! */\n          --_container-max-block-size: 100dvh;\n          --md-dialog-container-inset-block-start: 0px;\n        }\n\n        md-circular-progress {\n          margin-right: 16px;\n          --md-circular-progress-size: 40px;\n        }\n\n\n\n        #dialog {\n          width: 100%;\n        }\n\n        #ideaText {\n          margin-top: 8px;\n          width: 500px;\n        }\n\n\n\n\n        @media (max-width: 960px) {\n          #dialog {\n            --_fullscreen-header-block-size: 74px;\n          }\n\n          }\n        }\n      `,\n    ];\n  }\n\n  renderFooter() {\n    return html` <div class=\"layout horizontal footer\">\n      <md-text-button class=\"cancelButton\" @click=\"${this.cancel}\">\n        ${this.t(\"Cancel\")}\n      </md-text-button>\n    </div>`;\n  }\n\n  override render() {\n    return html`<md-dialog\n      @closed=\"${() => this.cancel()}\"\n      ?fullscreen=\"${!this.wide}\"\n      style=\"max-width: 800px;max-height: 90vh;\"\n      id=\"dialog\"\n    >\n      <div slot=\"content\">${super.render()}</div>\n    </md-dialog> `;\n  }\n}\n"]}