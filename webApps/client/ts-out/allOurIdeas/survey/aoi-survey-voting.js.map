{"version":3,"file":"aoi-survey-voting.js","sourceRoot":"","sources":["../../../src/allOurIdeas/survey/aoi-survey-voting.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html, nothing } from \"lit\";\nimport { property, customElement } from \"lit/decorators.js\";\nimport { unsafeHTML } from \"lit/directives/unsafe-html.js\";\n\nimport { YpBaseElement } from \"../../common/yp-base-element.js\";\nimport { YpMediaHelpers } from \"../../common/YpMediaHelpers.js\";\n\nimport \"../../common/yp-image.js\";\n\nimport \"@material/web/button/elevated-button.js\";\nimport \"@material/web/button/outlined-button.js\";\nimport \"@material/web/progress/circular-progress.js\";\n\nimport \"./aoi-new-idea-dialog.js\";\n\nimport { SharedStyles } from \"./SharedStyles.js\";\nimport { Dialog } from \"@material/web/dialog/internal/dialog.js\";\nimport { AoiNewIdeaDialog } from \"./aoi-new-idea-dialog.js\";\nimport { YpFormattingHelpers } from \"../../common/YpFormattingHelpers.js\";\n\n@customElement(\"aoi-survey-voting\")\nexport class AoiSurveyVoting extends YpBaseElement {\n  @property({ type: Number })\n  groupId!: number;\n\n  @property({ type: Object })\n  earl!: AoiEarlData;\n\n  @property({ type: Object })\n  question!: AoiQuestionData;\n\n  @property({ type: Object })\n  firstPrompt!: AoiPromptData;\n\n  @property({ type: Number })\n  promptId!: number;\n\n  @property({ type: Number })\n  voteCount = 0;\n\n  @property({ type: Boolean })\n  spinnersActive = false;\n\n  @property({ type: Object })\n  leftAnswer: AoiAnswerToVoteOnData | undefined;\n\n  @property({ type: Object })\n  rightAnswer: AoiAnswerToVoteOnData | undefined;\n\n  @property({ type: String })\n  appearanceLookup!: string;\n\n  @property({ type: Boolean })\n  breakForVertical = false;\n\n  @property({ type: Number })\n  levelTwoTargetVotes: number | undefined;\n\n  timer: number | undefined;\n\n  constructor() {\n    super();\n    this.resetAnimation = this.resetAnimation.bind(this);\n  }\n\n  override async connectedCallback() {\n    super.connectedCallback();\n    this.spinnersActive = false;\n    this.fire(\"needs-new-earl\");\n    window.appGlobals.activity(\"Voting - open\");\n    this.resetTimer();\n    this.installMediaQueryWatcher(\n      `(max-width: 1200px) and (min-width: 960px)`,\n      (matches) => {\n        this.breakForVertical = matches;\n      }\n    );\n  }\n\n  override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    window.appGlobals.activity(\"Voting - close\");\n    this.fireGlobal(\"set-ids\", {\n      questionId: this.question.id,\n      promptId: undefined,\n    });\n  }\n\n  resetTimer() {\n    this.timer = new Date().getTime();\n  }\n\n  animateButtons(direction: \"left\" | \"right\" | \"skip\"): Promise<void> {\n    return new Promise((resolve) => {\n      const leftButton = this.shadowRoot?.querySelector(\"#leftAnswerButton\");\n      const rightButton = this.shadowRoot?.querySelector(\"#rightAnswerButton\");\n\n      leftButton?.addEventListener(\"animationend\", this.resetAnimation);\n      rightButton?.addEventListener(\"animationend\", this.resetAnimation);\n\n      if (direction === \"left\") {\n        leftButton?.classList.add(\"animate-up\", \"fade-slow\");\n        rightButton?.classList.add(\"animate-down\", \"fade-fast\");\n      } else if (direction === \"right\") {\n        rightButton?.classList.add(\"animate-up\", \"fade-slow\");\n        leftButton?.classList.add(\"animate-down\", \"fade-fast\");\n      } else {\n        leftButton?.classList.add(\"fade-slow\");\n        rightButton?.classList.add(\"fade-slow\");\n      }\n\n      resolve();\n    });\n  }\n\n  resetAnimation(event: any) {\n    event.target.classList.remove(\n      \"animate-up\",\n      \"animate-down\",\n      \"animate-from-left\",\n      \"animate-from-right\",\n      \"fade-fast\",\n      \"fade-slow\"\n    );\n  }\n\n  async voteForAnswer(direction: \"left\" | \"right\" | \"skip\") {\n    window.appGlobals.activity(`Voting - ${direction}`);\n\n    const voteData: AoiVoteData = {\n      time_viewed: new Date().getTime() - (this.timer || 0),\n      prompt_id: this.promptId,\n      direction,\n      appearance_lookup: this.appearanceLookup,\n    };\n\n    const postVotePromise = window.aoiServerApi.postVote(\n      this.groupId,\n      this.question.id,\n      this.promptId,\n      this.language,\n      voteData,\n      direction\n    );\n\n    let animationPromise = this.animateButtons(direction);\n\n    const spinnerTimeout = setTimeout(() => {\n      this.spinnersActive = true;\n    }, 1000);\n\n    const [postVoteResponse] = await Promise.all([\n      postVotePromise,\n      animationPromise,\n    ]);\n\n    clearTimeout(spinnerTimeout);\n\n    this.spinnersActive = false;\n\n    if (!postVoteResponse) {\n      this.fire(\"display-snackbar\", this.t(\"Network error, please try again.\"));\n      this.removeAndInsertFromLeft();\n      return;\n    } else {\n      try {\n        this.leftAnswer = JSON.parse(\n          postVoteResponse.newleft\n        ) as AoiAnswerToVoteOnData;\n        this.rightAnswer = JSON.parse(\n          postVoteResponse.newright\n        ) as AoiAnswerToVoteOnData;\n        console.error(`Parsed JSON`, this.leftAnswer, this.rightAnswer);\n      } catch (error) {\n        console.error(\n          \"Error parsing answers JSON\",\n          error,\n          postVoteResponse.newleft,\n          postVoteResponse.newright\n        );\n        this.leftAnswer = postVoteResponse.newleft as any;\n        this.rightAnswer = postVoteResponse.newright as any;\n      }\n\n      this.promptId = postVoteResponse.prompt_id;\n      this.appearanceLookup = postVoteResponse.appearance_lookup;\n\n      this.fire(\"update-appearance-lookup\", {\n        appearanceLookup: this.appearanceLookup,\n        promptId: this.promptId,\n        leftAnswer: this.leftAnswer,\n        rightAnswer: this.rightAnswer,\n      });\n\n      this.fireGlobal(\"set-ids\", {\n        questionId: this.question.id,\n        promptId: this.promptId,\n      });\n\n      this.removeAndInsertFromLeft();\n\n      const buttons = this.shadowRoot?.querySelectorAll(\"md-elevated-button\");\n      buttons?.forEach((button) => {\n        //TODO: IMPORTANT GET THIS WORKING ON MOBILES\n        this.blur();\n      });\n\n      if (direction !== \"skip\") {\n        this.question.visitor_votes += 1;\n      }\n      this.requestUpdate();\n\n      this.resetTimer();\n    }\n  }\n\n  removeAndInsertFromLeft() {\n    const leftButton = this.shadowRoot?.querySelector(\"#leftAnswerButton\");\n    const rightButton = this.shadowRoot?.querySelector(\"#rightAnswerButton\");\n\n    leftButton?.classList.remove(\n      \"animate-up\",\n      \"animate-down\",\n      \"fade-fast\",\n      \"fade-slow\"\n    );\n    rightButton?.classList.remove(\n      \"animate-up\",\n      \"animate-down\",\n      \"fade-fast\",\n      \"fade-slow\"\n    );\n\n    leftButton?.classList.add(\"animate-from-left\");\n    rightButton?.classList.add(\"animate-from-right\");\n  }\n\n  openNewIdeaDialog() {\n    (this.$$(\"#newIdeaDialog\") as AoiNewIdeaDialog).open();\n  }\n\n  static override get styles() {\n    return [\n      super.styles,\n      SharedStyles,\n      css`\n        :host {\n          --md-elevated-button-container-color: var(\n            --md-sys-color-primary-container\n          );\n          --md-elevated-button-label-text-color: var(\n            --md-sys-color-on-primary-container\n          );\n        }\n\n        .iconImage, .iconImageRight {\n          width: 50px;\n          height: 50px;\n          margin-left: 16px;\n          border-radius: 24px;\n        }\n\n        .iconImageRight {\n          margin-left: 0;\n          margin-right: 16px;\n        }\n\n        .buttonContainer md-elevated-button {\n          margin: 8px;\n          width: 400px;\n          max-height: 120px;\n          height: 120px;\n          white-space: collapse balance;\n          --md-elevated-button-container-height: 120px !important;\n          --md-elevated-button-hover-label-text-color: var(\n            --md-sys-color-on-primary-container\n          );\n        }\n\n        .spinnerContainer {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          height: 120px;\n          margin: 8px;\n          width: 400px;\n        }\n\n        .progressBarContainer {\n          width: 450px;\n          height: 10px;\n          background-color: var(--md-sys-color-on-primary);\n          border-radius: 5px;\n          overflow: hidden;\n          box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);\n          margin-top: 32px;\n        }\n\n        .progressBar {\n          height: 100%;\n          background-color: var(--md-sys-color-primary);\n          transition: width 0.4s ease-in-out;\n        }\n\n        .progressBarText {\n          font-size: 12px;\n          text-align: right;\n          padding-top: 4px;\n          color: var(--md-sys-color-secondary);\n          width: 450px;\n        }\n\n        .or {\n          font-size: 22px;\n          padding: 8px;\n          color: var(--md-sys-color-secondary);\n        }\n\n        .questionTitle {\n          margin-bottom: 0px;\n          margin-top: 32px;\n          margin-left: 32px;\n          margin-right: 32px;\n        }\n\n        .newIdeaButton,\n        .skipButton {\n          margin-top: 24px;\n        }\n\n        .skipButton {\n          margin-left: 8px;\n        }\n\n        .buttonContainer {\n          margin-top: 32px;\n        }\n\n        .md-elevated-button {\n          transition: transform 0.3s ease-out;\n        }\n\n        .fade-fast {\n          transition: opacity 0.5s ease-out;\n          opacity: 0.2;\n        }\n\n        .fade-slow {\n          transition: opacity 1s ease-out;\n          opacity: 0.9;\n        }\n\n        .animate-up,\n        .animate-down {\n          transition: transform 1s ease-out;\n        }\n\n        .animate-up {\n          transform: translateY(-450px);\n        }\n\n        .animate-down {\n          transform: translateY(450px);\n        }\n\n        .animate-from-left,\n        .animate-from-right {\n          opacity: 1;\n        }\n\n        .animate-from-left {\n          animation: slideInFromLeft 0.7s forwards;\n        }\n\n        .animate-from-right {\n          animation: slideInFromRight 0.7s forwards;\n        }\n\n        @keyframes slideInFromLeft {\n          0% {\n            transform: translateX(-120%);\n            opacity: 0.25;\n          }\n          100% {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n\n        @keyframes slideInFromRight {\n          0% {\n            transform: translateX(120%);\n            opacity: 0.25;\n          }\n          100% {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n\n        @media (max-width: 960px) {\n          .animate-up {\n            transform: translateY(-550px);\n          }\n\n          .animate-down {\n            transform: translateY(550px);\n          }\n\n          .buttonContainer md-elevated-button {\n            margin: 8px;\n            width: 100%;\n            margin-right: 32px;\n            margin-left: 32px;\n            --md-elevated-button-container-height: 100px;\n          }\n\n          .spinnerContainer {\n            width: 100%;\n            height: 100px;\n          }\n\n          .topContainer {\n            overflow-x: clip;\n          }\n\n          .progressBarContainer {\n            width: 80%;\n          }\n\n          .progressBarText {\n            width: 80%;\n          }\n\n          .or {\n            font-size: 18px;\n            padding: 4px;\n            color: var(--md-sys-color-secondary);\n          }\n        }\n      `,\n    ];\n  }\n\n  renderProgressBar() {\n    if (this.earl.configuration) {\n      let targetVotes =\n        this.levelTwoTargetVotes ||\n        (window.appGlobals.originalQueryParameters.goalThreshold as number) ||\n        this.earl.configuration.target_votes ||\n        30;\n\n      if (\n        !this.levelTwoTargetVotes &&\n        this.question.visitor_votes >= targetVotes\n      ) {\n        //this.levelTwoTargetVotes = Math.max(Math.round((this.question.choices_count * this.question.choices_count)/4), targetVotes);\n        this.levelTwoTargetVotes = targetVotes * 2;\n        targetVotes = this.levelTwoTargetVotes;\n      }\n\n      const progressPercentage = Math.min(\n        (this.question.visitor_votes / targetVotes) * 100,\n        100\n      );\n\n      return html`\n        <div class=\"progressBarContainer\">\n          <div class=\"progressBar\" style=\"width: ${progressPercentage}%;\"></div>\n        </div>\n        <div class=\"progressBarText\">\n          ${this.question.visitor_votes} ${this.t(\"votes of\")} ${targetVotes}\n          ${this.t(\"target\")}\n          ${this.levelTwoTargetVotes ? html`(${this.t(\"Level 2\")})` : nothing}\n        </div>\n      `;\n    } else {\n      return nothing;\n    }\n  }\n\n  override render() {\n    return html`\n      <div\n        class=\"topContainer layout vertical wrap center-center\"\n        tabindex=\"-1\"\n      >\n        <div class=\"questionTitle\">${this.question.name}</div>\n        <div\n          class=\"buttonContainer layout ${this.breakForVertical\n            ? \"vertical\"\n            : \"horizontal\"} wrap center-center\"\n        >\n          ${this.spinnersActive\n            ? html`\n                <div class=\"spinnerContainer\">\n                  <md-circular-progress\n                    class=\"leftSpinner\"\n                    indeterminate\n                  ></md-circular-progress>\n                </div>\n              `\n            : nothing}\n          <md-elevated-button\n            id=\"leftAnswerButton\"\n            class=\"leftAnswer\"\n            ?hidden=\"${this.spinnersActive}\"\n            @click=${() => this.voteForAnswer(\"left\")}\n          >\n            ${this.leftAnswer?.imageUrl\n              ? html`\n                  <img\n                    slot=\"icon\"\n                    src=\"${this.leftAnswer?.imageUrl}\"\n                    alt=\"Left answer image\"\n                    class=\"iconImage\"\n                  />\n                `\n              : nothing}\n            ${YpFormattingHelpers.truncate(\n              this.leftAnswer?.content || (this.leftAnswer as any),\n              140\n            )}\n          </md-elevated-button>\n          <span class=\"or\"> ${this.t(\"or\")} </span>\n          ${this.spinnersActive\n            ? html`\n                <div class=\"spinnerContainer\">\n                  <md-circular-progress\n                    class=\"leftSpinner\"\n                    indeterminate\n                  ></md-circular-progress>\n                </div>\n              `\n            : nothing}\n          <md-elevated-button\n            id=\"rightAnswerButton\"\n            class=\"rightAnswer\"\n            trailing-icon\n            ?hidden=\"${this.spinnersActive}\"\n            @click=${() => this.voteForAnswer(\"right\")}\n          >\n            ${this.rightAnswer?.imageUrl\n              ? html`\n                  <img\n                    slot=\"icon\"\n                    src=\"${this.rightAnswer?.imageUrl}\"\n                    alt=\"Right answer image\"\n                    class=\"iconImageRight\"\n                  />\n                `\n              : nothing}\n            ${YpFormattingHelpers.truncate(\n              this.rightAnswer?.content || (this.rightAnswer as any),\n              140\n            )}\n          </md-elevated-button>\n        </div>\n        <div class=\"layout horizontal\">\n          <md-outlined-button\n            class=\"newIdeaButton\"\n            @click=\"${this.openNewIdeaDialog}\"\n          >\n            ${this.t(\"Add your own idea\")}\n          </md-outlined-button>\n          <md-text-button\n            class=\"skipButton\"\n            @click=${() => this.voteForAnswer(\"skip\")}\n          >\n            ${this.t(\"Skip\")}\n          </md-text-button>\n        </div>\n        ${this.renderProgressBar()}\n        <div class=\"layout horizontal wrap center-center\"></div>\n      </div>\n      ${!this.wide\n        ? html`\n            <input\n              type=\"text\"\n              id=\"dummyInput\"\n              style=\"position:absolute;opacity:0;\"\n            />\n          `\n        : nothing}\n      <aoi-new-idea-dialog\n        id=\"newIdeaDialog\"\n        .question=${this.question}\n        .earl=${this.earl}\n      ></aoi-new-idea-dialog>\n    `;\n  }\n}\n"]}