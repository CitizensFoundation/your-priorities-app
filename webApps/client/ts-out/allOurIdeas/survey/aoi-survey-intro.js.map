{"version":3,"file":"aoi-survey-intro.js","sourceRoot":"","sources":["../../../src/allOurIdeas/survey/aoi-survey-intro.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html, nothing } from \"lit\";\nimport { property, customElement } from \"lit/decorators.js\";\nimport { unsafeHTML } from \"lit/directives/unsafe-html.js\";\n\nimport { YpBaseElement } from \"../../common/yp-base-element.js\";\nimport { YpMediaHelpers } from \"../../common/YpMediaHelpers.js\";\n\nimport \"../../common/yp-image.js\";\n\nimport \"@material/web/fab/fab.js\";\nimport { SharedStyles } from \"./SharedStyles.js\";\nimport { YpNavHelpers } from \"../../common/YpNavHelpers.js\";\nimport { YpAccessHelpers } from \"../../common/YpAccessHelpers.js\";\n\n@customElement(\"aoi-survey-intro\")\nexport class AoiSurveyIntro extends YpBaseElement {\n  @property({ type: Object })\n  earl!: AoiEarlData;\n\n  @property({ type: Object })\n  group!: YpGroupData;\n\n  @property({ type: Object })\n  question!: AoiQuestionData;\n\n  @property({ type: Boolean })\n  isAdmin = false;\n\n  private footer: Element | null | undefined = null;\n  private footerEnd: Element | null | undefined = null;\n  private footerTopObserver: IntersectionObserver | null = null;\n  private footerEndObserver: IntersectionObserver | null = null;\n\n  override async connectedCallback() {\n    super.connectedCallback();\n    window.appGlobals.activity(\"Intro - open\");\n    this.isAdmin = YpAccessHelpers.checkGroupAccess(this.group);\n  }\n\n  override disconnectedCallback(): void {\n    super.disconnectedCallback();\n    window.appGlobals.activity(`Intro - close`);\n\n    if (this.footerTopObserver) {\n      this.footerTopObserver.disconnect();\n      this.footerTopObserver = null;\n    }\n    if (this.footerEndObserver) {\n      this.footerEndObserver.disconnect();\n      this.footerEndObserver = null;\n    }\n  }\n\n  override firstUpdated() {\n    this.setupFooterObserver();\n  }\n\n  _openAnalyticsAndPromption() {\n    YpNavHelpers.redirectTo(`/analytics/group/${this.group!.id}`);\n  }\n\n  _openAdmin() {\n    YpNavHelpers.redirectTo(`/admin/group/${this.group!.id}`);\n  }\n\n  renderAdminButtons() {\n    return html`\n      <div class=\"layout horizontal adminButtons\">\n        <md-icon-button\n          id=\"menuButton\"\n          @click=\"${this._openAnalyticsAndPromption}\"\n          title=\"${this.t(\"Analytics\")}\"\n          ><md-icon>analytics</md-icon>\n        </md-icon-button>\n        <md-icon-button\n          id=\"menuButton\"\n          @click=\"${this._openAdmin}\"\n          title=\"${this.t(\"Admin\")}\"\n          ><md-icon>settings</md-icon>\n        </md-icon-button>\n      </div>\n    `;\n  }\n\n  setupFooterObserver() {\n    this.footer = this.shadowRoot?.querySelector(\"#footerStart\");\n    this.footerEnd = this.shadowRoot?.querySelector(\"#footerEnd\");\n\n    this.footerTopObserver = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            window.appGlobals.activity(\"Footer - start is visible\");\n            this.footerTopObserver?.disconnect();\n          }\n        });\n      },\n      { rootMargin: \"-200px 0px\" }\n    );\n\n    this.footerEndObserver = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            window.appGlobals.activity(\"Footer - end is visible\");\n            this.footerEndObserver?.disconnect();\n          }\n        });\n      },\n      { rootMargin: \"0px\" }\n    );\n\n    if (this.footer) this.footerTopObserver.observe(this.footer);\n    if (this.footerEnd) this.footerEndObserver.observe(this.footerEnd);\n  }\n\n  get formattedDescription() {\n    return (this.earl.configuration!.welcome_message || \"\").replace(\n      /(\\n)/g,\n      \"<br>\"\n    );\n  }\n\n  clickStart() {\n    this.fire(\"startVoting\");\n    window.appGlobals.activity(\"Intro - click start\");\n  }\n\n  clickResults() {\n    this.fire(\"openResults\");\n  }\n\n  static override get styles() {\n    return [\n      ...super.styles,\n      SharedStyles,\n      css`\n        .footerHtml {\n          margin: 16px;\n          max-width: 600px;\n          line-height: 1.5;\n          color: var(--md-sys-color-on-background);\n        }\n\n        .adminButtons {\n          margin-top: 16px;\n        }\n\n        .footerHtml a {\n          color: var(--md-sys-color-on-background);\n        }\n\n        .fab {\n          margin-top: 16px;\n          margin-bottom: 8px;\n          cursor: pointer !important;\n        }\n\n        .description {\n          font-size: 18px;\n          letter-spacing: 0.04em;\n          line-height: 1.5;\n          border-radius: 8px;\n          max-width: 560px;\n          vertical-align: center;\n          margin-bottom: 16px;\n          margin-top: 8px;\n          padding: 16px;\n          padding-left: 0;\n          padding-right: 0;\n        }\n\n        :host {\n        }\n\n        .image {\n          width: 632px;\n          height: 356px;\n          margin-top: 32px;\n        }\n\n        .questionTitle {\n          max-width: 588px;\n          width: 588px;\n          padding: 20px;\n          line-height: 1.5;\n        }\n\n        .questionTitle[dark-mode] {\n          margin-top: 24px;\n        }\n\n        @media (max-width: 960px) {\n          .image {\n            width: 300px;\n            height: 169px;\n          }\n\n          .questionTitle {\n            max-width: 100%;\n            width: 100%;\n            padding: 16px;\n            line-height: 1.5;\n          }\n\n          .description {\n            max-width: 100%;\n          }\n\n          .footerHtml {\n            max-width: 100%;\n          }\n\n          .questionTitle[dark-mode] {\n          }\n\n          .darkModeButton {\n            margin-left: 12px;\n            margin-right: 12px;\n          }\n        }\n      `,\n    ];\n  }\n\n  override render() {\n    if (this.question) {\n      return html`\n      <div class=\"topContainer layout vertical wrap center-center\">\n        <yp-image\n          class=\"column image\"\n          sizing=\"contain\"\n          src=\"${YpMediaHelpers.getImageFormatUrl(this.group.GroupLogoImages)}\"\n        ></yp-image>\n        <div class=\"questionTitle\" ?dark-mode=\"${this.themeDarkMode}\">\n          <yp-magic-text\n            id=\"answerText\"\n            .contentId=\"${this.group.id}\"\n            .extraId=\"${this.question.id}\"\n            textOnly\n            truncate=\"300\"\n            .content=\"${this.question.name}\"\n            .contentLanguage=\"${this.group.language}\"\n            textType=\"aoiQuestionName\"\n          ></yp-magic-text>\n        </div>\n        <div class=\"description\">${this.formattedDescription}</div>\n        ${this.earl.active\n          ? html`\n              <md-fab\n                extended\n                variant=\"primary\"\n                class=\"fab\"\n                @click=\"${this.clickStart}\"\n                .label=\"${this.t(\"Start Voting\")}\"\n                ><md-icon slot=\"icon\">thumbs_up_down</md-icon></md-fab\n              >\n            `\n          : html`\n              <md-fab\n                extended\n                variant=\"primary\"\n                class=\"fab\"\n                @click=\"${this.clickResults}\"\n                .label=\"${this.t(\"Open Results\")}\"\n                ><md-icon slot=\"icon\">grading</md-icon></md-fab\n              >\n            `}\n        ${this.isAdmin ? this.renderAdminButtons() : nothing}\n        <div id=\"footerStart\" class=\"footerHtml\">\n          ${this.earl.configuration && this.earl.configuration.welcome_html\n            ? unsafeHTML(this.earl.configuration.welcome_html)\n            : nothing}\n        </div>\n        <div id=\"footerEnd\">&nbsp;</div>\n      </div>\n    `;\n    } else {\n      return nothing;\n    }\n  }\n}\n"]}