{"version":3,"file":"AoiServerApi.js","sourceRoot":"","sources":["../../../src/admin/allOurIdeas/AoiServerApi.ts"],"names":[],"mappings":"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","sourcesContent":["import { YpServerApi } from '../../common/YpServerApi.js';\n\nexport class AoiServerApi extends YpServerApi {\n  constructor(urlPath: string = '/api') {\n    super();\n    this.baseUrlPath = urlPath;\n  }\n\n  public getEarl(earlName: string): AoiEarlResponse {\n    return this.fetchWrapper(\n      this.baseUrlPath + `/earls/${earlName}.json`\n    ) as unknown as AoiEarlResponse;\n  }\n\n  public getSurveyResults(earlName: string): AoiResultData[] {\n    return this.fetchWrapper(\n      this.baseUrlPath + `/questions/${earlName}/results.json`\n    ) as unknown as AoiResultData[];\n  }\n\n  getSurveyAnalysis(\n    earlName: string,\n    analysisIndex: number,\n    analysisTypeIndex: number\n  ): AnalysisTypeData {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/questions/${earlName}/${analysisIndex}/${analysisTypeIndex}/analysis.json`\n    ) as unknown as AnalysisTypeData;\n  }\n\n  public submitIdea(questionId: number, newIdea: string): AoiAddIdeaResponse {\n    return this.fetchWrapper(\n      this.baseUrlPath + `/questions/${questionId}/add_idea.js`,\n      {\n        method: 'POST',\n        body: JSON.stringify({ new_idea: newIdea }),\n      },\n      false\n    ) as unknown as AoiAddIdeaResponse;\n  }\n\n  public postVote(\n    questionId: number,\n    promptId: number,\n    locale: string,\n    body: AoiVoteData\n  ): AoiVoteResponse {\n    const url = new URL(\n      `${window.location.protocol}//${window.location.host}${this.baseUrlPath}/questions/${questionId}/prompts/${promptId}/votes.js?locale=${locale}`\n    );\n\n    Object.keys(window.appGlobals.originalQueryParameters).forEach(key => {\n      if (key.startsWith('utm_')) {\n        url.searchParams.append(\n          key,\n          window.aoiAppGlobals.originalQueryParameters[key]\n        );\n      }\n    });\n\n    const browserId = window.appUser.getBrowserId();\n    const browserFingerprint = window.appUser.browserFingerprint;\n    const browserFingerprintConfidence = window.appUser.browserFingerprintConfidence;\n\n    url.searchParams.append(\"checksum_a\", browserId!);\n    url.searchParams.append(\"checksum_b\", browserFingerprint!);\n    url.searchParams.append(\"checksum_c\", browserFingerprintConfidence!.toString());\n\n    return this.fetchWrapper(\n      url.toString(),\n      {\n        method: 'POST',\n        body: JSON.stringify(body),\n      },\n      false\n    ) as unknown as AoiVoteResponse;\n  }\n\n  public postVoteSkip(\n    questionId: number,\n    promptId: number,\n    locale: string,\n    body: AoiVoteSkipData\n  ): AoiVoteResponse {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/questions/${questionId}/prompts/${promptId}/skip.js?locale=${locale}`,\n      {\n        method: 'POST',\n        body: JSON.stringify(body),\n      },\n      false\n    ) as unknown as AoiVoteResponse;\n  }\n}\n"]}