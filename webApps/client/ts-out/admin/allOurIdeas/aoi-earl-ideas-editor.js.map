{"version":3,"file":"aoi-earl-ideas-editor.js","sourceRoot":"","sources":["../../../src/admin/allOurIdeas/aoi-earl-ideas-editor.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html } from \"lit\";\nimport { customElement, property, query } from \"lit/decorators.js\";\nimport { YpStreamingLlmBase } from \"../../yp-llms/yp-streaming-llm-base.js\";\nimport { MdFilledTextField } from \"@material/web/textfield/filled-text-field.js\";\nimport { AoiAdminServerApi } from \"./AoiAdminServerApi.js\";\n\nimport \"@material/web/list/list.js\";\nimport \"@material/web/list/list-item.js\";\nimport \"@material/web/iconbutton/outlined-icon-button.js\";\nimport \"@material/web/button/filled-button.js\";\nimport \"@material/web/button/filled-tonal-button.js\";\nimport \"@material/web/chips/filter-chip.js\";\nimport \"@material/web/chips/chip-set.js\";\nimport \"@material/web/textfield/filled-text-field.js\";\nimport { AoiGenerateAiLogos } from \"./aoiGenerateAiLogos.js\";\nimport { image } from \"d3\";\nimport { ifDefined } from \"lit/directives/if-defined.js\";\n\n@customElement(\"aoi-earl-ideas-editor\")\nexport class AoiEarlIdeasEditor extends YpStreamingLlmBase {\n  @property({ type: Number })\n  groupId!: number;\n\n  @property({ type: Number })\n  communityId: number | undefined;\n\n  @property({ type: Object })\n  configuration!: AoiConfigurationData;\n\n  @property({ type: Boolean })\n  isCreatingIdeas!: boolean;\n\n  @property({ type: Array })\n  choices: AoiChoiceData[] | undefined;\n\n  @property({ type: Boolean })\n  isGeneratingWithAi = false;\n\n  @property({ type: Boolean })\n  isSubmittingIdeas = false;\n\n  @property({ type: Boolean })\n  isTogglingIdeaActive = false;\n\n  @property({ type: Boolean })\n  isFetchingChoices = false;\n\n  @property({ type: String })\n  currentIdeasFilter: \"latest\" | \"highestScore\" | \"userSubmitted\" = \"latest\";\n\n  @query(\"#answers\")\n  answersElement!: MdFilledTextField;\n\n  override scrollElementSelector = \"#answers\";\n\n  serverApi: AoiAdminServerApi;\n\n  constructor() {\n    super();\n    this.serverApi = new AoiAdminServerApi();\n  }\n\n  override connectedCallback(): void {\n    if (this.configuration.earl && this.configuration.earl.question_id) {\n      this.disableWebsockets = true;\n      this.isCreatingIdeas = false;\n      this.getChoices();\n    } else {\n      this.isCreatingIdeas = true;\n    }\n    super.connectedCallback();\n    this.addEventListener(\"yp-ws-closed\", this.socketClosed);\n    this.addEventListener(\"yp-ws-error\", this.socketError);\n  }\n\n  socketClosed() {\n    this.isGeneratingWithAi = false;\n  }\n\n  socketError() {\n    this.isGeneratingWithAi = false;\n  }\n\n  async getChoices() {\n    this.choices = await this.serverApi.getChoices(\n      this.communityId!,\n      this.configuration.earl!.question_id!\n    );\n  }\n\n  async addChatBotElement(wsMessage: YpAiChatWsMessage): Promise<void> {\n    switch (wsMessage.type) {\n      case \"start\":\n        break;\n      case \"moderation_error\":\n        //TODO\n        break;\n      case \"error\":\n        //TODO\n        this.isGeneratingWithAi = false;\n        break;\n      case \"end\":\n        this.isGeneratingWithAi = false;\n        this.answersElement.value += \"\\n\";\n        break;\n      case \"stream\":\n        if (wsMessage.message && wsMessage.message != \"undefined\") {\n          this.answersElement.value += wsMessage.message;\n          break;\n        } else {\n          console.warn(\"stream message is undefined\");\n          break;\n        }\n    }\n    this.scrollDown();\n  }\n\n  get answers() {\n    return (this.$$(\"#answers\") as MdFilledTextField)?.value\n      .split(\"\\n\")\n      .map((answer: string) =>\n        answer\n          .replace(/\\\\/g, '\\\\\\\\')\n          .replace(/\"/g, '\\\\\"')\n          .replace(/\\n/g, '\\\\n')\n          .replace(/\\r/g, '\\\\r')\n          .replace(/\\t/g, '\\\\t')\n      )\n      .filter((answer: string) => answer.length > 0); // Keep filtering out empty answers\n  }\n\n  hasMoreThanOneIdea() {\n    return;\n  }\n\n  openMenuFor(answer: AoiChoiceData) {\n    console.log(\"openMenuFor\", answer);\n  }\n\n  generateIdeas() {\n    this.isGeneratingWithAi = true;\n    try {\n      this.serverApi.startGenerateIdeas(\n        this.configuration.earl!.question!.name,\n        this.communityId!,\n        this.wsClientId,\n        this.answers\n      );\n    } catch (e) {\n      console.error(e);\n    }\n  }\n\n  async submitIdeasForCreation() {\n    this.isSubmittingIdeas = true;\n    try {\n      const { question_id } = await this.serverApi.submitIdeasForCreation(\n        this.communityId!,\n        this.answers,\n        this.configuration.earl!.question!.name\n      );\n\n      this.configuration.earl!.question_id = question_id;\n      this.configuration.earl!.active = true;\n\n      if (!this.configuration.earl!.configuration) {\n        this.configuration.earl!.configuration = {} as any;\n      }\n\n      if (!this.configuration.earl!.question) {\n        this.configuration.earl!.question = {} as any;\n      }\n\n      this.configuration.earl!.question!.id = question_id!;\n\n      this.fire(\"configuration-changed\", this.configuration);\n      this.requestUpdate();\n      this.getChoices();\n    } catch (e) {\n      console.error(e);\n    } finally {\n      this.isSubmittingIdeas = false;\n    }\n  }\n\n  toggleIdeaActivity(answer: AoiChoiceData) {\n    return async () => {\n      this.isTogglingIdeaActive = true;\n      try {\n        await this.serverApi.toggleIdeaActive(this.groupId, answer.id);\n        answer.active = !answer.active;\n      } catch (e) {\n        console.error(e);\n      } finally {\n        this.isTogglingIdeaActive = false;\n      }\n    };\n  }\n\n  applyFilter(filterType: string) {\n    this.currentIdeasFilter = filterType as any;\n  }\n\n  get sortedChoices() {\n    if (this.choices) {\n      switch (this.currentIdeasFilter) {\n        case \"latest\":\n          return this.choices.sort((a, b) => b.id - a.id);\n        case \"highestScore\":\n          return this.choices.sort((a, b) => b.score - a.score);\n        case \"userSubmitted\":\n          return this.choices.sort((a, b) => {\n            if (b.local_identifier < a.local_identifier) {\n              return -1;\n            }\n            if (b.local_identifier > a.local_identifier) {\n              return 1;\n            }\n            return 0;\n          });\n      }\n    } else {\n      return undefined;\n    }\n  }\n\n  async generateAiIcons() {\n    const imageGenerator = new AoiGenerateAiLogos();\n    imageGenerator.collectionType = \"community\";\n    imageGenerator.collectionId = this.communityId!;\n\n    this.isGeneratingWithAi = true;\n\n    for (let choice of this.choices!) {\n      try {\n        const { imageUrl, error } = (await imageGenerator.generateIcon(\n          choice.data.content,\n          this.themeColor\n        )) as unknown as { imageUrl: string; error: string };\n\n        if (error) {\n          console.error(error);\n          continue;\n        }\n\n        await this.serverApi.updateChoice(\n          this.communityId!,\n          this.configuration.earl!.question_id!,\n          choice.id,\n          {\n            content: choice.data.content,\n            imageUrl\n          }\n        );\n\n        choice.data.imageUrl = imageUrl;\n\n        console.error(\"imageUrl\", imageUrl, \"error\", error);\n        this.requestUpdate();\n      } catch (e) {\n        console.error(e);\n      }\n    }\n\n    this.isGeneratingWithAi = false;\n  }\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        .ideasList {\n          padding: 16px;\n          max-width: 900px;\n          width: 900px;\n          padding-left: 0;\n        }\n\n        .logo,\n        .iconImage {\n          width: 50px;\n          max-width: 50px;\n        }\n\n        .logo {\n          margin-right: 8px;\n        }\n\n        .iconImage {\n          border-radius: 12px;\n        }\n\n        .ideaContainer {\n          padding: 8px;\n          margin: 5px 0;\n          border-radius: 8px;\n          background-color: var(--md-sys-color-surface-variant);\n          color: var(--md-sys-color-on-surface-variant);\n        }\n\n        .answer {\n          padding: 16px;\n          padding-top: 16px;\n          padding-bottom: 16px;\n          border-radius: 16px;\n          background-color: var(--md-sys-color-surface);\n          color: var(--md-sys-color-on-surface);\n          flex-grow: 1;\n        }\n\n        .wins,\n        .losses,\n        .score {\n          padding: 5px;\n          text-align: center;\n          min-width: 50px;\n        }\n\n        .buttons {\n          padding: 5px;\n          display: flex;\n          align-items: center;\n          justify-content: space-around;\n          width: 120px;\n        }\n\n        .generateIconsProgress {\n          margin-top: 8px;\n        }\n\n        md-filled-text-field {\n          width: 100%;\n          margin-bottom: 32px;\n        }\n\n        .button {\n          margin-left: 16px;\n          margin-right: 16px;\n        }\n\n        .generationProgress {\n          width: 100%;\n          margin-bottom: 24px;\n          margin-top: -24px;\n        }\n\n        md-filled-text-field {\n          --md-filled-field-container-color: var(\n            --md-sys-color-surface\n          ) !important;\n        }\n      `,\n    ];\n  }\n\n  renderCreateIdeas() {\n    return html`\n      <div class=\"layout vertical center-center\">\n        <md-filled-text-field\n          type=\"textarea\"\n          id=\"answers\"\n          rows=\"14\"\n          .label=\"${this.t(\"answersToVoteOn\")}\"\n        >\n        </md-filled-text-field>\n        <md-linear-progress\n          class=\"generationProgress\"\n          ?hidden=\"${!this.isGeneratingWithAi}\"\n          indeterminate\n        ></md-linear-progress>\n        <div class=\"layout horizontal\">\n          ${this.isGeneratingWithAi\n            ? html`\n                <div class=\"layout vertical center-center\">\n                  <md-outlined-button class=\"button\" @click=\"${this.reset}\"\n                    >${this.t(\"stopGenerating\")}\n                    <md-icon slot=\"icon\">stop_circle</md-icon>\n                  </md-outlined-button>\n                </div>\n              `\n            : html`\n                <md-outlined-button\n                  class=\"button\"\n                  @click=\"${this.generateIdeas}\"\n                  ?disabled=\"${this.isGeneratingWithAi}\"\n                  >${this.answers?.length > 1\n                    ? this.t(\"generateMoreIdeasWithAi\")\n                    : this.t(\"generateIdeasWithAi\")}\n                  <md-icon slot=\"icon\">smart_toy</md-icon>\n                </md-outlined-button>\n              `}\n          <md-filled-button\n            class=\"button\"\n            @click=\"${this.submitIdeasForCreation}\"\n            ?disabled=\"${this.isSubmittingIdeas ||\n            this.answers?.length < 6 ||\n            this.isGeneratingWithAi}\"\n            >${this.t(\"submitAnswersForCreation\")}</md-filled-button\n          >\n        </div>\n      </div>\n    `;\n  }\n\n  renderIdeasSortingChips() {\n    return html`\n      <div class=\"layout horizontal center-center\">\n        <md-chip-set class=\"ideaFilters layout horizontal wrap\" type=\"filter\">\n          <md-filter-chip\n            class=\"layout horizontal center-center\"\n            label=\"Latest\"\n            .selected=\"${this.currentIdeasFilter == \"latest\"}\"\n            @click=\"${() => this.applyFilter(\"latest\")}\"\n          ></md-filter-chip>\n          <md-filter-chip\n            class=\"layout horizontal center-center\"\n            label=\"User submitted\"\n            .selected=\"${this.currentIdeasFilter == \"userSubmitted\"}\"\n            @click=\"${() => this.applyFilter(\"userSubmitted\")}\"\n          ></md-filter-chip>\n          <md-filter-chip\n            class=\"layout horizontal center-center\"\n            label=\"Highest Score\"\n            .selected=\"${this.currentIdeasFilter == \"highestScore\"}\"\n            @click=\"${() => this.applyFilter(\"highestScore\")}\"\n          ></md-filter-chip>\n        </md-chip-set>\n      </div>\n    `;\n  }\n\n  renderEditIdeas() {\n    return html`\n      <div class=\"layout vertical\">\n        ${this.renderIdeasSortingChips()}\n        <div class=\"ideasList\">\n          <md-linear-progress\n            indeterminate\n            ?hidden=\"${!this.isFetchingChoices}\"\n          ></md-linear-progress>\n          <div class=\"layout horizontal ideaContainer\">\n            <div class=\"logo\"></div>\n            <div class=\"flex\"></div>\n            <div class=\"wins\">${this.t(\"wins\")}</div>\n            <div class=\"losses\">${this.t(\"losses\")}</div>\n            <div class=\"score\">${this.t(\"score\")}</div>\n            <div class=\"buttons\">${this.t(\"actions\")}</div>\n          </div>\n\n          ${this.sortedChoices?.map((answer: AoiChoiceData, index: number) => {\n            return html`<div class=\"layout horizontal ideaContainer\">\n              <div class=\"logo\">\n                ${answer.data.imageUrl\n                  ? html`<img\n                      class=\"iconImage\"\n                      src=\"${ifDefined(answer.data.imageUrl)}\"\n                    />`\n                  : \"\"}\n              </div>\n              <div class=\"answer\">${answer.data.content}</div>\n              <div class=\"wins\">${answer.wins}</div>\n              <div class=\"losses\">${answer.losses}</div>\n              <div class=\"score\">${Math.round(answer.score)}</div>\n              <div class=\"buttons\">\n                <md-outlined-button @click=\"${this.toggleIdeaActivity(answer)}\">\n                  ${answer.active ? this.t(\"deactivate\") : this.t(\"activate\")}\n                </md-outlined-button>\n                <md-linear-progress\n                  indeterminate\n                  ?hidden=\"${!this.isTogglingIdeaActive}\"\n                ></md-linear-progress>\n              </div>\n            </div>`;\n          })}\n        </div>\n        <div class=\"layout vertical center-center\"></div>\n          <md-outlined-button\n                class=\"button\"\n                @click=\"${this.generateAiIcons}\"\n                ?disabled=\"${this.isGeneratingWithAi}\"\n                >${this.t(\"generateIconsWithAi\")}</md-outlined-button\n         >\n         <md-linear-progress\n          class=\"generateIconsProgress\"\n          ?hidden=\"${!this.isGeneratingWithAi}\"\n          indeterminate\n        ></md-linear-progress>\n        </div>\n    </div>\n    `;\n  }\n\n  override render() {\n    if (!this.choices) {\n      return this.renderCreateIdeas();\n    } else {\n      return this.renderEditIdeas();\n    }\n  }\n}\n"]}