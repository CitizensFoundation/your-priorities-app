{"version":3,"file":"yp-admin-html-editor.js","sourceRoot":"","sources":["../../src/admin/yp-admin-html-editor.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html, css, PropertyValues, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators.js\";\nimport { YpBaseElement } from \"../common/yp-base-element\";\n\nimport \"../yp-survey/yp-simple-html-editor.js\";\nimport { MdFilledTextField } from \"@material/web/textfield/filled-text-field\";\n\nimport \"@material/web/tabs/primary-tab.js\";\nimport \"@material/web/tabs/tabs.js\";\nimport { MdTabs } from \"@material/web/tabs/tabs.js\";\nimport \"@material/web/icon/icon.js\";\nimport \"@material/web/textfield/filled-text-field.js\";\nimport { YpGenerateAiImage } from \"../common/yp-generate-ai-image.js\";\n\nimport \"../common/yp-generate-ai-image.js\";\nimport { unsafeHTML } from \"lit/directives/unsafe-html.js\";\nimport { YpConfirmationDialog } from \"../yp-dialog-container/yp-confirmation-dialog\";\n\n@customElement(\"yp-admin-html-editor\")\nexport class YpAdminHtmlEditor extends YpBaseElement {\n  @property({ type: String })\n  content: string = \"\";\n\n  @property({ type: Array })\n  media: Array<YpSimpleGroupMediaData> = [];\n\n  @property({ type: Number })\n  selectedTab = 0;\n\n  @state()\n  mediaLoaded: { [key: number]: boolean } = {};\n\n  @property({ type: Boolean })\n  generatingAiImageInBackground = false;\n\n  @property({ type: Object })\n  group!: YpGroupData;\n\n  @property({ type: Number })\n  parentCollectionId: number | undefined;\n\n  @property({ type: Number })\n  mediaIdToDelete: number | undefined;\n\n  @property({ type: String })\n  collectionId: number | string | undefined;\n\n  @property({ type: Boolean })\n  hasVideoUpload = false;\n\n  @property({ type: Array })\n  imageIdsUploadedByUser: number[] = [];\n\n  @property({ type: Array })\n  videoIdsUploadedByUser: number[] = [];\n\n  private debounceTimer?: number;\n\n  _selectTab(event: CustomEvent) {\n    this.selectedTab = (event.currentTarget as MdTabs).activeTabIndex;\n  }\n\n  getConfiguration() {\n    console.log(JSON.stringify({\n      content: this.content,\n      media: this.media,\n    }));\n    return {\n      content: this.content,\n      media: this.media,\n    };\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this.addGlobalListener(\"yp-has-video-upload\", () => {\n      this.hasVideoUpload = true;\n    });\n    if (window.appGlobals.hasVideoUpload) this.hasVideoUpload = true;\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this.removeGlobalListener(\"yp-has-video-upload\", () => {\n      this.hasVideoUpload = true;\n    });\n  }\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        md-tabs {\n          width: 100%;\n          margin-bottom: 16px;\n        }\n\n        .deleteMediaButton {\n          top: 4px;\n          left: 4px;\n          position: absolute;\n        }\n\n        .insertMediaButton {\n          bottom: 4px;\n          right: 4px;\n          position: absolute;\n        }\n\n        .mediaHeader {\n          font-size: 20px;\n          margin: 24px;\n          margin-bottom: 8px;\n        }\n\n        .uploadIcon {\n          margin-left: 4px;\n          margin-right: 4px;\n        }\n\n        .videoUploadIcon {\n          margin-top: 16px;\n        }\n\n        .previewHtml {\n          width: 100%;\n          height: 100%;\n          background-color: var(--md-sys-color-surface);\n          color: var(--md-sys-color-on-surface);\n          margin-top: 16px;\n        }\n\n        .mediaContainer {\n          position: relative;\n          height: 150px;\n          max-height: 150px;\n          margin: 16px;\n          background-color: var(--md-sys-color-surface-variant);\n        }\n\n        .mediaImage,\n        .mediaVideo {\n          max-width: 100%;\n          max-height: 150px;\n        }\n\n        md-filled-icon-button {\n          margin: 4px;\n        }\n      `,\n    ];\n  }\n\n  _generateLogo(event: CustomEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.requestUpdate();\n    const generator = this.$$(\"#aiImageGenerator\") as YpGenerateAiImage;\n    generator.open();\n  }\n\n  override updated(changedProperties: Map<string | number | symbol, unknown>): void {\n    if (changedProperties.has(\"media\")) {\n      console.error(\"media changed\", this.media);\n    }\n  }\n\n  override firstUpdated(_changedProperties: PropertyValues) {}\n\n  renderAiImageGenerator() {\n    return html`<yp-generate-ai-image\n      id=\"aiImageGenerator\"\n      .collectionType=\"${this.collectionId === \"new\" ? \"community\" : \"group\"}\"\n      .collectionId=\"${this.collectionId === \"new\"\n        ? this.parentCollectionId\n        : this.group.id}\"\n      disableBackgroundGeneration\n      @got-image=\"${this._gotAiImage}\"\n    >\n    </yp-generate-ai-image>`;\n  }\n\n  _setMediaLoaded(id: number, loaded: boolean) {\n    this.mediaLoaded = { ...this.mediaLoaded, [id]: loaded };\n    this.requestUpdate();\n  }\n\n  _logoImageUploaded(event: CustomEvent) {\n    var image = JSON.parse(event.detail.xhr.response);\n    const uploadedLogoImageId = image.id;\n    const url = JSON.parse(image.formats)[0];\n    this.media.push({\n      id: uploadedLogoImageId,\n      type: \"image\",\n      url: url,\n    } as YpSimpleGroupMediaData);\n    this.imageIdsUploadedByUser.push(uploadedLogoImageId);\n    this.requestUpdate();\n    this.contentChanged();\n  }\n\n  _gotAiImage(event: CustomEvent) {\n    const url = event.detail.imageUrl;\n    const uploadedLogoImageId = event.detail.imageId;\n    this.media.push({\n      id: uploadedLogoImageId,\n      type: \"image\",\n      url: url,\n    } as YpSimpleGroupMediaData);\n    this.imageIdsUploadedByUser.push(uploadedLogoImageId);\n    this.requestUpdate();\n    this.contentChanged();\n  }\n\n  _removeHtmlTag(url: string, type: string) {\n    if (type === 'image') {\n      const imgRegex = new RegExp(`<img[^>]+src=[\"']${url}[\"'][^>]*>`, 'gi');\n      this.content = this.content.replace(imgRegex, '');\n    } else if (type === 'video') {\n      const videoRegex = new RegExp(`<video[^>]*>\\\\s*<source[^>]+src=[\"']${url}[\"'][^>]*>\\\\s*</video>`, 'gi');\n      this.content = this.content.replace(videoRegex, '');\n    }\n    this.contentChanged();\n  }\n\n  _videoUploaded(event: CustomEvent) {\n    const uploadedVideoId = event.detail.videoId;\n    const url = event.detail.detail.videoUrl;\n    this.media.push({\n      id: uploadedVideoId,\n      type: \"video\",\n      url: url,\n    } as YpSimpleGroupMediaData);\n    this.videoIdsUploadedByUser.push(uploadedVideoId);\n    this.requestUpdate();\n    this.contentChanged();\n  }\n\n  async reallyDeleteCurrentLogoImage() {\n    if (this.mediaIdToDelete) {\n      await window.adminServerApi.deleteImage(\n        this.mediaIdToDelete,\n        \"group\",\n        this.collectionId as number,\n        this.imageIdsUploadedByUser.includes(this.mediaIdToDelete),\n        true\n      );\n      const mediaItem = this.media.find(media => media.id === this.mediaIdToDelete);\n      this._removeHtmlTag(mediaItem!.url, mediaItem!.type);\n      this.media = this.media.filter((media) => media.id !== this.mediaIdToDelete);\n      this.imageIdsUploadedByUser = this.imageIdsUploadedByUser.filter(\n        (id) => id !== this.mediaIdToDelete\n      );\n      this.mediaIdToDelete = undefined;\n      this.contentChanged();\n    } else {\n      console.warn(\"No image to delete\");\n    }\n  }\n\n  async reallyDeleteCurrentVideo() {\n    if (this.mediaIdToDelete) {\n      await window.adminServerApi.deleteVideo(\n        this.mediaIdToDelete,\n        \"group\",\n        this.collectionId as number,\n        this.videoIdsUploadedByUser.includes(this.mediaIdToDelete),\n        true\n      );\n      const mediaItem = this.media.find(media => media.id === this.mediaIdToDelete);\n      this._removeHtmlTag(mediaItem!.url, mediaItem!.type);\n      this.media = this.media.filter((media) => media.id !== this.mediaIdToDelete);\n      this.videoIdsUploadedByUser = this.videoIdsUploadedByUser.filter(\n        (id) => id !== this.mediaIdToDelete\n      );\n      this.mediaIdToDelete = undefined;\n      this.contentChanged()\n    } else {\n      console.warn(\"No video to delete\");\n    }\n  }\n\n  deleteCurrentLogoImage() {\n    window.appDialogs.getDialogAsync(\n      \"confirmationDialog\",\n      (dialog: YpConfirmationDialog) => {\n        dialog.open(\n          this.t(\"confirmDeleteLogoImage\"),\n          this.reallyDeleteCurrentLogoImage.bind(this)\n        );\n      }\n    );\n  }\n\n  deleteCurrentVideo() {\n    window.appDialogs.getDialogAsync(\n      \"confirmationDialog\",\n      (dialog: YpConfirmationDialog) => {\n        dialog.open(\n          this.t(\"confirmDeleteVideo\"),\n          this.reallyDeleteCurrentVideo.bind(this)\n        );\n      }\n    );\n  }\n\n  _removeMedia(media: YpSimpleGroupMediaData) {\n    this.mediaIdToDelete = media.id;\n    if (media.type === \"image\") {\n      this.deleteCurrentLogoImage();\n    } else if (media.type === \"video\") {\n      this.deleteCurrentVideo();\n    }\n    this.debouncedSave();\n  }\n\n  renderMedia() {\n    return html`\n      ${this.renderImageUploadOptions()}\n\n      <div class=\"layout horizontal wrap\">\n        ${this.media.map(\n          (media) => html`\n            <div class=\"mediaContainer\">\n              ${media.type === \"image\"\n                ? html`\n                    <img\n                      class=\"mediaImage\"\n                      src=\"${media.url}\"\n                      @load=\"${() => this._setMediaLoaded(media.id, true)}\"\n                      @error=\"${() => this._setMediaLoaded(media.id, false)}\"\n                    />\n                  `\n                : media.type === \"video\"\n                ? html`\n                    <video\n                      class=\"mediaVideo\"\n                      controls\n                      @loadedmetadata=\"${() =>\n                        this._setMediaLoaded(media.id, true)}\"\n                      @error=\"${() => this._setMediaLoaded(media.id, false)}\"\n                    >\n                      <source src=\"${media.url}\" type=\"video/mp4\" />\n                    </video>\n                  `\n                : nothing}\n              <div\n                style=\"display: ${this.mediaLoaded[media.id]\n                  ? \"flex\"\n                  : \"none\"};\"\n              >\n                <md-filled-tonal-icon-button\n                  class=\"deleteMediaButton\"\n                  @click=\"${() => this._removeMedia(media)}\"\n                  title=\"${this.t(\"deleteMedia\")}\"\n                >\n                  <md-icon>delete</md-icon>\n                </md-filled-tonal-icon-button>\n                <md-filled-icon-button\n                  class=\"insertMediaButton\"\n                  @click=\"${() => this._insertMediaIntoHtml(media)}\"\n                  title=\"${this.t(\"insertMedia\")}\"\n                >\n                  <md-icon>arrow_upward</md-icon>\n                </md-filled-icon-button>\n              </div>\n            </div>\n          `\n        )}\n      </div>\n    `;\n  }\n\n  _insertMediaIntoHtml(media: YpSimpleGroupMediaData) {\n    if (media.type === \"image\") {\n      const img = `<img src=\"${media.url}\" alt=\"\" style=\"width:300px;\"/>\\n`;\n      this.content = img + this.content;\n      this.contentChanged();\n    } else if (media.type === \"video\") {\n      const video = `<video controls style=\"width:300px;\"><source src=\"${media.url}\" type=\"video/mp4\"/></video>\\n`;\n      this.content = video + this.content;\n      this.contentChanged();\n    }\n    this.requestUpdate();\n  }\n\n  contentChanged() {\n    this.fire(\"configuration-changed\");\n    this.debouncedSave();\n  }\n\n  renderImageUploadOptions() {\n    return html`\n      <div class=\"layout vertical logoImagePlaceholder\">\n        <div class=\"layout horizontal center-center logoUploadButtons\">\n          <yp-file-upload\n            id=\"logoImageUpload\"\n            raised\n            hideStatus\n            class=\"uploadIcon\"\n            useIconButton\n            target=\"/api/images?itemType=group-html-media\"\n            method=\"POST\"\n            buttonIcon=\"photo_camera\"\n            .buttonText=\"${this.t(\"image.logo.upload\")}\"\n            @success=\"${this._logoImageUploaded}\"\n          >\n          </yp-file-upload>\n          <div class=\"aiGenerationIconContainer uploadIcon\">\n            <md-filled-icon-button\n              ?hidden=\"${!this.hasLlm}\"\n              id=\"generateButton\"\n              @click=\"${this._generateLogo}\"\n              ><md-icon>smart_toy</md-icon></md-filled-icon-button\n            >\n          </div>\n\n          <yp-file-upload\n            ?hidden=\"${!this.hasVideoUpload}\"\n            id=\"videoFileUpload\"\n            raised\n            useIconButton\n            videoUpload\n            autoChooseFirstVideoFrameAsPost\n            class=\"uploadIcon videoUploadIcon\"\n            method=\"POST\"\n            buttonIcon=\"videocam\"\n            .buttonText=\"${this.t(\"uploadVideo\")}\"\n            @success=\"${this._videoUploaded}\"\n          >\n          </yp-file-upload>\n        </div>\n      </div>\n    `;\n  }\n\n  override render() {\n    return html`\n      <div class=\"layout vertical center-center\">\n        <md-tabs\n          @change=\"${this._selectTab}\"\n          .activeTabIndex=\"${this.selectedTab}\"\n        >\n          <md-primary-tab\n            >${this.t(\"simpleHtmlEditor\")}\n            <md-icon slot=\"icon\">edit_note</md-icon></md-primary-tab\n          >\n          <md-primary-tab\n            >${this.t(\"editHtmlDirectly\")}\n            <md-icon slot=\"icon\">html</md-icon></md-primary-tab\n          >\n          <md-primary-tab\n            >${this.t(\"previewHtml\")}\n            <md-icon slot=\"icon\">preview</md-icon></md-primary-tab\n          >\n        </md-tabs>\n      </div>\n\n      ${this.selectedTab === 0\n        ? html`\n            <yp-simple-html-editor\n              .value=\"${this.content}\"\n              @change=\"${this.changed}\"\n            ></yp-simple-html-editor>\n          `\n        : nothing}\n      ${this.selectedTab === 1\n        ? html`\n            <md-filled-text-field\n              data-type=\"text\"\n              type=\"textarea\"\n              .label=\"${this.t(\"editHtmlDirectly\")}\"\n              .value=\"${this.content}\"\n              minlength=\"2\"\n              @change=\"${this.changed}\"\n              rows=\"14\"\n              style=\"width: 100%;--md-filled-field-container-color: var(--md-sys-color-surface);\"\n            >\n            </md-filled-text-field>\n          `\n        : nothing}\n      ${this.selectedTab === 2\n        ? html`<div class=\"previewHtml\">${unsafeHTML(this.content)}</div>`\n        : nothing}\n\n      <div class=\"layout horizontal center-center\">\n        <div class=\"mediaHeader\">${this.t(\"addMedia\")}</div>\n      </div>\n      ${this.renderMedia()} ${this.renderAiImageGenerator()}\n    `;\n  }\n\n  changed(event: CustomEvent) {\n    if (event.currentTarget) {\n      this.content = (event.currentTarget as MdFilledTextField).value;\n    } else {\n      this.content = event.detail.value;\n    }\n\n    this.contentChanged();\n  }\n\n  debouncedSave() {\n    if (this.debounceTimer) {\n      clearTimeout(this.debounceTimer);\n    }\n    this.debounceTimer = window.setTimeout(() => {\n      // this.save();\n    }, 10000); // Adjust the delay time as needed\n  }\n}\n"]}