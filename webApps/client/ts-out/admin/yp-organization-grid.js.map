{"version":3,"file":"yp-organization-grid.js","sourceRoot":"","sources":["../../src/admin/yp-organization-grid.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html, css, nothing } from \"lit\";\nimport { customElement, property, query } from \"lit/decorators.js\";\nimport \"@material/web/dialog/dialog.js\";\nimport \"@material/web/list/list-item.js\";\nimport \"@material/web/list/list.js\";\nimport \"@material/web/button/filled-button.js\";\nimport \"@material/web/button/text-button.js\";\nimport \"@material/web/icon/icon.js\";\nimport \"@material/web/iconbutton/icon-button.js\";\nimport \"@material/web/progress/circular-progress.js\";\nimport \"@material/web/textfield/outlined-text-field.js\";\nimport { MdDialog } from \"@material/web/dialog/dialog.js\";\nimport { YpBaseElement } from \"../common/yp-base-element\";\nimport { YpFormattingHelpers } from \"../common/YpFormattingHelpers\";\nimport { YpMediaHelpers } from \"../common/YpMediaHelpers\";\n\nimport \"./yp-organization-edit.js\";\nimport { YpOrganizationEdit } from \"./yp-organization-edit.js\";\nimport { YpConfirmationDialog } from \"../yp-dialog-container/yp-confirmation-dialog\";\n\n@customElement(\"yp-organization-grid\")\nexport class YpOrganizationGrid extends YpBaseElement {\n  @property({ type: Array })\n  organizations: Array<any> | undefined;\n\n  @property({ type: String })\n  headerText: string | undefined;\n\n  @property({ type: String })\n  domainId: string | undefined;\n\n  @property({ type: Object })\n  selected: any | undefined;\n\n  organizationToDeleteId: number | undefined;\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        .header {\n          font-weight: bold;\n          padding: 10px;\n          background-color: #f0f0f0;\n        }\n\n        .addOrgButton {\n          margin-top: 16px;\n          margin-bottom: 64px;\n        }\n\n        .list {\n          display: table;\n          width: 100%;\n          border-collapse: collapse;\n          background-color: #fff;\n        }\n\n        .pageItem {\n          display: table-cell;\n          padding: 10px;\n          text-align: left;\n        }\n\n        .id {\n          width: 60px;\n        }\n\n        .title {\n          width: 200px;\n        }\n\n        .email {\n          width: 240px;\n        }\n\n        .locale {\n          width: 30px;\n          cursor: pointer;\n        }\n\n        md-button {\n          display: table-cell;\n          padding: 10px;\n          border: 1px solid #ddd;\n        }\n\n        .orgLogo {\n          height: 75px;\n          width: 75px;\n        }\n\n        [hidden] {\n          display: none !important;\n        }\n      `,\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  override async connectedCallback(): Promise<void> {\n    super.connectedCallback();\n    this.refresh();\n  }\n\n  async refresh() {\n    this.organizations = (await window.adminServerApi.adminMethod(\n      `/api/organizations/${this.domainId}/domainOrganizations`,\n      \"GET\"\n    )) as YpOrganizationData[];\n  }\n\n  override render() {\n    return html`\n      <div class=\"header\">${this.t(\"organizationsAdmin\")}</div>\n      <md-list class=\"list\">\n        ${this.organizations?.map(\n          (organization) => html`\n            <md-list-item class=\"layout horizontal\">\n              <div class=\"pageItem\">\n                <img\n                  src=\"${this._organizationImageUrl(organization)}\"\n                  class=\"orgLogo\"\n                />\n              </div>\n              <div class=\"pageItem id\">${organization.name}</div>\n              <div class=\"pageItem description\">\n                ${organization.description}\n              </div>\n              <div class=\"pageItem website\">${organization.website}</div>\n\n              <div class=\"layout horizontal\">\n                <md-text-button\n                  @click=\"${() => this._editOrganization(organization)}\"\n                >\n                  ${this.t(\"update\")}\n                </md-text-button>\n                <md-icon-button\n                  @click=\"${() => this._deleteOrganization(organization)}\"\n                  .label=\"${this.t(\"delete\")}\"\n                  ><md-icon>delete</md-icon></md-icon-button\n                >\n              </div>\n            </md-list-item>\n          `\n        )}\n      </md-list>\n\n      <div class=\"layout vertical center-center\">\n        <md-outlined-button\n          class=\"addOrgButton\"\n          @click=\"${this._createOrganization}\"\n          >${this.t(\"createOrganization\")}</md-outlined-button\n        >\n      </div>\n\n      <yp-organization-edit\n        id=\"editDialog\"\n        .domainId=\"${this.domainId}\"\n      ></yp-organization-edit>\n    `;\n  }\n\n  _deleteOrganization(organization: YpOrganizationData) {\n    this.organizationToDeleteId = organization.id;\n    window.appDialogs.getDialogAsync(\n      \"confirmationDialog\",\n      (dialog: YpConfirmationDialog) => {\n        dialog.open(\n          this.t(\"areYouSureYouWantToDeleteThisOrganization\"),\n          this._reallyDeleteOrganization.bind(this),\n          true,\n          false\n        );\n      }\n    );\n  }\n\n  async _reallyDeleteOrganization() {\n    try {\n      await window.adminServerApi.adminMethod(\n        `/api/organizations/${this.organizationToDeleteId}`,\n        \"DELETE\"\n      );\n      this.refresh();\n    } catch (e) {\n      console.error(e);\n    }\n  }\n\n  _afterEdit() {\n    const editDialog = this.shadowRoot!.getElementById(\n      \"editDialog\"\n    ) as YpOrganizationEdit;\n    editDialog.close();\n    this.refresh();\n  }\n\n  _createOrganization() {\n    const editDialog = this.shadowRoot!.getElementById(\n      \"editDialog\"\n    ) as YpOrganizationEdit;\n    editDialog.setup(undefined, true, this._afterEdit.bind(this));\n    editDialog.open(true, {});\n  }\n\n  _editOrganization(organization: any) {\n    const editDialog = this.shadowRoot!.getElementById(\n      \"editDialog\"\n    ) as YpOrganizationEdit;\n    editDialog.organization = organization;\n    editDialog.setup(organization, false, this._afterEdit.bind(this));\n    editDialog.open(false, {});\n  }\n\n  _organizationImageUrl(organization: any): string | null {\n    if (organization.OrgLogoImgs) {\n      return YpMediaHelpers.getImageFormatUrl(\n        organization.OrgLogoImgs,\n        2\n      );\n    } else {\n      return null;\n    }\n  }\n}\n"]}