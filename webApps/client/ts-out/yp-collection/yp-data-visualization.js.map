{"version":3,"file":"yp-data-visualization.js","sourceRoot":"","sources":["../../src/yp-collection/yp-data-visualization.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { html, css, nothing } from 'lit';\nimport { property, customElement } from 'lit/decorators.js';\n\nimport { YpBaseElement } from '../common/yp-base-element.js';\nimport { YpFormattingHelpers } from '../common/YpFormattingHelpers.js';\n\nimport \"@material/web/icon/icon.js\";\n\nimport { Chart } from 'chart.js';\n\n@customElement('yp-data-visualization')\nexport class YpDataVisualization extends YpBaseElement {\n  @property({ type: Object })\n  group!: YpGroupData;\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        :host {\n          margin-top: 16px;\n        }\n\n        canvas {\n        }\n\n        .wrapper {\n          position: relative;\n          display: inline-block;\n          margin-left: 16px;\n          margin-right: 16px;\n        }\n\n        .wrapper[small] {\n          padding: 0;\n          margin-left: 14px;\n          margin-right: 14px;\n        }\n\n        .wrapper[small-screen] {\n          padding: 0;\n          margin-left: 14px;\n          margin-right: 14px;\n        }\n\n        .text {\n          position: absolute;\n          text-align: center;\n          width: 100%;\n          line-height: 190px;\n          font-size: 28px;\n          color: #000;\n        }\n\n        .text[small] {\n          line-height: 135px;\n          font-size: 20px;\n        }\n\n        .text[small-screen] {\n          line-height: 135px;\n          font-size: 20px;\n        }\n\n        canvas {\n          position: relative;\n          z-index: 1;\n        }\n\n        .header {\n          font-size: 28px;\n          margin-bottom: 8px;\n          margin-top: 16px;\n        }\n\n        .groupName {\n          font-size: 28px;\n          margin: 8px;\n          padding: 8px;\n          color: #222;\n          margin-top: 0;\n          padding-top: 0;\n        }\n\n        .groupName[small-screen] {\n          font-size: 20px;\n          margin-bottom: 16px;\n        }\n\n        .topHeader {\n          font-size: 22px;\n          margin: 8px;\n          margin-top: 0;\n          color: #111;\n        }\n\n        .firstTopHeader {\n          color: #333;\n        }\n\n        .targetText {\n          margin-top: 8px;\n          margin-bottom: 8px;\n          font-size: 22px;\n          text-align: center;\n          color: #111;\n        }\n\n        .targetText[small] {\n          font-size: 18px;\n        }\n\n        .targetText[small-screen] {\n          font-size: 18px;\n        }\n\n        .stage[not-small] {\n          box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),\n            0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);\n        }\n\n        .stage {\n          background-color: #fefefe;\n          padding: 16px;\n          padding-top: 24px;\n          width: 520px;\n          margin: 16px;\n          margin-bottom: 8px;\n        }\n\n        .stage[small] {\n          width: 400px;\n          margin: 0;\n          padding: 8px;\n          padding-top: 32px;\n          padding-bottom: 16px;\n        }\n\n        .stage[small-screen] {\n          width: 300px;\n          padding: 8px;\n          padding-top: 32px;\n          padding-bottom: 16px;\n        }\n\n        .stageTop {\n          background-color: #fefefe;\n          padding: 16px;\n          width: 520px;\n          margin: 16px;\n          margin-bottom: 8px;\n          padding-top: 8px;\n        }\n\n        [hidden] {\n          display: none !important;\n        }\n      `,\n    ];\n  }\n\n  get canvasSize() {\n    return this.wide ? 135 : 190;\n  }\n\n  override firstUpdated(changedProperties: Map<string | number | symbol, unknown>) {\n    super.firstUpdated(changedProperties);\n    this._drawCharts();\n  }\n\n  formatAmount(amount: number) {\n    return `$${amount}m`;\n  }\n\n  _drawCharts() {\n    const data = this.group.configuration.dataForVisualizationJson!;\n    this._drawChart(\n      '#overallTarget',\n      data.overallTargetPercent,\n      this.t('overall'),\n      data.overallColor ? data.overallColor : '#5bac51'\n    );\n    this._drawChart(\n      '#overallActual',\n      data.overallActualPercent,\n      this.t('actual'),\n      data.overallColor ? data.overallColor : '#5bac51'\n    );\n    this._drawChart(\n      '#yearTarget',\n      data.yearTargetPercent,\n      this.t('overall'),\n      data.yearColor ? data.yearColor : '#004f77'\n    );\n    this._drawChart(\n      '#yearActual',\n      data.yearActualPercent,\n      this.t('actual'),\n      data.yearColor ? data.yearColor : '#004f77'\n    );\n  }\n\n  _drawChart(\n    chartId: string,\n    percentDone: number,\n    labelText: string,\n    color: string,\n    hideGray = false\n  ) {\n    // @ts-ignore\n    new Chart(this.$$(chartId)!.getContext('2d'), {\n      type: 'doughnut',\n      data: {\n        labels: [labelText, labelText],\n        datasets: [\n          {\n            data: [percentDone, percentDone - 100],\n            borderColor: [\n              hideGray ? 'transparent' : '#FFF',\n              hideGray ? 'transparent' : '#FFF',\n            ],\n            backgroundColor: [\n              color,\n              hideGray ? 'transparent' : 'rgb(220,220,220)',\n            ],\n          },\n        ],\n      },\n      options: {\n        // @ts-ignore\n        tooltips: false,\n        legend: {\n          display: false,\n        },\n        toolstips: {\n          callbacks: {\n            label: (tooltipItem: any) => {\n              return tooltipItem.yLabel;\n            },\n          },\n        },\n      },\n    });\n  }\n\n  override render() {\n    const data = this.group.configuration.dataForVisualizationJson!;\n    return html`\n      <div class=\"layout vertical center-center\">\n        <div\n          class=\"layout vertical stage shadow-elevation-2dp center-center\"\n          ?small-screen=\"${!this.wide}\"\n          ?small=\"${!this.wide}\"\n          ?not-small=\"${this.wide}\"\n        >\n          <div class=\"layout vertical\" ?hidden=\"${!this.wide}\">\n            <yp-magic-text\n              id=\"groupName\"\n              class=\"groupName\"\n              ?small-screen=\"${!this.wide}\"\n              textType=\"groupName\"\n              .contentLanguage=\"${this.group.language}\"\n              .disableTanslation=\"${this.group.configuration\n                .disableNameAutoTranslation}\"\n              textOnly\n              .content=\"${this.group.name}\"\n              .contentId=\"${this.group.id}\"\n            >\n            </yp-magic-text>\n          </div>\n          <div class=\"topHeader firstTopHeader\" ?hidden=\"${!this.wide}\">\n            ${this.t('overall')}\n          </div>\n          <div class=\"layout horizontal center-center\">\n            <div>\n              <div\n                id=\"breakdownWrap\"\n                class=\"wrapper\"\n                ?small-screen=\"${!this.wide}\"\n                ?small=\"${!this.wide}\"\n              >\n                <div\n                  class=\"text\"\n                  ?small-screen=\"${!this.wide}\"\n                  ?small=\"${!this.wide}\"\n                >\n                  ${data.overallTargetPercent}%\n                </div>\n                <canvas\n                  id=\"overallTarget\"\n                  width=\"${this.canvasSize}\"\n                  height=\"${this.canvasSize}\"\n                ></canvas>\n              </div>\n              <div\n                class=\"layout vertical targetText\"\n                ?small-screen=\"${!this.wide}\"\n                ?small=\"${!this.wide}\"\n              >\n                ${this.t('target')}:\n                ${this.formatAmount(data.overallTargetAmount)}\n              </div>\n            </div>\n            <div>\n              <div\n                id=\"breakdownWrapTwo\"\n                class=\"wrapper\"\n                ?small-screen=\"${!this.wide}\"\n                ?small=\"${!this.wide}\"\n              >\n                <div\n                  class=\"text\"\n                  ?small-screen=\"${!this.wide}\"\n                  ?small=\"${!this.wide}\"\n                >\n                  ${data.overallActualPercent}%\n                </div>\n                <canvas\n                  id=\"overallActual\"\n                  width=\"${this.canvasSize}\"\n                  height=\"${this.canvasSize}\"\n                ></canvas>\n              </div>\n              <div\n                class=\"layout vertical targetText\"\n                ?small-screen=\"${!this.wide}\"\n                ?small=\"${!this.wide}\"\n              >\n                ${this.t('actual')}:\n                ${this.formatAmount(data.overallActualAmount)}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div\n          class=\"layout vertical stage shadow-elevation-2dp center-center\"\n          ?small-screen=\"${!this.wide}\"\n          ?small=\"${!this.wide}\"\n          ?not-small=\"${this.wide}\"\n        >\n          <div class=\"layout vertical topHeader\">${data.currentYear}</div>\n          <div class=\"layout horizontal center-center\">\n            <div>\n              <div\n                id=\"breakdownWrapA\"\n                class=\"wrapper\"\n                ?small-screen=\"${!this.wide}\"\n                ?small=\"${!this.wide}\"\n              >\n                <div\n                  class=\"text\"\n                  ?small-screen=\"${!this.wide}\"\n                  ?small=\"${!this.wide}\"\n                >\n                  ${data.yearTargetPercent}%\n                </div>\n                <canvas\n                  id=\"yearTarget\"\n                  width=\"${this.canvasSize}\"\n                  height=\"${this.canvasSize}\"\n                ></canvas>\n              </div>\n              <div\n                class=\"layout vertical targetText\"\n                ?small-screen=\"${!this.wide}\"\n                ?small=\"${!this.wide}\"\n              >\n                ${this.t('target')}: ${this.formatAmount(data.yearTargetAmount)}\n              </div>\n            </div>\n            <div>\n              <div\n                id=\"breakdownWrapTwoA\"\n                class=\"wrapper\"\n                ?small-screen=\"${!this.wide}\"\n                ?small=\"${!this.wide}\"\n              >\n                <div\n                  class=\"text\"\n                  ?small-screen=\"${!this.wide}\"\n                  ?small=\"${!this.wide}\"\n                >\n                  ${data.yearActualPercent}%\n                </div>\n                <canvas\n                  id=\"yearActual\"\n                  width=\"${this.canvasSize}\"\n                  height=\"${this.canvasSize}\"\n                ></canvas>\n              </div>\n              <div\n                class=\"layout vertical targetText\"\n                ?small-screen=\"${!this.wide}\"\n                ?small=\"${!this.wide}\"\n              >\n                ${this.t('actual')}: ${this.formatAmount(data.yearActualAmount)}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n}\n"]}