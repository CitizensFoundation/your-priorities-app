{"version":3,"file":"yp-group.js","sourceRoot":"","sources":["../../src/yp-collection/yp-group.ts"],"names":[],"mappings":"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","sourcesContent":["import { YpAccessHelpers } from \"../common/YpAccessHelpers.js\";\nimport { YpMediaHelpers } from \"../common/YpMediaHelpers.js\";\n\nimport { YpCollection } from \"./yp-collection.js\";\nimport { YpCollectionItemsGrid } from \"./yp-collection-items-grid.js\";\nimport { TemplateResult, html, nothing, LitElement } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators.js\";\n\nimport \"@material/web/tabs/tabs.js\";\nimport \"@material/web/tabs/primary-tab.js\";\n\nimport \"./yp-group-header.js\";\nimport \"../ac-activities/ac-activities.js\";\n\nimport \"../yp-post/yp-posts-list.js\";\nimport \"../yp-post/yp-post-card-add.js\";\nimport { YpPostsList } from \"../yp-post/yp-posts-list.js\";\nimport { YpPostEdit } from \"../yp-post/yp-post-edit.js\";\nimport { YpPostMap } from \"../yp-post/yp-post-map.js\";\nimport { MdTabs } from \"@material/web/tabs/tabs.js\";\nimport { cache } from \"lit/directives/cache.js\";\n\nimport { YpSnackbar } from \"../yp-app/yp-snackbar.js\";\nimport { unsafeHTML } from \"lit/directives/unsafe-html.js\";\nimport { YpGroupType } from \"./ypGroupType.js\";\nimport G from \"glob\";\n\n// TODO: Remove\ninterface AcActivity extends LitElement {\n  scrollToItem(item: YpDatabaseItem): () => void;\n  loadNewData(): () => void;\n}\n\nexport const GroupTabTypes: Record<string, number> = {\n  Open: 0,\n  InProgress: 1,\n  Successful: 2,\n  Failed: 3,\n  Newsfeed: 4,\n  Map: 5,\n};\n\n@customElement(\"yp-group\")\nexport class YpGroup extends YpCollection {\n  @property({ type: Object })\n  override collection: YpGroupData | undefined;\n\n  @property({ type: String })\n  searchingFor: string | undefined;\n\n  @property({ type: Boolean })\n  hasNonOpenPosts = false;\n\n  @property({ type: Boolean })\n  disableNewPosts = false;\n\n  @property({ type: Number })\n  selectedGroupTab = GroupTabTypes.Open;\n\n  @property({ type: Number })\n  configCheckTimer: ReturnType<typeof setTimeout> | undefined;\n\n  @state()\n  newGroupRefresh = false;\n\n  @state()\n  isImportingCode = false;\n\n  @state()\n  haveLoadedAgentsOps = false;\n\n  @state()\n  haveLoadedAllOurIdeas = false;\n\n  tabCounters: Record<string, number> = {};\n  configCheckTTL = 45000;\n\n  constructor() {\n    super(\"group\", \"post\", \"lightbulb_outline\", \"post.create\");\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this.addListener(\"yp-post-count\", this._updateTabPostCount);\n    this.addListener(\n      \"yp-refresh-activities-scroll-threshold\",\n      this._clearScrollThreshold\n    );\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this.removeListener(\"yp-post-count\", this._updateTabPostCount);\n    this.removeListener(\n      \"yp-refresh-activities-scroll-threshold\",\n      this._clearScrollThreshold\n    );\n  }\n\n  _cancelConfigCheckTimer() {\n    if (this.configCheckTimer) {\n      clearTimeout(this.configCheckTimer);\n      this.configCheckTimer = undefined;\n    }\n  }\n\n  _startConfigCheckTimer() {\n    this._cancelConfigCheckTimer();\n    if (this.collection) {\n      this.configCheckTimer = setTimeout(\n        this._getGroupConfig.bind(this),\n        this.configCheckTTL\n      );\n    }\n  }\n\n  async _getGroupConfig() {\n    if (this.collection) {\n      const groupConfiguration = (await window.serverApi.getGroupConfiguration(\n        this.collection.id\n      )) as YpGroupConfiguration;\n      if (groupConfiguration) {\n        if (\n          this._doesGroupRequireRefresh(\n            (this.collection as YpGroupData).configuration,\n            groupConfiguration\n          )\n        ) {\n          window.appDialogs.getDialogAsync(\n            \"masterToast\",\n            (toast: YpSnackbar) => {\n              toast.textContent = this.t(\"groupConfigurationHasBeenUpdated\");\n              toast.timeoutMs = 7500;\n            }\n          );\n          this._refreshAjax();\n        }\n        this._startConfigCheckTimer();\n      } else {\n        this._cancelConfigCheckTimer();\n      }\n    } else {\n      this._cancelConfigCheckTimer();\n    }\n  }\n\n  _doesGroupRequireRefresh(\n    groupConfigA: YpGroupConfiguration,\n    groupConfigB: YpGroupConfiguration\n  ) {\n    if (groupConfigA && groupConfigB) {\n      if (\n        groupConfigA.canVote !== groupConfigB.canVote ||\n        groupConfigA.canAddNewPosts !== groupConfigB.canAddNewPosts ||\n        groupConfigA.disableDebate !== groupConfigB.disableDebate ||\n        groupConfigA.hideNewPost !== groupConfigB.hideNewPost\n      ) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  }\n\n  _updateTabPostCount(event: CustomEvent) {\n    const tabCounterInfo = event.detail;\n    this.tabCounters[tabCounterInfo.type] = tabCounterInfo.count;\n\n    this._setupOpenTab();\n\n    setTimeout(() => {\n      this.requestUpdate();\n    });\n  }\n\n  _setupOpenTab() {\n    if (this.hasNonOpenPosts) {\n      if (\n        this.collection!.configuration &&\n        (this.collection!.configuration as YpGroupConfiguration)\n          .makeMapViewDefault\n      ) {\n        console.log(\"Not opening tabs with ideas in map mode\");\n      } else {\n        if (Object.keys(this.tabCounters).length === 4) {\n          //TODO: Fix this logic of selecting a group with some ideas after we get the new counts from the server\n          if (this.selectedGroupTab === GroupTabTypes.Open) {\n            if (this.tabCounters[\"open\"] && this.tabCounters[\"open\"] > 0) {\n              this.selectedGroupTab = GroupTabTypes.Open;\n            } else if (\n              this.tabCounters[\"inProgress\"] &&\n              this.tabCounters[\"inProgress\"] > 0\n            ) {\n              this.selectedGroupTab = GroupTabTypes.InProgress;\n            } else if (\n              this.tabCounters[\"successful\"] &&\n              this.tabCounters[\"successful\"] > 0\n            ) {\n              this.selectedGroupTab = GroupTabTypes.Successful;\n            } else if (\n              this.tabCounters[\"failed\"] &&\n              this.tabCounters[\"failed\"] > 0\n            ) {\n              this.selectedGroupTab = GroupTabTypes.Failed;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  tabLabelWithCount(type: string): string {\n    const labelTranslation = this.t(\"posts.\" + type);\n    if (type === \"inProgress\") type = \"in_progress\";\n\n    return `${labelTranslation} (${\n      this.tabCounters[type] != undefined ? this.tabCounters[type] : \"...\"\n    })`;\n  }\n\n  getCurrentTabElement(): HTMLElement | undefined {\n    let element: HTMLElement | undefined | null;\n\n    switch (this.selectedGroupTab) {\n      case GroupTabTypes.Open:\n        element = this.$$(\"#openPostList\");\n        break;\n      case GroupTabTypes.InProgress:\n        element = this.$$(\"#in_progressPostList\");\n        break;\n      case GroupTabTypes.Successful:\n        element = this.$$(\"#successfulPostList\");\n        break;\n      case GroupTabTypes.Failed:\n        element = this.$$(\"#failedPostList\");\n        break;\n      case GroupTabTypes.Newsfeed:\n        element = this.$$(\"#newsfeed\");\n        break;\n      case GroupTabTypes.Map:\n        element = this.$$(\"#postMap\");\n        break;\n    }\n\n    if (element === null) element = undefined;\n\n    return element;\n  }\n\n  override async getCollection() {\n    window.appGlobals.retryMethodAfter401Login = this.getCollection.bind(this);\n    this.hasNonOpenPosts = false;\n    this.tabCounters = {};\n\n    if (\n      this.collectionId &&\n      window.appGlobals.cache.groupItemsCache[this.collectionId]\n    ) {\n      this.collection =\n        window.appGlobals.cache.groupItemsCache[this.collectionId];\n      this.refresh();\n    } else if (this.collectionId) {\n      this.collection = undefined;\n      this.collectionItems = undefined;\n      const groupResults = (await window.serverApi.getCollection(\n        this.collectionType,\n        this.collectionId\n      )) as YpGroupResults | undefined;\n      if (groupResults) {\n        this.collection = groupResults.group;\n        this.hasNonOpenPosts = groupResults.hasNonOpenPosts;\n        if (\n          !this.haveLoadedAgentsOps &&\n          this.collection.configuration.groupType == YpGroupType.PsAgentWorkflow\n        ) {\n          await import(\"../policySynth/ps-operations-manager.js\");\n          this.haveLoadedAgentsOps = true;\n        } else if (\n          !this.haveLoadedAllOurIdeas &&\n          this.collection.configuration.groupType == YpGroupType.AllOurIdeas\n        ) {\n          await import(\"../allOurIdeas/aoi-survey.js\");\n          this.haveLoadedAllOurIdeas = true;\n        }\n        this.refresh();\n      }\n    }\n    window.appGlobals.retryMethodAfter401Login = undefined;\n  }\n\n  //TODO: Fix moving on to the next group with focus if 0 ideas in Open\n  renderGroupTabs() {\n    if (this.collection && !this.tabsHidden) {\n      return html`\n        <div class=\"layout vertical center-center\">\n          <md-tabs\n            @change=\"${this._selectGroupTab}\"\n            .activeTabIndex=\"${this.selectedGroupTab}\"\n          >\n            <md-primary-tab\n              >${this.tabLabelWithCount(\"open\")}<md-icon slot=\"icon\"\n                >lightbulb_outline</md-icon\n              ></md-primary-tab\n            >\n            ${this.hasNonOpenPosts\n              ? html`\n                  <md-primary-tab\n                    >${this.tabLabelWithCount(\"inProgress\")}<md-icon slot=\"icon\"\n                      >lightbulb_outline</md-icon\n                    ></md-primary-tab\n                  >\n                  <md-primary-tab\n                    >${this.tabLabelWithCount(\"successful\")}<md-icon slot=\"icon\"\n                      >lightbulb_outline</md-icon\n                    ></md-primary-tab\n                  >\n                  <md-primary-tab\n                    >${this.tabLabelWithCount(\"failed\")}<md-icon slot=\"icon\"\n                      >lightbulb_outline</md-icon\n                    >\n                  </md-primary-tab>\n                `\n              : nothing}\n            ${this.renderNewsAndMapTabs()}\n          </md-tabs>\n        </div>\n      `;\n    } else {\n      return nothing;\n    }\n  }\n\n  renderPostList(statusFilter: string): TemplateResult {\n    return this.collection\n      ? html`<div class=\"layout vertical center-center\">\n          <yp-posts-list\n            id=\"${statusFilter}PostList\"\n            role=\"main\"\n            aria-label=\"${this.t(\"posts.posts\")}\"\n            .selectedGroupTab=\"${this.selectedGroupTab}\"\n            .listRoute=\"${this.subRoute}\"\n            .statusFilter=\"${statusFilter}\"\n            .searchingFor=\"${this.searchingFor}\"\n            .group=\"${this.collection as YpGroupData}\"\n          ></yp-posts-list>\n        </div> `\n      : html``;\n  }\n\n  renderCurrentGroupTabPage(): TemplateResult | undefined {\n    let page: TemplateResult | undefined;\n\n    switch (this.selectedGroupTab) {\n      case GroupTabTypes.Open:\n        page = this.renderPostList(\"open\");\n        break;\n      case GroupTabTypes.InProgress:\n        page = this.renderPostList(\"in_progress\");\n        break;\n      case GroupTabTypes.Successful:\n        page = this.renderPostList(\"successful\");\n        break;\n      case GroupTabTypes.Failed:\n        page = this.renderPostList(\"failed\");\n        break;\n      case GroupTabTypes.Newsfeed:\n        page = html` <ac-activities\n          id=\"newsfeed\"\n          .selectedGroupTab=\"${this.selectedGroupTab}\"\n          .collectionType=\"${this.collectionType}\"\n          .collectionId=\"${this.collectionId}\"\n        ></ac-activities>`;\n        break;\n      case GroupTabTypes.Map:\n        page = html``;\n        break;\n    }\n\n    return page;\n  }\n\n  override renderHeader() {\n    return this.collection && !this.noHeader\n      ? html`\n          <div class=\"layout vertical center-center header\">\n            <yp-group-header\n              .collection=\"${this.collection}\"\n              .collectionType=\"${this.collectionType}\"\n              aria-label=\"${this.collectionType}\"\n              role=\"banner\"\n            ></yp-group-header>\n          </div>\n        `\n      : nothing;\n  }\n\n  override render() {\n    if (this.collection && this.collection.configuration) {\n      let groupType: number = 0;\n\n      if ((this.collection as YpGroupData).configuration.groupType) {\n        // If groupType is string, convert it to number\n        //TODO: convert it to number when storing but keep this for backwards compatibility\n        if (\n          typeof (this.collection as YpGroupData).configuration.groupType ===\n          \"string\"\n        ) {\n          groupType = parseInt(\n            (this.collection as YpGroupData).configuration\n              .groupType as unknown as string\n          );\n        } else {\n          groupType = (this.collection as YpGroupData).configuration\n            .groupType as unknown as number;\n        }\n      }\n\n      if (groupType == YpGroupType.IdeaGenerationAndDebate) {\n        return this.renderYpGroup();\n      } else if (groupType == YpGroupType.AllOurIdeas) {\n        if (this.haveLoadedAllOurIdeas) {\n          return html`<aoi-survey\n            id=\"aoiSurvey\"\n            .collectionId=\"${this.collectionId as number}\"\n            .collection=\"${this.collection}\"\n          ></aoi-survey>`;\n        } else {\n          return html``;\n        }\n      } else if (groupType == YpGroupType.StaticHtml) {\n        return html`\n          <div class=\"layout vertical\">\n            ${unsafeHTML(\n              (this.collection as YpGroupData).configuration.staticHtml?.content\n            )}\n            <div\n              class=\"layout vertical center-center\"\n              ?hidden=\"${!YpAccessHelpers.checkGroupAccess(\n                this.collection as YpGroupData\n              )}\"\n            >\n              <md-icon-button\n                id=\"menuButton\"\n                @click=\"${this._openAdmin}\"\n                title=\"${this.t(\"group.edit\")}\"\n                ><md-icon>settings</md-icon>\n              </md-icon-button>\n            </div>\n            <ac-activities\n              id=\"newsfeed\"\n              .label=\"${this.t(\"addComment\")}\"\n              .notLoggedInLabel=\"${this.t(\"loginToAddComment\")}\"\n              .addLabel=\"${this.t(\"addComment\")}\"\n              .selectedGroupTab=\"${this.selectedGroupTab}\"\n              .collectionType=\"${this.collectionType}\"\n              .collectionId=\"${this.collectionId}\"\n            ></ac-activities>\n          </div>\n        `;\n      } else if (groupType == YpGroupType.PsAgentWorkflow) {\n        if (this.haveLoadedAgentsOps) {\n          return html`<ps-operations-manager\n            .groupId=\"${this.collection.id}\"\n          ></ps-operations-manager>`;\n        } else {\n          return html``;\n        }\n      } else {\n        return html``;\n      }\n    } else {\n      return html`<md-linear-progress indeterminate></md-linear-progress> `;\n    }\n  }\n\n  renderYpGroup() {\n    return html`\n      ${this.renderHeader()}\n      ${this.collection &&\n      !(this.collection.configuration as YpGroupConfiguration).hideNewPost\n        ? html` <div\n            class=\"layout vertical center-center\"\n            ?hidden=\"${(this.collection.configuration as YpGroupConfiguration)\n              .hideNewPost}\"\n          >\n            <div>\n              <yp-post-card-add\n                role=\"button\"\n                aria-label=\"${this.t(\"post.new\")}\"\n                .group=\"${this.collection as YpGroupData}\"\n                ?disableNewPosts=\"${this.disableNewPosts}\"\n                @new-post=\"${this._newPost}\"\n              ></yp-post-card-add>\n            </div>\n          </div>`\n        : nothing}\n      ${this.renderGroupTabs()} ${cache(this.renderCurrentGroupTabPage())}\n      ${!this.disableNewPosts &&\n      this.collection &&\n      !(this.collection.configuration as YpGroupConfiguration).hideNewPost\n        ? html` <md-fab\n            .label=\"${this.t(\"post.new\")}\"\n            icon=\"lightbulb\"\n            @click=\"${this._newPost}\"\n          ></md-fab>`\n        : nothing}\n    `;\n  }\n\n  _selectGroupTab(event: CustomEvent) {\n    this.selectedGroupTab = (event.currentTarget as MdTabs).activeTabIndex;\n\n    if (!this.hasNonOpenPosts && this.selectedGroupTab !== 0) {\n      this.selectedGroupTab += 3;\n    }\n  }\n\n  _openHelpPageIfNeededOnce() {\n    if (\n      this.collection &&\n      !sessionStorage.getItem(\"yp-welcome-for-group-\" + this.collection.id)\n    ) {\n      setTimeout(() => {\n        if (\n          this.collection &&\n          this.collection.configuration &&\n          this.collection.configuration.welcomePageId\n        ) {\n          this.fire(\"yp-open-page\", {\n            pageId: this.collection.configuration.welcomePageId,\n          });\n          sessionStorage.setItem(\n            \"yp-welcome-for-group-\" + this.collection.id,\n            \"true\"\n          );\n        }\n      }, 1200);\n    }\n  }\n\n  //TODO: Check this and rename\n  _refreshAjax() {\n    setTimeout(() => {\n      this.getCollection();\n      const newsfeed = this.$$(\"#newsfeed\") as AcActivity;\n      if (newsfeed) {\n        newsfeed.loadNewData();\n      }\n\n      //TODO: Get this working\n      const postsMap = this.$$(\"#postsMap\") as YpPostMap;\n      if (postsMap) {\n        postsMap.requestUpdate;\n      }\n    }, 100);\n  }\n\n  _newPost() {\n    window.appGlobals.activity(\"open\", \"newPost\");\n    //TODO: Fix ts type\n    window.appDialogs.getDialogAsync(\"postEdit\", (dialog: YpPostEdit) => {\n      dialog.setup(undefined, true, undefined, this.collection as YpGroupData);\n      dialog.open(true, {\n        groupId: this.collectionId!,\n        group: this.collection as YpGroupData,\n      });\n    });\n  }\n\n  _clearScrollThreshold() {\n    (\n      this.$$(\"#scrollTheshold\") as IronScrollThresholdInterface\n    ).clearTriggers();\n  }\n\n  override _setSelectedTabFromRoute(routeTabName: string): void {\n    let tabNumber;\n\n    switch (routeTabName) {\n      case \"open\":\n        tabNumber = GroupTabTypes.Open;\n        break;\n      case \"inProgress\":\n        tabNumber = GroupTabTypes.InProgress;\n        break;\n      case \"successfull\":\n        tabNumber = GroupTabTypes.Successful;\n        break;\n      case \"failed\":\n        tabNumber = GroupTabTypes.Failed;\n        break;\n      case \"news\":\n        tabNumber = GroupTabTypes.Newsfeed;\n        break;\n      case \"map\":\n        tabNumber = GroupTabTypes.Map;\n        break;\n      default:\n        tabNumber = GroupTabTypes.Open;\n        break;\n    }\n\n    if (tabNumber) {\n      this.selectedGroupTab = tabNumber;\n      window.appGlobals.activity(\n        \"open\",\n        this.collectionType + \"_tab_\" + routeTabName\n      );\n    }\n  }\n\n  get _isCurrentPostsTab(): boolean {\n    return (\n      this.selectedGroupTab == GroupTabTypes.Open ||\n      this.selectedGroupTab == GroupTabTypes.InProgress ||\n      this.selectedGroupTab == GroupTabTypes.Successful ||\n      this.selectedGroupTab == GroupTabTypes.Failed\n    );\n  }\n\n  _loadMoreData() {\n    if (this._isCurrentPostsTab) {\n      const tab = this.getCurrentTabElement() as YpPostsList;\n      if (tab) {\n        tab._loadMoreData();\n      } else {\n        console.error(\"Cant find tab to load data on\" + this.selectedGroupTab);\n      }\n    } else {\n      console.error(\"Trying to load more data on non posts tab\");\n    }\n  }\n\n  goToPostOrNewsItem() {\n    if (this._isCurrentPostsTab) {\n      //TODO: See what if this is needed\n    } else if (\n      this.selectedGroupTab === GroupTabTypes.Newsfeed &&\n      window.appGlobals.cache.cachedActivityItem !== undefined\n    ) {\n      const list = this.$$(\"#newsfeed\") as IronListInterface;\n      if (list) {\n        list.scrollToItem(window.appGlobals.cache.cachedActivityItem);\n        window.appGlobals.cache.cachedActivityItem = undefined;\n      } else {\n        console.warn(\"No group activities for scroll to item\");\n      }\n    }\n  }\n\n  //TODO: Implment this if needed\n  /*\n  _retryGoToPostIdTab: function (tabId) {\n        this.async(function () {\n          var tab = this.$$(\"#\"+tabId);\n          if (tab && window.appGlobals.cachedPostItem!==null) {\n            tab.scrollToPost(window.appGlobals.cachedPostItem);\n            window.appGlobals.cachedPostItem = null;\n          } else {\n            console.warn(\"Cant find tab or scroll post \"+tabId+ \" not retrying for item \"+window.appGlobals.cachedPostItem);\n          }\n        }, 100);\n      },\n\n      _selectedTabChanged: function (tabName) {\n        if (tabName=='config') {\n          this.async(function () {\n          });\n          var configRoute = this.listRoute.path;\n          var groupId = this.idRoute.path.split(\"/\")[1];\n          var configOverride= configRoute.substring(1, configRoute.length);\n          if (groupId && configOverride && configOverride!=\"\")\n            window.appGlobals.setupGroupConfigOverride(groupId, configOverride);\n          this.set('selectedTab', 'open');\n        } else {\n          if (this.group) {\n            //TODO (for new version): Change the URL to match the tab without reloading everything\n            //this.redirectTo(\"/group/\" + this.group.id + '/' + tabName);\n          }\n\n          if (tabName == \"map\") {\n            this.set('mapActive', true);\n          } else {\n            this.set('mapActive', false);\n          }\n\n          if (tabName && window.appGlobals) {\n            window.appGlobals.activity('open', 'group_tab_' + tabName,'',\n              { id: this.groupId });\n          }\n\n          this.async(function () {\n            var news = this.$$(\"#groupActivities\");\n            if (news) {\n              news.fireResize();\n            }\n          }, 300);\n        }\n        this._clearScrollThreshold();\n      },\n*/\n\n  //TODO: Make sure to capture the caching from this\n  /* _groupIdChanged: function (groupId, oldGroupId) {\n        this._cancelConfigCheckTimer();\n        if (groupId && groupId!=this.lastValidGroupId) {\n          this.newGroupRefresh = true;\n          this.set('lastValidGroupId', groupId);\n          this.set('group', null);\n          this.$.groupCard.resetGroup();\n          this.$.tabCountOpen.innerHTML = \"\";\n          if (this.hasNonOpenPosts) {\n            this.$$(\"#tabCountInProgress\").innerHTML = \"\";\n            this.$$(\"#tabCountSuccessful\").innerHTML = \"\";\n            this.$$(\"#tabCountFailed\").innerHTML = \"\";\n          }\n          this.set('hasNonOpenPosts', false);\n          this.set('tabCounters', {});\n          var groupIdInt = parseInt(groupId);\n\n          if (!this.selectedTab ||\n             (oldGroupId &&\n              this.selectedTab==='map' &&\n              !this.group.configuration.makeMapViewDefault\n             )) {\n            this.set('selectedTab', 'open');\n            this._setupOpenTab();\n          }\n\n          if (window.appGlobals.groupItemsCache && window.appGlobals.groupItemsCache[groupIdInt]) {\n            this._groupResponse(null, { response: {\n                group: window.appGlobals.groupItemsCache[groupIdInt],\n                checkServerForNonOpenPosts: true\n              }});\n            window.appGlobals.groupItemsCache[groupIdInt] = null;\n            console.info(\"Using cache for group id \"+groupId);\n            this.refresh();\n          } else {\n            this._getGroup();\n          }\n        }\n      },*/\n\n  override async refresh(fromMainApp = false) {\n    super.refresh();\n    const group = this.collection as YpGroupData;\n\n    if (group) {\n      this._openHelpPageIfNeededOnce();\n      group.configuration = window.appGlobals.overrideGroupConfigIfNeeded(\n        group.id,\n        group.configuration\n      );\n\n      if (group.configuration.canAddNewPosts != undefined) {\n        if (group.configuration.canAddNewPosts === true) {\n          this.disableNewPosts = false;\n        } else {\n          this.disableNewPosts = true;\n        }\n      } else {\n        this.disableNewPosts = false;\n      }\n\n      setTimeout(async () => {\n        const checkResults = (await window.serverApi.getHasNonOpenPosts(\n          group.id\n        )) as YpGetNonOpenPostsResponse | void;\n\n        if (checkResults) {\n          this.hasNonOpenPosts = checkResults.hasNonOpenPosts;\n        }\n      });\n\n      window.appGlobals.analytics.setCommunityAnalyticsTracker(\n        group.Community?.google_analytics_code\n      );\n\n      if (group.Community?.configuration) {\n        window.appGlobals.analytics.setCommunityPixelTracker(\n          group.Community.configuration.facebookPixelId\n        );\n      }\n\n      if (\n        group.configuration &&\n        (group.configuration.theme != null ||\n          group.configuration.themeOverrideColorPrimary != null)\n      ) {\n        window.appGlobals.theme.setTheme(group.theme_id, group.configuration);\n      } else if (\n        group.Community &&\n        (group.Community.configuration.theme != null ||\n          (group.Community.configuration &&\n            group.Community.configuration.themeOverrideColorPrimary))\n      ) {\n        window.appGlobals.theme.setTheme(\n          group.Community.theme_id,\n          group.Community.configuration\n        );\n      } else if (\n        group.Community &&\n        group.Community.Domain &&\n        group.Community.Domain.configuration.theme != null\n      ) {\n        window.appGlobals.theme.setTheme(group.Community.Domain.theme_id);\n      } else {\n        window.appGlobals.theme.setTheme(1);\n      }\n\n      if (group.configuration.locationHidden) {\n        if (group.configuration.locationHidden == true) {\n          this.locationHidden = true;\n        } else {\n          this.locationHidden = false;\n        }\n      } else {\n        this.locationHidden = false;\n      }\n\n      if (\n        group.configuration.useCommunityTopBanner &&\n        group.Community &&\n        group.Community.CommunityHeaderImages &&\n        group.Community.CommunityHeaderImages.length > 0\n      ) {\n        YpMediaHelpers.setupTopHeaderImage(\n          this,\n          group.Community.CommunityHeaderImages\n        );\n      } else if (\n        group.GroupHeaderImages &&\n        group.GroupHeaderImages.length > 0\n      ) {\n        YpMediaHelpers.setupTopHeaderImage(this, group.GroupHeaderImages);\n      } else {\n        YpMediaHelpers.setupTopHeaderImage(this, null);\n      }\n\n      let backPath;\n      let headerTitle;\n\n      const isAdmin = YpAccessHelpers.checkGroupAccess(\n        this.collection as YpGroupData\n      );\n\n      if (group.configuration.customBackURL) {\n        backPath = group.configuration.customBackURL;\n        headerTitle = group.configuration.customBackName;\n      } else if (\n        group.Community &&\n        group.Community.configuration &&\n        group.Community.configuration.redirectToGroupId &&\n        !isAdmin\n      ) {\n        backPath = \"/domain/\" + group.Community!.Domain!.id;\n        headerTitle = group.Community!.Domain!.name;\n      } else {\n        backPath = \"/community/\" + group.community_id;\n        headerTitle = group.Community!.name;\n      }\n\n      this.fire(\"yp-change-header\", {\n        headerTitle: headerTitle,\n        headerDescription: group.Community?.description,\n        headerIcon: \"social:group\",\n        documentTitle: group.name,\n        enableSearch: true,\n        disableCollectionUpLink:\n          group.configuration &&\n          group.configuration.disableCollectionUpLink === true,\n        hideHelpIcon: group.configuration.hideHelpIcon ? true : null,\n        useHardBack: this._useHardBack(group.configuration),\n        backPath: backPath,\n      });\n\n      window.appGlobals.setAnonymousGroupStatus(group);\n      window.appGlobals.setRegistrationQuestionGroup(group);\n\n      if (\n        group.configuration &&\n        group.configuration.disableFacebookLoginForGroup === true\n      ) {\n        window.appGlobals.disableFacebookLoginForGroup = true;\n      } else {\n        window.appGlobals.disableFacebookLoginForGroup = false;\n      }\n\n      if (group.configuration && group.configuration.externalGoalTriggerUrl) {\n        window.appGlobals.externalGoalTriggerGroupId = group.id;\n      } else {\n        window.appGlobals.externalGoalTriggerGroupId = undefined;\n      }\n\n      if (\n        group.Community &&\n        group.Community.configuration &&\n        group.Community.configuration.signupTermsPageId &&\n        group.Community.configuration.signupTermsPageId != -1\n      ) {\n        window.appGlobals.signupTermsPageId =\n          group.Community.configuration.signupTermsPageId;\n      } else {\n        window.appGlobals.signupTermsPageId = undefined;\n      }\n\n      this._setupGroupSaml(group);\n\n      window.appGlobals.currentGroup = group;\n\n      if (\n        (group.configuration &&\n          group.configuration.forceSecureSamlLogin &&\n          !YpAccessHelpers.checkGroupAccess(group)) ||\n        (group.Community &&\n          group.Community.configuration &&\n          group.Community.configuration.forceSecureSamlLogin &&\n          !YpAccessHelpers.checkCommunityAccess(group.Community))\n      ) {\n        window.appGlobals.currentForceSaml = true;\n      } else {\n        window.appGlobals.currentForceSaml = false;\n      }\n\n      if (group.configuration && group.configuration.makeMapViewDefault) {\n        this.selectedGroupTab = GroupTabTypes.Map;\n      }\n\n      if (\n        group.Community &&\n        group.Community.configuration &&\n        group.Community.configuration.highlightedLanguages\n      ) {\n        window.appGlobals.setHighlightedLanguages(\n          group.Community!.configuration.highlightedLanguages\n        );\n      } else {\n        window.appGlobals.setHighlightedLanguages(undefined);\n      }\n\n      if (this.hasNonOpenPosts && this.tabCounters) {\n        this._setupOpenTab();\n      }\n\n      if (group.configuration && group.configuration.maxNumberOfGroupVotes) {\n        window.appUser.calculateVotesLeftForGroup(group);\n      }\n\n      if (\n        group &&\n        group.configuration &&\n        group.configuration.isDataVisualizationGroup &&\n        group.configuration.dataForVisualizationJson\n      ) {\n        window.appDialogs.loadDataViz();\n      }\n    }\n\n    if (\n      this.hasNonOpenPosts &&\n      this.tabCounters &&\n      (this.newGroupRefresh || fromMainApp === true)\n    ) {\n      this._setupOpenTab();\n    }\n\n    this.newGroupRefresh = false;\n\n    window.appGlobals.postLoadGroupProcessing(group);\n\n    this._startConfigCheckTimer();\n\n    //TODO: Get this working, when you go back and fourth between survey group you get the wrong one until reload\n    /*if (fromMainApp &&\n      (this.collection as YpGroupData).configuration.groupType == 1\n    ) {\n      await this.updateComplete;\n      const survey = this.$$(\"#aoiSurvey\") as AoiSurvey;\n      await survey.getEarl();\n      this.requestUpdate();\n    }*/\n  }\n\n  _setupGroupSaml(group: YpGroupData) {\n    if (\n      group.Community &&\n      group.Community.configuration &&\n      group.Community.configuration.customSamlDeniedMessage\n    ) {\n      window.appGlobals.currentSamlDeniedMessage =\n        group.Community.configuration.customSamlDeniedMessage;\n    } else {\n      window.appGlobals.currentSamlDeniedMessage = undefined;\n    }\n\n    if (\n      group.Community &&\n      group.Community.configuration &&\n      group.Community.configuration.customSamlLoginMessage\n    ) {\n      window.appGlobals.currentSamlLoginMessage =\n        group.Community.configuration.customSamlLoginMessage;\n    } else {\n      window.appGlobals.currentSamlLoginMessage = undefined;\n    }\n  }\n\n  scrollToCollectionItemSubClass() {\n    if (\n      this.collection &&\n      window.appGlobals.cache.backToCommunityGroupItems &&\n      window.appGlobals.cache.backToCommunityGroupItems[this.collection.id]\n    ) {\n      (this.$$(\"#collectionItems\") as YpCollectionItemsGrid).scrollToItem(\n        window.appGlobals.cache.backToCommunityGroupItems[this.collection.id]\n      );\n      window.appGlobals.cache.backToCommunityGroupItems[this.collection.id] =\n        undefined;\n    }\n  }\n}\n"]}