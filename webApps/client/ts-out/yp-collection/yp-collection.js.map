{"version":3,"file":"yp-collection.js","sourceRoot":"","sources":["../../src/yp-collection/yp-collection.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, css, nothing, TemplateResult } from \"lit\";\nimport { property } from \"lit/decorators.js\";\n\n//import { ifDefined } from 'lit/directives/if-defined.js';\nimport { YpBaseElement } from \"../common/yp-base-element.js\";\nimport { YpAccessHelpers } from \"../common/YpAccessHelpers.js\";\nimport { YpMediaHelpers } from \"../common/YpMediaHelpers.js\";\n\nimport \"@material/web/tabs/tabs.js\";\nimport \"@material/web/tabs/primary-tab.js\";\n\nimport \"@material/web/fab/fab.js\";\nimport \"@material/web/fab/fab.js\";\nimport \"./yp-collection-header.js\";\nimport \"./yp-collection-items-list.js\";\nimport { YpCollectionItemsList } from \"./yp-collection-items-list.js\";\nimport { YpServerApi } from \"../common/YpServerApi.js\";\n\nimport \"../ac-activities/ac-activities.js\";\nimport \"../yp-post/yp-post-map.js\";\nimport { AcActivities } from \"../ac-activities/ac-activities.js\";\nimport { MdTabs } from \"@material/web/tabs/tabs.js\";\nimport { YpNavHelpers } from \"../common/YpNavHelpers.js\";\nimport { YpBaseElementWithLogin } from \"../common/yp-base-element-with-login.js\";\n\nexport const CollectionTabTypes: Record<string, number> = {\n  Collection: 0,\n  Newsfeed: 1,\n  Map: 2,\n};\n\nexport abstract class YpCollection extends YpBaseElementWithLogin {\n  @property({ type: Boolean })\n  noHeader = false;\n\n  @property({ type: Boolean })\n  tabsHidden = false;\n\n  @property({ type: Number })\n  collectionId: number | undefined;\n\n  @property({ type: String })\n  collectionName: string | undefined;\n\n  @property({ type: Object })\n  collection: YpCollectionData | undefined;\n\n  @property({ type: String })\n  subRoute: string | undefined;\n\n  @property({ type: Number })\n  selectedTab = CollectionTabTypes.Collection;\n\n  @property({ type: Array })\n  collectionItems: Array<YpCommunityData | YpGroupData> | undefined;\n\n  @property({ type: Boolean })\n  hideNewsfeed = false;\n\n  @property({ type: Boolean })\n  locationHidden = false;\n\n  @property({ type: Boolean })\n  hideCollection = false;\n\n  @property({ type: String })\n  createFabIcon: string | undefined;\n\n  @property({ type: String })\n  createFabLabel: string | undefined;\n\n  @property({ type: String })\n  headerImageUrl: string | undefined;\n\n  collectionType: string;\n  collectionItemType: string | null;\n  collectionCreateFabIcon: string;\n  collectionCreateFabLabel: string;\n\n  constructor(\n    collectionType: string,\n    collectionItemType: string | null,\n    collectionCreateFabIcon: string,\n    collectionCreateFabLabel: string\n  ) {\n    super();\n    this.collectionType = collectionType;\n    this.collectionItemType = collectionItemType;\n    this.collectionCreateFabIcon = collectionCreateFabIcon;\n    this.collectionCreateFabLabel = collectionCreateFabLabel;\n\n    //TODO: Fix this as it causes loadMoreData to be called twice on post lists at least\n    this.addGlobalListener(\"yp-logged-in\", this.loggedInUserCustom.bind(this));\n    this.addGlobalListener(\n      \"yp-got-admin-rights\",\n      this.getCollection.bind(this)\n    );\n  }\n\n  async loggedInUserCustom() {\n    this.refresh();\n    //TODO: Look into this, find a better solution than waiting\n    await new Promise((r) => setTimeout(r, 1500));\n    if (!this.collection || !this.collection.id) {\n      // this.getCollection();\n    }\n  }\n\n  abstract scrollToCollectionItemSubClass(): void;\n\n  setupTheme() {\n    console.error(\"Implement setupTheme in subclass\");\n  }\n\n  // DATA PROCESSING\n\n  override connectedCallback() {\n    super.connectedCallback();\n    if (this.collection) this.refresh();\n  }\n\n  refresh(): void {\n    console.info(\"REFRESH\");\n    if (this.collection) {\n      if (this.collection.default_locale != null) {\n        window.appGlobals.changeLocaleIfNeeded(this.collection.default_locale);\n      }\n\n      this.fire(\"yp-set-home-link\", {\n        type: this.collectionType,\n        id: this.collection.id,\n        name: this.collection.name,\n      } as YpHomeLinkData);\n\n      this.fire(\"yp-change-header\", {\n        headerTitle: null,\n        documentTitle: this.collection.name,\n        headerDescription:\n          this.collection.description || this.collection.objectives,\n        currentTheme: this.collection.configuration?.theme,\n      });\n\n      if (\n        this.collection.configuration?.hideAllTabs ||\n        (this.collection.configuration as YpGroupConfiguration)\n          ?.hideGroupLevelTabs\n      ) {\n        this.tabsHidden = true;\n      } else {\n        this.tabsHidden = false;\n      }\n\n      if (this.$$(\"#collectionItems\")) {\n        (this.$$(\"#collectionItems\") as YpCollectionItemsList).refresh();\n      }\n    }\n  }\n\n  async getCollection() {\n    if (this.collectionId) {\n      if (this.collection) {\n        this.setupTheme();\n      }\n      this.collectionItems = undefined;\n      this.collection = undefined;\n      this.collection = (await window.serverApi.getCollection(\n        this.collectionType,\n        this.collectionId\n      )) as YpCollectionData | undefined;\n      this.refresh();\n    } else {\n      console.error(\"No collection id for getCollection\");\n    }\n  }\n\n  async _getHelpPages(\n    collectionTypeOverride: string | undefined = undefined,\n    collectionIdOverride: number | undefined = undefined\n  ) {\n    if (this.collectionId) {\n      const helpPages = (await window.serverApi.getHelpPages(\n        collectionTypeOverride ? collectionTypeOverride : this.collectionType,\n        collectionIdOverride ? collectionIdOverride : this.collectionId\n      )) as Array<YpHelpPageData> | undefined;\n      if (helpPages) {\n        this.fire(\"yp-set-pages\", helpPages);\n      }\n    } else {\n      console.error(\"Collection id setup for get help pages\");\n    }\n  }\n\n  get collectionTabLabel(): string {\n    const translatedCollectionItems = this.t(\n      YpServerApi.transformCollectionTypeToApi(this.collectionItemType!)\n    );\n    return `${translatedCollectionItems} (${\n      this.collectionItems ? this.collectionItems.length : 0\n    })`;\n  }\n\n  // EVENTS\n\n  collectionIdChanged() {\n    this.getCollection();\n    this._getHelpPages();\n  }\n\n  override updated(changedProperties: Map<string | number | symbol, unknown>) {\n    super.updated(changedProperties);\n\n    if (changedProperties.has(\"subRoute\") && this.subRoute) {\n      const splitSubRoute = this.subRoute.split(\"/\");\n      this.collectionId = parseInt(splitSubRoute[1]);\n      if (splitSubRoute.length > 2) {\n        this._setSelectedTabFromRoute(splitSubRoute[1]);\n      } else {\n        this._setSelectedTabFromRoute(\"default\");\n      }\n    }\n\n    if (changedProperties.has(\"collectionId\") && this.collectionId) {\n      this.collectionIdChanged();\n    }\n  }\n\n  _selectTab(event: CustomEvent) {\n    this.selectedTab = (event.currentTarget as MdTabs).activeTabIndex;\n  }\n\n  _openAdmin() {\n    YpNavHelpers.redirectTo(\n      `/admin/${this.collectionType}/${this.collection!.id}`\n    );\n  }\n\n  _setSelectedTabFromRoute(routeTabName: string): void {\n    let tabNumber;\n\n    switch (routeTabName) {\n      case \"collection\":\n        tabNumber = CollectionTabTypes.Collection;\n        break;\n      case \"news\":\n        tabNumber = CollectionTabTypes.Newsfeed;\n        break;\n      case \"map\":\n        tabNumber = CollectionTabTypes.Map;\n        break;\n      default:\n        tabNumber = CollectionTabTypes.Collection;\n        break;\n    }\n\n    if (tabNumber) {\n      this.selectedTab = tabNumber;\n      window.appGlobals.activity(\n        \"open\",\n        this.collectionType + \"_tab_\" + routeTabName\n      );\n    }\n  }\n\n  scrollToCachedItem() {\n    if (\n      this.selectedTab === CollectionTabTypes.Newsfeed &&\n      window.appGlobals.cache.cachedActivityItem\n    ) {\n      const activities = this.$$(\"#collectionActivities\") as AcActivities;\n      if (activities) {\n        activities.scrollToItem(window.appGlobals.cache.cachedActivityItem);\n        window.appGlobals.cache.cachedActivityItem = undefined;\n      } else {\n        console.error(\"No activities for scroll to item\");\n      }\n    } else if (this.selectedTab === CollectionTabTypes.Collection) {\n      this.scrollToCollectionItemSubClass();\n    }\n  }\n\n  scrollToCollectionItemSubClassDomain() {\n    if (\n      this.collection &&\n      window.appGlobals.cache.backToDomainCommunityItems &&\n      window.appGlobals.cache.backToDomainCommunityItems[this.collection.id]\n    ) {\n      (this.$$(\"#collectionItems\") as YpCollectionItemsList).scrollToItem(\n        window.appGlobals.cache.backToDomainCommunityItems[this.collection.id]\n      );\n      window.appGlobals.cache.backToDomainCommunityItems[this.collection.id] =\n        undefined;\n    }\n  }\n\n  setFabIconIfAccess(\n    onlyAdminCanCreate: boolean,\n    hasCollectionAccess: boolean\n  ) {\n    if (this.loggedInUser && (!onlyAdminCanCreate || hasCollectionAccess)) {\n      this.createFabIcon = this.collectionCreateFabIcon;\n      this.createFabLabel = this.collectionCreateFabLabel;\n    } else {\n      this.createFabIcon = undefined;\n      this.createFabLabel = undefined;\n    }\n  }\n\n  //TODO: Review this when we remove the group community links\n  _useHardBack(configuration: YpCollectionConfiguration) {\n    if (configuration && configuration.customBackURL) {\n      const backUrl = configuration.customBackURL;\n      if (\n        backUrl.startsWith(\"/community/\") ||\n        backUrl.startsWith(\"/group/\") ||\n        backUrl.startsWith(\"/domain/\") ||\n        backUrl.startsWith(\"/post/\")\n      ) {\n        return false;\n      } else {\n        return true;\n      }\n    } else {\n      return false;\n    }\n  }\n  createNewCollection() {\n    let childCollectionType;\n    if (this.collectionType == \"domain\") {\n      childCollectionType = \"community\";\n    } else if (this.collectionType == \"community\") {\n      childCollectionType = \"group\";\n    } else {\n      console.error(\"Invalid collection type for create new collection\");\n      return;\n    }\n    YpNavHelpers.redirectTo(\n      `/admin/${childCollectionType}/new/${this.collectionId}`\n    );\n  }\n\n  get hasCustomTheme() {\n    if (\n      this.collection &&\n      this.collection.configuration &&\n      this.collection.configuration.theme\n    ) {\n      return !(this.collection.configuration as YpGroupConfiguration).theme!\n        .oneDynamicColor;\n    } else {\n      return false;\n    }\n  }\n\n  // UI\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        md-fab {\n          z-index: 1;\n          --md-fab-container-shape: 4px;\n          //--md-fab-label-text-size: 16px !important;\n          --md-fab-label-text-weight: 600 !important;\n          margin-bottom: 24px;\n          --md-fab-container-elevation: 0;\n          --md-fab-container-shadow-color: transparent;\n        }\n\n        md-tabs {\n          border-bottom-color: transparent;\n          max-width: 720px;\n          overflow-y: scroll;\n        }\n\n        .mainContent {\n          margin-left: 64px;\n          margin-right: 64px;\n        }\n\n        md-secondary-tab {\n          width: 180px;\n          padding-right: 16px;\n          padding-left: 16px;\n          --md-secondary-tab-active-indicator-height: 3px;\n        }\n\n        md-secondary-tab[has-custom-theme] {\n          --md-secondary-tab-active-indicator-color: var(\n            --md-sys-color-primary-container\n          );\n        }\n\n        md-icon-button {\n          margin-top: 16px;\n          margin-bottom: 16px;\n        }\n\n        md-filled-text-field {\n          margin-left: 8px;\n          margin-right: 8px;\n        }\n\n        md-tabs {\n          width: 100%;\n        }\n\n        .topContainer {\n          max-width: 1080px;\n          width: 100%;\n        }\n\n        @media (max-width: 960px) {\n          md-tabs {\n            width: 100%;\n          }\n        }\n\n        .createFab[is-map] {\n          right: inherit;\n          left: 28px;\n        }\n\n        @media (max-width: 960px) {\n          .header {\n            height: 100%;\n          }\n\n          .currentPage {\n            margin-bottom: 220px;\n            margin-top: 16px;\n          }\n        }\n      `,\n    ];\n  }\n\n  renderHeader() {\n    return this.collection && !this.noHeader\n      ? html`\n          <div class=\"layout vertical center-center header\">\n            <yp-collection-header\n              .collection=\"${this.collection}\"\n              .collectionType=\"${this.collectionType}\"\n              aria-label=\"${this.collectionType}\"\n              role=\"banner\"\n            ></yp-collection-header>\n          </div>\n        `\n      : nothing;\n  }\n\n  renderNewsAndMapTabs() {\n    return html`\n      <md-secondary-tab\n        ?has-custom-theme=\"${this.hasCustomTheme}\"\n        ?hidden=\"${this.hideNewsfeed}\"\n        >${this.t(\"post.tabs.news\")}<md-icon slot=\"icon\"\n          >rss_feed</md-icon\n        ></md-secondary-tab\n      >\n      <md-secondary-tab\n        ?has-custom-theme=\"${this.hasCustomTheme}\"\n        ?hidden=\"${this.locationHidden || this.collectionType == \"domain\"}\"\n      >\n        ${this.t(\"post.tabs.location\")}<md-icon slot=\"icon\"\n          >location_on</md-icon\n        ></md-secondary-tab\n      >\n    `;\n  }\n\n  renderTabs() {\n    if (this.collection && !this.tabsHidden) {\n      return html`\n        <div class=\"layout vertical center-center\">\n          <md-tabs\n            @change=\"${this._selectTab}\"\n            .activeTabIndex=\"${this.selectedTab}\"\n          >\n            <md-secondary-tab\n              ?has-custom-theme=\"${this.hasCustomTheme}\"\n              ?hidden=\"${this.hideCollection}\"\n              >${this.collectionTabLabel}\n              <md-icon slot=\"icon\">groups</md-icon></md-secondary-tab\n            >\n            ${this.renderNewsAndMapTabs()}\n          </md-tabs>\n        </div>\n      `;\n    } else {\n      return nothing;\n    }\n  }\n\n  renderCurrentTabPage(): TemplateResult | undefined {\n    let page: TemplateResult | undefined;\n\n    switch (this.selectedTab) {\n      case CollectionTabTypes.Collection:\n        page =\n          this.collectionItems && this.collectionItemType\n            ? html`<yp-collection-items-list\n                id=\"collectionItems\"\n                .collectionItems=\"${this.collectionItems}\"\n                .collection=\"${this.collection}\"\n                .collectionType=\"${this.collectionType}\"\n                .collectionItemType=\"${this.collectionItemType}\"\n                .collectionId=\"${this.collectionId!}\"\n              ></yp-collection-items-list>`\n            : html``;\n        break;\n      case CollectionTabTypes.Newsfeed:\n        page = html`<ac-activities\n          id=\"collectionActivities\"\n          .selectedTab=\"${this.selectedTab}\"\n          .collectionType=\"${this.collectionType}\"\n          .collectionId=\"${this.collectionId!}\"\n        ></ac-activities>`;\n        break;\n      case CollectionTabTypes.Map:\n        page = html`<yp-post-map\n          id=\"postsMap\"\n          .collectionType=\"${this.collectionType}\"\n          .collectionId=\"${this.collectionId!}\"\n        ></yp-post-map>`;\n        break;\n    }\n\n    return page;\n  }\n\n  // FFDC2F\n\n  override render() {\n    if (this.collection) {\n      return html`\n        <div class=\"layout vertical center-center\">\n          <div class=\"layout vertical topContainer\">\n            ${this.renderHeader()}\n            <div class=\"layout horizontal mainContent\">\n              ${this.renderTabs()}\n              <div class=\"flex\"></div>\n              ${this.createFabIcon && this.createFabLabel\n                ? html`\n                    <md-icon-button\n                      hidden\n                      class=\"filterButton\"\n                      .label=\"${this.t(\"filter\")}\"\n                      ><md-icon>tune</md-icon></md-icon-button\n                    >\n                    <md-fab\n                      lowered\n                      size=\"large\"\n                      ?extended=\"${this.wide}\"\n                      class=\"createFab\"\n                      variant=\"primary\"\n                      @click=\"${this.createNewCollection}\"\n                      ?is-map=\"${this.selectedTab === CollectionTabTypes.Map}\"\n                      .label=\"${this.t(this.createFabLabel)}\"\n                      .icon=\"${this.createFabIcon}\"\n                    >\n                      <md-icon hidden slot=\"icon\">add_circle</md-icon></md-fab\n                    >\n                  `\n                : nothing}\n            </div>\n          </div>\n        </div>\n        <div class=\"currentPage layout vertical center-center\">\n          <div class=\"topContainer\">${this.renderCurrentTabPage()}</div>\n        </div>\n      `;\n    } else {\n      return html` <md-linear-progress indeterminate></md-linear-progress> `;\n    }\n  }\n}\n"]}