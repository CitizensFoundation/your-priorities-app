{"version":3,"file":"YpCodeBaseclass.js","sourceRoot":"","sources":["../../src/common/YpCodeBaseclass.ts"],"names":[],"mappings":"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","sourcesContent":["import { Snackbar } from '@material/mwc-snackbar';\nimport { LitElement } from 'lit';\n\nimport { YpApp } from '../yp-app/yp-app.js';\nimport { YpAppGlobals } from '../yp-app/YpAppGlobals.js';\nimport { YpAppUser } from '../yp-app/YpAppUser.js';\nimport { YpAppDialogs } from '../yp-dialog-container/yp-app-dialogs.js';\nimport { YpServerApi } from './YpServerApi.js';\n\ndeclare global {\n  interface Window {\n    appGlobals: YpAppGlobals;\n    appUser: YpAppUser;\n    appDialogs: YpAppDialogs;\n    serverApi: YpServerApi;\n    app: YpApp;\n    locale: string;\n    MSStream: any;\n    PasswordCredential?: any;\n    autoTranslate: boolean;\n    FederatedCredential?: any;\n  }\n}\n\nexport class YpCodeBase {\n  language: string | undefined;\n  wide = false;\n\n  constructor() {\n    this.installMediaQueryWatcher(`(min-width: 900px)`, (matches) => {\n      this.wide = matches;\n    });\n\n    this.addGlobalListener(\n      'yp-language-loaded',\n      this._languageEvent.bind(this)\n    );\n    if (\n      window.appGlobals &&\n      window.appGlobals.i18nTranslation &&\n      window.appGlobals.locale\n    ) {\n      this.language = window.appGlobals.locale;\n    } else {\n      this.language = 'en';\n    }\n  }\n\n  installMediaQueryWatcher = (mediaQuery: string, layoutChangedCallback: (mediaQueryMatches: boolean) => void) => {\n    let mql = window.matchMedia(mediaQuery);\n    mql.addListener((e) => layoutChangedCallback(e.matches));\n    layoutChangedCallback(mql.matches);\n  };\n\n  _languageEvent(event: CustomEvent) {\n    const detail = event.detail;\n    this.language = detail.language;\n    window.appGlobals.locale = detail.language;\n  }\n\n  fire(\n    eventName: string,\n    data: object | string | boolean | number | null = {},\n    target: LitElement | Document\n  ) {\n    const event = new CustomEvent(eventName, {\n      detail: data,\n      bubbles: true,\n      composed: true,\n    });\n    target.dispatchEvent(event);\n  }\n\n  fireGlobal(\n    eventName: string,\n    data: object | string | boolean | number | null = {}\n  ) {\n    this.fire(eventName, data, document);\n  }\n\n  addListener(name: string, callback: Function, target: LitElement | Document) {\n    target.addEventListener(name, callback as EventListener, false);\n  }\n\n  addGlobalListener(name: string, callback: Function) {\n    this.addListener(name, callback, document);\n  }\n\n  showToast(text: string, timeout = 4000) {\n    window.appDialogs.getDialogAsync(\"masterToast\", (toast: any /*Snackbar*/) => {\n      toast.labelText = text;\n      toast.timeoutMs = timeout;\n      toast.open = true;\n    });\n  }\n\n  removeListener(\n    name: string,\n    callback: Function,\n    target: LitElement | Document\n  ) {\n    target.removeEventListener(name, callback as EventListener);\n  }\n\n  removeGlobalListener(name: string, callback: Function) {\n    this.removeListener(name, callback, document);\n  }\n\n  t(...args: Array<string>): string {\n    const key = args[0];\n    if (window.appGlobals.i18nTranslation) {\n      let translation = window.appGlobals.i18nTranslation.t(key);\n      if (!translation) translation = '';\n      return translation;\n    } else {\n      return '';\n    }\n  }\n}\n"]}