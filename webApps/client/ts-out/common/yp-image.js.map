{"version":3,"file":"yp-image.js","sourceRoot":"","sources":["../../src/common/yp-image.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n@license\nCopyright (c) 2016 The Polymer Community Authors. All rights reserved.\nCopyright (c) 2020 Citizens Foundation Iceland / Citizens Foundation USA LitElement Port. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer community is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport { LitElement, css, html } from \"lit\";\nimport { property, customElement } from \"lit/decorators.js\";\nimport { ifDefined } from \"lit/directives/if-defined.js\";\nimport { sourceColorFromImage } from \"./getThemeFromImage\";\n/**\n`yp-image` is an element for displaying an image that provides useful sizing and\npreloading options not found on the standard `<img>` tag.\n\nThe `sizing` option allows the image to be either cropped (`cover`) or\nletterboxed (`contain`) to fill a fixed user-size placed on the element.\n\nThe `preload` option prevents the browser from rendering the image until the\nimage is fully loaded.  In the interim, either the element's CSS `background-color`\ncan be be used as the placeholder, or the `placeholder` property can be\nset to a URL (preferably a data-URI, for instant rendering) for an\nplaceholder image.\n\nThe `fade` option (only valid when `preload` is set) will cause the placeholder\nimage/color to be faded out once the image is rendered.\n\nExamples:\n\n  Basically identical to `<img src=\"...\">` tag:\n\n    <yp-image src=\"http://lorempixel.com/400/400\"></yp-image>\n\n  Will letterbox the image to fit:\n\n    <yp-image style=\"width:400px; height:400px;\" sizing=\"contain\"\n      src=\"http://lorempixel.com/600/400\"></yp-image>\n\n  Will crop the image to fit:\n\n    <yp-image style=\"width:400px; height:400px;\" sizing=\"cover\"\n      src=\"http://lorempixel.com/600/400\"></yp-image>\n\n  Will show light-gray background until the image loads:\n\n    <yp-image style=\"width:400px; height:400px; background-color: lightgray;\"\n      sizing=\"cover\" preload src=\"http://lorempixel.com/600/400\"></yp-image>\n\n  Will show a base-64 encoded placeholder image until the image loads:\n\n    <yp-image style=\"width:400px; height:400px;\" placeholder=\"data:image/gif;base64,...\"\n      sizing=\"cover\" preload src=\"http://lorempixel.com/600/400\"></yp-image>\n\n  Will fade the light-gray background out once the image is loaded:\n\n    <yp-image style=\"width:400px; height:400px; background-color: lightgray;\"\n      sizing=\"cover\" preload fade src=\"http://lorempixel.com/600/400\"></yp-image>\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--yp-image-placeholder` | Mixin applied to #placeholder | `{}`\n`--yp-image-width` | Sets the width of the wrapped image | `auto`\n`--yp-image-height` | Sets the height of the wrapped image | `auto`\n*/\n\n@customElement(\"yp-image\")\nexport class YpImage extends LitElement {\n  /**\n   * The URL of an image.\n   */\n  @property({ type: String })\n  src: string | undefined = \"\";\n\n  /**\n   * A short text alternative for the image.\n   */\n  @property({ type: String })\n  alt: string | undefined = undefined;\n\n  /**\n   * CORS enabled images support:\n   * https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image\n   */\n  @property({ type: String })\n  crossorigin: string | undefined = undefined;\n\n  /**\n   * When true, the image is prevented from loading and any placeholder is\n   * shown.  This may be useful when a binding to the src property is known to\n   * be invalid, to prevent 404 requests.\n   */\n  @property({ type: Boolean })\n  preventLoad = false;\n\n  /**\n   * Sets a sizing option for the image.  Valid values are `contain` (full\n   * aspect ratio of the image is contained within the element and\n   * letterboxed) or `cover` (image is cropped in order to fully cover the\n   * bounds of the element), or `null` (default: image takes natural size).\n   */\n  @property({ type: String, reflect: true })\n  sizing: string | undefined = undefined;\n\n  /**\n   * When a sizing option is used (`cover` or `contain`), this determines\n   * how the image is aligned within the element bounds.\n   */\n  @property({ type: String })\n  position = \"center\";\n\n  /**\n   * When `true`, any change to the `src` property will cause the\n   * `placeholder` image to be shown until the new image has loaded.\n   */\n  @property({ type: Boolean })\n  preload = false;\n\n  /**\n   * This image will be used as a background/placeholder until the src image\n   * has loaded.  Use of a data-URI for placeholder is encouraged for instant\n   * rendering.\n   */\n  @property({ type: String })\n  placeholder: string | undefined = undefined;\n\n  /**\n   * When `preload` is true, setting `fade` to true will cause the image to\n   * fade into place.\n   */\n  @property({ type: Boolean })\n  fade = false;\n\n  /**\n   * Read-only value that is true when the image is loaded.\n   */\n  @property({ type: Boolean })\n  loaded = false;\n\n  /**\n   * Read-only value that tracks the loading state of the image when the\n   * `preload` option is used.\n   */\n  @property({ type: Boolean })\n  loading = false;\n\n  /**\n   * Read-only value that indicates that the last set `src` failed to load.\n   */\n  @property({ type: Boolean })\n  error = false;\n\n  /**\n   * Can be used to set the width of image (e.g. via binding); size may also\n   * be set via CSS.\n   */\n  @property({ type: String })\n  width: string | undefined = undefined;\n\n  /**\n   * Can be used to set the height of image (e.g. via binding); size may also\n   * be set via CSS.\n   * @type number\n   * @default null\n   */\n  @property({ type: String })\n  height: string | undefined = undefined;\n\n  _resolvedSrc: string | undefined = undefined;\n\n  ABS_URL = /(^\\/[^\\/])|(^#)|(^[\\w-\\d]*:)/;\n  workingURL: boolean | undefined = undefined;\n  resolveDoc: HTMLDocument | undefined = undefined;\n\n  static override get styles() {\n    return [\n      css`\n        :host {\n          display: inline-block;\n          overflow: hidden;\n          position: relative;\n        }\n\n        #baseURIAnchor {\n          display: none;\n        }\n\n        #sizedImgDiv {\n          position: absolute;\n          top: 0px;\n          right: 0px;\n          bottom: 0px;\n          left: 0px;\n\n          display: none;\n        }\n\n        #img {\n          display: block;\n          width: var(--yp-image-width, auto);\n          height: var(--yp-image-height, auto);\n        }\n\n        :host([sizing]) #sizedImgDiv {\n          display: block;\n        }\n\n        :host([sizing]) #img {\n          display: none;\n        }\n\n        #placeholder {\n          position: absolute;\n          top: 0px;\n          right: 0px;\n          bottom: 0px;\n          left: 0px;\n\n          background-color: inherit;\n          opacity: 1;\n        }\n\n        #placeholder.faded-out {\n          transition: opacity 0.5s linear;\n          opacity: 0;\n        }\n      `,\n    ];\n  }\n\n  override render() {\n    return html`\n      <a id=\"baseURIAnchor\" href=\"#\"></a>\n      <div\n        id=\"sizedImgDiv\"\n        role=\"img\"\n        ?hidden=\"${this._computeImgDivHidden}\"\n        aria-hidden=\"${this._computeImgDivARIAHidden}\"\n        aria-label=\"${ifDefined(this._computeImgDivARIALabel)}\"\n      ></div>\n      <img\n        id=\"img\"\n        alt=\"${this.alt ? this.alt : \"\"}\"\n        ?hidden=\"${this._computeImgHidden}\"\n        crossorigin=\"${ifDefined(this.crossorigin)}\"\n        @load=\"${this._imgOnLoad}\"\n        @error=\"${this._imgOnError}\"\n      />\n      <div\n        id=\"placeholder\"\n        ?hidden=\"${this.computePlaceholderHidden}\"\n        class=\"${this._computePlaceholderClassName}\"\n      ></div>\n    `;\n  }\n\n  $$(id: string): HTMLElement | null {\n    return this.shadowRoot ? this.shadowRoot.querySelector(id) : null;\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this._resolvedSrc = \"\";\n  }\n\n  static async getThemeColorsFromImage(\n    img: HTMLImageElement\n  ): Promise<string | undefined> {\n    return await new Promise(async (resolve, reject) => {\n      try {\n        const color = await sourceColorFromImage(\n          img\n        );\n        resolve(color);\n      } catch (err) {\n        reject(err);\n      }\n    });\n  }\n\n  _imgOnLoad() {\n    if (\n      (this.$$(\"img\") as HTMLImageElement).src !== this._resolveSrc(this.src!)\n    ) {\n      return;\n    }\n\n    this.loading = false;\n    this.loaded = true;\n    this.error = false;\n  }\n\n  _imgOnError() {\n    if (\n      (this.$$(\"img\") as HTMLImageElement).src !== this._resolveSrc(this.src!)\n    ) {\n      return;\n    }\n\n    this.$$(\"img\")!.removeAttribute(\"src\");\n    this.$$(\"#sizedImgDiv\")!.style.backgroundImage = \"\";\n\n    this.loading = false;\n    this.loaded = false;\n    this.error = true;\n  }\n\n  get computePlaceholderHidden(): boolean {\n    return !this.preload || (!this.fade && !this.loading && this.loaded);\n  }\n\n  _computePlaceholderClassName() {\n    return this.preload && this.fade && !this.loading && this.loaded\n      ? \"faded-out\"\n      : \"\";\n  }\n\n  get _computeImgDivHidden() {\n    return !this.sizing;\n  }\n\n  get _computeImgDivARIAHidden() {\n    return this.alt === \"\" ? true : false;\n  }\n\n  get _computeImgDivARIALabel() {\n    if (this.alt !== null) {\n      return this.alt;\n    }\n\n    // Polymer.ResolveUrl.resolveUrl will resolve '' relative to a URL x to\n    // that URL x, but '' is the default for src.\n    if (this.src === \"\") {\n      return \"\";\n    }\n\n    // NOTE: Use of `URL` was removed here because IE11 doesn't support\n    // constructing it. If this ends up being problematic, we should\n    // consider reverting and adding the URL polyfill as a dev dependency.\n    const resolved = this._resolveSrc(this.src!);\n    // Remove query parts, get file name.\n    if (resolved)\n      return resolved\n        .replace(/[?|#].*/g, \"\")\n        .split(\"/\")\n        .pop();\n    else return \"\";\n  }\n\n  get _computeImgHidden() {\n    return !!this.sizing;\n  }\n\n  _widthChanged() {\n    if (this.width) {\n      this.style.width = this.width + \"px\";\n    }\n  }\n\n  _heightChanged() {\n    this.style.height = this.height + \"px\";\n  }\n\n  _loadStateObserver() {\n    const newResolvedSrc = this._resolveSrc(this.src!);\n    if (newResolvedSrc === this._resolvedSrc) {\n      return;\n    }\n\n    this._resolvedSrc = \"\";\n    this.$$(\"img\")!.removeAttribute(\"src\");\n    this.$$(\"#sizedImgDiv\")!.style.backgroundImage = \"\";\n\n    if (this.src === \"\" || this.preventLoad) {\n      this.loading = false;\n      this.loaded = false;\n      this.error = false;\n    } else {\n      this._resolvedSrc = newResolvedSrc;\n      if (this._resolvedSrc)\n        (this.$$(\"img\") as HTMLImageElement).src = this._resolvedSrc;\n      this.$$(\"#sizedImgDiv\")!.style.backgroundImage =\n        'url(\"' + this._resolvedSrc + '\")';\n\n      this.loading = true;\n      this.loaded = false;\n      this.error = false;\n    }\n  }\n\n  _placeholderChanged() {\n    this.$$(\"#placeholder\")!.style.backgroundImage = this.placeholder\n      ? 'url(\"' + this.placeholder + '\")'\n      : \"\";\n  }\n\n  _transformChanged() {\n    const sizedImgDivStyle = this.$$(\"#sizedImgDiv\")!.style;\n    const placeholderStyle = this.$$(\"#placeholder\")!.style;\n\n    if (this.sizing) {\n      sizedImgDivStyle.backgroundSize = placeholderStyle.backgroundSize =\n        this.sizing;\n    }\n\n    sizedImgDivStyle.backgroundPosition = placeholderStyle.backgroundPosition =\n      this.sizing ? this.position : \"\";\n\n    sizedImgDivStyle.backgroundRepeat = placeholderStyle.backgroundRepeat = this\n      .sizing\n      ? \"no-repeat\"\n      : \"\";\n  }\n\n  _resolveSrc(testSrc: string) {\n    let resolved = this.resolveUrl(\n      testSrc,\n      (this.$$(\"#baseURIAnchor\") as HTMLAnchorElement).href\n    );\n    // NOTE: Use of `URL` was removed here because IE11 doesn't support\n    // constructing it. If this ends up being problematic, we should\n    // consider reverting and adding the URL polyfill as a dev dependency.\n    if (\n      resolved &&\n      resolved.length >= 2 &&\n      resolved[0] === \"/\" &&\n      resolved[1] !== \"/\"\n    ) {\n      // In IE location.origin might not work\n      // https://connect.microsoft.com/IE/feedback/details/1763802/location-origin-is-undefined-in-ie-11-on-windows-10-but-works-on-windows-7\n      resolved =\n        (location.origin || location.protocol + \"//\" + location.host) +\n        resolved;\n    }\n    return resolved;\n  }\n\n  resolveUrl(url: string, baseURI: string) {\n    if (url && this.ABS_URL.test(url)) {\n      return url;\n    }\n    if (url === \"//\") {\n      return url;\n    }\n    // Lazy feature detection.\n    if (this.workingURL === undefined) {\n      this.workingURL = false;\n      try {\n        const u = new URL(\"b\", \"http://a\");\n        u.pathname = \"c%20d\";\n        this.workingURL = u.href === \"http://a/c%20d\";\n      } catch (e) {\n        // silently fail\n      }\n    }\n    if (!baseURI) {\n      baseURI = document.baseURI || window.location.href;\n    }\n    if (this.workingURL) {\n      try {\n        return new URL(url, baseURI).href;\n      } catch (e) {\n        // Bad url or baseURI structure. Do not attempt to resolve.\n        return url;\n      }\n    } else {\n      return undefined;\n    }\n  }\n\n  override updated(changedProperties: Map<string | number | symbol, unknown>) {\n    super.updated(changedProperties);\n\n    if (changedProperties.has(\"placeHolder\")) {\n      this._placeholderChanged();\n    }\n\n    if (changedProperties.has(\"loaded\") && this.loaded) {\n      const event = new CustomEvent(\"loaded\", {\n        detail: {\n          imageYp: this,\n        },\n      });\n\n      this.dispatchEvent(event);\n    }\n\n    if (changedProperties.has(\"width\")) {\n      this._widthChanged();\n    }\n\n    if (changedProperties.has(\"height\")) {\n      this._widthChanged();\n    }\n\n    if (changedProperties.has(\"sizing\") || changedProperties.has(\"position\")) {\n      this._transformChanged();\n    }\n\n    if (changedProperties.has(\"src\") || changedProperties.has(\"preventLoad\")) {\n      this._loadStateObserver();\n    }\n  }\n}\n"]}