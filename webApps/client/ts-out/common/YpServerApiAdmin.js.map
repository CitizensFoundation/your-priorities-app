{"version":3,"file":"YpServerApiAdmin.js","sourceRoot":"","sources":["../../src/common/YpServerApiAdmin.ts"],"names":[],"mappings":"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","sourcesContent":["import { YpServerApiBase } from \"./YpServerApiBase.js\";\n\nexport class YpServerApiAdmin extends YpServerApiBase {\n  public adminMethod(\n    url: string,\n    method: string,\n    body: Record<string, unknown> | undefined = undefined\n  ) {\n    if ([\"GET\", \"HEAD\"].indexOf(method) > -1) {\n      return this.fetchWrapper(url);\n    } else {\n      return this.fetchWrapper(\n        url,\n        {\n          method: method,\n          body: JSON.stringify(body || {}),\n        },\n        false\n      );\n    }\n  }\n\n  public removeUserFromOrganization(organizationId: number, userId: number) {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/organizations/${organizationId}/${userId}/remove_user`,\n      {\n        method: \"DELETE\",\n        body: JSON.stringify({}),\n      },\n      false\n    );\n  }\n\n  public removeAdmin(collection: string, collectionId: number, userId: number) {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/${collection}/${collectionId}/${userId}/remove_admin`,\n      {\n        method: \"DELETE\",\n        body: JSON.stringify({}),\n      },\n      false\n    );\n  }\n\n  public addAdmin(\n    collection: string,\n    collectionId: number,\n    adminEmail: string\n  ) {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/${collection}/${collectionId}/${adminEmail}/add_admin`,\n      {\n        method: \"POST\",\n        body: JSON.stringify({}),\n      },\n      false\n    );\n  }\n\n  public inviteUser(\n    collection: string,\n    collectionId: number,\n    inviteEmail: string,\n    inviteType: string\n  ) {\n    let query = \"\";\n    if (inviteType == \"addUserDirectly\") {\n      if (collection === \"communities\") {\n        query = `?addToCommunityDirectly=1`;\n      } else {\n        query = `?addToGroupDirectly=1`;\n      }\n    }\n\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/${collection}/${collectionId}/${inviteEmail}/invite_user${query}`,\n      {\n        method: \"POST\",\n        body: JSON.stringify({}),\n      },\n      true,\n      undefined,\n      true\n    );\n  }\n\n  // add sibling\n  // add followup promt for additional causes\n  //\n\n  public addUserToOrganization(organizationId: number, userId: number) {\n    return this.fetchWrapper(\n      this.baseUrlPath + `/organizations/${organizationId}/${userId}/add_user`,\n      {\n        method: \"POST\",\n        body: JSON.stringify({}),\n      },\n      false\n    );\n  }\n\n  public addCollectionItem(\n    collectionId: number,\n    collectionItemType: string,\n    body: Record<string, unknown>\n  ) {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/${YpServerApiAdmin.transformCollectionTypeToApi(\n          collectionItemType\n        )}/${collectionId}`,\n      {\n        method: \"POST\",\n        body: JSON.stringify(body),\n      },\n      false\n    );\n  }\n\n  public updateTranslation(\n    collectionType: string,\n    collectionId: number,\n    body: YpTranslationTextData\n  ) {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/${YpServerApiAdmin.transformCollectionTypeToApi(\n          collectionType\n        )}/${collectionId}/update_translation`,\n      {\n        method: \"PUT\",\n        body: JSON.stringify(body),\n      },\n      false\n    );\n  }\n\n  public getTextForTranslations(\n    collectionType: string,\n    collectionId: number,\n    targetLocale: string\n  ) {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/${YpServerApiAdmin.transformCollectionTypeToApi(\n          collectionType\n        )}/${collectionId}/get_translation_texts?targetLocale=${targetLocale}`\n    );\n  }\n\n  public addVideoToCollection(\n    collectionId: number,\n    body: Record<string, unknown>,\n    type: string\n  ) {\n    let fullType;\n\n    if (type == \"group\") {\n      fullType = \"completeAndAddToGroup\";\n    } else if (type == \"community\") {\n      fullType = \"completeAndAddToCommunity\";\n    } else {\n      fullType = \"completeAndAddToDomain\";\n    }\n\n    return this.fetchWrapper(\n      this.baseUrlPath + `/videos/${collectionId}/${fullType}`,\n      {\n        method: \"PUT\",\n        body: JSON.stringify(body),\n      },\n      false\n    );\n  }\n\n  async deleteImage(\n    imageId: number,\n    collectionType: string,\n    collectionId: number,\n    deleteByUserOnly = false,\n    htmlImage = false\n  ) {\n    let fullType;\n    if (collectionType == \"group\") {\n      fullType = \"deleteImageFromGroup\";\n    } else if (collectionType == \"community\") {\n      fullType = \"deleteImageFromCommunity\";\n    } else {\n      fullType = \"deleteImageFromDomain\";\n    }\n\n    let queryParams = \"\";\n\n    if (deleteByUserOnly && htmlImage) {\n      queryParams = \"removeByUserIdOnly=true&htmlImage=true\";\n    } else if (htmlImage) {\n      queryParams = \"htmlImage=true\";\n    } else if (deleteByUserOnly) {\n      queryParams = \"removeByUserIdOnly=true\";\n    }\n\n    if (queryParams) {\n      queryParams = \"?\" + queryParams;\n    }\n\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/images/${collectionId}/${imageId}/${fullType}${queryParams}`,\n      {\n        method: \"DELETE\",\n        body: JSON.stringify({}),\n      },\n      false\n    );\n  }\n\n  async deleteVideo(\n    videoId: number,\n    collectionType: string,\n    collectionId: number,\n    deleteByUserOnly = false,\n    htmlVideo = false\n  ) {\n    let queryParams = \"\";\n    if (deleteByUserOnly && htmlVideo) {\n      queryParams = \"removeByUserIdOnly=true&htmlVideo=true\";\n    } else if (htmlVideo) {\n      queryParams = \"htmlVideo=true\";\n    } else if (deleteByUserOnly) {\n      queryParams = \"removeByUserIdOnly=true\";\n    }\n    if (queryParams) {\n      queryParams = \"?\" + queryParams;\n    }\n    let fullType;\n    if (collectionType == \"group\") {\n      fullType = \"deleteVideoFromGroup\";\n    } else if (collectionType == \"community\") {\n      fullType = \"deleteVideoFromCommunity\";\n    } else {\n      fullType = \"deleteVideoFromDomain\";\n    }\n\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/videos/${collectionId}/${videoId}/${fullType}${queryParams}`,\n      {\n        method: \"DELETE\",\n        body: JSON.stringify({}),\n      },\n      false\n    );\n  }\n\n  public getCommunityFolders(domainId: number) {\n    return this.fetchWrapper(\n      this.baseUrlPath + `/domains/${domainId}/availableCommunityFolders`\n    );\n  }\n\n  public getAnalyticsData(communityId: number, type: string, params: string) {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/communities/${communityId}/${type}/getPlausibleSeries?${params}`\n    );\n  }\n\n  public getSsnListCount(communityId: number, ssnLoginListDataId: number) {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/communities/${communityId}/${ssnLoginListDataId}/ssn_login_list_count`\n    );\n  }\n\n  public deleteSsnLoginList(communityId: number, ssnLoginListDataId: number) {\n    return this.fetchWrapper(\n      this.baseUrlPath +\n        `/communities/${communityId}/${ssnLoginListDataId}/ssn_login_list_count`,\n      {\n        method: \"DELETE\",\n        body: JSON.stringify({}),\n      },\n      false\n    );\n  }\n}\n"]}