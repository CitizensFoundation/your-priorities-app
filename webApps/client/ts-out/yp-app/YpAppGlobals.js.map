{"version":3,"file":"YpAppGlobals.js","sourceRoot":"","sources":["../../src/yp-app/YpAppGlobals.ts"],"names":[],"mappings":"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","sourcesContent":["import i18next from \"i18next\";\n//TODO: Fix moment\n//import moment from 'moment';\nimport HttpApi from \"i18next-http-backend\";\n\nimport { YpServerApi } from \"../common/YpServerApi.js\";\nimport { YpNavHelpers } from \"../common/YpNavHelpers.js\";\nimport { YpCodeBase } from \"../common/YpCodeBaseclass.js\";\nimport { YpRecommendations } from \"./YpRecommendations.js\";\nimport { YpCache } from \"./YpCache.js\";\nimport { YpOffline } from \"./YpOffline.js\";\nimport { YpAnalytics } from \"./YpAnalytics.js\";\nimport { YpThemeManager } from \"./YpThemeManager.js\";\nimport { YpSnackbar } from \"./yp-snackbar.js\";\n\nexport class YpAppGlobals extends YpCodeBase {\n  seenWelcome = false;\n\n  resetSeenWelcome = false;\n\n  disableWelcome = false;\n\n  activityHost = \"\";\n\n  domain: YpDomainData | undefined;\n\n  groupConfigOverrides: Record<number, Record<string, string | boolean>> = {};\n\n  currentAnonymousUser: YpUserData | undefined;\n\n  currentGroup: YpGroupData | undefined;\n\n  registrationQuestionsGroup: YpGroupData | undefined;\n\n  currentAnonymousGroup: YpGroupData | undefined;\n\n  currentForceSaml = false;\n\n  disableFacebookLoginForGroup = false;\n\n  googleMapsApiKey: string | undefined;\n\n  hasLlm = false;\n\n  currentSamlDeniedMessage: string | undefined;\n\n  currentSamlLoginMessage: string | undefined;\n\n  originalQueryParameters: Record<string, string | number | undefined> = {};\n\n  externalGoalTriggerGroupId: number | undefined;\n\n  externalGoalCounter = 0;\n\n  appStartTime!: Date;\n\n  autoTranslate = false;\n\n  goalTriggerEvents: Array<string> = [\n    \"newPost\",\n    \"endorse_up\",\n    \"endorse_down\",\n    \"newPointFor\",\n    \"newPointAgainst\",\n  ];\n\n  haveLoadedLanguages = false;\n\n  hasTranscriptSupport = false;\n\n  hasVideoUpload = false;\n\n  hasAudioUpload = false;\n\n  myDomains: Array<YpShortDomainList> | undefined;\n\n  // Locale seleted from query or loaded\n  locale: string | undefined;\n\n  // TODO: Remove any,\n  i18nTranslation: any | undefined;\n\n  serverApi!: YpServerApi;\n\n  recommendations!: YpRecommendations;\n\n  cache!: YpCache;\n\n  offline!: YpOffline;\n\n  analytics!: YpAnalytics;\n\n  theme!: YpThemeManager;\n\n  highlightedLanguages: string | undefined;\n\n  magicTextIronResizeDebouncer: number | undefined;\n\n  signupTermsPageId: number | undefined;\n\n  retryMethodAfter401Login: Function | undefined;\n\n  groupLoadNewPost = false;\n\n  groupNeedsRefresh = false;\n\n  communityNeedsRefresh = false;\n\n  domainNeedsRefresh = false;\n\n  constructor(serverApi: YpServerApi, disableInit = false) {\n    super();\n\n    if (!disableInit) {\n      this.appStartTime = new Date();\n\n      this.serverApi = serverApi;\n      this.recommendations = new YpRecommendations(serverApi);\n      this.cache = new YpCache();\n      this.analytics = new YpAnalytics();\n      this.theme = new YpThemeManager();\n      this.offline = new YpOffline();\n\n      // Boot\n      this.boot();\n      this.hasVideoUploadSupport();\n      this.hasAudioUploadSupport();\n\n      //TODO: See if this is recieved\n      this.fireGlobal(\"app-ready\");\n      this.parseQueryString();\n      this.addGlobalListener(\"yp-logged-in\", this._userLoggedIn.bind(this));\n    }\n  }\n\n  async setupMyDomains() {\n    if (this.domain && window.appUser && window.appUser.user) {\n      this.myDomains = await this.serverApi.getMyDomains();\n      this.fireGlobal(\"yp-my-domains-loaded\", { domains: this.myDomains });\n    } else {\n      console.warn(\"No domain or user found while setting up my domains\");\n    }\n  }\n\n  showRecommendationInfoIfNeeded() {\n    if (!localStorage.getItem(\"ypHaveShownRecommendationInfo\")) {\n      localStorage.setItem(\"ypHaveShownRecommendationInfo\", \"1\");\n      this.fireGlobal(\"yp-notify-dialog\", {\n        text: this.t(\"recommendationToastInfo\"),\n      });\n    }\n  }\n\n  showSpeechToTextInfoIfNeeded() {\n    if (\n      window.appGlobals.hasTranscriptSupport &&\n      !localStorage.getItem(\"haveShownTranscriptInfo\")\n    ) {\n      localStorage.setItem(\"haveShownTranscriptInfo\", \"1\");\n      this.fireGlobal(\"yp-notify-dialog\", { text: this.t(\"speechToTextInfo\") });\n    }\n  }\n\n  async hasVideoUploadSupport() {\n    const response =\n      (await this.serverApi.hasVideoUploadSupport()) as YpHasVideoResponse | void;\n    if (response) {\n      window.appGlobals.hasVideoUpload = response.hasVideoUploadSupport;\n      window.appGlobals.hasTranscriptSupport = response.hasTranscriptSupport;\n      this.fireGlobal(\"yp-has-video-upload\");\n    }\n  }\n\n  sendVideoView(videoId: number | string) {\n    this.serverApi.sendVideoView({ videoId: videoId });\n    this.activity(\"view\", \"video\", videoId);\n  }\n\n  sendLongVideoView(videoId: number | string) {\n    this.serverApi.sendVideoView({ videoId: videoId, longPlaytime: true });\n    this.activity(\"view\", \"videoLong\", videoId);\n  }\n\n  async hasAudioUploadSupport() {\n    const response =\n      (await this.serverApi.hasAudioUploadSupport()) as YpHasAudioResponse | void;\n    if (response) {\n      window.appGlobals.hasAudioUpload = response.hasAudioUploadSupport;\n      this.fireGlobal(\"yp-has-audio-upload\");\n    }\n  }\n\n  sendAudioListen(audioId: number | string) {\n    this.serverApi.sendAudioView({ audioId: audioId });\n    this.activity(\"view\", \"audio\", audioId);\n  }\n\n  sendLongAudioListen(audioId: number | string) {\n    this.serverApi.sendAudioView({ audioId: audioId, longPlaytime: true });\n    this.activity(\"view\", \"audioLong\", audioId);\n  }\n\n  changeLocaleIfNeededAfterWait(locale: string, force: boolean) {\n    if (\n      window.appGlobals.haveLoadedLanguages === true &&\n      locale &&\n      this.language != locale\n    ) {\n      if (force || !localStorage.getItem(\"yp-user-locale\")) {\n        i18next.changeLanguage(locale, () => {\n          //TODO: Fix moment\n          //moment.locale([locale, 'en']);\n          this.fireGlobal(\"yp-language-loaded\", { language: locale });\n          this.fireGlobal(\"language-loaded\", { language: locale });\n        });\n      }\n    }\n  }\n\n  setHighlightedLanguages(languages: string | undefined) {\n    this.highlightedLanguages = languages;\n    this.fireGlobal(\"yp-refresh-language-selection\");\n  }\n\n  changeLocaleIfNeeded(locale: string, force = false) {\n    if (window.appGlobals.haveLoadedLanguages) {\n      this.changeLocaleIfNeededAfterWait(locale, force);\n    } else {\n      setTimeout(() => {\n        console.warn(\n          \"Locales not loaded while trying to load languages, trying again in 100 ms\"\n        );\n        this.changeLocaleIfNeeded(locale, force);\n      }, 100);\n    }\n  }\n\n  //TODO: Test this well\n  parseQueryString() {\n    const queryString = (window.location.search || \"?\").substr(1);\n\n    const params: Record<string, string> = {};\n\n    const queries = queryString.split(\"&\");\n\n    queries.forEach((indexQuery: string) => {\n      const indexPair = indexQuery.split(\"=\");\n\n      const queryKey = decodeURIComponent(indexPair[0]);\n      const queryValue = decodeURIComponent(\n        indexPair.length > 1 ? indexPair[1] : \"\"\n      );\n\n      params[queryKey] = queryValue;\n    });\n\n    this.originalQueryParameters = params;\n  }\n\n  setAnonymousUser(user: YpUserData | undefined) {\n    this.currentAnonymousUser = user;\n  }\n\n  setRegistrationQuestionGroup(group: YpGroupData | undefined) {\n    if (\n      group &&\n      group.configuration &&\n      group.configuration.registrationQuestionsJson\n    ) {\n      this.registrationQuestionsGroup = group;\n      window.appUser.checkRegistrationAnswersCurrent();\n    } else {\n      this.registrationQuestionsGroup = undefined;\n    }\n  }\n\n  setAnonymousGroupStatus(group: YpGroupData | undefined) {\n    if (\n      group &&\n      group.configuration &&\n      (group.configuration.allowAnonymousUsers ||\n        group.configuration.allowOneTimeLoginWithName)\n    ) {\n      this.currentAnonymousGroup = group;\n      if (!window.appUser.user && this.currentAnonymousUser) {\n        window.appUser.setLoggedInUser(this.currentAnonymousUser);\n      } else if (\n        window.appUser &&\n        !window.appUser.user &&\n        group.configuration.allowAnonymousAutoLogin &&\n        this.originalQueryParameters &&\n        this.originalQueryParameters.autoLogin\n      ) {\n        window.appUser.autoAnonymousLogin();\n      }\n    } else {\n      if (\n        window.appUser &&\n        window.appUser.user &&\n        window.appUser.user.profile_data &&\n        window.appUser.user.profile_data.isAnonymousUser\n      ) {\n        window.appUser.removeAnonymousUser();\n      }\n      this.currentAnonymousGroup = undefined;\n    }\n  }\n\n  _domainChanged(domain: YpDomainData | undefined) {\n    if (domain) {\n      this.fireGlobal(\"yp-domain-changed\", { domain: domain });\n    }\n  }\n\n  notifyUserViaToast(text: string) {\n    this.fireGlobal(\"yp-open-toast\", { text: text });\n  }\n\n  reBoot() {\n    this.boot();\n  }\n\n\n  async _userLoggedIn(event: CustomEvent) {\n    const user: YpUserData = event.detail;\n    if (user) {\n      //TODO: Look at this\n      setTimeout(() => {\n        /*if (typeof ga == 'function') {\n          ga('set', '&uid', user.id);\n        }*/\n      }, 250); // Wait a bit to make sure google analytics tracking id has been set up dynamically\n      await this.setupMyDomains();\n    }\n    this.recommendations.reset();\n  }\n\n  setupTranslationSystem(loadPathPrefix: string = \"\") {\n    const hostname = window.location.hostname;\n    let defaultLocale = \"en\";\n    if (hostname.indexOf(\"betrireykjavik\") > -1) {\n      defaultLocale = \"is\";\n    } else if (hostname.indexOf(\"betraisland\") > -1) {\n      defaultLocale = \"is\";\n    } else if (hostname.indexOf(\"forbrukerradet\") > -1) {\n      defaultLocale = \"no\";\n    } else {\n      const tld = hostname.substring(hostname.lastIndexOf(\".\"));\n      const localeByTld: Record<string, string> = {\n        \".fr\": \"fr\",\n        \".hr\": \"hr\",\n        \".hu\": \"hu\",\n        \".nl\": \"nl\",\n        \".no\": \"no\",\n        \".pl\": \"pl\",\n        \".tw\": \"zh_tw\",\n      };\n      defaultLocale = localeByTld[tld] || \"en\";\n    }\n\n    const storedLocale = localStorage.getItem(\"yp-user-locale\");\n    if (storedLocale) {\n      defaultLocale = storedLocale;\n    }\n\n    let localeFromUrl: string | undefined;\n\n    if (\n      window.appGlobals.originalQueryParameters &&\n      window.appGlobals.originalQueryParameters[\"locale\"]\n    ) {\n      localeFromUrl = window.appGlobals.originalQueryParameters[\n        \"locale\"\n      ] as string;\n    }\n\n    if (\n      window.appGlobals.originalQueryParameters &&\n      window.appGlobals.originalQueryParameters[\"startAutoTranslate\"]\n    ) {\n      setTimeout(() => {\n        this.startTranslation();\n      }, 2500);\n    }\n\n    if (localeFromUrl && localeFromUrl.length > 1) {\n      defaultLocale = localeFromUrl;\n      localStorage.setItem(\"yp-user-locale\", localeFromUrl);\n    }\n\n    defaultLocale = defaultLocale.replace(\"-\", \"_\").toLowerCase();\n\n    i18next.use(HttpApi).init(\n      {\n        lng: defaultLocale,\n        fallbackLng: \"en\",\n        backend: { loadPath: `${loadPathPrefix}/locales/{{lng}}/{{ns}}.json` },\n      },\n      () => {\n        window.appGlobals.locale = defaultLocale;\n        window.appGlobals.i18nTranslation = i18next;\n        window.appGlobals.haveLoadedLanguages = true;\n        //TODO: Fix moment\n        //moment.locale([defaultLocale, 'en']);\n        // wait for 2 seconds\n        this.fireGlobal(\"yp-language-loaded\", { language: defaultLocale });\n        this.fireGlobal(\"language-loaded\", { language: defaultLocale });\n      }\n    );\n  }\n\n  startTranslation() {\n    window.appGlobals.autoTranslate = true;\n    this.fireGlobal(\"yp-auto-translate\", true);\n    window.appDialogs.getDialogAsync(\"masterToast\", (toast: YpSnackbar) => {\n      toast.labelText = this.t(\"autoTranslationStarted\");\n      toast.open = true;\n    });\n  }\n\n  stopTranslation() {\n    window.appGlobals.autoTranslate = false;\n    this.fireGlobal(\"yp-auto-translate\", false);\n    window.appDialogs.getDialogAsync(\"masterToast\", (toast: YpSnackbar) => {\n      toast.labelText = this.t(\"autoTranslationStopped\");\n      toast.open = true;\n    });\n    sessionStorage.setItem(\"dontPromptForAutoTranslation\", \"1\");\n  }\n\n  async boot() {\n    const results = (await this.serverApi.boot()) as YpDomainGetResponse | void;\n    if (results) {\n      this.domain = results.domain;\n      this.googleMapsApiKey = results.domain.googleMapsApiKey;\n      this.hasLlm = results.domain.hasLlm !== undefined ? results.domain.hasLlm : false;\n      this._domainChanged(this.domain);\n      this.setupMyDomains();\n      //this.analytics.setupGoogleAnalytics(this.domain);\n\n      if (window.location.pathname == \"/\") {\n        if (\n          results.community &&\n          results.community.configuration &&\n          results.community.configuration.redirectToGroupId\n        ) {\n          YpNavHelpers.redirectTo(\n            \"/group/\" + results.community.configuration.redirectToGroupId\n          );\n        } else if (\n          results.community &&\n          !results.community.is_community_folder\n        ) {\n          YpNavHelpers.redirectTo(\"/community/\" + results.community.id);\n        } else if (results.community && results.community.is_community_folder) {\n          YpNavHelpers.redirectTo(\"/community_folder/\" + results.community.id);\n        } else {\n          YpNavHelpers.redirectTo(\"/domain/\" + this.domain.id);\n          this.fireGlobal(\"yp-change-header\", {\n            headerTitle: this.domain.domain_name,\n            headerDescription: this.domain.description,\n          });\n        }\n      }\n    }\n    this.fireGlobal(\"yp-boot-from-server\");\n  }\n\n  setupGroupConfigOverride(groupId: number, configOverride: string) {\n    const configOverrideHash: Record<string, string> = {};\n    configOverride.split(\";\").forEach(function (configItem) {\n      const splitItem = configItem.split(\"=\");\n      configOverrideHash[splitItem[0]] = splitItem[1];\n    });\n    this.groupConfigOverrides[groupId] = configOverrideHash;\n    if (configOverrideHash[\"ln\"]) {\n      this.changeLocaleIfNeeded(configOverrideHash[\"ln\"], true);\n    }\n  }\n\n  // Example use http://localhost:4242/group/47/config/hg=1;rn=Your Priorities;ru=https://yrpri.org/\n  overrideGroupConfigIfNeeded(\n    groupId: number,\n    configuration: YpGroupConfiguration\n  ) {\n    if (!configuration) {\n      configuration = {};\n    }\n    const override = this.groupConfigOverrides[groupId];\n    if (!override) {\n      return configuration;\n    } else {\n      if (override[\"hg\"]) {\n        configuration[\"hideGroupHeader\"] = Boolean(override[\"hg\"]);\n      }\n      if (override[\"ht\"]) {\n        configuration[\"hideAllTabs\"] = Boolean(override[\"ht\"]);\n      }\n      if (override[\"hh\"]) {\n        configuration[\"hideHelpIcon\"] = Boolean(override[\"hh\"]);\n      }\n      if (override[\"rn\"]) {\n        configuration[\"customBackName\"] = override[\"rn\"] as string;\n      }\n      if (override[\"ru\"]) {\n        configuration[\"customBackURL\"] = override[\"ru\"] as string;\n      }\n      return configuration;\n    }\n  }\n\n  postLoadGroupProcessing(group: YpGroupData) {\n    if (this.originalQueryParameters[\"yu\"]) {\n      this.serverApi.marketingTrackingOpen(\n        group.id,\n        this.originalQueryParameters\n      );\n      this.externalGoalTriggerGroupId = group.id;\n      this.goalTriggerEvents = [\"newPost\", \"newPointFor\", \"newPointAgainst\"];\n      this.originalQueryParameters[\"goalThreshold\"] = 1;\n    }\n  }\n\n  checkExternalGoalTrigger(type: string) {\n    if (\n      this.externalGoalTriggerGroupId &&\n      this.originalQueryParameters &&\n      this.originalQueryParameters.goalThreshold &&\n      this.goalTriggerEvents.indexOf(type) > -1\n    ) {\n      this.externalGoalCounter += 1;\n      if (\n        this.externalGoalCounter == this.originalQueryParameters.goalThreshold\n      ) {\n        this.serverApi.triggerTrackingGoal(\n          this.externalGoalTriggerGroupId,\n          this.originalQueryParameters\n        );\n      }\n    }\n  }\n\n  activity(\n    type: string,\n    object: object | string | undefined = undefined,\n    context: string | object | number | undefined = undefined,\n    target: string | object | undefined = undefined\n  ) {\n    let actor;\n\n    if (window.appUser && window.appUser.user) {\n      actor = window.appUser.user.id;\n    } else {\n      actor = \"-1\";\n    }\n\n    let logString = \"activity stream: \" + actor + \" \" + type + \" \" + object;\n\n    console.log(logString);\n\n    if (context) logString += \" \" + context;\n\n    if (type == \"open\") {\n      // Wait by sending open so pageview event can be completed before\n      setTimeout(() => {\n        this.analytics.sendToAnalyticsTrackers(\n          \"send\",\n          \"event\",\n          object || {},\n          type\n        );\n      }, 25);\n    } else {\n      this.analytics.sendToAnalyticsTrackers(\n        \"send\",\n        \"event\",\n        object || {},\n        type\n      );\n    }\n\n    this.serverApi.createActivityFromApp({\n      actor: actor,\n      type: type,\n      object: object,\n      target: JSON.stringify(target),\n      context: context ? context : \"\",\n      path_name: location.pathname,\n      referrer: document.referrer,\n      screen_width: window.innerWidth,\n      url: window.location.href,\n      userLocale: this.locale,\n      userAutoTranslate: this.autoTranslate,\n      groupId: this.currentGroup ? this.currentGroup.id : undefined,\n      event_time: new Date().toISOString(),\n      session_id: this.getSessionFromCookie(),\n      user_agent: navigator.userAgent,\n    });\n\n    if (type === \"completed\" || type === \"clicked\") {\n      this.checkExternalGoalTrigger(object as string);\n    }\n  }\n\n  setSeenWelcome() {\n    this.seenWelcome = true;\n    localStorage.setItem(\"yrpri-welcome-status\", \"1\");\n  }\n\n  getSessionFromCookie() {\n    const strCookies = document.cookie;\n    const cookiearray = strCookies.split(\";\");\n    let sid = \"\";\n    for (let i = 0; i < cookiearray.length; i++) {\n      const name = cookiearray[i].split(\"=\")[0];\n      const value = cookiearray[i].split(\"=\")[1];\n      if (name == \" connect.sid\") sid = value;\n    }\n    return sid;\n  }\n}\n"]}