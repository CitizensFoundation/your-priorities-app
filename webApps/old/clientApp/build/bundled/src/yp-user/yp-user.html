<div hidden=""by-polymer-bundler=""><dom-module id="yp-bulk-status-display"assetpath="../yp-bulk-status-update/"><template><style include="iron-flex iron-flex-alignment">:host{padding:16px;margin:16px;}.statusMaterial{background-color:#FFF;padding:16px;margin:32px;margin-top:16px;}a{color:#000;}.detail{max-width:400px;margin:8px;padding:8px;}.openCloseButton{cursor:pointer;margin-top:8px;}.ideaLink{cursor:pointer;text-decoration:underline;}.postName{margin-top:8px;}.mainHeader{margin:16px;margin-bottom:0;}.infoText{padding-top:8px;padding-right:8px;padding-left:8px;}.voteText{font-size:19px;}.topArea{background-color:var(--primary-background-color);background-image:var(--top-area-background-image, none);height:300px;padding-top:0;margin-top:-24px;}.headerMaterial{padding:16px;background-color:#fcfcfc;padding-top:8px;padding-bottom:24px;}@media (max-width: 900px){.topArea{height:auto;}.statusMaterial{background-color:#FFF;padding:16px;margin:16px;margin-top:8px;}}[hidden]{display:none !important;}.templateList{background-color:#FFF;padding:32px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><div class="layout vertical center-center topArea"><paper-material elevation="5"class="headerMaterial layout vertical center-center"><h2 class="mainHeader">[[t('bulkStatusUdateFor')]]: [[community.name]]</h2><div class="infoText">[[t('bulkStatusUdateForInfo')]]</div></paper-material></div><template is="dom-if"if="[[!byTemplate]]"><template is="dom-repeat"items="[[config.groups]]"as="group"><paper-material elevation="2"class="statusMaterial layout horizontal center-center wrap"><template is="dom-repeat"items="[[_orderGroupStatuses(group.statuses)]]"as="status"><div class="layout vertical self-start"><h1 hidden$="[[hideGroupName]]">[[group.name]]</h1><h2>[[_officialStatusOptionsNamePlural(status.official_status)]]</h2><template is="dom-repeat"items="[[status.posts]]"as="post"><div class="layout vertical"><div class="layout horizontal"><iron-icon class="openCloseButton"data-args$="[[post.id]]"icon="keyboard-arrow-right"on-tap="_setOpen"></iron-icon><div class="postName"><div class="ideaLink"data-args$="[[post.id]]"on-tap="_setOpen">[[post.name]]</div></div></div><div id="detail_[[post.id]]"class="detail"hidden=""><div class="reason"hidden$="[[post.uniqueStatusMessage]]">[[_getTemplate(post.selectedTemplateName)]]</div><div class="reason"hidden$="[[!post.uniqueStatusMessage]]">[[post.uniqueStatusMessage]]</div><div class="postName">[[t('urlLink')]]: <a target="_blank"href="/post/[[post.id]]">[[post.name]]</a></div></div></div></template></div></template></paper-material></template></template><template is="dom-if"if="[[gotModifiedTemplates]]"restamp=""><div class="templateList"><template is="dom-repeat"items="[[_toArray(templates)]]"as="template"><h2>[[template.title]]</h2><template is="dom-repeat"items="[[template.posts]]"as="post"><div class="postName"><a target="_blank"href="/post/[[post.id]]">[[post.name]]</a></div></template></template></div></template><yp-ajax id="ajax"url="/api/users/[[userId]]/status_update/[[statusUpdateId]]"on-response="_response"></yp-ajax></template><script>Polymer({is:"yp-bulk-status-display",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypOfficialStatusOptions,Polymer.ypThemeBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypTruncateBehavior],properties:{config:{type:Object},templates:{type:Object},community:{type:Object,observer:"_communityChanged"},statusUpdateId:{type:Number,observer:"_statusUpdateIdChanged"},readToLoad:{type:Boolean,computed:"_readyToLoad(userId, statusUpdateId)"},userId:Number,hideGroupName:{type:Boolean,value:!1},byTemplate:{type:Boolean,value:!1},gotModifiedTemplates:{type:Boolean,value:!1}},_toArray:function(e){return Object.values(e)},_communityChanged:function(e){e&&e.CommunityHeaderImages&&0<e.CommunityHeaderImages.length&&this.setupTopHeaderImage(e.CommunityHeaderImages),e&&470==e.id&&this.set("hideGroupName",!0)},setupTopHeaderImage:function(e){var t;t=e?"url("+this.getImageFormatUrl(e,0)+")":"none",this.updateStyles({"--top-area-background-image":t})},_orderGroupStatuses:function(e){var s={"-1":3,0:2,"-2":1,2:0};return e.sort(function(e,t){return s[e.official_status.toString()]-s[t.official_status.toString()]})},_getTemplate:function(e){return e&&this.templates[e]?this.templates[e].content.replace("www.kosning.reykjavik.is","kosning.reykjavik.is"):"Vantar upplÃ½singar"},_readyToLoad:function(e,t){e&&t&&this.async(function(){this.$.ajax.generateRequest()},20)},_statusUpdateIdChanged:function(){},_setOpen:function(e){var t=(e=(e=e||window.event).target||e.srcElement).getAttribute("data-args");this.$$("#detail_"+t).hidden=!this.$$("#detail_"+t).hidden},_setClosed:function(){var e=event.target.getAttribute("data-args");this.$$("#detail_"+e).hidden=!0},_response:function(e,t){this.set("config",t.response.config);var s={};t.response.templates.forEach(function(e){s[e.title]=e}),this.set("templates",s),this.set("community",t.response.community),this.fire("change-header",{headerTitle:this.truncate(this.community.name,80),documentTitle:this.t("bulkStatusUdateFor")+" "+this.truncate(this.community.name,80),headerDescription:"",backPath:"/community/"+this.community.id}),null!=this.community.theme_id&&this.setTheme(this.community.theme_id),this.byTemplate&&(this.config.groups.forEach(function(e){e.statuses.forEach(function(e){e.posts.forEach(function(e){e.selectedTemplateName&&this.templates[e.selectedTemplateName]?(this.templates[e.selectedTemplateName].posts||(this.templates[e.selectedTemplateName].posts=[]),this.templates[e.selectedTemplateName].posts.push(e),console.log("Pusing to:"+e.selectedTemplateName+" id:"+e.id)):(this.templates["No template"]||(this.templates["No template"]={title:"No template"},this.templates["No template"].posts=[]),this.templates["No template"].posts.push(e))}.bind(this))}.bind(this))}.bind(this)),this._toArray(this.templates).forEach(function(e){e.posts&&0!=e.posts.length||delete this.templates[e.title]}.bind(this)),this.set("gotModifiedTemplates",!0))}})</script></dom-module></div><dom-module id="yp-user"><template><style include="iron-flex iron-flex-alignment">ac-activities{@apply --layout-vertical;@apply --layout-flex;}.card-container{@apply --layout-horizontal;@apply --layout-wrap;}@media (max-width: 330px){.card{padding-left:0;padding-right:0;padding-bottom:8px;padding-top:8px;}.card-container{padding:0;margin:0;}}yp-ajax{background-color:var(--primary-background-color);}.twitterFeed{margin-top:24px;}.archivedText{font-size:26px;color:#333;}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><app-route route="{{idRoute}}"pattern="/:id"data="{{idRouteData}}"tail="{{tabRoute}}"></app-route><app-route route="{{tabRoute}}"pattern="/:tabName"data="{{tabRouteData}}"tail="{{statusUpdateRoute}}"></app-route><app-route route="{{statusUpdateRoute}}"pattern="/:statusUpdateId"data="{{statusUpdateRouteData}}"></app-route><yp-user-large-card hidden=""id="userCard"class="largeCard card"user="[[user]]"on-update-domain="_refresh"></yp-user-large-card><paper-tabs hidden=""id="paper_tabs"class="tabs"selected="{{selected}}"focused=""><paper-tab class="tab">[[t('news')]]</paper-tab><paper-tab class="tab"><span>[[t('communities')]]</span> &nbsp; (<span>[[communitiesLength]]</span>)</paper-tab><paper-tab class="tab"><span>[[t('groups')]]</span> &nbsp; (<span>[[groupsLength]]</span>)</paper-tab><paper-tab class="tab"><div class="layout vertical center-center tabCounterContainer"><span>[[t('posts.posts')]]</span><div class="counterInfo"id="tabCount"></div></div></paper-tab></paper-tabs><iron-pages class="tabPages"selected="{{selectedTab}}"attr-for-selected="name"entry-animation="fade-in-animation"exit-animation="fade-out-animation"><section name="status_updates"><yp-bulk-status-display user-id$="[[userId]]"status-update-id$="[[statusUpdateId]]"></yp-bulk-status-display></section><section name="status_updates_templates"><yp-bulk-status-display by-template=""user-id$="[[userId]]"status-update-id$="[[statusUpdateId]]"></yp-bulk-status-display></section><section><ac-activities selected-tab="[[selectedTab]]"user-id="[[user.id]]"></ac-activities></section><section><template><div class="layout horizontal center-center"><yp-post-list id="postList"selected-tab="[[selected]]"status-filter="open"tab-counter-id="tabCount"searching-for="[[searchingFor]]"group="[[group]]"group-id="[[groupId]]"></yp-post-list></div></template></section></iron-pages><yp-ajax id="ajax"url="[[url]]"on-response="_response"></yp-ajax><yp-ajax id="pagesAjax"on-response="_pagesResponse"></yp-ajax></template><script>Polymer({is:"yp-user",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypThemeBehavior,Polymer.CollectionHelpers,Polymer.CommunityCollectionBehaviors,Polymer.GroupCollectionBehaviors,Polymer.ypGotoBehavior],properties:{idRoute:{type:Object},tabRoute:Object,statusUpdateRoute:Object,idRouteData:Object,tabRouteData:Object,statusUpdateRouteData:Object,userId:{type:Number,value:null,observer:"_userIdChanged"},url:{type:String},domainEmpty:{type:Boolean,value:!1},selectedTab:{type:String,value:null},user:{type:Object},statusUpdateId:String,selected:{type:Number,value:0,observer:"_selectedChanged"},userTabName:{type:String,value:null,observer:"_tabNameChanged"}},observers:["_routeIdChanged(idRouteData.id)","_routeTabChanged(tabRouteData.tabName)","_routeStatusUpdateChanged(statusUpdateRouteData.statusUpdateId)"],_routeIdChanged:function(e){e&&this.set("userId",e)},_routeTabChanged:function(e){e?this.set("selectedTab",e):e&&this._isNumber(e)&&(this.set("scrollToPointId",e),this.set("selectedTab","debate"))},_routeStatusUpdateChanged:function(e){e&&this.set("statusUpdateId",e)},_tabNameChanged:function(e){e&&("communities"==e?this.set("selected",0):"news"==e?this.set("selected",1):"other_social_media"==e&&this.set("selected",2))},_selectedChanged:function(e){this.user&&(0==e?this.redirectTo("/user/"+this.user.id+"/news"):1==e?this.redirectTo("/user/"+this.user.id+"/communities"):2==e?this.redirectTo("/user/"+this.user.id+"/groups"):3==e&&this.redirectTo("/user/"+this.user.id+"/posts"))},_userIdChanged:function(e){e&&(this.set("featuredCommunities",null),this.set("activeCommunities",null),this.set("archivedCommunities",null),this.set("featuredGroups",null),this.set("activeGroups",null),this.set("archivedGroups",null),this.$.ajax.url="/api/users/"+this.userId)},_refresh:function(){this.$.ajax.generateRequest()},_response:function(e,t){this.set("user",t.response),this.user&&(null!=this.user.theme_id&&this.setTheme(this.user.theme_id),this.user.UserHeaderImages&&0<this.user.UserHeaderImages.length&&this.$.page.setupTopHeaderImage(this.user.UserHeaderImages),this.setupCommunities(this.user.CommunityUsers),this.setupGroups(this.user.GroupUsers),this.fire("change-header",{historyBack:!0}),window.appGlobals.setAnonymousGroupStatus(null),window.appGlobals.disableFacebookLoginForGroup=!1)}})</script></dom-module>