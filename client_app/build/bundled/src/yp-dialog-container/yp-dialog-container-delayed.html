<div hidden=""by-polymer-bundler=""><script>Polymer.ypCollectionStatusOptions={properties:{collectionStatusOptions:{type:Object,computed:"_collectionStatusOptions(language)"}},_collectionStatusOptions:function(t){return t?[{name:"active",translatedName:this.t("status.active")},{name:"featured",translatedName:this.t("status.featured")},{name:"archived",translatedName:this.t("status.archived")},{name:"hidden",translatedName:this.t("status.hidden")}]:[]}}</script><dom-module id="yp-community-edit"assetpath="../yp-community/"><template><style include="iron-flex iron-flex-alignment">.access{@apply --layout-horizontal;@apply --layout-center-justified;}.accessHeader{color:var(--primary-color,#777);font-weight:normal;margin-bottom:0px;}paper-radio-button{display:block;}#registrationQuestionsJsonErrorInfo{margin-top:0px;margin-bottom:8px;color:#F00;font-weight:bold;}.additionalSettings{padding-top:16px;}.half{width:50%;}.hostnameInfo{color:#888;}.config{margin-top:16px;}paper-checkbox{margin-bottom:4px;}.uploadSection{max-width:300px;margin:8px;}.useVideoCover{margin-left:4px;margin-top:4px;}.themeOverrideInfo{margin-bottom:16px;}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog name="communityEdit"id="editDialog"title="[[editHeaderText]]"icon="group-work"action="[[action]]"method="[[method]]"params="[[params]]"save-text="[[saveText]]"toast-text="[[toastText]]"><div class="layout vertical"><paper-input id="name"name="name"type="text"label="[[t('name')]]"value="{{community.name}}"maxlength="60"minlength="1"required=""char-counter=""class="mainInput"></paper-input><paper-input id="hostname"name="hostname"type="text"allowed-pattern="[a-z0-9-]"label="[[t('community.hostname')]]"value="{{community.hostname}}"maxlength="80"minlength="1"required="[[!community.is_community_folder]]"char-counter=""class="mainInput"></paper-input><div class="hostnameInfo">https://[[hostnameExample]]</div><paper-textarea id="description"name="description"value="{{community.description}}"always-float-label="[[community.description]]"label="[[t('description')]]"char-counter=""rows="2"max-rows="5"minlength="1"on-value-changed="_descriptionChanged"required=""maxlength="[[descriptionMaxLength]]"class="mainInput"></paper-textarea><div class="horizontal end-justified layout"><emoji-selector id="emojiSelectorDescription"></emoji-selector></div></div><div class="layout horizontal wrap"><div class="layout vertical additionalSettings uploadSection"><yp-file-upload id="logoImageUpload"raised="true"multi="false"target="/api/images?itemType=community-logo"method="POST"on-success="_logoImageUploaded"><iron-icon class="icon"icon="photo-camera"></iron-icon><span>[[t('image.logo.upload')]]</span></yp-file-upload></div><div class="layout horizontal additionalSettings uploadSection"><yp-file-upload id="headerImageUpload"raised="true"multi="false"target="/api/images?itemType=community-header"method="POST"on-success="_headerImageUploaded"><iron-icon class="icon"icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload><paper-icon-button aria-label$="[[t('deleteHeaderImage')]]"class="removeButton layout self-start"icon="delete"on-tap="_deleteHeaderImage"hidden$="[[!hasHeaderImage]]">&gt;</paper-icon-button></div><template is="dom-if"if="[[hasVideoUpload]]"><div class="layout vertical uploadSection"><yp-file-upload id="videoFileUpload"raised="true"multi="false"video-upload=""method="POST"on-success="_videoUploaded"><iron-icon class="icon"icon="videocam"></iron-icon><span>[[t('uploadVideo')]]</span></yp-file-upload><template is="dom-if"if="[[hasVideos]]"restamp=""><paper-checkbox class="useVideoCover"name="useVideoCover"checked$="{{community.configuration.useVideoCover}}">[[t('useVideoCover')]]</paper-checkbox></template></div></template></div><h3 class="accessHeader">[[t('access')]]</h3><paper-radio-group id="access"name="access"class="access"selected="{{communityAccess}}"><paper-radio-button name="public">[[t('public')]]</paper-radio-button><paper-radio-button name="closed">[[t('closed')]]</paper-radio-button><paper-radio-button name="secret">[[t('secret')]]</paper-radio-button></paper-radio-group><paper-textarea id="registrationQuestions"name="registrationQuestions"type="text"rows="4"always-float-label="[[community.configuration.registrationQuestions]]"maxrows="8"on-value-changed="_registrationQuestionsChanged"max-rows="8"label="[[t('registrationQuestions')]]"value="{{community.configuration.registrationQuestions}}"></paper-textarea><div id="registrationQuestionsJsonErrorInfo"hidden$="[[!registrationQuestionsJsonError]]">[[t('structuredQuestionsJsonFormatNotValid')]]</div><div class="layout vertical config"hidden$="[[community.is_community_folder]]"><paper-checkbox name="onlyAdminsCanCreateGroups"checked$="{{community.only_admins_can_create_groups}}">[[t('community.onlyAdminsCanCreateGroups')]]</paper-checkbox><paper-checkbox hidden$="[[!community.configuration.alternativeHeader]]"name="alternativeHeader"checked$="{{community.configuration.alternativeHeader}}">[[t('community.alternativeHeader')]]</paper-checkbox><paper-checkbox name="disableDomainUpLink"checked$="{{community.configuration.disableDomainUpLink}}">[[t('disableCommunityDomainUpLink')]]</paper-checkbox><paper-checkbox name="disableNameAutoTranslation"checked$="{{community.configuration.disableNameAutoTranslation}}">[[t('disableNameAutoTranslation')]]</paper-checkbox><paper-checkbox id="useReadMoreForDescription"name="useReadMoreForDescription"checked$="{{community.configuration.useReadMoreForDescription}}"on-tap="_updateReadMoreForDescription">[[t('useReadMoreForDescription')]]</paper-checkbox><paper-checkbox name="hideAllTabs"checked$="{{community.configuration.hideAllTabs}}">[[t('hideAllTabs')]]</paper-checkbox></div><input type="hidden"name="themeId"value="[[themeId]]"> <input type="hidden"name="deleteHeaderImage"value="[[deleteHeaderImage]]"><yp-theme-selector object="[[community]]"selected-theme="{{themeId}}"></yp-theme-selector><paper-input id="themeOverrideColorPrimary"name="themeOverrideColorPrimary"allowed-pattern="[#-#0-9A-Fa-f]"maxlength="7"char-counter=""label="[[t('themeOverrideColorPrimary')]]"value="{{community.configuration.themeOverrideColorPrimary}}"><div prefix="">#</div></paper-input><paper-input id="themeOverrideColorAccent"name="themeOverrideColorAccent"allowed-pattern="[#-#0-9A-Fa-f]"maxlength="7"char-counter=""label="[[t('themeOverrideColorAccent')]]"value="{{community.configuration.themeOverrideColorAccent}}"></paper-input><paper-input id="themeOverrideBackgroundColor"name="themeOverrideBackgroundColor"allowed-pattern="[#-#0-9A-Fa-f]"maxlength="7"char-counter=""label="[[t('themeOverrideBackgroundColor')]]"value="{{community.configuration.themeOverrideBackgroundColor}}"></paper-input><div class="themeOverrideInfo"><b><em>[[t('themeOverrideColorInfo')]]</em></b></div><div class="layout vertical"><paper-checkbox name="hideInfoBoxExceptForAdmins"checked$="{{community.configuration.hideInfoBoxExceptForAdmins}}">[[t('hideInfoBoxExceptForAdmins')]]</paper-checkbox><paper-checkbox name="hideLogoBoxExceptOnMobile"checked$="{{community.configuration.hideLogoBoxExceptOnMobile}}">[[t('hideLogoBoxExceptOnMobile')]]</paper-checkbox><paper-checkbox name="hideLogoBoxShadow"checked$="{{community.configuration.hideLogoBoxShadow}}">[[t('hideLogoBoxShadow')]]</paper-checkbox></div><input type="hidden"name="uploadedLogoImageId"value="[[uploadedLogoImageId]]"> <input type="hidden"name="uploadedHeaderImageId"value="[[uploadedHeaderImageId]]"> <input type="hidden"name="appHomeScreenIconImageId"value="[[appHomeScreenIconImageId]]"> <input type="hidden"name="ssnLoginListDataId"value="[[ssnLoginListDataId]]"> <input type="hidden"name="is_community_folder"value="[[community.is_community_folder]]"><div class="layout horizontal config"><paper-dropdown-menu label="[[t('status.select')]]"><paper-listbox slot="dropdown-content"attr-for-selected="name"selected="{{status}}"><template is="dom-repeat"items="[[collectionStatusOptions]]"as="statusOption"><paper-item name="[[statusOption.name]]">[[statusOption.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden"name="status"value="[[status]]"></div><div class="layout horizontal config"hidden$="[[!availableCommunityFolders]]"><paper-dropdown-menu label="[[t('inCommunityFolder')]]"><paper-listbox slot="dropdown-content"attr-for-selected="folderid"selected="{{inCommunityFolderId}}"><template is="dom-repeat"items="[[availableCommunityFolders]]"as="communityFolder"><paper-item folderid="[[communityFolder.id]]">[[communityFolder.name]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden"name="in_community_folder_id"value="[[inCommunityFolderId]]"></div><yp-language-selector name="defaultLocale"no-user-events=""selected-locale="{{community.default_locale}}"></yp-language-selector><div class="layout horizontal config"hidden$="[[!pages]]"><paper-dropdown-menu label="[[t('signupTermsSelectPage')]]"><paper-listbox slot="dropdown-content"attr-for-selected="name"selected="{{community.configuration.signupTermsPageId}}"><template is="dom-repeat"items="[[translatedPages]]"as="page"><paper-item name="[[page.id]]"data-args$="[[index]]">[[_getLocalizePageTitle(page)]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden"name="signupTermsPageId"value="[[community.configuration.signupTermsPageId]]"></div><div class="layout horizontal config"hidden$="[[!pages]]"><paper-dropdown-menu label="[[t('welcomeSelectPage')]]"><paper-listbox slot="dropdown-content"attr-for-selected="name"selected="{{community.configuration.welcomePageId}}"><template is="dom-repeat"items="[[translatedPages]]"as="page"><paper-item name="[[page.id]]"data-args$="[[index]]">[[_getLocalizePageTitle(page)]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden"name="welcomePageId"value="[[community.configuration.welcomePageId]]"></div><paper-input id="google_analytics_code"name="google_analytics_code"type="text"label="[[t('analyticsTrackerCode')]]"value="{{community.google_analytics_code}}"maxlength="40"style="width: 200px;"></paper-input><paper-input id="facebookPixelId"name="facebookPixelId"type="text"label="[[t('facebookPixelId')]]"value="{{community.configuration.facebookPixelId}}"maxlength="40"style="width: 200px;"></paper-input><paper-textarea id="welcomeHTML"name="welcomeHTML"value="{{community.configuration.welcomeHTML}}"always-float-label="[[community.configuration.welcomeHTML]]"label="[[t('welcomeHTML')]]"rows="2"max-rows="5"minlength="1"class="mainInput"></paper-textarea><paper-input id="customBackURL"name="customBackURL"type="text"maxlength="256"label="[[t('customBackURL')]]"value="{{community.configuration.customBackURL}}"></paper-input><paper-input id="customBackName"name="customBackName"type="text"maxlength="35"label="[[t('customBackName')]]"value="{{community.configuration.customBackName}}"></paper-input><paper-input id="highlightedLanguages"name="highlightedLanguages"type="text"maxlength="200"label="[[t('highlightedLanguages')]]"value="{{community.configuration.highlightedLanguages}}"></paper-input><paper-input id="redirectToGroupId"name="redirectToGroupId"type="text"label="[[t('redirectToGroupId')]]"value="{{community.configuration.redirectToGroupId}}"maxlength="11"></paper-input><paper-input id="appHomeScreenShortName"name="appHomeScreenShortName"type="text"label="[[t('appHomeScreenShortName')]]"value="{{community.configuration.appHomeScreenShortName}}"maxlength="16"style="width: 200px;"></paper-input><div class="layout vertical additionalSettings half"><yp-file-upload id="appHomeScreenIconImageUpload"raised="true"multi="false"target="/api/images?itemType=app-home-screen-icon"method="POST"on-success="_appHomeScreenIconImageUploaded"><iron-icon class="icon"icon="photo-camera"></iron-icon><span>[[t('appHomeScreenIconImageUpload')]] (512x512)</span></yp-file-upload></div><div class="layout vertical"><paper-checkbox name="useTextOnlyInfoBox"checked$="{{community.configuration.useTextOnlyInfoBox}}">[[t('useTextOnlyInfoBox')]]</paper-checkbox><paper-checkbox name="muteNotificationsForEndorsements"checked$="{{community.configuration.muteNotificationsForEndorsements}}">[[t('muteNotificationsForEndorsements')]]</paper-checkbox><paper-checkbox name="closeNewsfeedSubmissions"checked$="{{community.configuration.closeNewsfeedSubmissions}}">[[t('closeNewsfeedSubmissions')]]</paper-checkbox><paper-checkbox name="sortBySortOrder"checked$="{{community.configuration.sortBySortOrder}}">[[t('sortGroupsBySortOrder')]]</paper-checkbox><paper-checkbox name="orderByRandom"checked$="{{community.configuration.orderByRandom}}">[[t('orderGroupsByRandom')]]</paper-checkbox><paper-checkbox name="alwaysShowOnDomainPage"checked$="{{community.configuration.alwaysShowOnDomainPage}}">[[t('alwaysShowOnDomainPage')]]</paper-checkbox><paper-checkbox name="hideRecommendationOnNewsFeed"checked$="{{community.configuration.hideRecommendationOnNewsFeed}}">[[t('hideRecommendationOnNewsFeed')]]</paper-checkbox><paper-checkbox name="recalculateCountersRecursively"checked$="{{community.configuration.recalculateCountersRecursively}}">[[t('recalculateCountersRecursively')]]</paper-checkbox><paper-checkbox name="hideGroupListCardObjectives"checked$="{{community.configuration.hideGroupListCardObjectives}}">[[t('hideGroupListCardObjectives')]]</paper-checkbox><paper-checkbox name="disableGroupDynamicFontSizes"checked$="{{community.configuration.disableGroupDynamicFontSizes}}">[[t('disableGroupDynamicFontSizes')]]</paper-checkbox><paper-checkbox name="enableFraudDetection"checked$="{{community.configuration.enableFraudDetection}}">[[t('enableFraudDetection')]]</paper-checkbox><template is="dom-if"if="[[ziggeoActive()]]"><paper-checkbox name="useZiggeo"checked$="{{community.configuration.useZiggeo}}">[[t('useZiggeo')]]</paper-checkbox></template><paper-checkbox name="forceSecureSamlLogin"disabled$="[[!hasSamlLoginProvider]]"checked$="{{community.configuration.forceSecureSamlLogin}}">[[t('forceSecureSamlLogin')]]</paper-checkbox></div><paper-textarea id="customSamlLoginMessage"name="customSamlLoginMessage"value="{{community.configuration.customSamlLoginMessage}}"always-float-label="[[community.configuration.customSamlLoginMessage]]"label="[[t('customSamlLoginMessage')]]"char-counter=""rows="2"max-rows="5"minlength="1"maxlength="175"class="mainInput"></paper-textarea><paper-textarea id="customSamlDeniedMessage"name="customSamlDeniedMessage"value="{{community.configuration.customSamlDeniedMessage}}"always-float-label="[[community.configuration.customSamlDeniedMessage]]"label="[[t('customSamlDeniedMessage')]]"char-counter=""rows="2"max-rows="5"minlength="1"maxlength="150"class="mainInput"></paper-textarea><paper-input id="actAsLinkToExternalYPSite"name="actAsLinkToExternalYPSite"type="text"label="[[t('actAsLinkToExternalYPSite')]]"value="{{community.configuration.actAsLinkToExternalYPSite}}"></paper-input><paper-input id="externalId"name="externalId"type="text"label="[[t('externalId')]]"value="{{community.configuration.externalId}}"></paper-input><paper-input id="projectId"name="projectId"type="text"label="[[t('projectId')]]"value="{{community.configuration.projectId}}"></paper-input><paper-checkbox name="useProjectIdForAnalytics"checked$="{{community.configuration.useProjectIdForAnalytics}}">[[t('useProjectIdForAnalytics')]]</paper-checkbox><div class="layout horizontal additionalSettings half"hidden$="[[!ssnLoginListDataId]]"><div><b>[[t('ssnLoginListCount')]]: [[ssnLoginListDataCount]]</b></div><div><paper-button style="padding: 8px;"raised=""on-tap="_deleteSsnLoginList">[[t('deleteSsnLoginList')]]</paper-button></div></div><div class="layout vertical additionalSettings half"hidden$="[[ssnLoginListDataId]]"><yp-file-upload id="ssnLoginListDataUpload"raised="true"disabled$="[[!hasSamlLoginProvider]]"hidden$="[[!community.id]]"accept=".txt,.csv"multi="false"target="/api/communities/[[community.id]]/upload_ssn_login_list"method="POST"on-success="_ssnLoginListDataUploaded"><iron-icon class="icon"icon="link"></iron-icon><span>[[t('ssnLoginListDataUpload')]]</span></yp-file-upload></div><yp-ajax id="pagesAjax"on-response="_pagesResponse"></yp-ajax><yp-ajax id="communityFoldersAjax"on-response="_communityFoldersResponse"></yp-ajax><yp-ajax id="ssnLoginListCount"on-response="_ssnLoginListCount"></yp-ajax><yp-ajax id="ssnLoginListDelete"method="DELETE"></yp-ajax></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-community-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior,Polymer.ypCollectionStatusOptions,Polymer.ypGotoBehavior,Polymer.ypTranslatedPagesBehavior],properties:{action:{type:String,value:"/api/communities"},community:{type:Object,observer:"_communityChanged"},hostnameExample:{type:String,computed:"_getExampleHostname(community.hostname)"},communityAccess:{type:String,value:"public"},inCommunityFolderId:{type:String,value:null},availableCommunityFolders:{type:Array,value:null},params:{type:String},method:{type:String},uploadedLogoImageId:{type:String},uploadedHeaderImageId:{type:String},uploadedAppIconImageId:{type:String},status:String,themeId:{type:String,value:null},appHomeScreenIconImageId:String,ssnLoginListDataId:{type:String,value:null},ssnLoginListDataCount:String,hasVideoUpload:{type:Boolean,value:!1},uploadedVideoId:{type:Number,value:null},hasSamlLoginProvider:{type:Boolean,value:!1},descriptionMaxLength:{type:Number,computed:"_getDescriptionMaxLength(community, useReadMoreForDescription,descriptionMaxLengthWithUrl)"},descriptionMaxLengthWithUrl:{type:Number,value:300},hasVideos:{type:Boolean,computed:"_hasVideos(community, uploadedVideoId)"},hasHeaderImage:{type:Boolean,computed:"_hasHeaderImage(community, deleteHeaderImage)"},registrationQuestionsJsonError:{type:Boolean,value:!1},deleteHeaderImage:{type:Boolean,value:!1},useReadMoreForDescription:{type:Boolean,value:!1}},_getDescriptionMaxLength:function(t,e,i){return e?2e3:i||300},_updateReadMoreForDescription:function(){this.set("useReadMoreForDescription",this.$$("#useReadMoreForDescription").checked),this.$$("#description").fire("iron-resize")},_hasVideos:function(t,e){return e||t&&t.CommunityLogoVideos&&0<t.CommunityLogoVideos.length},_hasHeaderImage:function(t,e){return!e&&t&&t.CommunityHeaderImages&&0<t.CommunityHeaderImages.length},_deleteHeaderImage:function(){this.set("deleteHeaderImage",!0)},observers:["_setupTranslation(language,t)"],_descriptionChanged:function(t){var e=t.target.value,i=new RegExp(/(?:https?|http?):\/\/[\n\S]+/g),s=e.match(i);if(s&&0<s.length){for(var o=0,n=0;n<Math.min(s.length,10);n++)o+=s[n].length;var a=300;a+=o,a-=Math.min(o,30*s.length),this.set("descriptionMaxLengthWithUrl",a)}else this.set("descriptionMaxLengthWithUrl",void 0)},_videoUploaded:function(t,e){e.videoId?(this.set("uploadedVideoId",e.videoId),this.set("community.configuration.useVideoCover",!0)):console.log("Trying to set video uploaded again")},_pagesResponse:function(t,e){var i=e.response;i.unshift({id:-1,title:{en:this.t("none")}}),this._setPages(t,i)},_communityFoldersResponse:function(t,e){var i,s=e.response;this.community.id&&(s.forEach(function(t,e){t.id==this.community.id&&(i=e)}.bind(this)),i&&s.splice(i,1));s&&0<s.length?(s.unshift({id:-1,name:this.t("none")}),this.set("availableCommunityFolders",s)):this.set("availableCommunityFolders",null)},_appHomeScreenIconImageUploaded:function(t,e){var i=JSON.parse(e.xhr.response);this.set("appHomeScreenIconImageId",i.id)},_deleteSsnLoginList:function(){this.$.ssnLoginListDelete.url="/api/communities/"+this.community.id+"/"+this.ssnLoginListDataId+"/delete_ssn_login_list",this.$.ssnLoginListDelete.body={},this.$.ssnLoginListDelete.generateRequest(),this.set("ssnLoginListDataId",null),this.set("ssnLoginListDataCount",null)},_ssnLoginListDataUploaded:function(t,e){this.set("ssnLoginListDataId",JSON.parse(e.xhr.response).ssnLoginListDataId),this._getSsnListCount()},_getSsnListCount:function(){this.$.ssnLoginListCount.url="/api/communities/"+this.community.id+"/"+this.ssnLoginListDataId+"/ssn_login_list_count",this.$.ssnLoginListCount.generateRequest()},_ssnLoginListCount:function(t,e){this.set("ssnLoginListDataCount",e.response.count)},_updateEmojiBindings:function(){this.async(function(){var t=this.$$("#description"),e=this.$$("#emojiSelectorDescription");t&&e?e.inputTarget=t:console.warn("Community edit: Can't bind emojis :(")}.bind(this),500)},_getExampleHostname:function(t){return t?t+"."+window.appGlobals.domain.domain_name:"your-hostname."+window.appGlobals.domain.domain_name},_customRedirect:function(e){if(e&&e.hostnameTaken)Polymer.dom(document).querySelector("yp-app").getDialogAsync("errorDialog",function(t){t.showErrorDialog(this.t("hostnameTaken"))}.bind(this));else if(e)if(window.appUser.recheckAdminRights(),this.uploadedVideoId){var t=document.createElement("iron-ajax");t.handleAs="json",t.contentType="application/json",t.url="/api/videos/"+e.id+"/completeAndAddToCommunity",t.method="PUT",t.body={videoId:this.uploadedVideoId,isZiggeo:window.appGlobals.useZiggeo},t.addEventListener("response",function(t){this._finishRedirect(e)}.bind(this)),t.generateRequest()}else this._finishRedirect(e);else console.warn("No community found on custom redirect")},_finishRedirect:function(t){t.is_community_folder?this.redirectTo("/community_folder/"+t.id):this.redirectTo("/community/"+t.id),window.appGlobals.activity("completed","editCommunity")},_communityChanged:function(t){t&&(0===this.community.access?this.communityAccess="public":1===this.community.access?this.communityAccess="closed":2===this.community.access&&(this.communityAccess="secret"),this.community.status&&this.set("status",this.community.status),this.community.in_community_folder_id&&this.set("inCommunityFolderId",this.community.in_community_folder_id)),this._updateEmojiBindings(),window.appGlobals.hasVideoUpload?this.set("hasVideoUpload",!0):this.set("hasVideoUpload",!1),window.appGlobals.domain&&window.appGlobals.domain.samlLoginProvided?this.set("hasSamlLoginProvider",!0):this.set("hasSamlLoginProvider",!1),this.community&&this.community.configuration&&this.community.configuration.ssnLoginListDataId&&(this.set("ssnLoginListDataId",this.community.configuration.ssnLoginListDataId),this._getSsnListCount())},_clear:function(){this.set("community",null),this.set("uploadedLogoImageId",null),this.set("uploadedHeaderImageId",null),this.set("appHomeScreenIconImageId",null),this.set("ssnLoginListDataId",null),this.set("ssnLoginListDataCount",null),this.set("communityFolderId",null),this.set("availableCommunityFolders",null),this.$.headerImageUpload.clear(),this.$.logoImageUpload.clear(),this.$.appHomeScreenIconImageUpload.clear(),this.$$("#videoFileUpload")&&this.$$("#videoFileUpload").clear()},_checkCommunityFolders:function(t){var e;e=t.Domain?t.Domain:window.appGlobals.domain,this.$.communityFoldersAjax.url="/api/domains/"+e.id+"/availableCommunityFolders",this.$.communityFoldersAjax.generateRequest()},setup:function(t,e,i,s,o){t?(this.set("community",t),this.community.configuration&&this.community.configuration.useReadMoreForDescription?this.set("useReadMoreForDescription",!0):this.set("useReadMoreForDescription",!1),this.$.pagesAjax.url="/api/communities/"+t.id+"/pages",this.$.pagesAjax.generateRequest()):this.set("community",{name:"",description:"",access:0,status:"active",community_folder_id:o||null,is_community_folder:s||null}),this._checkCommunityFolders(this.community),this.set("new",e),this.set("refreshFunction",i),this._setupTranslation()},_registrationQuestionsChanged:function(t,e){if(e&&e.value){var i=e.value.trim(),s=!1;try{JSON.parse(i)}catch(t){s=!0}this.set("registrationQuestionsJsonError",s)}else this.set("registrationQuestionsJsonError",!1)},_setupTranslation:function(){this.t&&(this.new?(this.community&&this.community.is_community_folder?this.set("editHeaderText",this.t("newCommunityFolder")):this.set("editHeaderText",this.t("community.new")),this.set("saveText",this.t("create")),this.set("toastText",this.t("communityToastCreated"))):(this.community&&this.community.is_community_folder?this.set("editHeaderText",this.t("updateCommunityFolder")):this.set("editHeaderText",this.t("Update community info")),this.set("saveText",this.t("save")),this.set("toastText",this.t("communityToastUpdated"))))}})</script><dom-module id="yp-group-edit"assetpath="../yp-group/"><template><style include="iron-flex iron-flex-alignment">.access{@apply --layout-horizontal;@apply --layout-center-justified;}.subHeaders{color:#333;font-weight:normal;margin-bottom:8px;margin-top:30px;font-size:22px;width:100%;padding-bottom:8px;border-bottom:2px solid #888;text-align:center;}paper-radio-button{display:block;}.additionalSettings{padding-top:8px;}yp-file-upload{}.half{width:50%;}.config{padding:8px;vertical-align:top;}paper-checkbox{padding-top:8px;}.icon{padding-right:8px;}paper-dropdown-menu{max-width:250px;width:250px;}.categoryName{padding-left:8px;}[hidden]{display:none !important;}.uploadSection{max-width:300px;margin:8px;margin-bottom:0;}.useVideoCover{margin-left:16px;margin-top:4px;}.themeOverrideInfo, .structuredQuestionsInfo{color:#555;font-style:italic;font-size:14px;}.themeOverrideInfo{margin-bottom:8px;}.exteraTopMargin{margin-top:8px;}.defaultPostImage{margin-top:16px;}#structuredQuestionsJsonErrorInfo, #registrationQuestionsJsonErrorInfo, #dataForVisualizationJsonError{margin-top:0px;margin-bottom:8px;color:#F00;font-weight:bold;}a{color:#000;}.allGroupMenus{margin-bottom:16px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog name="groupEdit"id="editDialog"title="[[editHeaderText]]"icon="people"action="[[action]]"method="[[method]]"params="[[params]]"save-text="[[saveText]]"toast-text="[[toastText]]"><template is="dom-if"if="[[group.configuration.actAsLinkToCommunityId]]"><div class="layout horizontal allGroupMenus"hidden$="[[!group.id]]"><a target="_blank"href="/group/[[group.id]]">[[t('fullGroupLinkMenus')]]</a></div></template><paper-input id="name"name="name"type="text"label="[[t('name')]]"value="{{group.name}}"maxlength="50"char-counter=""></paper-input><paper-textarea id="objectives"name="objectives"value="{{group.objectives}}"always-float-label="[[group.objectives]]"label="[[t('group.objectives')]]"char-counter=""rows="2"on-value-changed="_objectivesChanged"max-rows="5"maxlength="[[maxObjectivesLength]]"></paper-textarea><div class="horizontal end-justified layout"><emoji-selector id="emojiSelectorDescription"></emoji-selector></div><div class="layout vertical"><div class="subHeaders">[[t('headerMedia')]]</div><div class="layout horizontal wrap"><div class="layout vertical additionalSettings uploadSection"><yp-file-upload id="logoImageUpload"raised="true"multi="false"target="/api/images?itemType=group-logo"method="POST"on-success="_logoImageUploaded"><iron-icon class="icon"icon="photo-camera"></iron-icon><span>[[t('image.logo.upload')]]</span></yp-file-upload></div><div class="layout horizontal additionalSettings uploadSection"><yp-file-upload id="headerImageUpload"raised="true"multi="false"target="/api/images?itemType=group-header"method="POST"on-success="_headerImageUploaded"><iron-icon class="icon"icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload><paper-icon-button aria-label$="[[t('deleteHeaderImage')]]"class="removeButton layout self-start"icon="delete"on-tap="_deleteHeaderImage"hidden$="[[!hasHeaderImage]]">&gt;</paper-icon-button></div><template is="dom-if"if="[[hasVideoUpload]]"><div class="layout horizontal uploadSection"><yp-file-upload id="videoFileUpload"raised="true"multi="false"video-upload=""method="POST"on-success="_videoUploaded"><iron-icon class="icon"icon="videocam"></iron-icon><span>[[t('uploadVideo')]]</span></yp-file-upload><template is="dom-if"if="[[hasVideos]]"restamp=""><paper-checkbox class="useVideoCover"name="useVideoCover"checked$="{{group.configuration.useVideoCover}}">[[t('useVideoCover')]]</paper-checkbox></template></div></template><input type="hidden"name="uploadedLogoImageId"value="[[uploadedLogoImageId]]"> <input type="hidden"name="uploadedHeaderImageId"value="[[uploadedHeaderImageId]]"> <input type="hidden"name="deleteHeaderImage"value="[[deleteHeaderImage]]"></div><div class="subHeaders exteraTopMargin">[[t('access')]]</div><paper-radio-group id="access"name="access"class="access"selected="{{groupAccess}}"><paper-radio-button name="open_to_community">[[t('group.openToCommunity')]]</paper-radio-button><paper-radio-button name="public">[[t('group.public')]]</paper-radio-button><paper-radio-button name="closed">[[t('group.closed')]]</paper-radio-button><paper-radio-button name="secret">[[t('group.secret')]]</paper-radio-button></paper-radio-group><paper-dropdown-menu label="[[t('status.select')]]"><paper-listbox slot="dropdown-content"attr-for-selected="name"selected="{{status}}"><template is="dom-repeat"items="[[collectionStatusOptions]]"as="statusOption"><paper-item name="[[statusOption.name]]">[[statusOption.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><paper-checkbox name="allowAnonymousUsers"checked$="{{group.configuration.allowAnonymousUsers}}">[[t('allowAnonymousUsers')]]</paper-checkbox><paper-checkbox name="anonymousAskRegistrationQuestions"checked$="{{group.configuration.anonymousAskRegistrationQuestions}}">[[t('anonymousAskRegistrationQuestions')]]</paper-checkbox><paper-checkbox name="allowAnonymousAutoLogin"disabled$="[[!group.configuration.allowAnonymousUsers]]"checked$="{{group.configuration.allowAnonymousAutoLogin}}">[[t('allowAnonymousAutoLogin')]]</paper-checkbox><paper-checkbox name="allowOneTimeLoginWithName"checked$="{{group.configuration.allowOneTimeLoginWithName}}">[[t('allowOneTimeLoginWithName')]]</paper-checkbox><paper-checkbox name="disableFacebookLoginForGroup"checked$="{{group.configuration.disableFacebookLoginForGroup}}">[[t('disableFacebookLoginForGroup')]]</paper-checkbox><paper-checkbox name="forceSecureSamlLogin"disabled$="[[!hasSamlLoginProvider]]"checked$="{{group.configuration.forceSecureSamlLogin}}">[[t('forceSecureSamlLogin')]]</paper-checkbox><paper-checkbox name="forceSecureSamlEmployeeLogin"disabled$="[[!hasSamlLoginProvider]]"checked$="{{group.configuration.forceSecureSamlEmployeeLogin}}">[[t('forceSecureSamlEmployeeLogin')]]</paper-checkbox><input type="hidden"name="status"value="[[status]]"><paper-textarea id="registrationQuestions"name="registrationQuestions"type="text"rows="4"always-float-label="[[group.configuration.registrationQuestions]]"maxrows="8"on-value-changed="_registrationQuestionsChanged"max-rows="8"label="[[t('registrationQuestions')]]"value="{{group.configuration.registrationQuestions}}"></paper-textarea><div id="registrationQuestionsJsonErrorInfo"hidden$="[[!registrationQuestionsJsonError]]">[[t('structuredQuestionsJsonFormatNotValid')]]</div><paper-input id="customBackURL"name="customBackURL"type="text"maxlength="256"label="[[t('customBackURL')]]"value="{{group.configuration.customBackURL}}"></paper-input><paper-input id="customBackName"name="customBackName"type="text"maxlength="20"label="[[t('customBackName')]]"value="{{group.configuration.customBackName}}"></paper-input><paper-input id="optionalSortOrder"name="optionalSortOrder"type="number"allowed-pattern="[0-9]"label="[[t('optionalSortOrder')]]"value="{{group.configuration.optionalSortOrder}}"maxlength="4"></paper-input><div class="subHeaders">[[t('languageSettings')]]</div><yp-language-selector name="defaultLocale"no-user-events=""selected-locale="{{group.configuration.defaultLocale}}"></yp-language-selector><paper-checkbox name="disableNameAutoTranslation"checked$="{{group.configuration.disableNameAutoTranslation}}">[[t('disableNameAutoTranslation')]]</paper-checkbox><div class="subHeaders">[[t('themeSettings')]]</div><paper-checkbox name="inheritThemeFromCommunity"on-checked-changed="_inheritThemeChanged"checked$="{{group.configuration.inheritThemeFromCommunity}}">[[t('inheritThemeFromCommunity')]]</paper-checkbox><yp-theme-selector object="[[group]]"disable-selection="[[group.configuration.inheritThemeFromCommunity]]"selected-theme="{{themeId}}"></yp-theme-selector><paper-input id="themeOverrideColorPrimary"name="themeOverrideColorPrimary"allowed-pattern="[#-#0-9A-Fa-f]"maxlength="7"char-counter=""label="[[t('themeOverrideColorPrimary')]]"value="{{group.configuration.themeOverrideColorPrimary}}"><div prefix="">#</div></paper-input><paper-input id="themeOverrideColorAccent"name="themeOverrideColorAccent"allowed-pattern="[#-#0-9A-Fa-f]"maxlength="7"char-counter=""label="[[t('themeOverrideColorAccent')]]"value="{{group.configuration.themeOverrideColorAccent}}"></paper-input><paper-input id="themeOverrideBackgroundColor"name="themeOverrideBackgroundColor"allowed-pattern="[#-#0-9A-Fa-f]"maxlength="7"char-counter=""label="[[t('themeOverrideBackgroundColor')]]"value="{{group.configuration.themeOverrideBackgroundColor}}"></paper-input><div class="themeOverrideInfo"><em>[[t('themeOverrideColorInfo')]]</em></div><div class="layout vertical"><paper-checkbox name="hideInfoBoxExceptForAdmins"checked$="{{group.configuration.hideInfoBoxExceptForAdmins}}">[[t('hideInfoBoxExceptForAdmins')]]</paper-checkbox><paper-checkbox name="hideLogoBoxExceptOnMobile"checked$="{{group.configuration.hideLogoBoxExceptOnMobile}}">[[t('hideLogoBoxExceptOnMobile')]]</paper-checkbox><paper-checkbox name="hideLogoBoxShadow"checked$="{{group.configuration.hideLogoBoxShadow}}">[[t('hideLogoBoxShadow')]]</paper-checkbox><paper-checkbox name="galleryMode"checked$="{{group.configuration.galleryMode}}">[[t('galleryMode')]]</paper-checkbox><paper-checkbox name="showNameUnderLogoImage"checked$="{{group.configuration.showNameUnderLogoImage}}">[[t('showNameUnderLogoImage')]]</paper-checkbox><paper-checkbox name="alwaysHideLogoImage"checked$="{{group.configuration.alwaysHideLogoImage}}">[[t('alwaysHideLogoImage')]]</paper-checkbox><paper-checkbox name="hideStatsAndMembership"checked$="{{group.configuration.hideStatsAndMembership}}">[[t('hideStatsAndMembership')]]</paper-checkbox><paper-checkbox name="centerGroupName"checked$="{{group.configuration.centerGroupName}}">[[t('centerGroupName')]]</paper-checkbox><paper-checkbox name="noGroupCardShadow"checked$="{{group.configuration.noGroupCardShadow}}">[[t('noGroupCardShadow')]]</paper-checkbox></div><div hidden$="[[isGroupFolder]]"class="layout vertical"><div class="subHeaders">[[t('postSettings')]]</div><paper-checkbox name="canAddNewPosts"checked$="{{canAddNewPosts}}">[[t('group.canAddNewPosts')]]</paper-checkbox><paper-checkbox name="locationHidden"checked$="{{locationHidden}}">[[t('group.locationHidden')]]</paper-checkbox><paper-checkbox name="showWhoPostedPosts"checked$="{{showWhoPostedPosts}}">[[t('group.showWhoPostedPosts')]]</paper-checkbox><paper-checkbox name="askUserIfNameShouldBeDisplayed"checked$="{{group.configuration.askUserIfNameShouldBeDisplayed}}">[[t('askUserIfNameShouldBeDisplayed')]]</paper-checkbox><paper-checkbox name="disableDebate"checked$="{{group.configuration.disableDebate}}">[[t('disableDebate')]]</paper-checkbox><paper-checkbox name="allowAdminsToDebate"checked$="{{group.configuration.allowAdminsToDebate}}">[[t('allowAdminsToDebate')]]</paper-checkbox><paper-input id="postDescriptionLimit"name="postDescriptionLimit"type="text"allowed-pattern="[0-9]"label="[[t('postDescriptionLimit')]]"value="{{group.configuration.postDescriptionLimit}}"maxlength="4"char-counter=""></paper-input><paper-checkbox name="allowPostVideoUploads"disabled$="[[!hasVideoUpload]]"checked$="{{allowPostVideoUploads}}">[[t('allowPostVideoUploads')]]</paper-checkbox><paper-input id="videoPostUploadLimitSec"name="videoPostUploadLimitSec"allowed-pattern="[0-9]"maxlength="3"type="number"disabled$="[[!hasVideoUpload]]"label="[[t('videoPostUploadLimitSec')]]"value="{{group.configuration.videoPostUploadLimitSec}}"></paper-input><paper-checkbox name="allowPostAudioUploads"disabled$="[[!hasAudioUpload]]"checked$="{{allowPostAudioUploads}}">[[t('allowPostAudioUploads')]]</paper-checkbox><paper-input id="audioPostUploadLimitSec"name="audioPostUploadLimitSec"allowed-pattern="[0-9]"maxlength="3"type="number"disabled$="[[!hasaudioUpload]]"label="[[t('audioPostUploadLimitSec')]]"value="{{group.configuration.audioPostUploadLimitSec}}"></paper-input><paper-input id="customTitleQuestionText"name="customTitleQuestionText"maxlength="60"label="[[t('customTitleQuestionText')]]"value="{{group.configuration.customTitleQuestionText}}"></paper-input><paper-input id="hideNameInputAndReplaceWith"name="hideNameInputAndReplaceWith"maxlength="60"label="[[t('hideNameInputAndReplaceWith')]]"value="{{group.configuration.hideNameInputAndReplaceWith}}"></paper-input><paper-input id="customTabTitleNewLocation"name="customTabTitleNewLocation"maxlength="60"label="[[t('customTabTitleNewLocation')]]"value="{{group.configuration.customTabTitleNewLocation}}"></paper-input><paper-input id="customCategoryQuestionText"name="customCategoryQuestionText"type="text"label="[[t('customCategoryQuestionText')]]"value="{{group.configuration.customCategoryQuestionText}}"maxlength="30"char-counter=""></paper-input><paper-input id="customFilterText"name="customFilterText"type="text"label="[[t('customFilterText')]]"value="{{group.configuration.customFilterText}}"maxlength="17"char-counter=""></paper-input><paper-checkbox name="makeCategoryRequiredOnNewPost"checked$="{{group.configuration.makeCategoryRequiredOnNewPost}}">[[t('makeCategoryRequiredOnNewPost')]]</paper-checkbox><paper-checkbox name="showVideoUploadDisclaimer"checked$="{{group.configuration.showVideoUploadDisclaimer}}">[[t('showVideoUploadDisclaimer')]]</paper-checkbox><paper-checkbox name="moreContactInformation"checked$="{{group.configuration.moreContactInformation}}">[[t('moreContactInformation')]]</paper-checkbox><paper-checkbox name="moreContactInformationAddress"checked$="{{group.configuration.moreContactInformationAddress}}">[[t('moreContactInformationAddress')]]</paper-checkbox><paper-checkbox name="attachmentsEnabled"checked$="{{group.configuration.attachmentsEnabled}}">[[t('attachmentsEnabled')]]</paper-checkbox><paper-checkbox name="useContainImageMode"checked$="{{group.configuration.useContainImageMode}}">[[t('useContainImageMode')]]</paper-checkbox><paper-checkbox name="hideNewestFromFilter"checked$="{{group.configuration.hideNewestFromFilter}}">[[t('hideNewestFromFilter')]]</paper-checkbox><paper-checkbox name="hideNewPost"checked$="{{group.configuration.hideNewPost}}">[[t('hideNewPost')]]</paper-checkbox><paper-checkbox name="hideRecommendationOnNewsFeed"checked$="{{group.configuration.hideRecommendationOnNewsFeed}}">[[t('hideRecommendationOnNewsFeed')]]</paper-checkbox><paper-checkbox name="hideNewPostOnPostPage"checked$="{{hideNewPostOnPostPage}}">[[t('hideNewPostOnPostPage')]]</paper-checkbox><paper-checkbox name="hidePostCover"checked$="{{group.configuration.hidePostCover}}">[[t('hidePostCover')]]</paper-checkbox><paper-checkbox name="hidePostDescription"checked$="{{group.configuration.hidePostDescription}}">[[t('hidePostDescription')]]</paper-checkbox><paper-checkbox name="hidePostActionsInGrid"checked$="{{group.configuration.hidePostActionsInGrid}}">[[t('hidePostActionsInGrid')]]</paper-checkbox><paper-checkbox name="hideDebateIcon"checked$="{{group.configuration.hideDebateIcon}}">[[t('hideDebateIcon')]]</paper-checkbox><paper-checkbox name="hideSharing"checked$="{{group.configuration.hideSharing}}">[[t('hideSharing')]]</paper-checkbox><paper-checkbox name="hideEmoji"checked$="{{hideEmoji}}">[[t('hideEmoji')]]</paper-checkbox><paper-checkbox name="hidePostFilterAndSearch"checked$="{{group.configuration.hidePostFilterAndSearch}}">[[t('hidePostFilterAndSearch')]]</paper-checkbox><paper-checkbox name="hideMediaInput"checked$="{{group.configuration.hideMediaInput}}">[[t('hideMediaInput')]]</paper-checkbox><paper-checkbox name="hidePostImageUploads"disabled$="[[!hasVideoUpload]]"checked$="{{group.configuration.hidePostImageUploads}}">[[t('hidePostImageUploads')]]</paper-checkbox><paper-checkbox name="disablePostPageLink"checked$="{{group.configuration.disablePostPageLink}}">[[t('disablePostPageLink')]]</paper-checkbox><paper-input id="defaultLocationLongLat"name="defaultLocationLongLat"type="text"label="[[t('defaultLocationLongLat')]]"value="{{group.configuration.defaultLocationLongLat}}"maxlength="100"style="width: 300px;"></paper-input><paper-input id="forcePostSortMethodAs"name="forcePostSortMethodAs"type="text"label="[[t('forcePostSortMethodAs')]]"value="{{group.configuration.forcePostSortMethodAs}}"maxlength="12"></paper-input><paper-input id="descriptionTruncateAmount"name="descriptionTruncateAmount"type="text"allowed-pattern="[0-9]"label="[[t('descriptionTruncateAmount')]]"value="{{group.configuration.descriptionTruncateAmount}}"maxlength="4"></paper-input><paper-checkbox name="descriptionSimpleFormat"checked$="{{group.configuration.descriptionSimpleFormat}}">[[t('descriptionSimpleFormat')]]</paper-checkbox><paper-checkbox name="transcriptSimpleFormat"checked$="{{group.configuration.transcriptSimpleFormat}}">[[t('transcriptSimpleFormat')]]</paper-checkbox><paper-checkbox name="allPostsBlockedByDefault"checked$="{{group.configuration.allPostsBlockedByDefault}}">[[t('allPostsBlockedByDefault')]]</paper-checkbox><paper-checkbox name="exportSubCodesForRadiosAndCheckboxes"checked$="{{group.configuration.exportSubCodesForRadiosAndCheckboxes}}">[[t('exportSubCodesForRadiosAndCheckboxes')]]</paper-checkbox><paper-textarea id="structuredQuestions"name="structuredQuestions"type="text"rows="4"always-float-label="[[group.configuration.structuredQuestions]]"maxrows="8"on-value-changed="_structuredQuestionsChanged"max-rows="8"label="[[t('structuredQuestions')]]"value="{{group.configuration.structuredQuestions}}"></paper-textarea><div id="structuredQuestionsJsonErrorInfo"hidden$="[[!structuredQuestionsJsonError]]">[[t('structuredQuestionsJsonFormatNotValid')]]</div><div class="structuredQuestionsInfo">[[t('structuredQuestionsInfo')]]</div><div class="layout vertical additionalSettings uploadSection"><yp-file-upload id="docxSurveyUpload"raised="true"multi="false"target="/api/groups/-1/convert_docx_survey_to_json"accept="application/vnd.openxmlformats-officedocument.wordprocessingml.document"method="PUT"on-success="_haveUploadedDocxSurvey"><iron-icon class="icon"icon="sort"></iron-icon><span>[[t('uploadDocxSurveyFormat')]]</span></yp-file-upload></div><paper-input id="alternativeTextForNewIdeaButton"name="alternativeTextForNewIdeaButton"type="text"label="[[t('alternativeTextForNewIdeaButton')]]"value="{{group.configuration.alternativeTextForNewIdeaButton}}"maxlength="30"char-counter=""></paper-input><paper-input id="alternativeTextForNewIdeaButtonClosed"name="alternativeTextForNewIdeaButtonClosed"type="text"label="[[t('alternativeTextForNewIdeaButtonClosed')]]"value="{{group.configuration.alternativeTextForNewIdeaButtonClosed}}"maxlength="30"char-counter=""></paper-input><paper-input id="alternativeTextForNewIdeaButtonHeader"name="alternativeTextForNewIdeaButtonHeader"type="text"label="[[t('alternativeTextForNewIdeaButtonHeader')]]"value="{{group.configuration.alternativeTextForNewIdeaButtonHeader}}"maxlength="30"char-counter=""></paper-input><paper-input id="alternativeTextForNewIdeaSaveButton"name="alternativeTextForNewIdeaSaveButton"type="text"label="[[t('alternativeTextForNewIdeaSaveButton')]]"value="{{group.configuration.alternativeTextForNewIdeaSaveButton}}"maxlength="20"char-counter=""></paper-input><paper-input id="customThankYouTextNewPosts"name="customThankYouTextNewPosts"type="text"char-counter=""label="[[t('customThankYouTextNewPosts')]]"value="{{group.configuration.customThankYouTextNewPosts}}"maxlength="120"></paper-input><div class="layout vertical additionalSettings defaultPostImage"><yp-file-upload id="defaultPostImageUpload"raised="true"multi="false"target="/api/images?itemType=group-logo"method="POST"on-success="_defaultPostImageUploaded"><iron-icon class="icon"icon="photo-camera"></iron-icon><span>[[t('defaultPostImage')]]</span></yp-file-upload></div><div class="layout horizontal"><div class="layout vertical additionalSettings"><yp-file-upload id="defaultDataImageUpload"raised="true"multi="false"target="/api/images?itemType=group-logo"method="POST"on-success="_defaultDataImageUploaded"><iron-icon class="icon"icon="photo-camera"></iron-icon><span>[[t('defaultDataImage')]]</span></yp-file-upload></div><input type="hidden"name="uploadedDefaultDataImageId"value="[[uploadedDefaultDataImageId]]"></div><input type="hidden"name="canVote"value$="[[canVote]]"> <input type="hidden"name="canAddNewPosts"value$="[[canAddNewPosts]]"> <input type="hidden"name="locationHidden"value$="[[locationHidden]]"> <input type="hidden"name="showWhoPostedPosts"value$="[[showWhoPostedPosts]]"> <input type="hidden"name="themeId"value="[[themeId]]"> <input type="hidden"name="uploadedDefaultPostImageId"value="[[uploadedDefaultPostImageId]]"><div class="subHeaders exteraTopMargin">[[t('voteSettings')]]</div><div class="layout horizontal"><paper-dropdown-menu label="[[t('endorsementButtons')]]"disabled$="[[endorsementButtonsDisabled]]"><paper-listbox slot="dropdown-content"attr-for-selected="name"selected="{{endorsementButtons}}"><template is="dom-repeat"items="[[endorsementButtonsOptions]]"as="buttonsSelection"><paper-item name="[[buttonsSelection.name]]">[[buttonsSelection.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden"name="endorsementButtons"value="[[endorsementButtons]]"></div><paper-checkbox name="canVote"checked$="{{canVote}}">[[t('group.canVote')]]</paper-checkbox><paper-checkbox name="hideVoteCount"checked$="{{group.configuration.hideVoteCount}}">[[t('hideVoteCount')]]</paper-checkbox><paper-checkbox name="hideVoteCountUntilVoteCompleted"checked$="{{group.configuration.hideVoteCountUntilVoteCompleted}}">[[t('hideVoteCountUntilVoteCompleted')]]</paper-checkbox><paper-checkbox name="hideDownVoteForPost"checked$="{{group.configuration.hideDownVoteForPost}}">[[t('hideDownVoteForPost')]]</paper-checkbox><paper-input id="maxNumberOfGroupVotes"name="maxNumberOfGroupVotes"type="text"allowed-pattern="[0-9]"label="[[t('maxNumberOfGroupVotes')]]"value="{{group.configuration.maxNumberOfGroupVotes}}"maxlength="4"></paper-input><paper-input id="customVoteUpHoverText"name="customVoteUpHoverText"type="text"label="[[t('customVoteUpHoverText')]]"value="{{group.configuration.customVoteUpHoverText}}"maxlength="100"char-counter=""></paper-input><paper-input id="customVoteDownHoverText"name="customVoteDownHoverText"type="text"label="[[t('customVoteDownHoverText')]]"value="{{group.configuration.customVoteDownHoverText}}"maxlength="100"char-counter=""></paper-input><paper-textarea id="customRatingsText"name="customRatingsText"type="text"rows="2"on-value-changed="_customRatingsTextChanged"always-float-label="[[group.configuration.customRatingsText]]"maxrows="2"label="[[t('customRatings')]]"value="{{group.configuration.customRatingsText}}"></paper-textarea><div class="structuredQuestionsInfo">[[t('customRatingsInfo')]]</div><div class="subHeaders">[[t('pointSettings')]]</div><paper-checkbox name="newPointOptional"checked$="{{newPointOptional}}">[[t('newPointOptional')]]</paper-checkbox><paper-checkbox name="hideNewPointOnNewIdea"checked$="{{group.configuration.hideNewPointOnNewIdea}}">[[t('hideNewPointOnNewIdea')]]</paper-checkbox><paper-checkbox name="hidePointAuthor"checked$="{{group.configuration.hidePointAuthor}}">[[t('hidePointAuthor')]]</paper-checkbox><paper-checkbox name="hidePointAgainst"checked$="{{group.configuration.hidePointAgainst}}">[[t('hidePointAgainst')]]</paper-checkbox><paper-input id="pointCharLimit"name="pointCharLimit"type="text"allowed-pattern="[0-9]"label="[[t('pointCharLimit')]]"value="{{group.configuration.pointCharLimit}}"maxlength="4"></paper-input><paper-input id="alternativePointForHeader"name="alternativePointForHeader"type="text"label="[[t('alternativePointForHeader')]]"value="{{group.configuration.alternativePointForHeader}}"maxlength="100"char-counter=""></paper-input><paper-input id="alternativePointAgainstHeader"name="alternativePointAgainstHeader"type="text"label="[[t('alternativePointAgainstHeader')]]"value="{{group.configuration.alternativePointAgainstHeader}}"maxlength="100"char-counter=""></paper-input><paper-input id="alternativePointForLabel"name="alternativePointForLabel"type="text"label="[[t('alternativePointForLabel')]]"value="{{group.configuration.alternativePointForLabel}}"maxlength="100"char-counter=""></paper-input><paper-input id="alternativePointAgainstLabel"name="alternativePointAgainstLabel"type="text"label="[[t('alternativePointAgainstLabel')]]"value="{{group.configuration.alternativePointAgainstLabel}}"maxlength="100"char-counter=""></paper-input><paper-checkbox name="allowPointVideoUploads"disabled$="[[!hasVideoUpload]]"checked$="{{allowPointVideoUploads}}">[[t('allowPointVideoUploads')]]</paper-checkbox><paper-input id="videoPointUploadLimitSec"name="videoPointUploadLimitSec"type="text"maxlength="3"allowed-pattern="[0-9]"disabled$="[[!hasVideoUpload]]"label="[[t('videoPointUploadLimitSec')]]"value="{{group.configuration.videoPointUploadLimitSec}}"></paper-input><paper-checkbox name="allowPointAudioUploads"disabled$="[[!hasAudioUpload]]"checked$="{{allowPointAudioUploads}}">[[t('allowPointAudioUploads')]]</paper-checkbox><paper-input id="audioPointUploadLimitSec"name="audioPointUploadLimitSec"type="text"maxlength="3"allowed-pattern="[0-9]"disabled$="[[!hasaudioUpload]]"label="[[t('audioPointUploadLimitSec')]]"value="{{group.configuration.audioPointUploadLimitSec}}"></paper-input><paper-checkbox name="disableMachineTranscripts"checked$="{{group.configuration.disableMachineTranscripts}}">[[t('disableMachineTranscripts')]]</paper-checkbox><paper-checkbox name="allowAdminAnswersToPoints"checked$="{{group.configuration.allowAdminAnswersToPoints}}">[[t('allowAdminAnswersToPoints')]]</paper-checkbox><paper-input id="customAdminCommentsTitle"name="customAdminCommentsTitle"type="text"label="[[t('customAdminCommentsTitle')]]"value="{{group.configuration.customAdminCommentsTitle}}"maxlength="50"char-counter=""></paper-input><div class="subHeaders">[[t('additionalGroupConfig')]]</div><paper-checkbox name="hideAllTabs"checked$="{{hideAllTabs}}">[[t('hideAllTabs')]]</paper-checkbox><paper-checkbox name="hideGroupLevelTabs"checked$="{{group.configuration.hideGroupLevelTabs}}">[[t('hideGroupLevelTabs')]]</paper-checkbox><paper-checkbox name="hideHelpIcon"checked$="{{hideHelpIcon}}">[[t('hideHelpIcon')]]</paper-checkbox><paper-checkbox name="useCommunityTopBanner"checked$="{{group.configuration.useCommunityTopBanner}}">[[t('useCommunityTopBanner')]]</paper-checkbox><paper-checkbox name="makeMapViewDefault"checked$="{{group.configuration.makeMapViewDefault}}">[[t('makeMapViewDefault')]]</paper-checkbox><paper-checkbox name="simpleFormatDescription"checked$="{{group.configuration.simpleFormatDescription}}">[[t('simpleFormatDescription')]]</paper-checkbox><paper-checkbox name="resourceLibraryLinkMode"checked$="{{group.configuration.resourceLibraryLinkMode}}">[[t('resourceLibraryLinkMode')]]</paper-checkbox><paper-checkbox name="collapsableTranscripts"checked$="{{group.configuration.collapsableTranscripts}}">[[t('collapsableTranscripts')]]</paper-checkbox><paper-checkbox name="allowWhatsAppSharing"checked$="{{group.configuration.allowWhatsAppSharing}}">[[t('allowWhatsAppSharing')]]</paper-checkbox><paper-input id="actAsLinkToCommunityId"name="actAsLinkToCommunityId"type="number"allowed-pattern="[0-9]"label="[[t('actAsLinkToCommunityId')]]"value="{{group.configuration.actAsLinkToCommunityId}}"maxlength="8"></paper-input><paper-input id="maxDaysBackForRecommendations"name="maxDaysBackForRecommendations"type="text"maxlength="5"allowed-pattern="[0-9]"label="[[t('maxDaysBackForRecommendations')]]"value="{{group.configuration.maxDaysBackForRecommendations}}"></paper-input><paper-input id="customUserNamePrompt"name="customUserNamePrompt"type="text"label="[[t('customUserNamePrompt')]]"value="{{group.configuration.customUserNamePrompt}}"maxlength="45"char-counter=""></paper-input><paper-input id="customTermsIntroText"name="customTermsIntroText"type="text"label="[[t('customTermsIntroText')]]"value="{{group.configuration.customTermsIntroText}}"maxlength="100"char-counter=""></paper-input><paper-input id="externalGoalTriggerUrl"name="externalGoalTriggerUrl"type="text"label="[[t('externalGoalTriggerUrl')]]"value="{{group.configuration.externalGoalTriggerUrl}}"></paper-input><paper-input id="externalId"name="externalId"type="text"label="[[t('externalId')]]"value="{{group.configuration.externalId}}"></paper-input><paper-checkbox name="usePostListFormatOnDesktop"checked$="{{group.configuration.usePostListFormatOnDesktop}}">[[t('usePostListFormatOnDesktop')]]</paper-checkbox><paper-checkbox name="usePostTags"checked$="{{group.configuration.usePostTags}}">[[t('usePostTags')]]</paper-checkbox><paper-checkbox name="usePostTagsForPostListItems"checked$="{{group.configuration.usePostTagsForPostListItems}}">[[t('usePostTagsForPostListItems')]]</paper-checkbox><paper-checkbox name="usePostTagsForPostCards"checked$="{{group.configuration.usePostTagsForPostCards}}">[[t('usePostTagsForPostCards')]]</paper-checkbox><paper-checkbox name="forceShowDebateCountOnPost"checked$="{{group.configuration.forceShowDebateCountOnPost}}">[[t('forceShowDebateCountOnPost')]]</paper-checkbox><paper-checkbox name="closeNewsfeedSubmissions"checked$="{{group.configuration.closeNewsfeedSubmissions}}">[[t('closeNewsfeedSubmissions')]]</paper-checkbox><paper-checkbox name="hideNewsfeeds"checked$="{{group.configuration.hideNewsfeeds}}">[[t('hideNewsfeeds')]]</paper-checkbox><div class="layout horizontal config"hidden$="[[!pages]]"><paper-dropdown-menu label="[[t('welcomeSelectPage')]]"><paper-listbox slot="dropdown-content"attr-for-selected="name"selected="{{group.configuration.welcomePageId}}"><template is="dom-repeat"items="[[translatedPages]]"as="page"><paper-item name="[[page.id]]"data-args$="[[index]]">[[_getLocalizePageTitle(page)]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden"name="welcomePageId"value="[[group.configuration.welcomePageId]]"></div><paper-input id="urlToReview"name="urlToReview"type="text"label="[[t('urlToReview')]]"value="{{group.configuration.urlToReview}}"></paper-input><paper-input id="urlToReviewActionText"name="urlToReviewActionText"type="text"label="[[t('urlToReviewActionText')]]"value="{{group.configuration.urlToReviewActionText}}"maxlength="30"char-counter=""></paper-input><paper-checkbox id="isDataVisualizationGroup"name="isDataVisualizationGroup"on-tap="_isDataVisualizationGroupClick"checked$="{{group.configuration.isDataVisualizationGroup}}">[[t('isDataVisualizationGroup')]]</paper-checkbox><paper-textarea id="dataForVisualization"name="dataForVisualization"type="text"hidden$="[[!isDataVisualizationGroup]]"rows="4"always-float-label="[[group.configuration.dataForVisualization]]"maxrows="8"on-value-changed="_dataForVisualizationChanged"max-rows="8"label="[[t('dataForVisualization')]]"value="{{group.configuration.dataForVisualization}}"></paper-textarea><div id="dataForVisualizationJsonError"hidden$="[[!dataForVisualizationJsonError]]">[[t('structuredQuestionsJsonFormatNotValid')]]</div><template is="dom-if"if="[[groupMoveToOptions]]"restamp=""><div class="layout horizontal config"><paper-dropdown-menu name="moveGroupTo"label="[[t('moveGroupTo')]]"><paper-listbox slot="dropdown-content"attr-for-selected="name"><template is="dom-repeat"items="[[groupMoveToOptions]]"as="option"><paper-item name="[[option.id]]"data-args$="[[index]]">[[option.name]]</paper-item></template></paper-listbox></paper-dropdown-menu></div></template><div class="layout vertical config"hidden$="[[!group.Categories]]"><div class="subHeaders">[[t('categories.the_all')]]</div><template is="dom-repeat"items="[[group.Categories]]"as="category"><paper-item data-category$="[[category]]"data-category-name$="[[category.name]]"on-tap="_openCategoryEdit"><img sizing="cover"height="24"width="24"class="filterIcon"src="[[_categoryImageSrc(category)]]"> <span class="categoryName">[[category.name]] - [[category.id]]</span></paper-item></template></div></div></div><input type="hidden"name="hideAllTabs"value$="[[hideAllTabs]]"> <input type="hidden"name="hideNewPostOnPostPage"value$="[[hideNewPostOnPostPage]]"> <input type="hidden"name="newPointOptional"value$="[[newPointOptional]]"> <input type="hidden"name="hideHelpIcon"value$="[[hideHelpIcon]]"> <input type="hidden"name="hideEmoji"value$="[[hideEmoji]]"> <input type="hidden"name="hideGroupHeader"value$="[[hideGroupHeader]]"> <input type="hidden"name="allowPostVideoUploads"value$="[[allowPostVideoUploads]]"> <input type="hidden"name="allowPointVideoUploads"value$="[[allowPointVideoUploads]]"> <input type="hidden"name="allowPostAudioUploads"value$="[[allowPostAudioUploads]]"> <input type="hidden"name="allowPointAudioUploads"value$="[[allowPointAudioUploads]]"> <input type="hidden"name="in_group_folder_id"value="[[inGroupFolderId]]"> <input type="hidden"name="is_group_folder"value="[[isGroupFolder]]"><yp-ajax id="pagesAjax"on-response="_pagesResponse"></yp-ajax><yp-ajax id="groupMoveToOptionsAjax"disable-user-error=""on-response="_groupMoveToOptionsResponse"></yp-ajax></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-group-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior,Polymer.ypCollectionStatusOptions,Polymer.ypGotoBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypTranslatedPagesBehavior],properties:{canVote:{type:Boolean,value:!0},canAddNewPosts:{type:Boolean,value:!0},showWhoPostedPosts:{type:Boolean,value:!1},hideAllTabs:Boolean,hideNewPostOnPostPage:Boolean,newPointOptional:Boolean,hideHelpIcon:Boolean,hideEmoji:Boolean,hideGroupHeader:Boolean,action:{type:String,value:"/api/groups"},group:{type:Object,observer:"_groupChanged"},community:{type:Object},groupAccess:{type:String,value:"public"},uploadedLogoImageId:{type:String},uploadedHeaderImageId:{type:String},uploadedDefaultDataImageId:{type:String},uploadedDefaultPostImageId:{type:String},allowPostVideoUploads:{type:Boolean,value:null},allowPointVideoUploads:{type:Boolean,value:null},allowPostAudioUploads:{type:Boolean,value:null},allowPointAudioUploads:{type:Boolean,value:null},endorsementButtonsDisabled:{type:Boolean,value:!1},status:String,publicCommunity:{type:Boolean,value:!1},themeId:{type:String,value:null},locationHidden:Boolean,endorsementButtonsOptions:{type:Object,computed:"_endorsementButtonsOptions(language)"},endorsementButtons:String,hasSamlLoginProvider:{type:Boolean,value:!1},hasVideoUpload:{type:Boolean,value:!1},hasAudioUpload:{type:Boolean,value:!1},uploadedVideoId:{type:Number,value:null},structuredQuestionsJsonError:{type:Boolean,value:!1},registrationQuestionsJsonError:{type:Boolean,value:!1},dataForVisualizationJsonError:{type:Boolean,value:!1},maxObjectivesLength:{type:Number,value:300},isDataVisualizationGroup:{type:Boolean,value:!1},hasVideos:{type:Boolean,computed:"_hasVideos(group, uploadedVideoId)"},hasHeaderImage:{type:Boolean,computed:"_hasHeaderImage(group, deleteHeaderImage)"},deleteHeaderImage:{type:Boolean,value:!1},inGroupFolderId:{type:Number},isGroupFolder:{type:Boolean,value:!1},groupMoveToOptions:{type:Array,value:null}},_hasVideos:function(t,e){return e||t&&t.GroupLogoVideos&&0<t.GroupLogoVideos.length},_hasHeaderImage:function(t,e){return!e&&t&&t.GroupHeaderImages&&0<t.GroupHeaderImages.length},_deleteHeaderImage:function(){this.set("deleteHeaderImage",!0)},_isDataVisualizationGroupClick:function(){this.set("isDataVisualizationGroup",this.$$("#isDataVisualizationGroup").checked)},_inheritThemeChanged:function(t,e){e.value&&!0===e.value?(this.$$("yp-theme-selector").disableSelection=!0,this.$$("yp-theme-selector").selectedTheme=null):this.$$("yp-theme-selector")&&(this.$$("yp-theme-selector").disableSelection=!1)},_objectivesChanged:function(t){var e=t.target.value,o=new RegExp(/(?:https?|http?):\/\/[\n\S]+/g),i=e.match(o);if(i&&0<i.length){for(var s=0,n=0;n<Math.min(i.length,10);n++)s+=i[n].length;var a=300;a+=s,a-=Math.min(s,30*i.length),this.set("maxObjectivesLength",a)}},_structuredQuestionsChanged:function(t,e){if(e&&e.value){var o=e.value.trim();if(o.startsWith("[")||o.startsWith("{")){var i=!1;try{JSON.parse(o)}catch(t){i=!0}this.set("structuredQuestionsJsonError",i)}else this.set("structuredQuestionsJsonError",!1)}else this.set("structuredQuestionsJsonError",!1)},_registrationQuestionsChanged:function(t,e){if(e&&e.value){var o=e.value.trim(),i=!1;try{JSON.parse(o)}catch(t){i=!0}this.set("registrationQuestionsJsonError",i)}else this.set("registrationQuestionsJsonError",!1)},_dataForVisualizationChanged:function(t,e){if(e&&e.value){var o=e.value.trim();try{JSON.parse(o)}catch(t){!0}}else this.set("dataForVisualizationJsonError",!1)},_customRatingsTextChanged:function(t,e){e.value&&""!==e.value?this.set("endorsementButtonsDisabled",!0):this.set("endorsementButtonsDisabled",!1)},_videoUploaded:function(t,e){e.videoId?(this.set("uploadedVideoId",e.videoId),this.set("group.configuration.useVideoCover",!0)):console.log("Trying to set video uploaded again")},observers:["_setupTranslation(language,t)"],_openCategoryEdit:function(e){window.appGlobals.activity("open","category.new"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("categoryEdit",function(t){t.setup(this.group,!1,this._refreshCategories.bind(this),this._deleteCategory.bind(this),e.model.category),t.open("edit",{categoryId:e.model.category.id})}.bind(this))},_deleteCategory:function(e){var o=[];__.each(this.group.Categories,function(t){t.id!==e.id&&o.push(t)}),this.set("group.Categories",o)},_refreshCategories:function(e){var o=[];__.each(this.group.Categories,function(t){t.id===e.id?o.push(e):o.push(t)}),this.set("group.Categories",o)},_categoryImageSrc:function(t){return this.getImageFormatUrl(t.CategoryIconImages,0)},_endorsementButtonsOptions:function(){return this.t?[{name:"hearts",translatedName:this.t("endorsementButtonsHeart")},{name:"arrows",translatedName:this.t("endorsementArrows")},{name:"thumbs",translatedName:this.t("endorsementThumbs")},{name:"hats",translatedName:this.t("endorsementHats")}]:[]},_updateEmojiBindings:function(){this.async(function(){var t=this.$$("#objectives"),e=this.$$("#emojiSelectorDescription");t&&e?e.inputTarget=t:console.warn("Group edit: Can't bind emojis :(")}.bind(this),500)},_publicCommunity:function(t){return!!t&&0===t.Community.access},_customRedirect:function(e){if(e)if(window.appUser.recheckAdminRights(),this.uploadedVideoId){var t=document.createElement("iron-ajax");t.handleAs="json",t.contentType="application/json",t.url="/api/videos/"+e.id+"/completeAndAddToGroup",t.method="PUT",t.body={videoId:this.uploadedVideoId,isZiggeo:window.appGlobals.useZiggeo},t.addEventListener("response",function(t){this._finishRedirect(e)}.bind(this)),t.generateRequest()}else this._finishRedirect(e);else console.warn("No group found on custom redirect")},_finishRedirect:function(t){t&&t.configuration.isDataVisualizationGroup?this.redirectTo("/group_data_viz/"+t.id):t&&t.is_group_folder?this.redirectTo("/group_folder/"+t.id):this.redirectTo("/group/"+t.id),window.appGlobals.activity("complete","editGroup")},_groupChanged:function(t){t&&(0==t.access?this.groupAccess="public":1==t.access?this.groupAccess="closed":2==t.access?this.groupAccess="secret":3==t.access&&(this.groupAccess="open_to_community"),t&&t.status&&this.set("status",t.status),t.configuration&&null!=t.configuration.canVote?(this.set("canVote",t.configuration.canVote),this.set("canAddNewPosts",t.configuration.canAddNewPosts)):(this.set("canVote",!0),this.set("canAddNewPosts",!0)),t.configuration&&null!=t.configuration.endorsementButtons?this.set("endorsementButtons",t.configuration.endorsementButtons):this.set("endorsementButtons","hearts"),this._setFromConfiguration("locationHidden"),this._setFromConfiguration("hideAllTabs"),this._setFromConfiguration("hideNewPostOnPostPage"),this._setFromConfiguration("newPointOptional"),this._setFromConfiguration("hideHelpIcon"),this._setFromConfiguration("hideEmoji"),this._setFromConfiguration("hideGroupHeader"),this._setFromConfiguration("showWhoPostedPosts"),this._setFromConfiguration("allowPostVideoUploads",!0),this._setFromConfiguration("allowPointVideoUploads",!0),this._setFromConfiguration("allowPostAudioUploads",!0),this._setFromConfiguration("allowPointAudioUploads",!0),t.configuration&&t.configuration.isDataVisualizationGroup&&this.set("isDataVisualizationGroup",!0),this.async(function(){this.community?0==this.community.access?this.set("publicCommunity",!0):this.set("publicCommunity",!1):t&&t.Community&&(0==t.Community.access?this.set("publicCommunity",!0):this.set("publicCommunity",!1))}),t&&t.id||!window.appGlobals.hasVideoUpload||(null===this.allowPostVideoUploads&&this.set("allowPostVideoUploads",!0),null===this.allowPointVideoUploads&&this.set("allowPointVideoUploads",!0)),window.appGlobals.hasVideoUpload?this.set("hasVideoUpload",!0):this.set("hasVideoUpload",!1),t&&t.id||!window.appGlobals.hasAudioUpload||(null===this.allowPostAudioUploads&&this.set("allowPostAudioUploads",!0),null===this.allowPointAudioUploads&&this.set("allowPointAudioUploads",!0)),window.appGlobals.hasAudioUpload?this.set("hasAudioUpload",!0):this.set("hasAudioUpload",!1),t.configuration&&t.configuration.structuredQuestions&&this._structuredQuestionsChanged(null,{value:t.configuration.structuredQuestions})),this._updateEmojiBindings(),window.appGlobals.domain&&window.appGlobals.domain.samlLoginProvided?this.set("hasSamlLoginProvider",!0):this.set("hasSamlLoginProvider",!1)},_setFromConfiguration:function(t,e){this.group.configuration&&null!=this.group.configuration[t]&&""!==this.group.configuration[t]?this.set(t,this.group.configuration[t]):this.set(t,!!e&&null)},_clear:function(){this.set("group",null),this.set("uploadedLogoImageId",null),this.set("uploadedHeaderImageId",null),this.set("uploadedDefaultDataImageId",null),this.set("uploadedVideoId",null),this.$$("#videoFileUpload")&&this.$$("#videoFileUpload").clear(),this.$$("#headerImageUpload")&&this.$$("#headerImageUpload").clear(),this.$$("#logoImageUpload")&&this.$$("#logoImageUpload").clear(),this.$$("#defaultDataImageUpload")&&this.$$("#defaultDataImageUpload").clear()},setup:function(t,e,o){if(t){if(t.configuration){if(t.configuration.customRatings&&!t.configuration.customRatingsText){var i="";t.configuration.customRatings.forEach(function(t){i+=t.name+","+t.numberOf+","+t.emoji+","}),i=i.substring(0,i.length-1),t.configuration.customRatingsText=i}void 0!==t.theme_id&&null!==t.theme_id||(t.configuration.inheritThemeFromCommunity=!0)}t.is_group_folder?this.set("isGroupFolder",!0):this.set("isGroupFolder",!1),t.in_group_folder_id?this.set("inGroupFolderId",t.inGroupFolderId):this.set("inGroupFolderId",void 0),this.set("group",t),this.$.pagesAjax.url="/api/groups/"+t.id+"/pages",this.$.pagesAjax.generateRequest(),this.$.groupMoveToOptionsAjax.url="/api/communities/"+t.community_id+"/group_folders_simple",this.$.groupMoveToOptionsAjax.generateRequest()}else this.set("group",{name:"",objectives:"",access:0,status:"active",configuration:{inheritThemeFromCommunity:!0}});this.set("new",e),this.set("refreshFunction",o),this.group.configuration&&this.group.configuration.customRatingsText&&""!==this.group.configuration.customRatingsText?this.set("endorsementButtonsDisabled",!0):this.set("endorsementButtonsDisabled",!1),this._setupTranslation()},setupAfterOpen:function(t){t.community&&(this.community=t.community),t.isGroupFolder?(this.set("group.is_group_folder",!0),this.set("isGroupFolder",!0)):this.group&&this.group.id||this.set("isGroupFolder",!1),t.inGroupFolderId?(this.set("group.in_group_folder_id",t.inGroupFolderId),this.set("inGroupFolderId",t.inGroupFolderId)):this.group&&this.group.id||this.set("inGroupFolderId",void 0);var e=0;this.community?0!=this.community.access&&(this.set("groupAccess","open_to_community"),this.set("group.access",3),e=3):this.group.Community&&0!=this.group.Community.access&&(this.set("groupAccess","open_to_community"),e=3),this.set("group.access",e),this._setupTranslation()},_pagesResponse:function(t,e){var o=e.response;o.unshift({id:-1,title:{en:this.t("none")}}),this._setPages(t,o)},_groupMoveToOptionsResponse:function(t,e){var o=e.response;if(o&&0<o.length){for(var i=0;i<o.length;i++)o[i].name="".concat(o[i].id," - ").concat(o[i].name);this.group.in_group_folder_id&&o.unshift({id:0,name:"".concat(this.group.Community.id,"C - ").concat(this.group.Community.name)}),o.unshift({id:-1,name:"0 - ".concat(this.t("none"))}),this.set("groupMoveToOptions",o)}},_setupTranslation:function(){this.language&&this.t&&(this.isGroupFolder?this.new?(this.editHeaderText=this.t("newGroupFolder"),this.toastText=this.t("groupToastCreated"),this.set("saveText",this.t("create"))):(this.set("saveText",this.t("save")),this.editHeaderText=this.t("editGroupFolder"),this.toastText=this.t("groupToastUpdated")):this.new?(this.editHeaderText=this.t("group.new"),this.toastText=this.t("groupToastCreated"),this.set("saveText",this.t("create"))):(this.set("saveText",this.t("save")),this.editHeaderText=this.t("group.update"),this.toastText=this.t("groupToastUpdated")))},_haveUploadedDocxSurvey:function(t,e){e.xhr.response&&((e=JSON.parse(e.xhr.response)).jsonContent=JSON.stringify(JSON.parse(e.jsonContent)),this.$$("#structuredQuestions").value=e.jsonContent,this.$$("#structuredQuestions").alwaysFloatLabel=!0,this.group&&this.group.configuration&&(this.group.configuration.structuredQuestions=e.jsonContent),this.$.editDialog.scrollResize(),this.fire("iron-resize"))}})</script><dom-module id="yp-magic-text-dialog"assetpath="../yp-magic-text/"><template><style>:host{display:block;}#dialog[rtl]{direction:rtl;}#dialog{background-color:#FFF;max-width:50%;}@media (max-width: 1100px){#dialog{max-width:80%;}}@media (max-width: 600px){#dialog{max-width:100%;}paper-dialog{padding:0;margin:0;}}.buttons{color:var(--accent-color);}div{font-size:16px;}</style><paper-dialog id="dialog"rtl$="[[rtl]]"><h2>[[pageTitle]]</h2><paper-dialog-scrollable><div hidden$="[[!finalContent]]"inner-h-t-m-l="[[finalContent]]"></div><div hidden$="[[finalContent]]">[[content]]</div></paper-dialog-scrollable><div class="buttons"><paper-button raised=""dialog-dismiss="">[[closeDialogText]]</paper-button></div></paper-dialog><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-yp-auto-translate="_autoTranslateEvent"></lite-signal><iron-ajax id="getTranslationAjax"on-response="_getTranslationResponse"></iron-ajax></template><script>var YpMagicTextBoxDialog=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"subClassProcessing",value:function(){this.processedContent=this.processedContent.replace(/\n/g,"<br />")}},{key:"open",value:function(e,t,i,s,n,o,a,l,r){l&&(this.skipSanitize=!0),this.contentId=t,this.extraId=i,this.textType=s,this.contentLanguage=n,this.disableTranslation=r,this.structuredQuestionsConfig=a,this.set("isDialog",!0),this.set("content",e),this.set("closeDialogText",o),this.$.dialog.open(),setTimeout(function(){this.$.dialog.fire("iron-resize")}.bind(this),50)}}],[{key:"is",get:function(){return"yp-magic-text-dialog"}}]),t}(YpMagicTextBox);customElements.define(YpMagicTextBoxDialog.is,YpMagicTextBoxDialog)</script></dom-module><dom-module id="yp-post-user-image-edit"assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment"></style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog double-width=""id="editDialog"icon="photo-camera"action="[[action]]"title="[[editHeaderText]]"method="[[method]]"save-text="[[saveText]]"next-action-text="[[t('next')]]"toast-text="[[toastText]]"params="[[params]]"><div class="layout vertical center-center"><yp-file-upload id="imageFileUpload"raised="true"multi="false"method="POST"on-success="_imageUploaded"><iron-icon class="icon"icon="photo-camera"></iron-icon><span>[[t('image.upload')]]</span></yp-file-upload></div><paper-input id="photographerName"name="photographerName"type="text"label="[[t('post.photographerName')]]"value="{{image.photographer_name}}"maxlength="60"char-counter=""></paper-input><paper-textarea id="description"required=""minlength="1"name="description"value="{{image.description}}"always-float-label="[[image.description]]"label="[[t('post.description')]]"char-counter=""rows="2"max-rows="5"maxlength="200"></paper-textarea><input type="hidden"name="uploadedPostUserImageId"value="[[uploadedPostUserImageId]]"> <input type="hidden"name="oldUploadedPostUserImageId"value="[[oldUploadedPostUserImageId]]"></yp-edit-dialog></template><script>Polymer({is:"yp-post-user-image-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior],properties:{new:{type:Boolean,value:!1},image:{type:Object,observer:"_imageChanged"},post:{type:Object,observer:"_postChange"},action:{type:String,value:"/api/images"},imageUploadTarget:{type:String,notify:!0},uploadedPostUserImageId:{type:String},oldUploadedPostUserImageId:{type:String},editHeaderText:{type:String},saveText:{type:String},method:{type:String}},_postChange:function(t){t&&(this.$.imageFileUpload.target="/api/images?itemType=post-user-image&postId="+t.id)},listeners:{"iron-form-invalid":"_formInvalid"},_imageChanged:function(t){t&&this.set("oldUploadedPostUserImageId",t.id)},_formInvalid:function(){this.set("selected",0),this.$$("#photographerName").autoValidate=!0,this.$$("#description").autoValidate=!0},_imageUploaded:function(t,e){var i=JSON.parse(e.xhr.response);this.set("uploadedPostUserImageId",i.id)},_clear:function(){this.set("uploadedPostUserImageId",null),this.$$("#imageFileUpload").clear()},setup:function(t,e,i,s){e?this.set("image",e):this.set("image",{description:"",photographerName:""}),t?this.set("post",t):this.set("post",null),this.set("new",i),this.set("refreshFunction",s),this._setupTranslation()},_setupTranslation:function(){this.new?(this.editHeaderText=this.t("post.newPhoto"),this.toastText=this.t("post.photo.toast.added")):(this.editHeaderText=this.t("post.photoUpdate"),this.toastText=this.t("post.photo.toast.updated"))}})</script></dom-module><dom-module id="yp-api-action-dialog"assetpath="../yp-api-action-dialog/"><template><style include="iron-flex iron-flex-alignment">:host{display:block;height:0;}paper-dialog{background-color:#FFF;}.spinner{margin-top:8px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><div class="layout horizontal center-center spinner"><yp-ajax method$="[[method]]"id="apiAjax"on-response="_response"></yp-ajax></div><paper-dialog id="confirmationDialog"on-close="_onClose"><div>[[confirmationText]]</div><div class="buttons"><paper-button dialog-dismiss="">[[t('cancel')]]</paper-button><paper-button dialog-confirm=""on-tap="_delete">[[confirmButtonText]]</paper-button></div></paper-dialog></template><script>Polymer({is:"yp-api-action-dialog",behaviors:[Polymer.ypLanguageBehavior],properties:{confirmationText:{type:String},action:{type:String},onFinishedFunction:{type:Function,value:null},confirmButtonText:{type:String},finalDeleteWarning:{type:Boolean,value:!1}},_onClose:function(){this.fire("close")},setup:function(i,t,n,e,o){this.set("action",i),this.set("confirmationText",t),this.set("onFinishedFunction",n),e?this.set("confirmButtonText",e):this.set("confirmButtonText",this.t("delete")),o?this.set("method",o):this.set("method","DELETE")},open:function(i){i&&i.finalDeleteWarning&&this.set("finalDeleteWarning",!0),this.$$("#confirmationDialog").open()},_delete:function(){var i=this;this.finalDeleteWarning?(this.set("finalDeleteWarning",!1),this.set("confirmationText",this.t("finalDeleteWarning")),this.$$("#confirmationDialog").close(),this.async(function(){i.$$("#confirmationDialog").open()},10)):(this.$$("#apiAjax").url=this.action,this.$$("#apiAjax").setBody({deleteConfirmed:!0}),this.$$("#apiAjax").generateRequest())},_response:function(i){this.fire("api-action-finished"),this.onFinishedFunction&&this.onFinishedFunction(i)}})</script></dom-module></div>