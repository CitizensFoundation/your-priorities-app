<div hidden=""by-polymer-bundler=""><dom-module id="yp-post-card-add"assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">:host{margin-top:8px;margin-bottom:8px;width:100%;}.postCard{width:100%;min-height:75px;margin-top:8px;padding:16px;background-color:var(--accent-color);color:#FFF;font-size:16px;cursor:pointer;margin-bottom:8px;text-align:center;max-width:310px;outline-color:var(--accent-color);}iron-icon{height:80px;width:80px;color:#FFF;}.header{padding:0;margin:0;padding-top:16px;}.icon{--iron-icon-height:140px;--iron-icon-width:140px;}.half{width:50%;}paper-fab{}.addText{padding-left:0;padding-right:8px;}iron-icon{width:64px;height:64px;margin-right:8px;margin-left:0;}.addNewIdeaText{font-size:26px;color:#FFF;font-family:var(--app-header-font-family, Roboto);}.closed{font-size:22px;}paper-card[disabled]{background-color:#888;cursor:initial;}iron-icon[disabled]{}@media (max-width: 420px){:host{margin-top:0;}.postCard{width:100%;margin-left:0;margin-right:0;margin-bottom:4px;padding:16px;}.addNewIdeaText{font-size:24px;width:auto;}iron-icon{height:48px;width:48px;}.closed{font-size:20px;}}@media (max-width: 420px){.postCard{max-width:300px;}}[hidden]{display:none !important;}.container{width:100%;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><div class="layout vertical center-center container"><paper-card disabled$="[[disabled]]"elevation="[[elevation]]"aria-disabled="[[disabled]]"role="button"aria-label="[[t('post.add_new')]]"tabindex="0"on-keydown="_keyDown"class="postCard"on-tap="_newPost"><div class="layout horizontal center-center addNewIdeaText"><iron-icon disabled$="[[disabled]]"icon="lightbulb-outline"></iron-icon><div class="flex addText"hidden$="[[disabled]]"><template is="dom-if"if="[[!group.configuration.alternativeTextForNewIdeaButton]]">[[t('post.add_new')]]</template><template is="dom-if"if="[[group.configuration.alternativeTextForNewIdeaButton]]"><yp-magic-text content-id="[[group.id]]"extra-id="[[index]]"text-only=""content="[[group.configuration.alternativeTextForNewIdeaButton]]"content-language="[[group.language]]"class="ratingName"text-type="alternativeTextForNewIdeaButton"></yp-magic-text></template></div><div class="flex addText closed"hidden$="[[!disabled]]"><template is="dom-if"if="[[!group.configuration.alternativeTextForNewIdeaButtonClosed]]">[[t('closedForNewPosts')]]</template><template is="dom-if"if="[[group.configuration.alternativeTextForNewIdeaButtonClosed]]"><yp-magic-text content-id="[[group.id]]"extra-id="[[index]]"text-only=""content="[[group.configuration.alternativeTextForNewIdeaButtonClosed]]"content-language="[[group.language]]"class="ratingName"text-type="alternativeTextForNewIdeaButtonClosed"></yp-magic-text></template></div></div></paper-card></div></template><script>Polymer({is:"yp-post-card-add",properties:{elevation:{type:Number},disabled:{type:Boolean},group:Object},_keyDown:function(e){13===e.keyCode&&this._newPost()},_newPost:function(){this.disabled||this.fire("new-post")},behaviors:[Polymer.ypLanguageBehavior]})</script></dom-module><dom-module id="yp-post-list-item"assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">.card-actions{}.post-name{margin:0;padding:16px;padding-top:20px;padding-bottom:8px;cursor:pointer;vertical-align:middle !important;font-size:1.25rem;background-color:#fff;color:#000;letter-spacing:.0125em;font-weight:var(--app-header-font-weight, 500);font-family:var(--app-header-font-family, Roboto);}.postNameContainer{width:100%;}.postCardCursor{cursor:pointer;}.postCard{background-color:#fff;@apply --layout-horizontal;}:host{display:block;@apply --layout-vertical;}.postCard{height:100px;width:895px;border-radius:4px;}.postCard[hide-post-cover]{height:190px;}.postCard[hide-post-cover][hide-actions]{height:165px;}.postCard[hide-post-cover][hide-description]{height:140px;}.postCard[hide-description]{height:372px;}.postCard[hide-description][hide-actions]{height:331px;}.postCard[hide-description][hide-post-cover][hide-actions]{height:110px;}.postCard[hide-actions]{height:402px;}.postCard[mini]{width:210px;height:100%;margin:0;padding-top:0;padding-bottom:0;}yp-post-cover-media{width:178px;height:100px;}yp-post-cover-media[mini]{width:210px;height:118px;min-height:118px;}.post-name[mini]{padding:16px;}.description{font-size:17px;padding:16px;padding-top:0;cursor:pointer;color:#555;}.postActions{position:absolute;right:20px;bottom:0;margin:0;}.shareIcon{position:absolute;left:8px;bottom:2px;--paper-share-button-icon-color:#656565;--paper-share-button-icon-height:46px;--paper-share-button-icon-width:46px;text-align:right;width:48px;height:48px;}.customRatings{position:absolute;bottom:10px;right:6px;}@media (max-width: 960px){.customRatings{bottom:12px;}:host{width:100%;max-width:423px;}.description[has-custom-ratings]{padding-bottom:28px;}.postCard{margin-left:0;margin-right:0;padding-left:0;padding-right:0;width:100%;height:100%;}.postCard[mini]{width:210px;height:100%;}.card{margin-left:0;margin-right:0;padding-left:0;padding-right:0;width:100%;height:100%;}.card[mini]{width:210px;height:100%;}yp-post-cover-media{width:100%;height:230px;}yp-post-cover-media[mini]{width:210px;height:118px;min-height:118px;}.card{height:100%;padding-bottom:48px;}.postCard{height:100% !important;}yp-post-cover-media[audio-cover]{width:100%;height:100px;}}@media (max-width: 420px){yp-post-cover-media{height:225px;}yp-post-cover-media[audio-cover]{height:100px;}}@media (max-width: 375px){yp-post-cover-media{height:207px;}yp-post-cover-media[audio-cover]{height:100px;}}@media (max-width: 360px){yp-post-cover-media{height:200px;}yp-post-cover-media[audio-cover]{height:90px;}}@media (max-width: 320px){yp-post-cover-media{height:180px;}yp-post-cover-media[audio-cover]{height:90px;}}[hidden]{display:none !important;}a{text-decoration:none;}.share[mini]{display:none;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-logged-in="_userLoggedIn"></lite-signal><iron-media-query query="(min-width: 600px)"query-matches="{{wide}}"></iron-media-query><paper-material mini$="[[mini]]"hide-post-cover$="[[post.Group.configuration.hidePostCover]]"hide-description$="[[post.Group.configuration.hidePostDescription]]"hide-actions$="[[post.Group.configuration.hidePostActionsInGrid]]"audio-cover$="[[isAudioCover]]"class="card postCard layout vertical"elevation="[[elevation]]"animated=""><div class="layout vertical"><a href="[[_getPostLink(post)]]"id="theMainA"on-tap="_savePostToBackCache"><div class="layout horizontal"><yp-post-cover-media mini$="[[mini]]"top-radius=""audio-cover$="[[isAudioCover]]"alt-tag="[[post.name]]"post="[[post]]"hidden$="[[post.Group.configuration.hidePostCover]]"></yp-post-cover-media><div class="layout vertical"><div class="postNameContainer"><div class="post-name"mini$="[[mini]]"id="postName"><yp-magic-text id="postNameMagicText"text-type="postName"content-language="[[post.language]]"on-tap="goToPostIfNotHeader"text-only=""content="[[postName]]"content-id="[[post.id]]"></yp-magic-text></div></div><template is="dom-if"if="[[!post.Group.configuration.usePostTagsForPostListItems]]"><template is="dom-if"if="[[!post.public_data.structuredAnswersJson]]"><yp-magic-text class="description layout horizontal"has-custom-ratings$="[[post.Group.configuration.customRatings]]"hidden$="[[hideDescription]]"text-type="postContent"content-language="[[post.language]]"on-tap="goToPostIfNotHeader"remove-urls=""text-only=""content="[[post.description]]"content-id="[[post.id]]"truncate="200"></yp-magic-text></template><template is="dom-if"if="[[post.public_data.structuredAnswersJson]]"><yp-magic-text id="description"text-type="postContent"content-language="[[post.language]]"hidden$="[[hideDescription]]"content="[[structuredAnswersFormatted]]"remove-urls=""disable-translation=""skip-sanitize=""content-id="[[post.id]]"class="description"truncate="120"></yp-magic-text></template></template><template is="dom-if"if="[[post.Group.configuration.usePostTagsForPostListItems]]"><yp-post-tags post="[[post]]"></yp-post-tags></template></div></div></a><div hidden$="[[post.Group.configuration.hidePostActionsInGrid]]"on-tap="_onBottomClick"><template is="dom-if"if="[[!mini]]"><div class="share"hidden=""blah$="[[post.Group.configuration.hideSharing]]"><paper-share-button on-share-tap="_shareTap"class="shareIcon"less-margin$="[[post.Group.configuration.hideDownVoteForPost]]"endorsed$="[[isEndorsed]]"horizontal-align="right"id="shareButton"whatsapp="[[post.Group.configuration.allowWhatsAppSharing]]"title$="[[t('post.shareInfo')]]"facebook=""email=""twitter=""popup=""url="[[fullPostUrl]]"></paper-share-button></div><template is="dom-if"if="[[post.Group.configuration.customRatings]]"><yp-post-ratings-info class="customRatings"post="[[post]]"></yp-post-ratings-info></template><template is="dom-if"if="[[!post.Group.configuration.customRatings]]"><yp-post-actions floating=""class="postActions"elevation="-1"endorse-mode="[[endorseMode]]"post="[[post]]"hidden$="[[mini]]"></yp-post-actions></template></template></div></div></paper-material><lite-signal on-lite-signal-yp-auto-translate="_autoTranslateEvent"></lite-signal><yp-ajax hidden=""id="translatedSurveyAjax"on-response="_translatedSurveyResponse"></yp-ajax></template><script>Polymer({is:"yp-post-list-item",behaviors:[Polymer.ypLanguageBehavior,Polymer.YpPostBehavior,Polymer.AccessHelpers,Polymer.ypLoggedInUserBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypTruncateBehavior,Polymer.ypGotoBehavior,Polymer.YpPostSurveyTranslationBehavior],properties:{hideDescription:{type:Boolean,computed:"_hideDescription(mini, post)"},selectedMenuItem:{type:String},elevation:{type:Number,value:1},post:{type:Object,observer:"_postChanged"},hasPostAccess:{type:Boolean,value:!1,notify:!0,computed:"_hasPostAccess(post, gotAdminRights)"},mini:{type:Boolean,value:!1},isAudioCover:{type:Boolean,value:!1}},_onBottomClick:function(o){o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation()},clickOnA:function(){this.$.theMainA&&this.$.theMainA.click()},_savePostToBackCache:function(){this.post&&(window.appGlobals.cachedPostItem=this.post)},_getPostLink:function(o){if(o)return o.Group.configuration&&o.Group.configuration.disablePostPageLink?"#":o.Group.configuration&&o.Group.configuration.resourceLibraryLinkMode?o.description.trim():"/post/"+o.id;console.warn("Trying to get empty post link")},_shareTap:function(o,t){window.appGlobals.activity("postShareCardOpen",t.brand,this.post?this.post.id:-1)},_hideDescription:function(o,t){return o||t&&t.Group.configuration&&t.Group.configuration.hidePostDescription},_hasPostAccess:function(o){return!!o&&this.checkPostAccess(o)},goToPostIfNotHeader:function(){this.post.Group.configuration&&this.post.Group.configuration.disablePostPageLink?console.log("goToPostDisabled"):this.post.Group.configuration&&this.post.Group.configuration.resourceLibraryLinkMode||this.goToPost(null,null,null,this.post)},_postChanged:function(o){o&&("audio"===o.cover_media_type?this.set("isAudioCover",!0):this.set("isAudioCover",!1),this._getSurveyTranslationsIfNeeded())},updateDescriptionIfEmpty:function(o){this.post.description&&""!=this.post.description||this.set("post.description",o)},_refresh:function(){Polymer.dom(document).querySelector("yp-app").getDialogAsync("postEdit",function(o){o.selected=0,this.fire("refresh")}.bind(this))},_openReport:function(){window.appGlobals.activity("open","post.report"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("apiActionDialog",function(o){o.setup("/api/posts/"+this.post.id+"/report",this.t("reportConfirmation"),this._onReport.bind(this),this.t("post.report"),"PUT"),o.open()}.bind(this))},_onReport:function(){window.appGlobals.notifyUserViaToast(this.t("post.report")+": "+this.post.name)}})</script></dom-module><dom-module id="yp-posts-filter"assetpath="../yp-posts-filter/"><template><style include="iron-flex iron-flex-alignment">:host{padding-bottom:0 !important;margin-bottom:0 !important;}paper-menu-button{padding:0;margin:0;}paper-button, paper-item{font-family:var(--app-header-font-family, Roboto);}.filterIcon{padding-right:8px;}.filterIconTransform{-moz-transform:scaleY(-1);-o-transform:scaleY(-1);-webkit-transform:scaleY(-1);transform:scaleY(-1);filter:FlipV;-ms-filter:"FlipV";}.dropdown-trigger{margin-bottom:16px;margin-left:16px;}.clear-search-trigger{width:55px;height:55px;margin-bottom:16px;}paper-item{min-height:32px;}.subTitle{font-size:22px;margin-top:10px;margin-right:8px;}#filterDropdown{padding-left:0;margin-left:0;}#dropDownTrigger{background-color:#fff;margin-left:16px;color:#111;}@media (max-width: 600px){.subTitle{font-size:17px;padding-top:0;margin-top:16px;}.dropdown-trigger{padding-left:0;margin-left:0;margin-bottom:0;margin-top:0;}.clear-search-trigger{width:50px;height:50px;margin-top:5px;margin-bottom:0;margin-top:0;}paper-button{}#dropDownTrigger{margin-left:0;margin-right:0;}}paper-dropdown-menu{padding-left:8px;padding-right:8px;}.filterHeader{margin-top:16px;padding-bottom:0;margin-bottom:0;font-weight:bold;font-size:18px;}.categoriesDropdownMenu{padding-left:16px;parring-right:16px;}.dropdownIcon{color:#000;margin-right:8px;margin-left:8px;}.catImage{width:24px;height:24px;margin-right:8px;}.filterText{margin-right:8px;}.dropDownContent, #mainListMenu, .categoriesDropdownMenu, .catDropDown{background-color:#fff !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><template is="dom-if"if="[[group]]"><div class="layout horizontal center-center mainContainer wrap"><template is="dom-if"if="[[showFilter]]"><paper-menu-button id="filterDropdown"class="selected-items"icon="sort"vertical-align="auto"horizontal-align="right"><paper-button raised=""title$="[[t('filterIdeas')]]"id="dropDownTrigger"icon="sort"slot="dropdown-trigger"><iron-icon icon="sort"class="dropdownIcon"></iron-icon><div class="filterText">{{t('filterIdeas')}}</div></paper-button><div slot="dropdown-content"class="layout vertical dropDownContent"><div><div class="filterHeader layout horizontal center-center">[[t('filterIdeas')]]</div><template is="dom-if"if="[[categoriesWithCount]]"restamp=""><div class="layout vertical"><paper-dropdown-menu class="dropdown-content wrap categoriesDropdownMenu"><paper-listbox slot="dropdown-content"id="categoryMenu"class="catDropDown"attr-for-selected="data-category-id"on-iron-select="_changeCategory"><paper-item data-category-id="-1"name="-1"><iron-icon icon="select-all"class="filterIcon"></iron-icon><span>[[t('categories.the_all')]] ([[allPostCount]])</span></paper-item><template is="dom-repeat"items="[[categoriesWithCount]]"as="category"><paper-item data-category-id$="[[category.id]]"data-category-name$="[[category.name]]"><iron-image sizing="cover"class="catImage"height="24"width="24"src="[[_categoryImageSrc(category)]]"></iron-image>[[category.name]] ([[category.count]])</paper-item></template></paper-listbox></paper-dropdown-menu></div></template><div class="layout horizontal center-center"><yp-ajax id="categoriesWithCountAjax"on-response="_categoriesCountResponse"></yp-ajax></div><paper-listbox slot="dropdown-content"id="mainListMenu"on-iron-select="_changeFilter"><paper-item data-filter="top"><iron-icon icon="trending-up"class="filterIcon"></iron-icon><span>[[t('post.top')]]</span></paper-item><paper-item data-filter="newest"><iron-icon icon="new-releases"class="filterIcon"></iron-icon><span>[[t('post.newest')]]</span></paper-item><paper-item data-filter="most_debated"><iron-icon icon="chat-bubble-outline"class="filterIcon"></iron-icon><span>[[t('post.most_debated')]]</span></paper-item><paper-item data-filter="random"><iron-icon icon="cached"class="filterIcon"></iron-icon><span>[[t('post.random')]]</span></paper-item></paper-listbox></div></div></paper-menu-button></template><template is="dom-if"if="[[searchingFor]]"><paper-icon-button aria-label$="[[t('clearSearchInput')]]"icon="clear"on-tap="_clearSearch"class="clear-search-trigger"></paper-icon-button></template></div></template></template><script>Polymer({is:"yp-posts-filter",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypGotoBehavior,Polymer.ypMediaFormatsBehavior],properties:{filter:{type:String,value:"newest",notify:!0,observer:"_filterChanged"},filterName:{type:String},categoryId:{type:String,notify:!0,observer:"_categoryIdChanged"},categoryName:{type:String},group:{type:Object,observer:"_groupChanged"},subTitle:{type:String,value:"",notify:!0},searchingFor:{type:String,value:null,notify:!0,observer:"_searchingForChanged"},showFilter:{type:Boolean,value:!0},postsCount:{type:Number,notify:!0},tabName:{type:String,observer:"_tabNameChanged"},categoriesWithCount:{type:Array,value:null},allPostCount:{type:Number,value:0}},observers:["_listLanguageChanged(language)"],_getCategoryCount:function(e,t){var i=__.find(t,function(t){return t.category_id==e});return i?i.count:0},_oldCategory:function(t){return!t||t.id<804},_categoriesCountResponse:function(t,e){var i=e.response.categoriesCount;this.set("allPostCount",e.response.allPostCount);var r=[];__.each(this.group.Categories,function(t){t.count=this._getCategoryCount(t.id,i),0<t.count&&r.push(t)}.bind(this)),1<r.length?(this.set("categoriesWithCount",r),this.async(function(){var t=this.$$("#categoryMenu");t?this.categoryId?t.selected=this.categoryId:t.selected="-1":console.error("Cant set category menu")})):console.error("Unexpected categories count")},_openDropDown:function(){var t=this.$$("#dropDownTrigger");t&&t.click()},_searchingForChanged:function(){this.showFilter=!0},_clearSearch:function(){this.set("searchingFor",null),this.set("filter","newest"),this._updateAfterFiltering()},openFilter:function(){window.appGlobals.activity("open","filter")},_filterChanged:function(t){t&&(this.filterName="post."+this.filter,this._updateTitle())},_categoryIdChanged:function(t){t&&this._updateTitle()},_listLanguageChanged:function(t){t&&this.t&&this._updateTitle()},searchFor:function(t){this.set("searchingFor",t);var e="/group/"+this.group.id+"/open/"+this.group.name+"/search/"+this.searchingFor;window.appGlobals.activity("change","filter",e),this.redirectTo(e),this.fire("refresh-group")},_updateTitle:function(){if(this.searchingFor)this.set("subTitle",this.t("post.searchingFor")+this.searchingFor);else{var t,e=this.t(this.filterName);t=this.categoryName?this.categoryName:this.t("categories.the_all");this.t("short_word.in");this._ifCategories()?this.set("subTitle",e+" - "+t):this.set("subTitle",e)}},_changeFilter:function(t,e){this.set("filter",e.item.dataset.filter),this._updateAfterFiltering()},_changeCategory:function(t,e){var i=this.categoryId,r=e.item.dataset.categoryId;"-1"!=r?(this.set("categoryId",r),this.categoryName=e.item.dataset.categoryName):(this.set("categoryId",null),this.categoryName=null,this.$$("#categoryMenu").selected=null),this._updateTitle(),i!==this.categoryId&&this._updateAfterFiltering()},buildPostsUrlPath:function(){var t="/group/"+this.group.id+"/"+this.tabName;return this.filter&&(t+="/posts/"+this.filter),this.categoryId&&(t+="/"+this.categoryId+"/"+this.categoryName),t},_updateAfterFiltering:function(){this.filter||this.set("filter","newest");var t=this.buildPostsUrlPath();window.appGlobals.activity("change","filter",t),this.fire("refresh-group")},_ifCategories:function(){return!!this.group&&(this.group.Categories&&0<this.group.Categories.length)},resetSelection:function(){this.async(function(){this.$$("#categoryMenu")&&(this.$$("#categoryMenu").selected=null),this.$$("#mainListMenu")?this.$$("#mainListMenu").selected=null:console.error("Cant find mainListMenu menu")},100)},_tabNameChanged:function(){0},_setupCategories:function(e,i){this.set("categoriesWithCount",null),this.async(function(){var t=this.$$("#categoriesWithCountAjax");t?(t.url="/api/groups/"+e.id+"/categories_count/"+i,t.generateRequest()):console.error("Can't find categories ajax.")},100)},_groupChanged:function(t){this.set("categoriesWithCount",null),this.set("allPostCount",0),t&&(this._updateTitle(),t.Categories&&0<t.Categories.length&&this._setupCategories(t,this.tabName),this.resetSelection())},_categoryItems:function(){return this.group.Categories?this.splitArray(this.group.Categories,7):[]},_categoryImageSrc:function(t){return this.getImageFormatUrl(t.CategoryIconImages,0)},splitArray:function(t,e){return t.chunk(e)}})</script></dom-module><dom-module id="yp-post-list"assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">:host{}.container{@apply --layout-horizontal;@apply --layout-wrap;}.postsFilter{padding-left:16px;height:36px;}.objectives{padding-bottom:40px;max-width:432px;}.description{padding:12px;}yp-post-card{padding-bottom:52px;}#outerRegion{position:relative;@apply --layout-vertical;}#scrollableRegion{}iron-list{height:100vh;}yp-ajax{padding-top:48px;}yp-posts-filter{margin-bottom:8px;margin-left:8px;margin-top:16px;}#ironList{}.searchButton{padding:8px;margin:8px;}.searchContainer{margin-top:8px;}yp-posts-filter{padding-right:16px;}.half{width:50%;}.searchBox{--paper-input-container-label:{font-size:23px;color:#555;font-family:var(--app-header-font-family, Roboto);};font-family:var(--app-header-font-family, Roboto);margin-bottom:22px;margin-right:8px;}@media (max-width: 800px){.searchBox{--paper-input-container-label:{font-size:18px;};margin-bottom:8px;}.searchBox{margin-top:8px;}.half{width:100%;}.searchContainer{@apply --layout-center-center;margin-top:0;}.postsFilter{padding-left:16px;width:215px !important;}}.noIdeas{background-color:#FFF;max-width:200px;padding:16px;margin:16px;margin-top:32px;}.noIdeasText{font-weight:bold;}.card{padding:0;padding-top:8px;}.card[wide-padding]{padding:16px !important;}.card[desktop-list]{padding:0 !important;padding-top:16px !important;}#searchInput{margin-left:8px;}[hidden]{display:none !important;}:focus{}.largeAjax{position:absolute;bottom:32px;}a{text-decoration:none;}.card[is-last-item]{padding-bottom:128px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><iron-media-query query="(min-width: 1024px)"query-matches="{{wide}}"></iron-media-query><iron-a11y-keys id="a11y"target="[[searchTarget]]"keys="enter"on-keys-pressed="_search"></iron-a11y-keys><div class="layout vertical center-center topMost"><div class="searchContainer layout horizontal center-center wrap"hidden$="[[group.configuration.hidePostFilterAndSearch]]"><div class="layout horizontal center-center"><yp-posts-filter on-tap="_tapOnFilter"sub-title="{{subTitle}}"class="filter"id="postsFilter"tab-name="[[statusFilter]]"on-refresh-group="_refreshGroupFromFilter"group="[[group]]"filter="{{filter}}"searching-for="{{searchingFor}}"category-id="{{categoryId}}"category-name="{{categoryName}}"posts-count="{{postsCount}}"></yp-posts-filter></div><div class="layout horizontal center-center"><paper-input id="searchInput"label$="[[t('searchFor')]]"value="{{searchingFor}}"class="searchBox"></paper-input><paper-icon-button aria-label$="[[t('startSearch')]]"icon="search"on-tap="_search"hidsden$="[[!showSearchIcon]]"></paper-icon-button></div></div><template is="dom-if"if="[[noPosts]]"restamp=""><div class="layout horiztonal center-center"><paper-material class="noIdeas layout horizontal center-center"elevation="2"hidden$="[[group.configuration.allPostsBlockedByDefault]]"><div class="noIdeasText">[[t('noIdeasHere')]]</div></paper-material></div></template><div class="layout horizontal center-center"><iron-list id="ironList"selection-enabled=""scroll-offset="[[scrollOffset]]"on-selected-item-changed="_selectedItemChanged"items="[[posts]]"as="post"scroll-target="document"grid$="[[wideNotListFormat]]"role="list"><template><div wide-padding$="[[wide]]"desktop-list$="[[desktopListFormat]]"class="card layout vertical center-center"is-last-item$="[[_isLastItem(index)]]"aria-label="[[post.name]]"role="listitem"aria-level="2"tabindex$="[[tabIndex]]"><template is="dom-if"if="[[!desktopListFormat]]"><yp-post-card id="postCard[[post.id]]"on-refresh="_refreshPost"class="card"post="[[post]]"on-mouseover="cardMouseOver"on-mouseout="cardMouseOut"></yp-post-card></template><template is="dom-if"if="[[desktopListFormat]]"><yp-post-list-item id="postCard[[post.id]]"on-refresh="_refreshPost"class="card"post="[[post]]"on-mouseover="cardMouseOver"on-mouseout="cardMouseOut"></yp-post-list-item></template></div></template></iron-list></div><div class="layout horizontal center-center largeAjax"><yp-ajax id="ajax"large-spinner=""on-response="_postsResponse"></yp-ajax><yp-ajax id="refreshPost"on-response="_refreshPostResponse"></yp-ajax></div></div></template><script>Polymer({is:"yp-post-list",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypIronListBehavior],properties:{wide:Boolean,categories:{type:Array},subTitle:{type:String,notify:!0},defaultCategories:{type:Boolean,value:!1},posts:{type:Array,value:null,notify:!0},groupId:{type:Number,observer:"_groupIdChanged"},userId:{type:Number},group:{type:Object,notify:!0,observer:"_groupChanged"},filter:{type:String,value:"newest",observer:"_filterChanged"},statusFilter:{type:String,value:"open",notify:!0},categoryId:{type:String,observer:"_categoryIdChanged"},postsCount:{type:Number,notify:!0},searchTarget:{type:Object,computed:"_searchTarget(noPosts)"},categoryName:{type:String},searchingFor:{type:String,value:null,observer:"_searchingForChanged"},selectedCategoryName:{type:String},selectedTab:{type:String,observer:"_selectedTabChanged"},tabCounterId:{type:String},oldestPostAt:{type:Date},noPosts:{type:Boolean,value:!1},wideListOffset:{type:Number,value:610},listOffset:{type:String,value:"500px"},showSearchIcon:{type:Boolean,value:!1},randomSeed:{type:Number,value:null},scrollOffset:{type:Number,computed:"_scrollOffset(wide, group, selectedTab)"},desktopListFormat:{type:Boolean,computed:"_desktopListFormat(wide, group, posts)"},wideNotListFormat:{type:Boolean,computed:"_wideNotListFormat(wide, desktopListFormat, group, posts)"}},_isLastItem:function(t){return this.posts&&t>=this.posts.length-1},_wideNotListFormat:function(t,e){return!0===(t&&!e)},_desktopListFormat:function(t,e){return!0===(t&&e&&e.configuration&&e.configuration.usePostListFormatOnDesktop)},_selectedItemChanged:function(t,e){if(e&&e.value){var o=this.$$("#postCard"+e.value.id);o&&o.clickOnA()}},_refreshPost:function(t,e){this.$.refreshPost.url="/api/posts/"+e.id,this.$.refreshPost.generateRequest()},_refreshPostResponse:function(t,e){for(var o=e.response,s=0;s<this.posts.length;s++)if(this.posts[s].id==o.id){this.set("posts."+s,o),window.appGlobals.updatePostInCache(o),this.async(function(){this.$$("#ironList").fire("iron-resize")});break}},_getPostLink:function(t){if(t)return t.Group.configuration&&t.Group.configuration.disablePostPageLink?"#":t.Group.configuration&&t.Group.configuration.resourceLibraryLinkMode?t.description.trim():"/post/"+t.id;console.warn("Trying to get empty post link")},_scrollOffset:function(t,e){var o=this.$$("iron-list");if(o){var s=o.offsetTop;return s-=75,0<o.offsetTop&&0<s?console.info("Post list scroll offset: "+s):(s=t?550:700,e&&e.configuration&&(e.configuration.hideAllTabs&&(s-=60),e.configuration.hideNewPost&&(s-=100),e.configuration.hidePostFilterAndSearch&&(s-=100)),console.info("Post list (manual) scroll offset: "+s)),s}return console.warn("No list for scroll offset"),null},_tapOnFilter:function(){window.appGlobals.activity("click","filter")},_searchTarget:function(t){t||this.async(function(){return this.$$("#searchInput")})},_selectedTabChanged:function(){this.statusFilter},_search:function(){window.appGlobals.activity("click","search"),this.searchingFor&&""!=this.searchingFor&&this._refreshGroupFromFilter()},cardMouseOver:function(t){t.currentTarget.elevation=4},cardMouseOut:function(t){t.currentTarget.elevation=1},buildPostsUrlPath:function(){return this.$.postsFilter.buildPostsUrlPath()},_searchingForChanged:function(t){this.set("moreToLoad",!0),t&&""!=t?this.set("showSearchIcon",!0):this.set("showSearchIcon",!1)},_filterChanged:function(){this.set("moreToLoad",!0)},_categoryIdChanged:function(){this.set("moreToLoad",!0)},scrollToPost:function(t){t&&this.posts?(console.info("Scrolling to post: "+t.id),this.$$("#ironList").scrollToItem(t),document.dispatchEvent(new CustomEvent("lite-signal",{bubbles:!0,compose:!0,detail:{name:"yp-refresh-activities-scroll-threshold",data:{}}}))):console.error("No post id on goToPostId")},_groupIdChanged:function(){},_groupChanged:function(t){this.set("posts",null),this.set("noPosts",!1),this.set("randomSeed",Math.random()),t&&(this.set("moreToLoad",!0),window.appGlobals.originalQueryParameters&&window.appGlobals.originalQueryParameters.categoryId?(this.set("categoryId",window.appGlobals.originalQueryParameters.categoryId),window.appGlobals.originalQueryParameters.categoryId=void 0):this.set("categoryId",null),t.configuration&&t.configuration.forcePostSortMethodAs&&-1<["oldest","newest","top","most_debated","random","alphabetical"].indexOf(t.configuration.forcePostSortMethodAs)?this.set("filter",t.configuration.forcePostSortMethodAs):t.configuration&&null!=t.configuration.canAddNewPosts?!0===t.configuration.canAddNewPosts?this.set("filter","newest"):!1===t.configuration.canAddNewPosts&&!1===t.configuration.canVote?this.set("filter","top"):this.set("filter","random"):this.filter||this.set("filter","newest"),this._loadMoreData())},_refreshGroupFromFilter:function(){this.set("posts",null),this.set("moreToLoad",!0),this._loadMoreData()},_loadMoreData:function(){var t,e;this.moreToLoad&&this.group&&(console.info("_loadMoreData for groupId: "+this.groupId+" statusFilter: "+this.statusFilter),this.set("moreToLoad",!1),this.set("noPosts",!1),e=this.userId?(t=this.userId+"/posts","users"):(t=this.groupId,"groups"),this.searchingFor?this.$$("#ajax").url="/api/"+e+"/"+t+"/search/"+this.searchingFor:(this.$$("#ajax").url="/api/"+e+"/"+t+"/posts/"+this.filter,this.categoryId?this.$$("#ajax").url+="/"+this.categoryId:this.$$("#ajax").url+="/null",this.$$("#ajax").url+="/"+this.statusFilter),this.$$("#ajax").url+="?offset="+(null!=this.posts?this.posts.length:0),"random"==this.filter&&this.randomSeed&&(this.$$("#ajax").url+="&randomSeed="+this.randomSeed),this.$$("#ajax").generateRequest())},_postsResponse:function(t,e){var o=e.response.posts;if(this.set("postsCount",e.response.totalPostsCount),this.fire("yp-post-count",{tabCounterId:this.tabCounterId,count:this.postsCount}),this.posts)for(var s=0;s<o.length;s++)this.push("posts",o[s]);else this.set("posts",o);0!=o.length||null!=this.posts&&0!=this.posts.length||this.async(function(){this.set("noPosts",!0)},250),0<o.length?this.set("noPosts",!1):this.searchingFor&&""!=this.searchingFor&&this.set("noPosts",!1),this.async(function(){var t=this.$$("#postsFilter");t&&t._updateTitle()},20),this.async(function(){this.$$("#ironList").fire("iron-resize")}),0<o.length&&o.length!=this.postsCount&&this.set("moreToLoad",!0),document.dispatchEvent(new CustomEvent("lite-signal",{bubbles:!0,compose:!0,detail:{name:"yp-refresh-activities-scroll-threshold",data:{}}})),this._processCategories(),this._checkForMultipleLanguages(o),window.appGlobals.addPostsToCacheLater(o)},_checkForMultipleLanguages:function(t){if(!localStorage.getItem("dontPromptForAutoTranslation")&&!sessionStorage.getItem("dontPromptForAutoTranslation")){var e=null,o=!1;t.forEach(function(t){t.language&&!o&&(e||"??"===t.language?e&&e!==t.language&&"??"!==t.language&&(o=!0,console.info("Multiple post languages: "+e+" and "+t.language)):(e=t.language,t.description))}),o&&Polymer.dom(document).querySelector("yp-app").getDialogAsync("autoTranslateDialog",function(t){t.openLaterIfAutoTranslationEnabled()}.bind(this))}},_processCategories:function(){if(this.categoryId&&this.group)for(var t=0;t<this.group.Categories.length;t++)this.group.Categories[t].id==this.categoryId&&(this.selectedCategoryName=this.group.Categories[t].name);else this.selectedCategoryName="categories.all"}})</script></dom-module><dom-module id="yp-group-card-large"><template><style include="iron-flex iron-flex-alignment">:host{}.groupAccess{padding-bottom:8px;}.group-name{padding-bottom:4px;margin:0;font-size:24px;font-weight:var(--app-header-font-weight, 700);font-family:var(--app-header-font-family, Roboto);}.group-name[widetext]{font-size:22px;}.group-name[largefont]{font-size:22px;}.group-name[admin]{padding-right:32px;}video{outline:none !important;}.objectives{}.groupCard{background-color:#fefefe;color:#333;height:243px;width:432px;padding:0 !important;margin-top:0 !important;}.stats{position:absolute;bottom:0px;right:8px;}.edit{color:#FFF;position:absolute;top:0;right:0;padding-right:0;margin-right:0;}.description-and-stats{width:100%;}.newCategory{color:var( --primary-background-color,#F2F2F2);position:absolute;top:64px;right:0;}iron-image, video{width:432px;height:243px;}.description{padding:0;margin:0;}.groupDescription{padding-left:16px;padding-right:16px;padding-top:12px;font-size:var(--group-description-font-size, 15px);}.groupDescription[widetext]{font-size:14px;}.groupDescription[largefont]{font-size:14px;}.urlToReviewButton{color:#FFF;background-color:var(--accent-color, #000);padding:8px;margin-top:16px;}.group-name{background-color:var(--primary-color-800, #000);color:#fafafa;padding-left:16px;padding-top:16px;padding-bottom:16px;padding-right:32px !important;min-height:28px;}.textBox{margin-left:32px;position:relative;}@media (max-width: 960px){:host{max-width:423px;width:100%;}.urlToReviewButton{color:#FFF;background-color:var(--accent-color, #000);padding:8px;margin-top:0;margin-bottom:16px;}.groupCard{margin-bottom:16px;width:100%;height:100%;margin-left:8px;margin-right:8px;}.top-card{margin-top:16px !important;}iron-image, video{width:100%;height:230px;}.imageCard{height:230px;}.imageCard[is-video]{background-color:transparent;}.group-name{font-size:20px;min-height:24px;}.groupDescription{padding-top:12px;padding-bottom:42px;}.stats{}}@media (max-width: 420px){iron-image, video{height:225px;}.imageCard{height:225px;}}@media (max-width: 375px){iron-image, video{height:207px;}.imageCard{height:205px;}}@media (max-width: 360px){iron-image, video{height:200px;}.imageCard{height:200px;}}@media (max-width: 320px){iron-image, video{height:180px;}.imageCard{height:180px;}}[hidden]{display:none !important;}a{text-decoration:none;color:inherit;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-yp-pause-media-playback="_pauseMediaPlayback"></lite-signal><lite-signal on-lite-signal-yp-auto-translate="_autoTranslateEvent"></lite-signal><div class="layout horizontal center-center wrap"aria-label="[[t('group')]]"role="banner"><paper-material id="cardImage"elevation="3"is-video$="[[groupVideoURL]]"animated=""class="groupCard imageCard top-card"><template is="dom-if"if="[[groupVideoURL]]"restamp=""><video id="videoPlayer"data-id$="[[groupVideoId]]"controls=""preload="meta"class="logo"src="[[groupVideoURL]]"playsinline=""poster="[[groupVideoPosterURL]]"></video></template><template is="dom-if"if="[[!groupVideoURL]]"restamp=""><iron-image class="logo"sizing="cover"alt$="[[group.name]]"preload=""src="[[groupLogoImagePath]]"></iron-image></template></paper-material><paper-material id="card"elevation="3"animated-shadow=""class="groupCard textBox"><div class="layout vertical"><div class="layout horizontal wrap"><div class="layout vertical description-and-stats"><div class="description"><div admin$="[[hasGroupAccess]]"role="heading"aria-level="1"aria-label="[[group.name]]"><yp-magic-text id="groupName"class="group-name"widetext$="[[wideText]]"text-type="groupName"content-language="[[group.language]]"disable-translation="[[group.configuration.disableNameAutoTranslation]]"largefont$="[[largeFont]]"text-only=""content="[[groupName]]"content-id="[[group.id]]"></yp-magic-text></div><div hidden=""class="groupAccess">[[groupAccessText]]</div><yp-magic-text id="objectives"class="groupDescription"widetext$="[[wideText]]"simple-format="[[group.configuration.simpleFormatDescription]]"largefont$="[[largeFont]]"text-type="groupContent"content-language="[[group.language]]"content="[[group.objectives]]"content-id="[[group.id]]"></yp-magic-text></div></div><paper-menu-button class="edit"horizontal-align="[[editMenuAlign]]"hidden$="[[!showMenuItem]]"><paper-icon-button aria-label$="[[t('openGroupMenu')]]"icon="more-vert"slot="dropdown-trigger"></paper-icon-button><paper-listbox slot="dropdown-content"on-iron-select="_menuSelection"><paper-item hidden$="[[!hasGroupAccess]]"id="editMenuItem">[[t('group.edit')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="newCategoryMenuItem">[[t('category.new')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="usersMenuItem">[[t('group.users')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="adminsMenuItem">[[t('group.admins')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="pagesMenuItem">[[t('pages.managePages')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="moderationMenuItem">[[t('flaggedContent')]] <span hidden$="[[!flaggedContentCount]]">&nbsp; ([[flaggedContentCount]])</span></paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="moderationAllMenuItem">[[t('manageAllContent')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="exportXlsMenuItem">[[t('exportGroupXls')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="exportDocxMenuItem">[[t('exportGroupDocx')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="cloneMenuItem">[[t('cloneGroup')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="deleteMenuItem">[[t('group.delete')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="anonymizeMenuItem">[[t('anonymizeGroupContent')]]</paper-item><paper-item hidden$="[[!hasGroupAccess]]"id="deleteContentMenuItem">[[t('deleteGroupContent')]]</paper-item><paper-item id="addPostMenuItem">[[t('post.new')]]</paper-item><paper-item id="openAnalyticsApp"hidden$="[[!hasGroupAccess]]">[[t('openAnalyticsApp')]]</paper-item><paper-item id="openAdminApp"hidden$="[[!hasGroupAccess]]">[[t('editTranslations')]]</paper-item></paper-listbox></paper-menu-button><div class="layout horizontal center-center"style="width: 100%"><paper-material class="urlToReviewButton layout vertical center-center"role="button"hidden$="[[!group.configuration.urlToReview]]"><a href="[[group.configuration.urlToReview]]"target="_blank"><yp-magic-text class="urlToReviewActionText"widetext$="[[wideText]]"largefont$="[[largeFont]]"text-type="urlToReviewActionText"content-language="[[group.language]]"content="[[group.configuration.urlToReviewActionText]]"content-id="[[group.id]]"></yp-magic-text></a></paper-material></div></div><yp-group-stats class="stats"group="[[group]]"hidden$="[[group.configuration.urlToReview]]"></yp-group-stats></div><template is="dom-if"if="[[group]]"restamp=""><template is="dom-if"if="[[hasGroupAccess]]"restamp=""><yp-ajax hidden=""disable-user-error=""method="GET"url="/api/groups/[[group.id]]/flagged_content_count"auto=""on-response="_setFlaggedContentCount"></yp-ajax></template></template><iron-media-query query="(max-width: 800px)"query-matches="{{narrowScreen}}"></iron-media-query><lite-signal on-lite-signal-got-admin-rights="_gotAdminRights"></lite-signal></paper-material></div></template><script>Polymer({is:"yp-group-card-large",behaviors:[Polymer.ypLanguageBehavior,Polymer.GroupBehaviors,Polymer.LargeCardBehaviors,Polymer.AccessHelpers,Polymer.ypGotAdminRightsBehavior,Polymer.ypGotoBehavior,Polymer.ypTruncateBehavior,Polymer.ypMediaFormatsBehavior],properties:{group:{type:Object,observer:"_groupChanged"},hasGroupAccess:{type:Boolean,value:!1,computed:"_hasGroupAccess(group, gotAdminRights)"},groupAccessText:{type:String,computed:"_groupAccessText(group, language)"},showMenuItem:{type:Boolean,value:!1,computed:"_showMenuItem(hasGroupAccess, group)"},exportUrl:{type:String,computed:"_exportUrl(hasGroupAccess, group)"},exportUrlDocx:{type:String,computed:"_exportUrlDocx(hasGroupAccess, group, language, autoTranslateActive)"},autoTranslateActive:{type:Boolean,value:!1},groupVideoURL:{type:String,value:null},groupVideoPosterURL:{type:String,value:null},groupVideoId:Number,flaggedContentCount:{type:Number,value:null}},_autoTranslateEvent:function(e,o){this.set("autoTranslateActive",o)},_exportUrl:function(e,o){return e&&o?"/api/groups/"+o.id+"/export_group":null},_exportUrlDocx:function(e,o,t,n){if(e&&o&&t){var i="";return n&&(i="?translateLanguage="+t),"/api/groups/"+o.id+"/export_group_docx"+i}return null},_showMenuItem:function(e,o){return e||o&&o.configuration&&!0===o.configuration.canAddNewPosts},_hasGroupAccess:function(e,o){return!(!e||!o)&&null!=this.checkGroupAccess(e)},resetGroup:function(){this.set("group",null)},_groupChanged:function(e,o){if(this.async(function(){window.appGlobals.largeFont?this.set("largeFont",!0):this.set("largeFont",!1)},100),e&&e.configuration&&e.configuration.useVideoCover&&e.GroupLogoVideos){var t=this._getVideoURL(e.GroupLogoVideos),n=this._getVideoPosterURL(e.GroupLogoVideos,e.GroupLogoImages);t&&n?(this.set("groupVideoURL",t),this.set("groupVideoPosterURL",n),this.set("groupVideoId",e.GroupLogoVideos[0].id)):this._resetVideo()}else this._resetVideo();this.setupMediaEventListeners(e,o)},_resetVideo:function(){this.set("groupVideoURL",null),this.set("groupVideoPosterURL",null)},_groupAccessText:function(e,o){if(!e||!o)return"";switch(e.access){case 0:return this.t("group.public");case 1:return this.t("group.closed");case 2:return this.t("group.secret")}},_menuSelection:function(e,o){"editMenuItem"===o.item.id?this._openEdit():"newCategoryMenuItem"===o.item.id?this._openCategoryEdit():"deleteMenuItem"===o.item.id?this._openDelete():"cloneMenuItem"===o.item.id?this._openClone():"usersMenuItem"===o.item.id?this._openUsersDialog():"adminsMenuItem"===o.item.id?this._openAdminsDialog():"pagesMenuItem"===o.item.id?this._openPagesDialog():"addPostMenuItem"===o.item.id?this.fire("yp-post-new"):"deleteContentMenuItem"===o.item.id?this._openDeleteContent():"moderationMenuItem"===o.item.id?this._openContentModeration():"moderationAllMenuItem"===o.item.id?this._openAllContentModeration():"exportDocxMenuItem"===o.item.id?this._openCreateDocxReport():"exportXlsMenuItem"===o.item.id?this._openCreateXlsReport():"anonymizeMenuItem"===o.item.id?this._openAnonymizeContent():"openAnalyticsApp"===o.item.id?window.location="/analytics/group/"+this.group.id:"openAdminApp"===o.item.id&&(window.location="/admin/group/"+this.group.id),this.$$("paper-listbox").select(null)},_openContentModeration:function(){window.appGlobals.activity("open","groupContentModeration"),Polymer.dom(document).querySelector("yp-app").getContentModerationAsync(function(e){e.setup(this.group.id,null,null,!1),e.open(this.group.name)}.bind(this))},_openAllContentModeration:function(){window.appGlobals.activity("open","communityAllContentModeration"),Polymer.dom(document).querySelector("yp-app").getContentModerationAsync(function(e){e.setup(this.group.id,null,null,"/moderate_all_content"),e.open(this.group.name)}.bind(this))},_openPagesDialog:function(){window.appGlobals.activity("open","group.pagesAdmin"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("pagesGrid",function(e){e.setup(this.group.id,null,null,!1),e.open()}.bind(this))},_openUsersDialog:function(){window.appGlobals.activity("open","group.users"),Polymer.dom(document).querySelector("yp-app").getUsersGridAsync(function(e){e.setup(this.group.id,null,null,!1),e.open(this.group.name)}.bind(this))},_openAdminsDialog:function(){window.appGlobals.activity("open","group.admins"),Polymer.dom(document).querySelector("yp-app").getUsersGridAsync(function(e){e.setup(this.group.id,null,null,!0),e.open(this.group.name)}.bind(this))},_openEdit:function(){window.appGlobals.activity("open","group.edit"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("groupEdit",function(o){o._clear(),this._refreshGroup(this.group.id,function(e){o.setup(e,!1,this._refresh.bind(this)),o.open("edit",{groupId:e.id})}.bind(this))}.bind(this))},_refreshGroup:function(e,t){var o=document.createElement("iron-ajax");o.url="/api/groups/"+e,o.handleAs="json",o.contentType="application/json",o.body={},o.addEventListener("response",function(e,o){t(e.detail.response.group)}.bind(this)),o.addEventListener("error",function(e,o){console.error("Couldn't refresh grop")}.bind(this)),o.generateRequest()},_openCreateDocxReport:function(){window.appGlobals.activity("open","createReportDocx"),Polymer.dom(document).querySelector("yp-app").getCreateReportAsync(function(e){e.setupAndOpen("docx",this.group,null)}.bind(this))},_openCreateXlsReport:function(){window.appGlobals.activity("open","createReportXls"),Polymer.dom(document).querySelector("yp-app").getCreateReportAsync(function(e){e.setupAndOpen("xls",this.group,null)}.bind(this))},_openDelete:function(){window.appGlobals.activity("open","group.delete"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("apiActionDialog",function(e){e.setup("/api/groups/"+this.group.id,this.t("groupDeleteConfirmation"),this._onDeleted.bind(this)),e.open({finalDeleteWarning:!0})}.bind(this))},_openDeleteContent:function(){window.appGlobals.activity("open","group.deleteContent"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("apiActionDialog",function(e){e.setup("/api/groups/"+this.group.id+"/delete_content",this.t("groupDeleteContentConfirmation")),e.open({finalDeleteWarning:!0})}.bind(this))},_openClone:function(){window.appGlobals.activity("open","group.clone"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("apiActionDialog",function(e){e.setup("/api/groups/"+this.group.id+"/clone",this.t("areYouSureCloneGroup"),this._onCloned.bind(this),this.t("cloneGroup"),"POST"),e.open({finalDeleteWarning:!1})}.bind(this))},_openAnonymizeContent:function(){window.appGlobals.activity("open","group.anonymize"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("apiActionDialog",function(e){e.setup("/api/groups/"+this.group.id+"/anonymize_content",this.t("groupAnonymizeConfirmation"),null,this.t("anonymize")),e.open({finalDeleteWarning:!0})}.bind(this))},_openCategoryEdit:function(){window.appGlobals.activity("open","category.new"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("categoryEdit",function(e){e.setup(this.group,!0,this._refreshCategory.bind(this)),e.open("new",{groupId:this.group.id})}.bind(this))},_refreshCategory:function(){this.fire("update-group")},_onDeleted:function(){this.dispatchEvent(new CustomEvent("yp-refresh-community",{bubbles:!0,composed:!0})),this.redirectTo("/community/"+this.group.community_id)},_onCloned:function(){this.dispatchEvent(new CustomEvent("yp-refresh-community",{bubbles:!0,composed:!0})),this.redirectTo("/community/"+this.group.community_id)},_newCategory:function(){this.$$("#newCategory").open("new",{groupId:this.group.id})},_refresh:function(e){e&&this.set("group",e),this.fire("update-group")}})</script></dom-module></div><dom-module id="yp-group"><template><style include="iron-flex iron-flex-alignment">.objectives{padding-bottom:40px;max-width:432px;}.description{padding:12px;}yp-ajax{background-color:var(--primary-background-color);}.counterInfo{font-size:11px;}.topContainer{margin-top:16px;}.createFab{position:fixed;bottom:24px;right:28px;background-color:var(--accent-color);color:#FFF;--paper-fab-iron-icon:{color:var(--icon-general-color, #FFF);height:40px;width:40px;};}.createFab[is-map]{right:inherit;left:28px;}paper-tab{--paper-tabs:{font-family:var(--app-header-font-family, Roboto);};font-family:var(--app-header-font-family, Roboto);}.createFab[wide-layout]{width:72px;height:72px;--paper-fab-iron-icon:{color:var(--icon-general-color, #FFF);width:50px;height:50px;};}.createFabContainer[wide-layout] .createFab{}.topArea{background-color:var(--primary-background-color);background-image:var(--top-area-background-image, none);height:300px;}.tabs{width:1100px;padding-top:8px;padding-bottom:8px;}.tabs .tab{width:250px;}.largeAddButton{margin-bottom:4px;}@media (max-width: 1000px){.tabs{font-size:15px;}.topArea{height:auto;}}@media (max-width: 600px){.tabs{font-size:14px;word-wrap:break-word !important;}.tabs[has-non-open-posts]{font-size:14px;}.counterInfo[has-non-open-posts]{font-size:9px;}.tabs .tab{word-wrap:break-word !important;}.largeAddButton[is-apple]{margin-top:32px;}.largeAddButton[is-ipad]{margin-top:48px;}}@media (max-width: 380px){.tabs{font-size:14px;width:360px;}paper-tab{}}@media (max-width: 320px){.tabs{font-size:13px;}paper-tab{}}.tabSubTitle{font-size:13px;}.minHeightSection{min-height:450px;}.tabContainer[hide]{display:none;}[hidden]{display:none !important;}</style><div id="topContainer"><div id="topArea"class="large-card-wrapper layout horizontal center-center topArea"hidden$="[[group.configuration.hideGroupHeader]]"><yp-group-card-large id="groupCard"class="largeCard"group="[[group]]"on-update-group="_refreshAjax"></yp-group-card-large></div><div class="largeAddButton layout horizontal center-center"is-apple$="[[isOldiOs]]"is-ipad$="[[isIpad]]"hidden$="[[group.configuration.hideNewPost]]"><yp-post-card-add group="[[group]]"disabled="[[disableNewPosts]]"on-new-post="_newPost"elevation="2"role="button"aria-label="Add idea"></yp-post-card-add></div><div class="layout horizontal center-center tabContainer"hide$="[[group.configuration.hideAllTabs]]"hidden$="[[group.configuration.hideGroupLevelTabs]]"><paper-tabs scrollable$="[[shouldScrollTabs]]"id="paperTabs"has-non-open-posts$="[[hasNonOpenPosts]]"class="tabs"selected="{{selectedTab}}"attr-for-selected="name"focused=""><paper-tab id="tab1"name="open"><div class="layout vertical center-center tabCounterContainer"><div hidden$="[[isTabOpen]]">[[t('posts.open')]]</div><div hidden$="[[!isTabOpen]]"class="tabSubTitsle">[[tabOpenSubTitle]]</div><div class="counterInfo"has-non-open-posts$="[[hasNonOpenPosts]]"id="tabCountOpen"></div></div></paper-tab><template is="dom-if"if="[[hasNonOpenPosts]]"><paper-tab name="in_progress"><div class="layout vertical center-center tabCounterContainer"><div>[[t('posts.inProgress')]]</div><div hidden$="[[!isTabInProgress]]"class="tabSubTitle">[[tabInProgressSubTitle]]</div><div hidden$="[[isTabInProgress]]"has-non-open-posts$="[[hasNonOpenPosts]]"class="counterInfo"id="tabCountInProgress"></div></div></paper-tab><paper-tab name="successful"><div class="layout vertical center-center tabCounterContainer"><div>[[t('posts.successful')]]</div><div hidden$="[[!isTabSuccessful]]"class="tabSubTitle">[[tabSuccessfulSubTitle]]</div><div hidden$="[[isTabSuccessful]]"has-non-open-posts$="[[hasNonOpenPosts]]"class="counterInfo"id="tabCountSuccessful"></div></div></paper-tab><paper-tab name="failed"><div class="layout vertical center-center tabCounterContainer"><div>[[t('posts.failed')]]</div><div hidden$="[[!isTabFailed]]"class="tabSubTitle">[[tabFailedSubTitle]]</div><div hidden$="[[isTabFailed]]"has-non-open-posts$="[[hasNonOpenPosts]]"class="counterInfo"id="tabCountFailed"></div></div></paper-tab></template><paper-tab name="news">[[t('news')]]</paper-tab><paper-tab name="map"hidden$="[[locationHidden]]">[[t('posts.map')]]</paper-tab></paper-tabs></div><iron-pages id="tabPages"class="tabPages"selected="{{selectedTab}}"attr-for-selected="name"entry-animation="fade-in-animation"exit-animation="fade-out-animation"><section name="open"role="main"aria-label$="[[t('posts.posts')]]"><div class="layout horizontal center-center"><yp-post-list id="openPostList"sub-title="{{tabOpenSubTitle}}"selected-tab="[[selectedTab]]"list-route="[[listRoute]]"status-filter="open"tab-counter-id="tabCountOpen"searching-for="[[searchingFor]]"group="[[group]]"group-id="[[lastValidGroupId]]"></yp-post-list></div></section><section name="news"class="minHeightSection"><template is="dom-if"if="[[newsTabSelected]]"><ac-activities id="groupActivities"disable-new-posts="[[disableNewPosts]]"selected-tab="[[selectedTab]]"list-route="[[listRoute]]"group-id="[[group.id]]"></ac-activities></template></section><template is="dom-if"if="[[hasNonOpenPosts]]"><section name="in_progress"><div class="layout horizontal center-center"><yp-post-list id="inProgressPostList"sub-title="{{tabInProgressSubTitle}}"selected-tab="[[selectedTab]]"list-route="[[listRoute]]"status-filter="in_progress"tab-counter-id="tabCountInProgress"searching-for="[[searchingFor]]"group="[[group]]"group-id="[[lastValidGroupId]]"></yp-post-list></div></section><section name="successful"><div class="layout horizontal center-center"><yp-post-list id="successfulPostList"sub-title="{{tabSuccessfulSubTitle}}"selected-tab="[[selectedTab]]"list-route="[[listRoute]]"status-filter="successful"tab-counter-id="tabCountSuccessful"searching-for="[[searchingFor]]"group="[[group]]"group-id="[[lastValidGroupId]]"></yp-post-list></div></section><section name="failed"><div class="layout horizontal center-center"><yp-post-list id="failedPostList"sub-title="{{tabFailedSubTitle}}"selected-tab="[[selectedTab]]"list-route="[[listRoute]]"status-filter="failed"tab-counter-id="tabCountFailed"searching-for="[[searchingFor]]"group="[[group]]"group-id="[[lastValidGroupId]]"></yp-post-list></div></section></template><section name="map"hidden$="[[locationHidden]]"class="minHeightSection"><template is="dom-if"if="[[mapActive]]"restamp=""><yp-post-map id="postsMap"group-id="[[group.id]]"></yp-post-map></template></section></iron-pages></div><template is="dom-if"if="[[!disableNewPosts]]"restamp=""><div class="create-fab-wrapper layout horizontal end-justified createFabContainer"hidden$="[[disableNewPosts]]"><paper-fab class="createFab"icon="[[createFabIcon]]"elevation="5"is-map$="[[mapActive]]"wide-layout$="{{wideWidth}}"title$="[[t('post.new')]]"on-tap="_newPost"></paper-fab></div></template><iron-scroll-threshold id="scrollTheshold"lower-threshold="550"on-lower-threshold="_loadMoreData"scroll-target="document"></iron-scroll-threshold><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-yp-refresh-group-posts="_refreshGroupPosts"></lite-signal><lite-signal on-lite-signal-yp-refresh-activities-scroll-threshold="_clearScrollThreshold"></lite-signal><iron-media-query query="(min-width: 1024px)"query-matches="{{wideWidth}}"></iron-media-query><iron-media-query query="(max-width: 700px)"query-matches="{{phoneWidth}}"></iron-media-query><app-route route="{{idRoute}}"pattern="/:id"data="{{idRouteData}}"tail="{{tabRoute}}"></app-route><app-route route="{{tabRoute}}"pattern="/:tabName"data="{{tabRouteData}}"tail="{{listRoute}}"></app-route><div class="layout horizontal center-center"><yp-ajax large-spinner=""id="ajax"on-response="_groupResponse"></yp-ajax><yp-ajax id="ajaxCheckNonOpenPosts"on-response="_nonOpenPosts"></yp-ajax><yp-ajax id="pagesAjax"on-response="_pagesResponse"></yp-ajax><yp-ajax hidden=""id="configurationAjax"on-response="_configurationAjaxResponse"></yp-ajax></div></template><script>Polymer({is:"yp-group",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypThemeBehavior,Polymer.AccessHelpers,Polymer.YpNewsTabSelected,Polymer.ypDetectOldiOs,Polymer.ypGotoBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypNumberFormatBehavior],listeners:{"yp-post-count":"_updateTabPostCount","yp-post-new":"_newPost"},properties:{idRoute:Object,tabRoute:Object,idRouteData:Object,tabRouteData:Object,listRoute:Object,createFabIcon:{type:String,value:"lightbulb-outline"},groupId:{type:Number,observer:"_groupIdChanged"},group:{type:Object,notify:!0,value:null},searchingFor:{type:String,value:null},selectedTab:{type:String,value:"open",observer:"_selectedTabChanged"},hasNonOpenPosts:{type:Boolean,value:!1,observer:"_refreshTabsAndPages"},mapActive:{type:Boolean,value:!1},lastValidGroupId:{type:String},disableNewPosts:{type:Boolean,value:!1},locationHidden:{type:Boolean,value:!1},tabCounters:{type:Object,value:{}},tabOpenSubTitle:String,tabInProgressSubTitle:String,tabSuccessfulSubTitle:String,tabFailedSubTitle:String,isTabOpen:{type:Boolean,computed:"_isTabOpen(selectedTab)"},isTabInProgress:{type:Boolean,computed:"_isTabInProgress(selectedTab)"},isTabSuccessful:{type:Boolean,computed:"_isTabSuccessful(selectedTab)"},isTabFailed:{type:Boolean,computed:"_isTabFailed(selectedTab)"},isOldiOs:{type:Boolean,computed:"_isOldiOs(groupId)"},isIpad:{type:Boolean,computed:"_isIpad(groupId)"},shouldScrollTabs:{type:Boolean,computed:"_shouldScrollTabs(phoneWidth, hasNonOpenPosts)"},phoneWidth:{type:Boolean,value:null},configCheckTimer:{type:Object,value:null}},configCheckTTL:45e3,newGroupRefresh:!1,_shouldScrollTabs:function(t,o){return t&&o},observers:["_routeIdChanged(idRouteData.id)","_routeTabChanged(tabRouteData.tabName)"],_cancelConfigCheckTimer:function(){this.configCheckTimer&&(clearTimeout(this.configCheckTimer),this.set("configCheckTimer",null))},_startConfigCheckTimer:function(){this._cancelConfigCheckTimer(),this.group&&(this.configCheckTimer=this.async(function(){this.$.configurationAjax.url="/api/groups/"+this.group.id+"/configuration",this.$.configurationAjax.generateRequest()}.bind(this),this.configCheckTTL))},_doesGroupRequireRefresh:function(t,o){return!(!t||!o)&&(t.canVote!==o.canVote||t.canAddNewPosts!==o.canAddNewPosts||t.disableDebate!==o.disableDebate||t.hideNewPost!==o.hideNewPost)},_configurationAjaxResponse:function(t,o){var e=o.response;this.group&&e?(this._doesGroupRequireRefresh(this.group.configuration,e)&&(Polymer.dom(document).querySelector("yp-app").getDialogAsync("masterToast",function(t){t.text=this.t("groupConfigurationHasBeenUpdated"),t.duration=7500,t.close(),t.show()}.bind(this)),this._refreshAjax()),this._startConfigCheckTimer()):this._cancelConfigCheckTimer()},_isTabOpen:function(t){return"open"===t},_isTabInProgress:function(t){return"in_progress"===t},_isTabFailed:function(t){return"failed"===t},_isTabSuccessful:function(t){return"successful"===t},_clearScrollThreshold:function(){this.$$("#scrollTheshold").clearTriggers(),console.info("Clearing scrolling triggers for group")},_loadDataOnTab:function(t){var o=this.$$("#"+t);o?o._loadMoreData():console.error("Cant find tab "+t)},_goToPostIdTab:function(t){var o=this.$$("#"+t);o&&null!==window.appGlobals.cachedPostItem?(o.scrollToPost(window.appGlobals.cachedPostItem),window.appGlobals.cachedPostItem=null):(console.warn("Cant find tab or scroll post "+t+" retrying for item "+window.appGlobals.cachedPostItem),this._retryGoToPostIdTab(t))},_retryGoToPostIdTab:function(o){this.async(function(){var t=this.$$("#"+o);t&&null!==window.appGlobals.cachedPostItem?(t.scrollToPost(window.appGlobals.cachedPostItem),window.appGlobals.cachedPostItem=null):console.warn("Cant find tab or scroll post "+o+" not retrying for item "+window.appGlobals.cachedPostItem)},100)},_isIpad:function(){return/iPad/.test(navigator.userAgent)&&!window.MSStream},goToPostOrNewsItem:function(){if("open"==this.selectedTab)this._goToPostIdTab("openPostList");else if("in_progress"==this.selectedTab)this._goToPostIdTab("inProgressPostList");else if("successful"==this.selectedTab)this._goToPostIdTab("successfulPostList");else if("failed"==this.selectedTab)this._goToPostIdTab("failedPostList");else if("news"==this.selectedTab&&null!==window.appGlobals.cachedActivityItem){var t=this.$$("#groupActivities");t?(t.scrollToItem(window.appGlobals.cachedActivityItem),window.appGlobals.cachedActivityItem=null):console.warn("No group activities for scroll to item")}},_loadMoreData:function(){"open"==this.selectedTab?this._loadDataOnTab("openPostList"):"in_progress"==this.selectedTab?this._loadDataOnTab("inProgressPostList"):"successful"==this.selectedTab?this._loadDataOnTab("successfulPostList"):"failed"==this.selectedTab&&this._loadDataOnTab("failedPostList")},_refreshGroupPosts:function(){this.$$("#openPostList")._refreshGroupFromFilter()},_routeIdChanged:function(t){t&&this.set("groupId",t)},_routeTabChanged:function(t){t&&this.set("selectedTab",t)},_selectedTabChanged:function(t){if("config"==t){this.async(function(){});var o=this.listRoute.path,e=this.idRoute.path.split("/")[1],i=o.substring(1,o.length);e&&i&&""!=i&&window.appGlobals.setupGroupConfigOverride(e,i),this.set("selectedTab","open")}else this.group,"map"==t?this.set("mapActive",!0):this.set("mapActive",!1),t&&window.appGlobals&&window.appGlobals.activity("open","group_tab_"+t,"",{id:this.groupId}),this.async(function(){var t=this.$$("#groupActivities");t&&t.fireResize()},300);this._clearScrollThreshold()},_refreshTabsAndPages:function(){this.async(function(){var t=this.$$("#tabPages");t&&t.forceSynchronousItemUpdate();var o=this.$$("#paperTabs");o&&(o.forceSynchronousItemUpdate(),o.notifyResize())},10)},_updateTabPostCount:function(t,o){!0===this.$.ajaxCheckNonOpenPosts.active?this.async(function(){this._reallyUpdateTabPostCount(t,o)},200):this._reallyUpdateTabPostCount(t,o)},_reallyUpdateTabPostCount:function(t,o){var e=this.$$("#"+o.tabCounterId);e&&(e.innerHTML=this.formatNumber(o.count),this.tabCounters[o.tabCounterId]=o.count),this._setupOpenTab()},_setupOpenTab:function(){console.debug("selectedTab: "+this.selectedTab),console.debug("tabCounters: "+JSON.stringify(this.tabCounters)),this.hasNonOpenPosts&&(this.group.configuration&&this.group.configuration.makeMapViewDefault?console.log("Not opening tabs with ideas in map mode"):4===Object.keys(this.tabCounters).length&&"open"===this.selectedTab&&(this.tabCounters.tabCountOpen&&0<this.tabCounters.tabCountOpen?this.set("selectedTab","open"):this.tabCounters.tabCountInProgress&&0<this.tabCounters.tabCountInProgress?this.set("selectedTab","in_progress"):this.tabCounters.tabCountSuccessful&&0<this.tabCounters.tabCountSuccessful?this.set("selectedTab","successful"):this.tabCounters.tabCountFailed&&0<this.tabCounters.tabCountFailed&&this.set("selectedTab","failed")))},_searchingForChanged:function(){},_filterChanged:function(){},_categoryIdChanged:function(){},_openEdit:function(){this.$$("#groupEdit").open("edit",{groupId:this.group.id})},_refreshAjax:function(){this.async(function(){this._getGroup(),this.$$("#groupActivities")&&this.$$("#groupActivities").loadNewData();var t=this.$$("#postsMap");t&&t.refreshAjax()},100)},_groupIdChanged:function(t,o){if(this._cancelConfigCheckTimer(),t&&t!=this.lastValidGroupId){this.newGroupRefresh=!0,this.set("lastValidGroupId",t),this.set("group",null),this.$.groupCard.resetGroup(),this.$.tabCountOpen.innerHTML="",this.hasNonOpenPosts&&(this.$$("#tabCountInProgress").innerHTML="",this.$$("#tabCountSuccessful").innerHTML="",this.$$("#tabCountFailed").innerHTML=""),this.set("hasNonOpenPosts",!1),this.set("tabCounters",{});var e=parseInt(t);this.selectedTab&&(!o||"map"!==this.selectedTab||this.group.configuration.makeMapViewDefault)||(this.set("selectedTab","open"),this._setupOpenTab()),window.appGlobals.groupItemsCache&&window.appGlobals.groupItemsCache[e]?(this._groupResponse(null,{response:{group:window.appGlobals.groupItemsCache[e],checkServerForNonOpenPosts:!0}}),window.appGlobals.groupItemsCache[e]=null,console.info("Using cache for group id "+t),this.refresh()):this._getGroup()}},_getGroup:function(){this.$.ajax.url="/api/groups/"+this.groupId,this.$.ajax.retryMethodAfter401Login=this._getGroup.bind(this),this.$.ajax.generateRequest()},_pagesResponse:function(t,o){this.fire("yp-set-pages",o.response)},_nonOpenPosts:function(t,o){this.set("hasNonOpenPosts",o.response.hasNonOpenPosts)},_groupResponse:function(t,o){this.set("group",o.response.group),this.set("group.configuration",window.appGlobals.overrideGroupConfigIfNeeded(this.group.id,this.group.configuration)),this.refresh(),null!=this.group.configuration.canAddNewPosts?!0===this.group.configuration.canAddNewPosts?this.set("disableNewPosts",!1):this.set("disableNewPosts",!0):this.set("disableNewPosts",!1),o.response.checkServerForNonOpenPosts&&this.group?(this.$.ajaxCheckNonOpenPosts.url="/api/groups/"+this.group.id+"/checkNonOpenPosts",this.$.ajaxCheckNonOpenPosts.generateRequest()):this.set("hasNonOpenPosts",o.response.hasNonOpenPosts),"edit"==this.selectedTab&&(this.set("tabName","open"),this.$$("#groupCard")._openEdit()),window.appGlobals.postLoadGroupProcessing(this.group),this._startConfigCheckTimer()},setupTopHeaderImage:function(t){var o;this.wideWidth&&(o=t?"url("+this.getImageFormatUrl(t,0)+")":"none",this.updateStyles({"--top-area-background-image":o}))},_useHardBack:function(t){if(t&&t.customBackURL){var o=t.customBackURL;return!(o.startsWith("/community/")||o.startsWith("/group/")||o.startsWith("/domain/")||o.startsWith("/post/"))}return!1},refresh:function(t){if(this.group){this._openHelpPageIfNeeded(),this.fire("yp-set-home-link",{type:"group",id:this.group.id,name:this.group.name}),null!=this.group.configuration.defaultLocale&&window.appGlobals.changeLocaleIfNeeded(this.group.configuration.defaultLocale),window.appGlobals.setCommunityAnalyticsTracker(this.group.Community.google_analytics_code),this.group.Community.configuration&&window.appGlobals.setCommunityPixelTracker(this.group.Community.configuration.facebookPixelId),null!=this.group.theme_id||this.group.configuration&&null!=this.group.configuration.themeOverrideColorPrimary?this.setTheme(this.group.theme_id,this.group.configuration):this.group.Community&&(null!=this.group.Community.theme_id||this.group.Community.configuration&&this.group.Community.configuration.themeOverrideColorPrimary)?this.setTheme(this.group.Community.theme_id,this.group.Community.configuration):this.group.Community&&this.group.Community.Domain&&null!=this.group.Community.Domain.theme_id?this.setTheme(this.group.Community.Domain.theme_id):this.setTheme(1),this.group.configuration.locationHidden&&1==this.group.configuration.locationHidden?this.set("locationHidden",!0):this.set("locationHidden",!1),this._refreshTabsAndPages(),this.group.configuration.useCommunityTopBanner&&this.group.Community.CommunityHeaderImages&&0<this.group.Community.CommunityHeaderImages.length?this.setupTopHeaderImage(this.group.Community.CommunityHeaderImages):this.group.GroupHeaderImages&&0<this.group.GroupHeaderImages.length?this.setupTopHeaderImage(this.group.GroupHeaderImages):this.setupTopHeaderImage(null);var o,e,i=this.checkGroupAccess(this.group);e=this.group.configuration.customBackURL?(o=this.group.configuration.customBackURL,this.group.configuration.customBackName):this.group.Community&&this.group.Community.configuration&&this.group.Community.configuration.redirectToGroupId&&!i?(o="/domain/"+this.group.Community.Domain.id,this.group.Community.Domain.name):(o="/community/"+this.group.community_id,this.group.Community.name),this.fire("change-header",{headerTitle:e,headerDescription:this.group.Community.description,headerIcon:"social:group",documentTitle:this.group.name,enableSearch:!0,hideHelpIcon:!!this.group.configuration.hideHelpIcon||null,useHardBack:this._useHardBack(this.group.configuration),backPath:o}),this.$.pagesAjax.url="/api/groups/"+this.group.id+"/pages",this.$.pagesAjax.generateRequest(),window.appGlobals.setAnonymousGroupStatus(this.group),window.appGlobals.setRegistrationQuestionGroup(this.group),this.group.configuration&&!0===this.group.configuration.disableFacebookLoginForGroup?window.appGlobals.disableFacebookLoginForGroup=!0:window.appGlobals.disableFacebookLoginForGroup=!1,this.group.configuration&&this.group.configuration.externalGoalTriggerUrl?window.appGlobals.externalGoalTriggerGroupId=this.group.id:window.appGlobals.externalGoalTriggerGroupId=null,this.group.Community&&this.group.Community.configuration&&this.group.Community.configuration.signupTermsPageId&&-1!=this.group.Community.configuration.signupTermsPageId?window.appGlobals.signupTermsPageId=this.group.Community.configuration.signupTermsPageId:window.appGlobals.signupTermsPageId=null,this.group.Community&&this.group.Community.configuration&&this.group.Community.configuration.customSamlDeniedMessage?window.appGlobals.currentSamlDeniedMessage=this.group.Community.configuration.customSamlDeniedMessage:window.appGlobals.currentSamlDeniedMessage=null,this.group.Community.configuration&&this.group.Community.configuration.customSamlLoginMessage?window.appGlobals.currentSamlLoginMessage=this.group.Community.configuration.customSamlLoginMessage:window.appGlobals.currentSamlLoginMessage=null,window.appGlobals.currentGroup=this.group,this.group.configuration&&this.group.configuration.forceSecureSamlLogin&&!this.checkGroupAccess(this.group)||this.group.Community&&this.group.Community.configuration&&this.group.Community.configuration.forceSecureSamlLogin&&!this.checkCommunityAccess(this.group.Community)?window.appGlobals.currentForceSaml=!0:window.appGlobals.currentForceSaml=!1,this.group.configuration&&this.group.configuration.makeMapViewDefault&&(this.set("selectedTab","map"),this.set("tabRouteData.tabName","map")),this.group.Community&&this.group.Community.configuration&&this.group.Community.configuration.highlightedLanguages?window.appGlobals.setHighlightedLanguages(this.group.Community.configuration.highlightedLanguages):window.appGlobals.setHighlightedLanguages(null),this.group.configuration&&this.group.configuration.maxNumberOfGroupVotes&&window.appUser.calculateVotesLeftForGroup(this.group)}this.hasNonOpenPosts&&this.tabCounters&&(this.newGroupRefresh||!0===t)&&this._setupOpenTab(),this.newGroupRefresh=!1},_openHelpPageIfNeeded:function(){sessionStorage.getItem("yp-welcome-for-group-"+this.group.id)||this.group&&this.group.configuration&&this.group.configuration.welcomePageId&&this.async(function(){this.fire("yp-open-page",{pageId:this.group.configuration.welcomePageId}),sessionStorage.setItem("yp-welcome-for-group-"+this.group.id,!0)},1200)},_newPost:function(){window.appGlobals.activity("open","newPost"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("postEdit",function(t){t.setup(null,!0,null),t.open("new",{groupId:this.groupId,group:this.group})}.bind(this))}})</script></dom-module>