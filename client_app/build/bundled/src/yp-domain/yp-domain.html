<div hidden=""by-polymer-bundler=""><dom-module id="yp-domain-stats"><template><style include="iron-flex iron-flex-alignment">:host{display:block;}.stats{padding-top:8px;padding-bottom:8px;color:var(--main-stats-color-on-white);}.stats-text{font-size:18px;text-align:right;vertical-align:bottom;padding-right:8px;color:var(--main-stats-color-on-white);}.stats-icon{padding-left:8px;margin-right:4px;}@media (max-width: 945px){.hideIfMobile{display:none;}}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><iron-media-query query="(max-width: 800px)"query-matches="{{narrowScreen}}"></iron-media-query><div class="stats layout horizontal end-justified"><div class="layout horizontal wrap"><div class="layout horizontal"><iron-icon title$="[[t('stats.posts')]]"icon="lightbulb-outline"class="stats-icon"></iron-icon><div title$="[[t('stats.posts')]]"class="stats-text"style="">{{formatNumber(domain.counter_posts)}}</div><iron-icon title$="[[t('stats.discussions')]]"icon="chat-bubble-outline"class="stats-icon"></iron-icon><div title$="[[t('stats.discussions')]]"class="stats-text">{{formatNumber(domain.counter_points)}}</div><iron-icon hidden$="[[narrowScreen]]"title$="[[t('stats.communities')]]"icon="group-work"class="stats-icon hideIfMobile"></iron-icon><div hidden$="[[narrowScreen]]"title$="[[t('stats.communities')]]"class="stats-text hideIfMobile"style="">{{formatNumber(domain.counter_communities)}}</div></div><div class="layout horizontal"><iron-icon hidden=""title$="[[t('stats.groups')]]"icon="people"class="stats-icon hideIfMobile"></iron-icon><div hidden=""title$="[[t('stats.groups')]]"class="stats-text hideIfMobile"style="">{{formatNumber(domain.counter_groups)}}</div><iron-icon title$="[[t('stats.users')]]"icon="face"class="stats-icon"></iron-icon><div title$="[[t('stats.users')]]"class="stats-text">{{formatNumber(domain.counter_users)}}</div></div></div></div></template><script>Polymer({is:"yp-domain-stats",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypNumberFormatBehavior],properties:{domain:{type:Object},narrowScreen:Boolean}})</script></dom-module><dom-module id="yp-domain-large-card"><template><style include="iron-flex iron-flex-alignment">:host{}.description{}.description[largefont]{font-size:15px;}.stats{position:absolute;bottom:0;right:8px;}yp-domain-stats{color :#fff;}.domain-name{padding:0;padding-bottom:4px;padding-right:1px;margin:0;min-height:54px;font-size:42px;font-weight:var(--app-header-font-weight, bold);}.domain-name[largefont]{font-size:38px;}.domain-name[longname]{font-size:32px;padding-bottom:15px;}.large-card{background-color:#fefefe;color:#333;height:243px;width:432px;padding:0 !important;margin-top:0 !important;}.image, video{width:432px;height:243px;}.description-and-stats{width:100%;}.edit{color:#FFF;position:absolute;top:0;right:0px;padding-right:0;margin-right:0;}h1{font-size:42px;}.textBox{margin-left:32px;position:relative;}.description{padding:0;margin:0;}video{outline:none !important;}.domainDescription{padding-left:16px;padding-right:16px;padding-top:16px;}.domain-name{background-color:var(--primary-color-800, #000);color:#fafafa;padding:12px;padding-left:16px;vertical-align:middle;margin:0;padding-right:32px;padding-bottom:6px;padding-top:14px;}.domain-name[largefont]{}@media (max-width: 960px){:host{max-width:423px;padding:0 !important;padding-top:8px !important;width:100%;}.large-card{width:100%;height:100%;margin-left:8px;margin-right:8px;margin-top:8px !important;}.top-card{margin-bottom:16px;}iron-image, video, .image{width:100%;height:230px;}.imageCard{height:230px;}.imageCard[is-video]{background-color:transparent;}.domain-name{font-size:22px;padding-bottom:9px;min-height:28px;}.description{padding-bottom:42px;}.stats{}.textBox{margin-left:8px;}}@media (max-width: 375px){iron-image, video, .image{height:225px;}.imageCard{height:225px;}}@media (max-width: 375px){iron-image, video, .image{height:207px;}.imageCard{height:205px;}}@media (max-width: 360px){iron-image, video, .image{height:200px;}.imageCard{height:200px;}}@media (max-width: 320px){iron-image, video, .image{height:180px;}.imageCard{height:180px;}}[hidden]{display:none !important;}a{text-decoration:none;color:inherit;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><div class="layout horizontal wrap"aria-label="[[t('domain')]]"role="banner"><paper-material is-video$="[[domainVideoURL]]"id="cardImage"elevation="3"animated=""class="large-card imageCard top-card"><template is="dom-if"if="[[domainVideoURL]]"restamp=""><video id="videoPlayer"data-id$="[[domainVideoId]]"controls=""preload="meta"class="image"src="[[domainVideoURL]]"playsinline=""poster="[[domainVideoPosterURL]]"></video></template><template is="dom-if"if="[[!domainVideoURL]]"><iron-image class="image"hidden$="[[hideImage]]"alt$="[[domain.name]]"sizing="cover"src$="[[_domainLogoImagePath(domain)]]"></iron-image></template></paper-material><paper-material id="card"elevation="4"animated=""class="large-card textBox"><div class="layout vertical"><div class="layout horizontal wrap"><div class="layout vertical description-and-stats"><div class="descriptionContainer"><div class="domain-name"longname$="[[longName]]"largefont$="[[largeFont]]"role="heading"aria-level="1"aria-label="[[domain.name]]"><yp-magic-text text-type="domainName"content-language="[[domain.language]]"disable-translation="[[domain.configuration.disableNameAutoTranslation]]"text-only=""content="[[domain.name]]"content-id="[[domain.id]]"></yp-magic-text></div><template is="dom-if"if="[[domain.id]]"><yp-magic-text id="description"class="description domainDescription"largefont$="[[largeFont]]"text-type="domainContent"content-language="[[domain.language]]"content="[[domain.description]]"content-id="[[domain.id]]"></yp-magic-text></template></div></div></div><paper-menu-button vertical-align="top"horizontal-align="[[editMenuAlign]]"class="edit"hidden$="[[!showMenuItem]]"><paper-icon-button aria-label$="[[t('openDomainMenu')]]"icon="more-vert"slot="dropdown-trigger"></paper-icon-button><paper-listbox slot="dropdown-content"on-iron-select="_menuSelection"><paper-item hidden$="[[!hasDomainAccess]]"id="editMenuItem">[[t('domain.edit')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]"id="createOrganizationMenuItem">[[t('domain.createOrganization')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]"id="pagesMenuItem">[[t('pages.managePages')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]"id="usersMenuItem">[[t('domainUsers')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]"id="moderationMenuItem">[[t('flaggedContent')]] <span hidden$="[[!flaggedContentCount]]">&nbsp; ([[flaggedContentCount]])</span></paper-item><paper-item hidden$="[[!hasDomainAccess]]"id="moderationAllMenuItem">[[t('manageAllContent')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]"id="adminsMenuItem">[[t('domainAdmins')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]"id="organizationsGridMenuItem">[[t('organizationsAdmin')]]</paper-item><a hidden$="[[!hasDomainAccess]]"target="_blank"href$="[[exportLoginsUrl]]"><paper-item id="exportLogins">[[t('exportLogins')]]</paper-item></a><paper-item id="addCommunityMenuItem">[[t('community.add')]]</paper-item><paper-item id="addCommunityFolderMenuItem"hidden$="[[!hasDomainAccess]]">[[t('newCommunityFolder')]]</paper-item><paper-item id="openAnalyticsApp"hidden$="[[!hasDomainAccess]]">[[t('openAnalyticsApp')]]</paper-item></paper-listbox></paper-menu-button></div><yp-domain-stats class="stats"domain="[[domain]]"></yp-domain-stats></paper-material></div><template is="dom-if"if="[[domain]]"restamp=""><template is="dom-if"if="[[hasDomainAccess]]"restamp=""><yp-ajax method="GET"disable-user-error=""hidden=""url="/api/domains/[[domain.id]]/flagged_content_count"auto=""on-response="_setFlaggedContentCount"></yp-ajax></template></template><iron-media-query query="(max-width: 945px)"query-matches="{{narrowScreen}}"></iron-media-query><lite-signal on-lite-signal-got-admin-rights="_gotAdminRights"></lite-signal><lite-signal on-lite-signal-yp-pause-media-playback="_pauseMediaPlayback"></lite-signal></template><script>Polymer({is:"yp-domain-large-card",behaviors:[Polymer.ypLanguageBehavior,Polymer.LargeCardBehaviors,Polymer.AccessHelpers,Polymer.ypGotAdminRightsBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypTruncateBehavior],properties:{domain:{type:Object,notify:!0,value:null,observer:"_domainChanged"},elevation:{type:Number},hideImage:{type:Boolean,value:!1},hasDomainAccess:{type:Boolean,value:!1,computed:"_hasDomainAccess(domain, gotAdminRights)"},showMenuItem:{type:Boolean,value:!1,computed:"_showMenuItem(hasDomainAccess, domain)"},domainVideoURL:{type:String,computed:"_domainVideoURL(domain)"},domainVideoPosterURL:{type:String,computed:"_domainVideoPosterURL(domain)"},domainVideoId:Number,flaggedContentCount:{type:Number,value:null},exportLoginsUrl:{type:String,computed:"_exportLoginsUrl(hasDomainAccess, domain)"},largeFont:{type:Boolean,value:!1},longName:{type:Boolean,value:!1}},_exportLoginsUrl:function(n,o){return n&&o?"/api/domains/"+o.id+"/export_logins":null},_domainChanged:function(n,o){this.setupMediaEventListeners(n,o),this.async(function(){n&&n.name&&20<n.name.length?this.set("longName",!0):this.set("longName",!1),window.appGlobals.largeFont?this.set("largeFont",!0):this.set("largeFont",!1)})},_domainVideoURL:function(n){if(n&&n.configuration&&n.configuration.useVideoCover&&n.DomainLogoVideos){var o=this._getVideoURL(n.DomainLogoVideos);return o?(this.set("domainVideoId",n.DomainLogoVideos[0].id),o):null}return null},_domainVideoPosterURL:function(n){if(n&&n.configuration&&n.configuration.useVideoCover&&n.DomainLogoVideos){var o=this._getVideoPosterURL(n.DomainLogoVideos,n.DomainLogoImages);return o||null}return null},_showMenuItem:function(n,o){return n||o&&!o.only_admins_can_create_communities},_hasDomainAccess:function(n,o){return!(!n||!o)&&null!=this.checkDomainAccess(n)},_menuSelection:function(n,o){"editMenuItem"===o.item.id?this._openEdit():"createOrganizationMenuItem"===o.item.id?this._newOrganization():"pagesMenuItem"===o.item.id?this._openPagesDialog():"organizationsGridMenuItem"===o.item.id?this._openOrganizationsGrid():"usersMenuItem"===o.item.id?this._openUsersDialog():"adminsMenuItem"===o.item.id?this._openAdminsDialog():"moderationMenuItem"===o.item.id?this._openContentModeration():"moderationAllMenuItem"===o.item.id?this._openAllContentModeration():"addCommunityMenuItem"===o.item.id?this.fire("yp-new-community"):"addCommunityFolderMenuItem"===o.item.id?this.fire("yp-new-community-folder"):"openAnalyticsApp"===o.item.id&&(window.location="/analytics/domain/"+this.domain.id),this.$$("paper-listbox").select(null)},_openUsersDialog:function(){window.appGlobals.activity("open","domainUsers"),Polymer.dom(document).querySelector("yp-app").getUsersGridAsync(function(n){n.setup(null,null,this.domain.id,!1),n.open(this.domain.name)}.bind(this))},_openAdminsDialog:function(){window.appGlobals.activity("open","domainAdmins"),Polymer.dom(document).querySelector("yp-app").getUsersGridAsync(function(n){n.setup(null,null,this.domain.id,!0),n.open(this.domain.name)}.bind(this))},_openOrganizationsGrid:function(){window.appGlobals.activity("open","domain.organizationsGrid"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("organizationsGrid",function(n){n.open()}.bind(this))},_openPagesDialog:function(){window.appGlobals.activity("open","domain.pagesAdmin"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("pagesGrid",function(n){n.setup(null,null,this.domain.id,!1),n.open()}.bind(this))},_openEdit:function(){window.appGlobals.activity("open","domainEdit"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("domainEdit",function(n){n.setup(this.domain,!1,this._refresh.bind(this)),n.open("edit",{domainId:this.domain.id})}.bind(this))},_openContentModeration:function(){window.appGlobals.activity("open","domainContentModeration"),Polymer.dom(document).querySelector("yp-app").getContentModerationAsync(function(n){n.setup(null,null,this.domain.id,!1),n.open(this.domain.name)}.bind(this))},_openAllContentModeration:function(){window.appGlobals.activity("open","domainAllContentModeration"),Polymer.dom(document).querySelector("yp-app").getContentModerationAsync(function(n){n.setup(null,null,this.domain.id,"/moderate_all_content"),n.open(this.domain.name)}.bind(this))},_newOrganization:function(){window.appGlobals.activity("open","organizationEdit"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("organizationEdit",function(n){n.setup(null,!0,this._refresh.bind(this)),n.open("new",{domainId:this.domain.id})}.bind(this))},_refresh:function(n){n&&this.set("domain",n),this.fire("update-domain")},_domainName:function(n){return n&&n.name?this.truncate(this.trim(n.name),200):n?n.short_name:void 0},_domainLogoImagePath:function(n){if(n)return this.getImageFormatUrl(n.DomainLogoImages,0)},_domainHeaderImagePath:function(n){if(n)return this.getImageFormatUrl(n.DomainHeaderImages,0)}})</script></dom-module></div><dom-module id="yp-domain"><template><style include="iron-flex iron-flex-alignment">ac-activities{@apply --layout-vertical;@apply --layout-flex;}.card-container{@apply --layout-horizontal;@apply --layout-wrap;}.card{padding:16px;}paper-tab{--paper-tabs:{font-family:var(--app-header-font-family, Roboto);};font-family:var(--app-header-font-family, Roboto);}@media (max-width: 330px){.card{padding-left:0;padding-right:0;padding-bottom:8px;padding-top:8px;}.card-container{padding:0;margin:0;}}yp-ajax{background-color:var(--primary-background-color);}.twitterFeed{margin-top:24px;}.archivedText{font-size:26px;color:#333;}.ypBottomContainer{@apply --layout-horizontal;@apply --layout-center-center;}:host{display:block;}.minHeightSection{min-height:450px;}#paper_tabs[apple]{margin-top:42px;margin-bottom:8px;}[hidden]{display:none !important;}</style><yp-page id="page"create-fab-icon="[[createFabIcon]]"create-fab-title="[[t('community.add')]]"on-yp-create-fab-tap="_newCommunity"role="main"aria-label$="[[t('communities')]]"><yp-domain-large-card id="domainCard"slot="largeCard"class="largeCard card"domain="[[domain]]"on-update-domain="_refreshAjax"></yp-domain-large-card><paper-tabs id="paper_tabs"apple$="[[isOldiOs]]"slot="tabs"class="tabs"selected="{{selectedTab}}"attr-for-selected="name"focused=""><paper-tab name="communities"class="tab"><span>[[t('communities')]]</span> &nbsp; (<span>[[communitiesLength]]</span>)</paper-tab><paper-tab name="news"class="tab"hidden$="[[domain.configuration.hideDomainNews]]">[[t('news')]]</paper-tab></paper-tabs><iron-pages class="tabPages"fullbleed=""slot="tabPages"selected="{{selectedTab}}"attr-for-selected="name"entry-animation="fade-in-animation"exit-animation="fade-out-animation"><section name="communities"class="layout vertical"role="main"aria-label$="[[t('communities')]]"><div class="card-container layout center-center wrap"><yp-community-grid id="communityGrid"featured-communities="[[featuredCommunities]]"active-communities="[[activeCommunities]]"archived-communities="[[archivedCommunities]]"hide-add$="[[!createFabIcon]]"on-add-new-community="_newCommunity"></yp-community-grid></div></section><section name="news"class="minHeightSection"><template is="dom-if"if="[[newsTabSelected]]"><ac-activities id="domainNews"selected-tab="[[selectedTab]]"domain-id="[[domain.id]]"></ac-activities></template></section></iron-pages></yp-page><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-logged-in="_userLoggedIn"></lite-signal><lite-signal on-lite-signal-got-admin-rights="_gotAdminRights"></lite-signal><app-route route="{{idRoute}}"pattern="/:id"data="{{idRouteData}}"tail="{{tabRoute}}"></app-route><app-route route="{{tabRoute}}"pattern="/:tabName"data="{{tabRouteData}}"></app-route><div class="ypBottomContainer"><yp-ajax id="ajax"url="[[url]]"on-response="_response"></yp-ajax><yp-ajax id="pagesAjax"on-response="_pagesResponse"></yp-ajax></div></template><script>Polymer({is:"yp-domain",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypThemeBehavior,Polymer.CommunityCollectionBehaviors,Polymer.CollectionHelpers,Polymer.AccessHelpers,Polymer.YpNewsTabSelected,Polymer.ypLoggedInUserBehavior,Polymer.ypDetectOldiOs,Polymer.ypGotoBehavior,Polymer.ypGotAdminRightsBehavior],properties:{idRoute:Object,tabRoute:Object,idRouteData:Object,tabRouteData:Object,createFabIcon:{type:String,value:null,notify:!0},domainId:{type:Number,value:null,observer:"_domainIdChanged"},url:{type:String},domainEmpty:{type:Boolean,value:!1},domain:{type:Object},selectedTab:{type:String,value:"communities",observer:"_selectedTabChanged"},otherSocialMediaActive:{type:Boolean,value:!1},isOldiOs:{type:Boolean,computed:"_isOldiOs(domainId)"},disableRefreshOnce:{type:Boolean,value:!1},hasDomainAccess:{type:Boolean,computed:"_hasDomainAccess(domain, gotAdminRights, loggedInUser)"}},observers:["_routeIdChanged(idRouteData.id)","_routeTabChanged(tabRouteData.tabName)"],listeners:{"yp-new-community":"_newCommunity","yp-new-community-folder":"_newCommunityFolder"},_hasDomainAccess:function(e){if(e){var i=this.checkDomainAccess(e);return!e.only_admins_can_create_communities||i?this.set("createFabIcon","add"):this.set("createFabIcon",void 0),i}return!1},scrollToCommunityItem:function(){if("news"===this.selectedTab&&null!==window.appGlobals.cachedActivityItem){var e=this.$$("#domainNews");e?(e.scrollToItem(window.appGlobals.cachedActivityItem),window.appGlobals.cachedActivityItem=null):console.warn("No domain activities for scroll to item")}else"communities"===this.selectedTab&&window.appGlobals.backToDomainCommunityItems&&window.appGlobals.backToDomainCommunityItems[this.domain.id]&&(this.$.communityGrid.scrollToItem(window.appGlobals.backToDomainCommunityItems[this.domain.id]),window.appGlobals.backToDomainCommunityItems[this.domain.id]=null)},_userLoggedIn:function(e){e&&this.domain&&-1<window.location.href.indexOf("/domain/")&&this.$.ajax.generateRequest()},_routeIdChanged:function(e){e&&this.set("domainId",e)},_routeTabChanged:function(e){e&&this.set("selectedTab",e)},_selectedTabChanged:function(e){"other_social_media"==e?this.set("otherSocialMediaActive",!0):this.set("otherSocialMediaActive",!1),this.domain&&this.redirectTo("/domain/"+this.domain.id+"/"+e),e&&window.appGlobals&&window.appGlobals.activity("open","domain_tab_"+e),this.async(function(){var e=this.$$("#domainNews");e&&e.fireResize()},300)},_domainIdChanged:function(e){e&&(this.set("featuredCommunities",null),this.set("activeCommunities",null),this.set("archivedCommunities",null),this.$.ajax.url="/api/domains/"+this.domainId,this.$.ajax.generateRequest())},_refreshAjax:function(){this.async(function(){this.$.ajax.generateRequest()},100)},_refreshAjaxLimited:function(){this.set("disableRefreshOnce",!0),this._refreshAjax()},_newCommunity:function(){window.appGlobals.activity("open","newCommunity"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("communityEdit",function(e){e.setup(null,!0,this._refreshAjaxLimited.bind(this)),e.open("new",{domainId:this.domainId})}.bind(this))},_newCommunityFolder:function(){window.appGlobals.activity("open","newCommunityFolder"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("communityEdit",function(e){e.setup(null,!0,this._refreshAjaxLimited.bind(this),!0),e.open("new",{domainId:this.domainId})}.bind(this))},_pagesResponse:function(e,i){this.fire("yp-set-pages",i.response)},_response:function(e,i){console.log("Got domain response: "+i.response.id),this.set("domain",i.response),window.appGlobals.domain=this.domain,this.disableRefreshOnce?this.set("disableRefreshOnce",!1):this.refresh(),window.appGlobals.setupGoogleAnalytics(this.domain),this.domain.Communities&&this.setupCommunities(__.dropRight(this.domain.Communities,this.domain.Communities.length-500)),this.$.domainCard.setElevation(5),this.$.domainCard.lowerCardLater()},refresh:function(){this.domain&&(null!=this.domain.default_locale&&window.appGlobals.changeLocaleIfNeeded(this.domain.default_locale),null!=this.domain.theme_id&&this.setTheme(this.domain.theme_id),this.fire("yp-set-home-link",{type:"domain",id:this.domain.id,name:this.domain.name}),this.fire("change-header",{headerTitle:null,documentTitle:this.domain.name,headerDescription:this.domain.description}),this.domain.DomainHeaderImages&&0<this.domain.DomainHeaderImages.length?this.$.page.setupTopHeaderImage(this.domain.DomainHeaderImages):this.$.page.setupTopHeaderImage(null),this.$.pagesAjax.url="/api/domains/"+this.domain.id+"/pages",this.$.pagesAjax.generateRequest(),window.appGlobals.setHighlightedLanguages(null)),window.appGlobals.setAnonymousGroupStatus(null),window.appGlobals.setRegistrationQuestionGroup(null),window.appGlobals.disableFacebookLoginForGroup=!1,window.appGlobals.externalGoalTriggerGroupId=null,window.appGlobals.currentForceSaml=!1,window.appGlobals.currentSamlDeniedMessage=null,window.appGlobals.currentSamlLoginMessage=null,window.appGlobals.currentGroup=null}})</script></dom-module>