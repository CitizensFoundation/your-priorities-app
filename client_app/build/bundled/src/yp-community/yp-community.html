<div hidden=""by-polymer-bundler=""><dom-module id="yp-group-card"assetpath="../yp-group/"><template><style include="iron-flex iron-flex-alignment">:host{display:block;@apply --layout-vertical;width:416px;}.description{color:var(--primary-color-more-darker, #424242);line-height:var(--description-line-height, 1.3);}.groupCard{height:445px;background-color:#fff;}.objectives{@apply --layout-vertical;color:var(--primary-color-more-darker, #424242);line-height:var(--objectives-line-height, 1.3);padding:16px;font-size:16px;}.objectives[widetext]{font-size:15px;}.stats{position:absolute;bottom:0px;right:8px;}.group-name[archived]{background-color:#aaa;}iron-image[archived]{opacity:0.85;filter:alpha(opacity=85);}.post-image{}iron-image{width:416px;height:234px;display:block;}yp-group-stats{color:var(--primary-color-more-darker, #424242);}paper-card{background-color:#f00;vertical-align:text-top;}.informationText{vertical-align:text-top;}.group-name{margin:0;font-size:var(--large-heading-size, 26px);padding:8px;padding-top:16px;padding-bottom:16px;background-color:var(--primary-color-800);color:#FFF;font-weight:bold;cursor:pointer;vertical-align:middle;width:auto;}.groupNameFontSize4Wide{font-size:30px;}.groupNameFontSize3Wide{font-size:26px;}.groupNameFontSize2Wide{font-size:24px;}.groupNameFontSize1Wide{font-size:22px;}.groupNameFontSize4Mobile{font-size:28px;}.groupNameFontSize3Mobile{font-size:24px;}.groupNameFontSize2Mobile{font-size:22px;}.groupNameFontSize1Mobile{font-size:19px;}.groupNameFontSize4Wide[widetext]{font-size:26px;}.groupNameFontSize3Wide[widetext]{font-size:22px;}.groupNameFontSize2Wide[widetext]{font-size:20px;}.groupNameFontSize1Wide[widetext]{font-size:18px;}.groupNameFontSize4Mobile[widetext]{font-size:26px;}.groupNameFontSize3Mobile[widetext]{font-size:22px;}.groupNameFontSize2Mobile[widetext]{font-size:20px;}.groupNameFontSize1Mobile[widetext]{font-size:18px;}.group-name[featured]{font-size:25px;background-color:var(--accent-color);}yp-membership-button[archived]{display:none;}yp-membership-button{position:absolute;right:24px;top:214px;width:32px;height:32px;color:var(--icon-general-color, #FFF);}.objectives{padding:8px;}@media (max-width: 960px){:host{max-width:423px;width:100%;padding-top:0 !important;}.groupCard{margin-left:0;margin-right:0;padding-left:0;padding-right:0;width:100%;height:100%;padding-bottom:38px;}yp-membership-button{top:205px;}iron-image{width:100%;height:230px;}.group-name{width:auto;}}@media (max-width: 420px){iron-image{height:225px;}yp-membership-button{top:205px;}}@media (max-width: 375px){iron-image{height:207px;}yp-membership-button{top:185px;}}@media (max-width: 360px){iron-image{height:200px;}}@media (max-width: 320px){iron-image{height:180px;}yp-membership-button{top:155px;}}.withPointer{cursor:pointer;}.edit{color:#888;position:absolute;bottom:0;right:0;padding-right:0;margin-right:0;text-align:right;}[hidden]{display:none !important;}.group-name[has-data-viz]{padding-top:26px;}</style><iron-media-query query="(min-width: 600px)"query-matches="{{wide}}"></iron-media-query><paper-card class="groupCard"animated=""elevation="[[elevation]]"><template is="dom-if"if="[[!group.CommunityLink]]"><template is="dom-if"if="[[visualizationData]]"><yp-data-visualization small=""data="[[visualizationData]]"></yp-data-visualization></template><template is="dom-if"if="[[!visualizationData]]"><iron-image hidden$="[[!noImage]]"header-mode$="[[headerMode]]"archived$="[[archived]]"sizing="cover"class="main-image withPointer"src="https://i.imgur.com/sdsFAoT.png"on-tap="_goToGroup"></iron-image><iron-image hidden$="[[noImage]]"archived$="[[archived]]"class="logo withPointer"alt$="[[group.name]]"sizing="cover"on-tap="_goToGroup"preload=""src="[[groupLogoImagePath]]"></iron-image></template><yp-magic-text id="groupName"has-data-viz$="[[visualizationData]]"class="group-name"widetext$="[[wideText]]"text-type="groupName"content-language="[[group.language]]"archived$="[[archived]]"featured$="[[featured]]"on-tap="_goToGroup"disable-translation="[[group.configuration.disableNameAutoTranslation]]"text-only=""content="[[groupName]]"content-id="[[group.id]]"></yp-magic-text><yp-magic-text id="objectives"widetext$="[[wideText]]"class="objectives withPointer"on-tap="_goToGroup"text-type="groupContent"content-language="[[group.language]]"remove-urls=""text-only=""content="[[groupObjectives]]"content-id="[[group.id]]"truncate="200"></yp-magic-text><yp-group-stats class="stats"group="[[group]]"></yp-group-stats><yp-membership-button archived$="[[archived]]"group="[[group]]"></yp-membership-button></template><template is="dom-if"if="[[group.CommunityLink]]"><iron-image hidden$="[[!noImage]]"header-mode$="[[headerMode]]"archived$="[[archived]]"sizing="cover"c=""lass="main-image withPointer"src="https://i.imgur.com/sdsFAoT.png"on-tap="_goToGroup"></iron-image><iron-image hidden$="[[noImage]]"archived$="[[archived]]"class="logo withPointer"alt$="[[group.CommunityLink.name]]"sizing="cover"on-tap="_goToGroup"preload=""src="[[groupCommuntityLinkLogoImagePath]]"></iron-image><yp-magic-text id="groupName"class="group-name"widetext$="[[wideText]]"text-type="communityName"content-language="[[group.CommunityLink.language]]"archived$="[[archived]]"featured$="[[featured]]"on-tap="_goToGroup"disable-translation="[[group.configuration.disableNameAutoTranslation]]"text-only=""content="[[group.CommunityLink.name]]"content-id="[[group.CommunityLink.id]]"></yp-magic-text><yp-magic-text id="objectives"widetext$="[[wideText]]"class="objectives withPointer"on-tap="_goToGroup"text-type="communityContent"content-language="[[group.CommunityLink.language]]"remove-urls=""text-only=""content="[[group.CommunityLink.description]]"content-id="[[group.CommunityLink.id]]"truncate="200"></yp-magic-text><div class="edit"><paper-icon-button class="editButtons"hidden$="[[!hasGroupAccess]]"aria-label$="[[t('openDelete')]]"on-tap="_openDelete"icon="delete"></paper-icon-button><paper-icon-button class="editButtons"hidden$="[[!hasGroupAccess]]"aria-label$="[[t('openEdit')]]"on-tap="_openEdit"icon="create"></paper-icon-button></div></template></paper-card><lite-signal on-lite-signal-got-admin-rights="_gotAdminRights"></lite-signal></template><script>Polymer({is:"yp-group-card",behaviors:[Polymer.ypLanguageBehavior,Polymer.GroupBehaviors,Polymer.ypTruncateBehavior,Polymer.ypGotAdminRightsBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypGotoBehavior,Polymer.AccessHelpers],properties:{hasGroupAccess:{type:Boolean,value:!1,computed:"_hasGroupAccess(group, gotAdminRights)"},visualizationData:{type:Object,value:null}},_openDelete:function(e){e.preventDefault(),window.appGlobals.activity("open","group.delete"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("apiActionDialog",function(e){e.setup("/api/groups/"+this.group.id,this.t("groupDeleteConfirmation"),this._onDeleted.bind(this)),e.open({finalDeleteWarning:!0})}.bind(this))},_onDeleted:function(){this.dispatchEvent(new CustomEvent("yp-refresh-community",{bubbles:!0,composed:!0})),this.redirectTo("/community/"+this.group.community_id)},_openEdit:function(e){e.preventDefault(),window.appGlobals.activity("open","group.edit"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("groupEdit",function(e){e._clear(),e.setup(this.group,!1,this._refresh.bind(this)),e.open("edit",{groupId:this.group.id})}.bind(this))},_refresh:function(){this.redirectTo("/community/"+this.group.community_id)},_hasGroupAccess:function(e,o){return!(!e||!o)&&null!=this.checkGroupAccess(e)}})</script></dom-module><dom-module id="yp-group-grid"assetpath="../yp-group/"><template><style include="iron-flex iron-flex-alignment">.groupCard{padding:0;padding-top:16px;}.groupCard[wide-padding]{padding:16px !important;}iron-list{height:100vh;}[hidden]{display:none !important;}:focus{}@media (max-width: 1199px){.groupCard{}}a{text-decoration:none;width:100%;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><iron-media-query query="(min-width: 1024px)"query-matches="{{wide}}"></iron-media-query><div class="layout horizontal center-center"><iron-list id="ironList"selection-enabled=""scroll-offset="[[scrollOffset]]"on-selected-item-changed="_selectedItemChanged"items="[[activeGroups]]"as="group"scroll-target="document"role="list"grid$="[[wide]]"><template><div class="groupCard layout vertical center-center"wide-padding$="[[wide]]"tabindex$="[[tabIndex]]"role="listitem"aria-level="2"aria-label="[[group.name]]"><a href="[[_getGroupUrl(group)]]"id="groupCardHref[[group.id]]"class="layout vertical center-center"><yp-group-card wide-padding$="[[wide]]"group="[[group]]"on-mouseover="cardMouseOver"on-mouseout="cardMouseOut"></yp-group-card></a></div></template></iron-list></div></template><script>Polymer({is:"yp-group-grid",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypIronListBehavior,Polymer.ypCardMouseBehavior],properties:{featuredGroups:Array,archivedGroups:Array,activeGroups:Array,hideAdd:{type:Boolean,value:!1},wide:{type:Boolean,value:!1},scrollOffset:{type:Number,computed:"_scrollOffset(wide, featuredGroups, activeGroups)"}},_selectedItemChanged:function(o,r){if(r&&r.value){var e=this.$$("#groupCardHref"+r.value.id);e&&e.click()}},_getGroupUrl:function(o){return o&&o.configuration&&o.configuration.actAsLinkToCommunityId?"/community/"+o.configuration.actAsLinkToCommunityId:o&&o.configuration&&o.configuration.isDataVisualizationGroup&&o.configuration.dataForVisualizationJson?"/group_data_viz/"+o.id:"/group/"+o.id},_scrollOffset:function(o){var r=this.$.ironList;if(r){var e=r.offsetTop;return e-=75,0<r.offsetTop&&0<e?console.info("Group list scroll offset: "+e):(e=o?390:450,console.info("Group list (manual) scroll offset: "+e)),e}return console.warn("No group list for scroll offset"),null},scrollToItem:function(o){console.log("Group grid scrolling to item"),this.$.ironList.scrollToItem(o),document.dispatchEvent(new CustomEvent("lite-signal",{bubbles:!0,compose:!0,detail:{name:"yp-refresh-activities-scroll-threshold",data:{}}}))},_newGroup:function(){this.fire("add-new-group")}})</script></dom-module></div><dom-module id="yp-community"><template><style include="iron-flex iron-flex-alignment">.card-container{@apply --layout-horizontal;@apply --layout-wrap;}.card{padding:16px;}yp-ajax{background-color:var(--primary-background-color) !important;}.archivedText{font-size:26px;color:#333;}.minHeightSection{min-height:450px;}#paper_tabs[apple]{margin-top:42px;margin-bottom:8px;}[hidden]{display:none !important;}</style><yp-page id="page"create-fab-icon="[[createFabIcon]]"create-fab-title="[[t('group.add')]]"on-yp-create-fab-tap="_newGroup"hide-all-tabs="[[community.configuration.hideAllTabs]]"role="main"aria-label$="[[t('groups')]]"><template is="dom-if"if="[[useAlternativeHeader]]"><yp-community-header id="communityCard"slot="largeCard"class="largeCard card"community="[[community]]"on-update-community="_refreshAjax"></yp-community-header></template><template is="dom-if"if="[[useNormalHeader]]"><yp-community-large-card id="communityCard"slot="largeCard"class="largeCard card"community="[[community]]"on-update-community="_refreshAjax"></yp-community-large-card></template><paper-tabs id="paper_tabs"apple$="[[isOldiOs]]"slot="tabs"class="tabs"selected="{{selectedTab}}"attr-for-selected="name"focused=""hidden$="[[community.configuration.hideAllTabs]]"><paper-tab name="groups"class="tab"><span>[[t('groups')]]</span> &nbsp; (<span>[[groupsLength]]</span>)</paper-tab><paper-tab name="news"class="tab">[[t('news')]]</paper-tab><paper-tab name="map"class="tab"hidden$="[[locationHidden]]">[[t('posts.map')]]</paper-tab></paper-tabs><iron-pages class="tabPages"slot="tabPages"selected="{{selectedTab}}"attr-for-selected="name"entry-animation="fade-in-animation"exit-animation="fade-out-animation"><section name="groups"role="main"aria-label$="[[t('groups')]]"><div class="layout horizontal center-center"><yp-group-grid id="groupGrid"featured-groups="[[featuredGroups]]"active-groups="[[activeGroups]]"archived-groups="[[archivedGroups]]"hide-add$="[[!createFabIcon]]"on-add-new-group="_newGroup"></yp-group-grid></div></section><section class="minHeightSection"name="news"><template is="dom-if"if="[[newsTabSelected]]"><ac-activities id="communityNews"selected-tab="[[selectedTab]]"community-id="[[community.id]]"></ac-activities></template></section><section class="minHeightSection"name="map"hidden$="[[locationHidden]]"><template is="dom-if"if="[[mapActive]]"restamp=""><yp-post-map community-id="[[community.id]]"></yp-post-map></template></section></iron-pages></yp-page><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-logged-in="_userLoggedIn"></lite-signal><lite-signal on-lite-signal-got-admin-rights="_gotAdminRights"></lite-signal><app-route route="{{idRoute}}"pattern="/:id"data="{{idRouteData}}"tail="{{tabRoute}}"></app-route><app-route route="{{tabRoute}}"pattern="/:tabName"data="{{tabRouteData}}"></app-route><yp-ajax id="ajax"url="/api/communities"on-response="_response"></yp-ajax><yp-ajax id="pagesAjax"on-response="_pagesResponse"></yp-ajax></template><script>Polymer({is:"yp-community",behaviors:[Polymer.ypLanguageBehavior,Polymer.GroupCollectionBehaviors,Polymer.ypThemeBehavior,Polymer.CollectionHelpers,Polymer.AccessHelpers,Polymer.YpNewsTabSelected,Polymer.ypLoggedInUserBehavior,Polymer.ypDetectOldiOs,Polymer.ypGotoBehavior,Polymer.ypMediaFormatsBehavior],properties:{idRoute:Object,tabRoute:Object,idRouteData:Object,tabRouteData:Object,createFabIcon:{type:String,value:null,notify:!0},communityId:{type:Number,value:null,observer:"_communityIdChanged"},community:{type:Object},selectedTab:{type:String,value:"groups",observer:"_selectedTabChanged"},mapActive:{type:Boolean,value:!1},locationHidden:{type:Boolean,value:!1},useAlternativeHeader:{type:Boolean,value:!1},isOldiOs:{type:Boolean,computed:"_isOldiOs(communityId)"},useNormalHeader:{type:Boolean,value:!0}},observers:["_routeIdChanged(idRouteData.id)","_routeTabChanged(tabRouteData.tabName)"],listeners:{"yp-new-group":"_newGroup"},_userLoggedIn:function(t){t&&this.community&&-1<window.location.href.indexOf("/community/")&&this.$$("#ajax").generateRequest()},_newPostForGroup:function(i){window.appGlobals.activity("open","newPost"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("postEdit",function(t){t.setup(null,!0,null),t.open("new",{groupId:i.id,group:i})}.bind(this))},_refreshTabsAndPages:function(){this.async(function(){var t=this.$$("#tabPages");t&&t.forceSynchronousItemUpdate();var i=this.$$("#paper_tabs");i&&(i.forceSynchronousItemUpdate(),i.notifyResize())},10)},scrollToGroupItem:function(){if("news"===this.selectedTab&&null!==window.appGlobals.cachedActivityItem){var t=this.$$("#communityNews");t?(t.scrollToItem(window.appGlobals.cachedActivityItem),window.appGlobals.cachedActivityItem=null):console.warn("No community activities for scroll to item")}else"groups"===this.selectedTab&&window.appGlobals.backToCommunityGroupItems&&window.appGlobals.backToCommunityGroupItems[this.community.id]&&(this.$.groupGrid.scrollToItem(window.appGlobals.backToCommunityGroupItems[this.community.id]),window.appGlobals.backToCommunityGroupItems[this.community.id]=null)},_routeIdChanged:function(t){t&&this.set("communityId",t)},_routeTabChanged:function(t){t&&this.set("selectedTab",t)},_selectedTabChanged:function(t){this.community&&this.redirectTo("/community/"+this.community.id+"/"+t),"map"==t?this.set("mapActive",!0):this.set("mapActive",!1),t&&window.appGlobals&&window.appGlobals.activity("open","community_tab_"+t,"",{id:this.communityId}),this.async(function(){var t=this.$$("#communityNews");t&&t.fireResize()},300)},_hideEdit:function(){return!this.community||(!window.appUser.loggedIn()||window.appUser.user.id!=this.community.user_id)},_communityHeaderUrl:function(t){return this.getImageFormatUrl(t.CommunityHeaderImages,2)},_communityIdChanged:function(t){t&&(this.set("community",null),this.set("featuredGroups",null),this.set("activeGroups",null),this.set("archivedGroups",null),this.set("selectedTab","groups"),this._getCommunity())},_getCommunity:function(){this.$$("#ajax").url="/api/communities/"+this.communityId,this.$$("#ajax").retryMethodAfter401Login=this._getCommunity.bind(this),this.$$("#ajax").generateRequest()},_newGroup:function(){window.appGlobals.activity("open","newGroup"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("groupEdit",function(t){t.setup(null,!0,this._refreshAjax.bind(this)),t.open("new",{communityId:this.communityId,community:this.community})}.bind(this))},_pagesResponse:function(t,i){this.fire("yp-set-pages",i.response)},_response:function(t,i){if(this.set("community",i.response),this.community.is_community_folder)this.redirectTo("/community_folder/"+this.community.id);else{this.refresh(),this.community.is_community_folder||this.community.only_admins_can_create_groups&&!this.checkCommunityAccess(this.community)||this.set("createFabIcon","add");this._communityHeaderUrl(this.community);this.setupGroups(this.community.Groups,this.community.configuration),this._setLocationHidden(this.community.Groups),this.community.Groups&&0<this.community.Groups.length&&window.appGlobals.setAnonymousGroupStatus(this.community.Groups[0]),this.async(function(){var t=this.$$("#communityCard");t&&(t.setElevation(5),t.lowerCardLater())},20)}},_gotAdminRights:function(t,i){i&&0<i&&this.checkCommunityAccess(this.community)&&this.set("createFabIcon","add")},_setLocationHidden:function(t){var i=!0;t.forEach(function(t){t.configuration&&t.configuration.locationHidden?1!=t.configuration.locationHidden&&(i=!1):i=!1}.bind(this)),this.set("locationHidden",i),this._refreshTabsAndPages()},_openHelpPageIfNeeded:function(){sessionStorage.getItem("yp-welcome-for-community-"+this.community.id)||this.community&&this.community.configuration&&this.community.configuration.welcomePageId&&this.async(function(){this.fire("yp-open-page",{pageId:this.community.configuration.welcomePageId}),sessionStorage.setItem("yp-welcome-for-community-"+this.community.id,!0)},1200)},_useHardBack:function(t){if(t&&t.customBackURL){var i=t.customBackURL;return!(i.startsWith("/community/")||i.startsWith("/group/")||i.startsWith("/domain/")||i.startsWith("/post/"))}return!1},refresh:function(){if(this.community){var t,i,e;if(this._openHelpPageIfNeeded(),this.fire("yp-set-home-link",{type:"community",id:this.community.id,name:this.community.name}),window.appGlobals.setCommunityAnalyticsTracker(this.community.google_analytics_code),this.community.configuration&&window.appGlobals.setCommunityPixelTracker(this.community.configuration.facebookPixelId),null!=this.community.theme_id||this.community.configuration&&null!=this.community.configuration.themeOverrideColorPrimary?this.setTheme(this.community.theme_id,this.community.configuration):null!=this.community.Domain.theme_id&&this.setTheme(this.community.Domain.theme_id),null!=this.community.default_locale&&window.appGlobals.changeLocaleIfNeeded(this.community.default_locale),this.community.configuration&&this.community.configuration.alternativeHeader&&""!=this.community.configuration.alternativeHeader?(this.set("useAlternativeHeader",!0),this.set("useNormalHeader",!1)):(this.set("useAlternativeHeader",!1),this.set("useNormalHeader",!0)),this.community.CommunityHeaderImages&&0<this.community.CommunityHeaderImages.length?this.$.page.setupTopHeaderImage(this.community.CommunityHeaderImages):this.$.page.setupTopHeaderImage(null),-1<window.location.href.indexOf("/community"))e=this.community.CommunityFolder?(t="/community_folder/"+this.community.CommunityFolder.id,i=this.community.CommunityFolder.name,this.community.CommunityFolder.description):(t="/domain/"+this.community.domain_id,i=this.community.Domain.name,this.community.Domain.description),this.fire("change-header",{headerTitle:this.community.configuration&&this.community.configuration.customBackName?this.community.configuration.customBackName:i,headerDescription:e,headerIcon:"group-work",useHardBack:this._useHardBack(this.community.configuration),disableDomainUpLink:this.community.configuration&&!0===this.community.configuration.disableDomainUpLink,documentTitle:this.community.name,backPath:this.community.configuration&&this.community.configuration.customBackURL?this.community.configuration.customBackURL:t});this.$.pagesAjax.url="/api/communities/"+this.community.id+"/pages",this.$.pagesAjax.generateRequest(),window.appGlobals.disableFacebookLoginForGroup=!1,window.appGlobals.externalGoalTriggerGroupId=null,window.appGlobals.currentGroup=null,this.community.configuration&&this.community.configuration.forceSecureSamlLogin&&!this.checkCommunityAccess(this.community)?window.appGlobals.currentForceSaml=!0:window.appGlobals.currentForceSaml=!1,this.community.configuration&&this.community.configuration.customSamlDeniedMessage?window.appGlobals.currentSamlDeniedMessage=this.community.configuration.customSamlDeniedMessage:window.appGlobals.currentSamlDeniedMessage=null,this.community.configuration&&this.community.configuration.customSamlLoginMessage?window.appGlobals.currentSamlLoginMessage=this.community.configuration.customSamlLoginMessage:window.appGlobals.currentSamlLoginMessage=null,this.community.configuration&&this.community.configuration.signupTermsPageId&&-1!=this.community.configuration.signupTermsPageId?window.appGlobals.signupTermsPageId=this.community.configuration.signupTermsPageId:window.appGlobals.signupTermsPageId=null,this.community.configuration.highlightedLanguages?window.appGlobals.setHighlightedLanguages(this.community.configuration.highlightedLanguages):window.appGlobals.setHighlightedLanguages(null)}},defaultGroupFirst:function(t){for(var i,e=[],o=null,n=0;n<t.length;n++)"default"!=(i=t[n]).short_name?e.push(i):o=i;return e.unshift(o),e},noTestGroup:function(t){for(var i,e=[],o=0;o<t.length;o++)"test"!=(i=t[o]).short_name&&"ac-posts"!=i.short_name&&"development"!=i.short_name&&-1==i.short_name.indexOf("2012")&&-1==i.short_name.indexOf("2013")&&e.push(i);return e},_refreshAjax:function(){this.async(function(){this.$$("#ajax").generateRequest()},100)},ready:function(){}})</script></dom-module>