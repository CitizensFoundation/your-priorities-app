{"version":3,"file":"yp-user-delete-or-anonymize.js","sourceRoot":"","sources":["../../src/yp-user/yp-user-delete-or-anonymize.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, css } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport { YpBaseElement } from '../common/yp-base-element.js';\nimport '../common/yp-image.js';\n\nimport '@material/web/dialog/dialog.js';\nimport '@material/web/button/text-button.js';\n\nimport '@material/web/progress/circular-progress.js';\n\nimport { YpConfirmationDialog } from '../yp-dialog-container/yp-confirmation-dialog.js';\nimport { Dialog } from '@material/web/dialog/internal/dialog.js';\n\n@customElement('yp-user-delete-or-anonymize')\nexport class YpUserDeleteOrAnonymize extends YpBaseElement {\n  @property({type: Boolean})\n  spinnerActive = false\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        md-dialog {\n          padding-left: 8px;\n          padding-right: 8px;\n          max-width: 450px;\n        }\n\n        .buttons {\n          margin-top: 16px;\n          margin-bottom: 4px;\n          text-align: center;\n        }\n\n        .boldButton {\n          font-weight: bold;\n        }\n\n        .header {\n          font-size: 22px;\n          color: var(--md-sys-color-on-error-container);\n          background-color: var(--md-sys-color-error-container);\n          font-weight: bold;\n        }\n\n        @media (max-width: 480px) {\n        }\n\n        @media (max-width: 320px) {\n        }\n      `,\n    ];\n  }\n\n  override render() {\n    return html`\n      <md-dialog id=\"dialog\" modal>\n        <div slot=\"headline\" class=\"header layout horizontal center-center\">\n          <div>${this.t('deleteOrAnonymizeUser')}</div>\n        </div>\n        <div slot=\"content\">\n        <div class=\"helpInfo\">${this.t('anonymizeUserInfo')}</div>\n\n        <div class=\"helpInfo\">${this.t('deleteUserInfo')}</div>\n\n\n        </div>\n\n        <div class=\"buttons layout vertical center-center\" slot=\"actions\">\n          <div class=\"layout horizontal ajaxElements\">\n            <md-circular-progress hidden?=\"${!this.spinnerActive}\" indeterminate></md-circular-progress>\n          </div>\n          <div class=\"layout horizontal center-center\">\n            <md-text-button\n              .label=\"${this.t('cancel')}\"\n              slot=\"secondaryAction\"\n              dialog-dismiss=\"\"></md-text-button>\n            <md-text-button\n              .label=\"${this.t('deleteAccount')}\"\n              raised\n              slot=\"primaryAction\"\n\n              class=\"boldButton\"\n              @click=\"${this._deleteUser}\"></md-text-button>\n            <md-text-button\n              .label=\"${this.t('anonymizeAccount')}\"\n              slot=\"primaryAction\"\n              raised\n              class=\"boldButton\"\n              @click=\"${this._anonymizeUser}\"></md-text-button>\n          </div>\n        </div>\n      </md-dialog>\n    `;\n  }\n\n  _deleteUser() {\n    window.appDialogs.getDialogAsync('confirmationDialog', (dialog: YpConfirmationDialog) => {\n      dialog.open(\n        this.t('areYouSureYouWantToDeleteUser'),\n        this._deleteUserFinalWarning.bind(this),\n        true\n      );\n    });\n  }\n\n  _deleteUserFinalWarning() {\n    setTimeout( ()  =>{\n      window.appDialogs\n        .getDialogAsync(\n          'confirmationDialog',\n           (dialog: YpConfirmationDialog) => {\n            dialog.open(\n              this.t('areYouReallySureYouWantToDeleteUser'),\n              this._deleteUserForReal.bind(this),\n              true\n            );\n          }\n        );\n    });\n  }\n\n  _anonymizeUser() {\n    window.appDialogs\n      .getDialogAsync(\n        'confirmationDialog',\n         (dialog: YpConfirmationDialog) => {\n          dialog.open(\n            this.t('areYouSureYouWantToAnonymizeUser'),\n            this._anonymizeUserFinalWarning.bind(this),\n            true\n          );\n        }\n      );\n  }\n\n  _anonymizeUserFinalWarning() {\n    setTimeout( () => {\n      window.appDialogs\n        .getDialogAsync(\n          'confirmationDialog',\n           (dialog: YpConfirmationDialog) => {\n            dialog.open(\n              this.t('areYouReallySureYouWantToAnonymizeUser'),\n              this._anonymizeUserForReal.bind(this),\n              true\n            );\n          }\n        );\n    });\n  }\n\n  async _deleteUserForReal() {\n    this.spinnerActive = true\n    await window.serverApi.deleteUser()\n    this.spinnerActive = false\n    this._completed()\n  }\n\n  async _anonymizeUserForReal() {\n    this.spinnerActive = true\n    await window.serverApi.anonymizeUser()\n    this.spinnerActive = false\n    this._completed()\n  }\n\n  open() {\n    (this.$$('#dialog') as Dialog).open = true\n  }\n\n  _completed() {\n    (this.$$('#dialog') as Dialog).open = false\n    window.location.href = '/'\n  }\n}\n"]}