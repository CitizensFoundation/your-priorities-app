{"version":3,"file":"yp-registration-questions-dialog.js","sourceRoot":"","sources":["../../src/yp-user/yp-registration-questions-dialog.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, css } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\nimport \"@material/web/button/text-button.js\";\nimport \"@material/web/dialog/dialog.js\";\n\nimport \"./yp-registration-questions.js\";\n\nimport { YpBaseElement } from \"../common/yp-base-element.js\";\n\nimport { YpRegistrationQuestions } from \"./yp-registration-questions.js\";\nimport { Dialog } from \"@material/web/dialog/internal/dialog.js\";\n\n@customElement(\"yp-registration-questions-dialog\")\nexport class YpRegistrationQuestionsDialog extends YpBaseElement {\n  @property({ type: Object })\n  registrationQuestionsGroup: YpGroupData | undefined;\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        [hidden] {\n          display: none !important;\n        }\n\n        md-dialog[open][is-safari] {\n          height: 100%;\n        }\n\n        yp-registration-questions {\n          margin-top: 0;\n          min-height: 15px;\n          margin-bottom: 16px;\n          text-align: left;\n        }\n\n        .upper {\n          text-transform: capitalize;\n        }\n      `,\n    ];\n  }\n\n  logout() {\n    this.close();\n    window.appUser.logout();\n    setTimeout(() => {\n      window.location.reload();\n    }, 450);\n  }\n\n  override render() {\n    return html`\n      <md-dialog\n        id=\"dialog\"\n        @cancel=\"${this.scrimDisableAction}\"\n        ?is-safari=\"${this.isSafari}\"\n      >\n        <div slot=\"headline\">${this.t(\"registrationQuestionsInfo\")}</div>\n        <div slot=\"content\">\n          <yp-registration-questions\n            id=\"registrationQuestions\"\n            @dom-change=\"${this._questionsUpdated}\"\n            @question-changed=\"${this._questionsUpdated}\"\n            @resize-scroller=\"${this._questionsUpdated}\"\n            .group=\"${this.registrationQuestionsGroup}\"\n          ></yp-registration-questions>\n        </div>\n\n        <div slot=\"actions\">\n          <md-text-button @click=\"${this.logout}\"\n            ><span class=\"upper\">${this.t(\"user.logout\")}</span></md-text-button\n          >\n          <md-text-button @click=\"${this._validateAndSend}\" autofocus\n            ><span class=\"upper\"\n              >${this.t(\"completeLogin\")}</span\n            ></md-text-button\n          >\n        </div>\n      </md-dialog>\n    `;\n  }\n\n  _onEnter(event: KeyboardEvent) {\n    if (event.keyCode == 13) {\n      event.stopPropagation();\n      this._validateAndSend();\n    }\n  }\n\n  _questionsUpdated() {\n    setTimeout(() => {\n      //this.$$(\"#scrollable\").fire('iron-resize');\n    }, 100);\n  }\n\n  async _validateAndSend() {\n    const registrationQuestions = this.$$(\n      \"#registrationQuestions\"\n    ) as YpRegistrationQuestions;\n    if (registrationQuestions.validate()) {\n      window.appGlobals.activity(\"submit\", \"registrationAnswers\");\n      //TODO: Check all serverApi for catch errors and how to handle that\n      await window.appGlobals.serverApi.sendRegistrationQuestions(\n        registrationQuestions.getAnswers()\n      );\n      window.appUser.setHasRegistrationAnswers();\n      this.fireGlobal(\"yp-registration-questions-done\");\n      this.close();\n      return true;\n    } else {\n      //this.fire(\"yp-error\", this.t(\"user.completeForm\"));\n      return false;\n    }\n  }\n\n  async open(registrationQuestionsGroup: YpGroupData) {\n    this.registrationQuestionsGroup = registrationQuestionsGroup;\n    this.requestUpdate();\n\n    await this.updateComplete;\n\n    (this.$$(\"#dialog\") as Dialog).show();\n  }\n\n  close() {\n    (this.$$(\"#dialog\") as Dialog).close();\n  }\n}\n"]}