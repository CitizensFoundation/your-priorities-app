{"version":3,"file":"yp-promotion-dashboard.js","sourceRoot":"","sources":["../../../src/analytics-and-promotion/yp-analytics/yp-promotion-dashboard.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html, nothing } from 'lit';\nimport { property, customElement } from 'lit/decorators.js';\n\nimport '../pl-components/pl-dashboard.js';\n\nimport './yp-realtime.js';\nimport './yp-historical.js';\n\nimport { PlausibleDashboard } from '../pl-components/pl-dashboard.js';\nimport { YpServerApi } from '../../common/YpServerApi.js';\n\n@customElement('yp-promotion-dashboard')\nexport class YpPromotionDashboard extends PlausibleDashboard {\n  @property({ type: String })\n  plausibleSiteName: string | undefined;\n\n  @property({ type: Object })\n  collection!: YpCollectionData;\n\n  @property({ type: String })\n  collectionType!: string;\n\n  @property({ type: Number })\n  collectionId!: number | string;\n\n  @property({ type: Number })\n  useCommunityId: number | undefined;\n\n override connectedCallback(): void {\n    try {\n      fetch('/api/users/has/PlausibleSiteName', {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n        .then(response => response.json())\n        .then(data => {\n          this.plausibleSiteName = data.plausibleSiteName;\n          this.site = {\n            domain: this.plausibleSiteName!,\n            hasGoals: true,\n            embedded: false,\n            offset: 1,\n            statsBegin: this.collection!.created_at!,\n            isDbip: false,\n            flags: {\n              custom_dimension_filter: false,\n            },\n          };\n          super.connectedCallback();\n        });\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  static override get styles() {\n    return [css`\n      :host {\n        max-width: 1280px;\n        width: 1280px;\n      }\n    `];\n  }\n\n  override render() {\n    if (this.site && this.query) {\n      if (this.query!.period === 'realtime') {\n        return html`\n          <yp-realtime\n            .timer=\"${this.timer}\"\n            .site=\"${this.site}\"\n            .currentRole=\"${this.currentUserRole}\"\n            .query=\"${this.query}\"\n            .collectionType=\"${this.collectionType}\"\n            .collectionId=\"${this.collectionId}\"\n            .history=\"${this.history}\"\n            .proxyUrl=\"${`/api/${YpServerApi.transformCollectionTypeToApi(this.collectionType)}/${this.collectionId}/plausibleStatsProxy${this.useCommunityId ? `?communityId=${this.useCommunityId}` : ''}`}\"\n            proxyFaviconBaseUrl=\"/api/users/PlausibleFavIcon/\"\n          ></yp-realtime>\n        `;\n      } else {\n        return html`\n          <yp-historical\n            .timer=\"${this.timer}\"\n            .site=\"${this.site}\"\n            .history=\"${this.history}\"\n            .currentRole=\"${this.currentUserRole}\"\n            .query=\"${this.query}\"\n            .collectionType=\"${this.collectionType}\"\n            .collectionId=\"${this.collectionId}\"\n            .proxyUrl=\"${`/api/${YpServerApi.transformCollectionTypeToApi(this.collectionType)}/${this.collectionId}/plausibleStatsProxy${this.useCommunityId ? `?communityId=${this.useCommunityId}` : ''}`}\"\n            proxyFaviconBaseUrl=\"/api/users/PlausibleFavIcon/\"\n          ></yp-historical>\n        `;\n      }\n    } else {\n      return nothing;\n    }\n  }\n}\n"]}