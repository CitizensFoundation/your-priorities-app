{"version":3,"file":"pl-base-graph.js","sourceRoot":"","sources":["../../../../../src/analytics-and-promotion/pl-components/stats/graph/pl-base-graph.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, css, html, nothing } from 'lit';\nimport { property, customElement, query } from 'lit/decorators.js';\nimport Chart from 'chart.js/auto';\nimport { navigateToQuery } from '../../query.js';\nimport numberFormatter, {\n  durationFormatter,\n} from '../../util/number-formatter.js';\nimport * as api from '../../api';\nimport * as storage from '../../util/storage.js';\nimport { GraphTooltip, buildDataSet, dateFormatter } from './graph-util.js';\nimport './pl-top-stats.js';\nimport * as url from '../../util/url.js';\nimport { PlausibleBaseElementWithState } from '../../pl-base-element-with-state.js';\nimport { formatISO } from '../../util/date.js';\n\nexport abstract class PlausibleBaseGraph extends PlausibleBaseElementWithState {\n  @property({ type: Object })\n  graphData: any;\n\n  @property({ type: Object })\n  ctx!: CanvasRenderingContext2D | null;\n\n  @property({ type: Boolean })\n  darkTheme = false;\n\n  @property({ type: Object })\n  chart: Chart | undefined;\n\n  @query('canvas')\n  canvasElement!: HTMLCanvasElement;\n\n  @property({ type: Boolean })\n  exported = false;\n\n  @property({ type: Object })\n  history!: any;\n\n  @property({ type: String })\n  chartTitle!: string;\n\n  @property({ type: String })\n  label!: string;\n\n  @property({ type: String })\n  gradientColorStop1 = 'rgba(101,116,205, 0.2)';\n\n  @property({ type: String })\n  gradientColorStop2 = 'rgba(101,116,205, 0.2)';\n\n  @property({ type: String })\n  prevGradientColorStop1 = 'rgba(101,116,205, 0.075)';\n\n  @property({ type: String })\n  prevGradientColorStop2 = 'rgba(101,116,205, 0)';\n\n  @property({ type: String })\n  borderColor = 'rgba(101,116,205)';\n\n  @property({ type: String })\n  pointBackgroundColor = 'rgba(101,116,205)';\n\n  @property({ type: String })\n  pointHoverBackgroundColor = 'rgba(71, 87, 193)';\n\n  @property({ type: String })\n  prevPointHoverBackgroundColor = 'rgba(166,187,210,0.8)';\n\n  @property({ type: String })\n  prevBorderColor = 'rgba(166,187,210,0.5)';\n\n  @property({ type: Number })\n  chartHeigh = 342\n\n  @property({ type: Number })\n  chartWidth = 1054\n\n  @property({ type: String })\n  metrics: PlausibleTimeseriesMetricsOptions = 'visitors';\n\n  @property({ type: String })\n  method: \"aggregate\" | \"timeseries\" = 'timeseries';\n\n  regenerateChart(): any {}\n\n  fetchGraphData(): any {}\n\n  constructor() {\n    super();\n    this.repositionTooltip = this.repositionTooltip.bind(this);\n  }\n\n  static override get styles() {\n    return [...super.styles, css`.mainContainer{\n      margin-top: 24px;\n    }`];\n  }\n\n override connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('mousemove', this.repositionTooltip);\n    this.fetchGraphData = this.fetchGraphData.bind(this);\n  }\n\n  override firstUpdated(\n    _changedProperties: Map<string | number | symbol, unknown>\n  ): void {\n    this.fetchGraphData();\n    if (this.timer) {\n      this.timer.onTick(this.fetchGraphData);\n    }\n    if (this.graphData) {\n      this.chart = this.regenerateChart();\n    }\n    if (this.timer) {\n      this.timer.onTick(this.fetchGraphData);\n    }\n  }\n\n  override updated(changedProperties: Map<string | number | symbol, unknown>): void {\n    super.updated(changedProperties);\n\n    if (changedProperties.get('query')) {\n      this.fetchGraphData();\n    }\n\n    const tooltip = this.$$('#chartjs-tooltip');\n\n    if (\n      this.graphData &&\n      (changedProperties.has('graphData') || changedProperties.has('darkTheme'))\n    ) {\n      if (this.chart) {\n        this.chart.destroy();\n      }\n      this.chart = this.regenerateChart();\n      this.chart!.update();\n\n      if (tooltip) {\n        tooltip.style.display = 'none';\n      }\n    }\n\n    if (!this.graphData) {\n      if (this.chart) {\n        this.chart.destroy();\n      }\n\n      if (tooltip) {\n        tooltip.style.display = 'none';\n      }\n    }\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    // Ensure that the tooltip doesn't hang around when we are loading more data\n    const tooltip = document.getElementById('chartjs-tooltip');\n    if (tooltip) {\n      tooltip.style.opacity = '0';\n      tooltip.style.display = 'none';\n    }\n    window.removeEventListener('mousemove', this.repositionTooltip);\n  }\n  buildDataSet(\n    plot: string | any[],\n    present_index: number,\n    ctx: {\n      createLinearGradient: (\n        arg0: number,\n        arg1: number,\n        arg2: number,\n        arg3: number\n      ) => any;\n    },\n    isPrevious = false\n  ) {\n    var gradient = ctx.createLinearGradient(0, 0, 0, 300);\n    var prev_gradient = ctx.createLinearGradient(0, 0, 0, 300);\n    gradient.addColorStop(0, this.gradientColorStop1);\n    gradient.addColorStop(1, this.gradientColorStop2);\n    prev_gradient.addColorStop(0, this.prevGradientColorStop1);\n    prev_gradient.addColorStop(1, this.prevGradientColorStop2);\n\n    if (!isPrevious) {\n      if (present_index) {\n        var dashedPart = plot.slice(present_index - 1, present_index + 1);\n        var dashedPlot = new Array(present_index - 1).concat(dashedPart);\n        const _plot = [...plot];\n        for (var i = present_index; i < _plot.length; i++) {\n          _plot[i] = undefined;\n        }\n\n        return [\n          {\n            label: this.label,\n            data: _plot,\n            borderWidth: 3,\n            borderColor: this.borderColor,\n            pointBackgroundColor: this.pointBackgroundColor,\n            pointHoverBackgroundColor: this.pointHoverBackgroundColor,\n            pointBorderColor: 'transparent',\n            pointHoverRadius: 4,\n            backgroundColor: gradient,\n            fill: true,\n          },\n          {\n            label: this.label,\n            data: dashedPlot,\n            borderWidth: 3,\n            borderDash: [3, 3],\n            borderColor: this.borderColor,\n            pointHoverBackgroundColor: this.pointHoverBackgroundColor,\n            pointBorderColor: 'transparent',\n            pointHoverRadius: 4,\n            backgroundColor: gradient,\n            fill: true,\n          },\n        ];\n      } else {\n        return [\n          {\n            label: this.label,\n            data: plot,\n            borderWidth: 3,\n            borderColor: this.borderColor,\n            pointHoverBackgroundColor: this.pointHoverBackgroundColor,\n            pointBorderColor: 'transparent',\n            pointHoverRadius: 4,\n            backgroundColor: gradient,\n            fill: true,\n          },\n        ];\n      }\n    } else {\n      return [\n        {\n          label: this.label,\n          data: plot,\n          borderWidth: 2,\n          // borderDash: [10, 1],\n          borderColor: this.prevBorderColor,\n          pointHoverBackgroundColor: this.prevPointHoverBackgroundColor,\n          pointBorderColor: 'transparent',\n          pointHoverBorderColor: 'transparent',\n          pointHoverRadius: 4,\n          backgroundColor: prev_gradient,\n          fill: true,\n        },\n      ];\n    }\n  }\n\n  transformCustomDateForStatsQuery(query: PlausibleQueryData) {\n    if (query.period == 'custom') {\n      query.date = `${formatISO(query.from!)},${formatISO(query.to!)}` as unknown as Date;\n      query.from = undefined;\n      query.to = undefined;\n      return query;\n    } else {\n      return query;\n    }\n  }\n\n  repositionTooltip(e: MouseEvent) {\n    const tooltipEl = this.$$('#chartjs-tooltip');\n    if (tooltipEl && window.innerWidth >= 768) {\n      if (e.clientX > 0.66 * window.innerWidth) {\n        tooltipEl.style.right =\n          window.innerWidth - e.clientX + window.pageXOffset + 'px';\n        tooltipEl.style.left = '';\n      } else {\n        tooltipEl.style.right = '';\n        tooltipEl.style.left = e.clientX + window.pageXOffset + 'px';\n      }\n      tooltipEl.style.top = e.clientY + window.pageYOffset + 'px';\n      tooltipEl.style.opacity = '1';\n    }\n  }\n  /**\n   * The current ticks' limits are set to treat iPad (regular/Mini/Pro) as a regular screen.\n   * @param {*} chart - The chart instance.\n   * @param {*} dimensions - An object containing the new dimensions *of the chart.*\n   */\n  updateWindowDimensions(chart: Chart, dimensions: any) {\n    //@ts-ignore\n    chart.options.scales.x.ticks.maxTicksLimit = dimensions.width < 720 ? 5 : 8;\n    //@ts-ignore\n    chart.options.scales.y.ticks.maxTicksLimit =\n      dimensions.height < 233 ? 3 : 8;\n  }\n\n  pollExportReady() {\n    if (document.cookie.includes('exporting')) {\n      setTimeout(this.pollExportReady.bind(this), 1000);\n    } else {\n      this.exported = false;\n    }\n  }\n\n  downloadSpinner() {\n    this.exported = true;\n    document.cookie = 'exporting=';\n    setTimeout(this.pollExportReady.bind(this), 1000);\n  }\n\n  graphTooltip(\n    graphData: { interval: string; labels: { [x: string]: any } },\n    mainCanvasElement: { getBoundingClientRect: () => any },\n    tooltipElement: any\n  ) {\n    return (context: { tooltip: any }) => {\n      const tooltipModel = context.tooltip;\n      const offset = mainCanvasElement.getBoundingClientRect();\n\n      // Tooltip Element\n      let tooltipEl = tooltipElement;\n\n      // Create element on first render\n      if (!tooltipEl) {\n        tooltipEl = document.createElement('div');\n        tooltipEl.id = 'chartjs-tooltip';\n        tooltipEl.style.display = 'none';\n        tooltipEl.style.opacity = 0;\n        document.body.appendChild(tooltipEl);\n      }\n\n      if (tooltipEl && offset && window.innerWidth < 768) {\n        tooltipEl.style.top =\n          offset.y + offset.height + window.scrollY + 15 + 'px';\n        tooltipEl.style.left = offset.x + 'px';\n        tooltipEl.style.right = null;\n        tooltipEl.style.opacity = 1;\n      }\n\n      // Stop if no tooltip showing\n      if (tooltipModel.opacity === 0) {\n        tooltipEl.style.display = 'none';\n        return;\n      }\n\n      function getBody(bodyItem: { lines: any }) {\n        return bodyItem.lines;\n      }\n\n      function renderLabel(\n        label: string,\n        prev_label: string | undefined = undefined\n      ) {\n        const formattedLabel = dateFormatter(graphData.interval, true)(label);\n        const prev_formattedLabel =\n          prev_label && dateFormatter(graphData.interval, true)(prev_label);\n\n        if (graphData.interval === 'month') {\n          return !prev_label ? formattedLabel : prev_formattedLabel;\n        }\n\n        if (graphData.interval === 'date') {\n          return !prev_label ? formattedLabel : prev_formattedLabel;\n        }\n\n        if (graphData.interval === 'hour') {\n          return !prev_label\n            ? `${dateFormatter('date', true)(label)}, ${formattedLabel}`\n            : `${dateFormatter('date', true)(prev_label)}, ${dateFormatter(\n                graphData.interval,\n                true\n              )(prev_label)}`;\n        }\n\n        return !prev_label ? formattedLabel : prev_formattedLabel;\n      }\n\n      // function renderComparison(change) {\n      //   const formattedComparison = numberFormatter(Math.abs(change))\n\n      //   if (change > 0) {\n      //     return `<span class='text-green-500 font-bold'>${formattedComparison}%</span>`\n      //   }\n      //   if (change < 0) {\n      //     return `<span class='text-red-400 font-bold'>${formattedComparison}%</span>`\n      //   }\n      //   if (change === 0) {\n      //     return `<span class='font-bold'>0%</span>`\n      //   }\n      // }\n\n      // Set Tooltip Body\n      if (tooltipModel.body) {\n        var bodyLines = tooltipModel.body.map(getBody);\n\n        // Remove duplicated line on overlap between dashed and normal\n        if (bodyLines.length === 3) {\n          bodyLines[1] = false;\n        }\n\n        const data = tooltipModel.dataPoints[0];\n        const label = graphData.labels[data.dataIndex];\n        const point = data.raw || 0;\n\n        // const prev_data = tooltipModel.dataPoints.slice(-1)[0]\n        // const prev_label = graphData.prev_labels && graphData.prev_labels[prev_data.dataIndex]\n        // const prev_point = prev_data.raw || 0\n        // const pct_change = point === prev_point ? 0 : prev_point === 0 ? 100 : Math.round(((point - prev_point) / prev_point * 100).toFixed(1))\n\n        let innerHtml = `\n        <div class='text-gray-100 flex flex-col'>\n          <div class='flex justify-between items-center'>\n              <span class='font-bold mr-4 text-lg'>${this.label}</span>\n          </div>\n          <div class='flex flex-col'>\n            <div class='flex flex-row justify-between items-center'>\n              <span class='flex items-center mr-4'>\n                <div class='w-3 h-3 mr-1 rounded-full' style='background-color: rgba(101,116,205)'></div>\n                <span>${renderLabel(label)}</span>\n              </span>\n              <span>${numberFormatter(point)}</span>\n            </div>\n          </div>\n          <span class='font-bold text-'>${\n            graphData.interval === 'month'\n              ? 'Click to view month'\n              : graphData.interval === 'date'\n              ? 'Click to view day'\n              : ''\n          }</span>\n        </div>\n        `;\n\n        tooltipEl.innerHTML = innerHtml;\n      }\n      tooltipEl.style.display = null;\n    };\n  }\n\n  onClick(e: CustomEvent) {\n    const element = this.chart!.getElementsAtEventForMode(\n      e,\n      'index',\n      {\n        intersect: false,\n      },\n      false\n    )[0];\n    const date = this.chart!.data!.labels![element.index] as string;\n\n    if (this.graphData.interval === 'month') {\n      navigateToQuery(this.history, this.query, {\n        period: 'month',\n        date,\n      });\n    } else if (this.graphData.interval === 'date') {\n      navigateToQuery(this.history, this.query, {\n        period: 'day',\n        date,\n      });\n    }\n  }\n\n  downloadLink() {\n    if (this.query.period !== 'realtime') {\n      if (this.exported) {\n        return html`\n          <div class=\"w-4 h-4 mx-2\">\n            <svg\n              class=\"animate-spin h-4 w-4 text-indigo-500\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n            >\n              <circle\n                class=\"opacity-25\"\n                cx=\"12\"\n                cy=\"12\"\n                r=\"10\"\n                stroke=\"currentColor\"\n                strokeWidth=\"4\"\n              ></circle>\n              <path\n                class=\"opacity-75\"\n                fill=\"currentColor\"\n                d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n              ></path>\n            </svg>\n          </div>\n        `;\n      } else {\n        const endpoint = `/${encodeURIComponent(\n          this.site.domain!\n        )}/export${api.serializeQuery(this.query)}`;\n\n        //TODO: Get export working\n        return html`\n          <a\n            hidden\n            class=\"w-4 h-4 mx-2\"\n            href=\"${endpoint}\"\n            download\n            @click=\"${this.downloadSpinner.bind(this)}\"\n          >\n            <svg\n              style=\"max-width: 50px;max-height: 50px;\"\n              class=\"absolute text-gray-700 feather dark:text-gray-300\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            >\n              <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"></path>\n              <polyline points=\"7 10 12 15 17 10\"></polyline>\n              <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\"></line>\n            </svg>\n          </a>\n        `;\n      }\n    } else {\n      return nothing;\n    }\n  }\n\n  renderHeader() {}\n\n  override render() {\n    if (this.graphData) {\n      const extraClass =\n        this.graphData && this.graphData.interval === 'hour'\n          ? ''\n          : 'cursor-pointer';\n\n      return html`\n        <div class=\"mainContainer w-full p-4 bg-white rounded shadow-xl dark:bg-gray-825\">\n          ${this.renderHeader()}\n          <div class=\"relative px-2\">\n            <div class=\"absolute right-4 -top-10 flex\">\n              ${this.downloadLink()}\n            </div>\n            <canvas\n              id=\"main-graph-canvas\"\n              class=${'mt-4 select-none ' + extraClass}\n              width=\"${this.chartWidth}\"\n              height=\"${this.chartHeigh}\"\n            ></canvas>\n          </div>\n        </div>\n      `;\n    } else {\n      return nothing;\n    }\n  }\n}\n"]}