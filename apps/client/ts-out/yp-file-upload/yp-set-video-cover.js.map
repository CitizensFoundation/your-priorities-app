{"version":3,"file":"yp-set-video-cover.js","sourceRoot":"","sources":["../../src/yp-file-upload/yp-set-video-cover.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, css, nothing } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport '@material/web/textfield/outlined-text-field.js';\nimport '@material/web/progress/linear-progress.js';\nimport '@material/web/icon/icon.js';\nimport '@material/web/iconbutton/outlined-icon-button.js';\n\nimport '@material/web/radio/radio.js';\nimport { MdRadio } from '@material/web/radio/radio.js';\n\n//import '../yp-post/yp-posts-list.js';\nimport '../common/yp-emoji-selector.js';\n//import '../yp-post/yp-post-card-add.js';\n\nimport { YpBaseElement } from '../common/yp-base-element.js';\n\n@customElement('yp-set-video-cover')\nexport class YpSetVideoCover extends YpBaseElement {\n  @property({ type: Number })\n  videoId!: number;\n\n  @property({ type: String })\n  previewVideoUrl: string | undefined;\n\n  @property({ type: Array })\n  videoImages: Array<string> | undefined;\n\n  @property({ type: Number })\n  selectedVideoCoverIndex = 0;\n\n  @property({ type: Boolean })\n  useMainPhotoForVideoCover = false;\n\n  @property({ type: Boolean })\n  noDefaultCoverImage = false;\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        .previewFrame {\n          max-height: 50px;\n          max-width: 89px;\n          height: 50px;\n          width: 89px;\n          cursor: pointer;\n        }\n\n        .videoImages {\n          overflow-x: auto;\n          width: 200px;\n          max-height: 70px;\n          height: 70px;\n        }\n\n        .selectedCover {\n          border-top: 2px solid var(--accent-color);\n          max-height: 50px;\n          max-width: 89px;\n          white-space: nowrap;\n        }\n\n        .coverImage {\n          max-height: 50px;\n          max-width: 89px;\n          white-space: nowrap;\n        }\n\n        .limitInfo {\n          margin-top: 0;\n          text-align: center;\n          font-size: 14px;\n        }\n\n        .mainPhotoCheckbox {\n          margin-top: 4px;\n          margin-bottom: 4px;\n        }\n      `,\n    ];\n  }\n\n  override render() {\n    return this.videoImages\n      ? html`\n          <video\n            hidden\n            controls\n            class=\"previewVideo\"\n            .url=\"${this.previewVideoUrl}\"></video>\n          <div class=\"layout horizontal videoImages videoPreviewContainer\">\n            <div style=\"white-space: nowrap\">\n              ${this.videoImages.map(\n                (image, index) => html`\n                  <img\n                    .class=\"${this._classFromImageIndex(index)}\"\n                    data-index=\"${index}\"\n                    @click=\"${this._selectVideoCover}\"\n                    sizing=\"cover\"\n                    class=\"previewFrame\"\n                    src=\"${image}\" />\n                `\n              )}\n\n              <div\n                class=\"layout horizontal mainPhotoCheckbox\"\n                ?hidden=\"${this.noDefaultCoverImage}\">\n                <mwc-formfield .label=\"${this.t('useMainPhoto')}\">\n                  <md-radio\n                    @click=\"${this._selectVideoCoverMainPhoto}\"\n                    name=\"useMainPhoto\"></md-radio>\n                </mwc-formfield>\n              </div>\n            </div>\n          </div>\n\n        `\n      : nothing;\n  }\n\n  _classFromImageIndex(index: number) {\n    if (index == this.selectedVideoCoverIndex) {\n      return 'selectedCover';\n    } else {\n      return 'coverImage';\n    }\n  }\n\n  override updated(changedProperties: Map<string | number | symbol, unknown>) {\n    super.updated(changedProperties);\n\n    if (changedProperties.has('videoId')) {\n      this._getVideoMeta();\n    }\n  }\n\n  async _getVideoMeta() {\n    if (this.videoId) {\n      const response = await window.serverApi.getVideoFormatsAndImages(this.videoId);\n      if (response.previewVideoUrl && response.videoImages) {\n        this.previewVideoUrl = response.previewVideoUrl;\n        this.videoImages = response.videoImages;\n      }\n     } else {\n      console.error('_getVideoImages no video id');\n    }\n  }\n\n  _selectVideoCover(event: CustomEvent) {\n    const frameIndex = (event.target as HTMLElement).getAttribute('data-index');\n    this.fire('set-cover', frameIndex);\n    this.fire('set-default-cover', false);\n    window.serverApi.setVideoCover(this.videoId,  { frameIndex: frameIndex });\n\n  }\n\n  _selectVideoCoverMainPhoto() {\n    setTimeout(() => {\n      if ((this.$$('#useMainPhotoId') as MdRadio).checked) {\n        window.serverApi.setVideoCover(this.videoId,  { frameIndex: -2 });\n        this.fire('set-default-cover', true);\n      } else {\n        this.fire('set-default-cover', false);\n      }\n    });\n  }\n}\n"]}