import{c as e,i as t,y as i,b as r,_ as n,e as o,t as a,a as s}from"./944ce39b.js";import{c,a as u,u as d}from"./7e20d750.js";var l=c((function(e){
/**
   * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
   * @summary Record audio, video or screen inside the browser.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef RecordRTC
   * @class
   * @example
   * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
   *     type: 'video', // audio or video or gif or canvas
   *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
   * });
   * recorder.startRecording();
   * @see For further information:
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
   * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
   */
function t(e,n){if(!e)throw"First parameter is required.";n=new i(e,n=n||{type:"video"});var o=this;function a(t){t&&(n.initCallback=function(){t(),t=n.initCallback=null});var i=new r(e,n);(f=new i(e,n)).record(),h("recording"),n.disableLogs||console.log("Initialized recorderType:",f.constructor.name,"for output-type:",n.type)}function s(e){if(e=e||function(){},f){if("paused"===o.state)return o.resumeRecording(),void setTimeout((function(){s(e)}),1);"recording"===o.state||n.disableLogs||console.warn('Recording state should be: "recording", however current state is: ',o.state),n.disableLogs||console.log("Stopped recording "+n.type+" stream."),"gif"!==n.type?f.stop(t):(f.stop(),t()),h("stopped")}else v();function t(t){if(f){Object.keys(f).forEach((function(e){"function"!=typeof f[e]&&(o[e]=f[e])}));var i=f.blob;if(!i){if(!t)throw"Recording failed.";f.blob=i=t}if(i&&!n.disableLogs&&console.log(i.type,"->",y(i.size)),e){var r;try{r=l.createObjectURL(i)}catch(e){}"function"==typeof e.call?e.call(o,r):e(r)}n.autoWriteToDisk&&u((function(e){var t={};t[n.type+"Blob"]=e,E.Store(t)}))}else"function"==typeof e.call?e.call(o,""):e("")}}function c(e){postMessage((new FileReaderSync).readAsDataURL(e))}function u(e,t){if(!e)throw"Pass a callback function over getDataURL.";var i=t?t.blob:(f||{}).blob;if(!i)return n.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout((function(){u(e,t)}),1e3);if("undefined"==typeof Worker||navigator.mozGetUserMedia){var r=new FileReader;r.readAsDataURL(i),r.onload=function(t){e(t.target.result)}}else{var o=function(e){try{var t=l.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),i=new Worker(t);return l.revokeObjectURL(t),i}catch(e){}}(c);o.onmessage=function(t){e(t.data)},o.postMessage(i)}}function d(e){e=e||0,"paused"!==o.state?"stopped"!==o.state&&(e>=o.recordingDuration?s(o.onRecordingStopped):(e+=1e3,setTimeout((function(){d(e)}),1e3))):setTimeout((function(){d(e)}),1e3)}function h(e){o&&(o.state=e,"function"==typeof o.onStateChanged.call?o.onStateChanged.call(o,e):o.onStateChanged(e))}var f,p='It seems that recorder is destroyed or "startRecording" is not invoked for '+n.type+" recorder.";function v(){!0!==n.disableLogs&&console.warn(p)}var m={startRecording:function(t){return n.disableLogs||console.log("RecordRTC version: ",o.version),t&&(n=new i(e,t)),n.disableLogs||console.log("started recording "+n.type+" stream."),f?(f.clearRecordedData(),f.record(),h("recording"),o.recordingDuration&&d(),o):(a((function(){o.recordingDuration&&d()})),o)},stopRecording:s,pauseRecording:function(){f?"recording"===o.state?(h("paused"),f.pause(),n.disableLogs||console.log("Paused recording.")):n.disableLogs||console.warn("Unable to pause the recording. Recording state: ",o.state):v()},resumeRecording:function(){f?"paused"===o.state?(h("recording"),f.resume(),n.disableLogs||console.log("Resumed recording.")):n.disableLogs||console.warn("Unable to resume the recording. Recording state: ",o.state):v()},initRecorder:a,setRecordingDuration:function(e,t){if(void 0===e)throw"recordingDuration is required.";if("number"!=typeof e)throw"recordingDuration must be a number.";return o.recordingDuration=e,o.onRecordingStopped=t||function(){},{onRecordingStopped:function(e){o.onRecordingStopped=e}}},clearRecordedData:function(){f?(f.clearRecordedData(),n.disableLogs||console.log("Cleared old recorded data.")):v()},getBlob:function(){if(f)return f.blob;v()},getDataURL:u,toURL:function(){if(f)return l.createObjectURL(f.blob);v()},getInternalRecorder:function(){return f},save:function(e){f?b(f.blob,e):v()},getFromDisk:function(e){f?t.getFromDisk(n.type,e):v()},setAdvertisementArray:function(e){n.advertisement=[];for(var t=e.length,i=0;i<t;i++)n.advertisement.push({duration:i,image:e[i]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){"recording"!==o.state||n.disableLogs||console.warn("Stop an active recorder."),f&&"function"==typeof f.clearRecordedData&&f.clearRecordedData(),f=null,h("inactive"),o.blob=null},onStateChanged:function(e){n.disableLogs||console.log("Recorder state changed:",e)},state:"inactive",getState:function(){return o.state},destroy:function(){var e=n.disableLogs;n={disableLogs:!0},o.reset(),h("destroyed"),m=o=null,R.AudioContextConstructor&&(R.AudioContextConstructor.close(),R.AudioContextConstructor=null),n.disableLogs=e,n.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return o=m,m;for(var g in m)this[g]=m[g];return o=this,m}
/**
   * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
   * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef RecordRTCConfiguration
   * @class
   * @example
   * var options = RecordRTCConfiguration(mediaStream, options);
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
   * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
   */
function i(e,t){return t.recorderType||t.type||(t.audio&&t.video?t.type="video":t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===O||t.recorderType===x||t.recorderType===L?t.type="video":t.recorderType===T?t.type="gif":t.recorderType===S?t.type="audio":t.recorderType===P&&(k(e,"audio").length&&k(e,"video").length||!k(e,"audio").length&&k(e,"video").length?t.type="video":k(e,"audio").length&&!k(e,"video").length&&(t.type="audio"))),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}
/**
   * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
   * @summary It returns best recorder-type available for your browser.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef GetRecorderType
   * @class
   * @example
   * var RecorderType = GetRecorderType(options);
   * var recorder = new RecorderType(options);
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
   * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
   */function r(e,t){var i;return(v||h||f)&&(i=S),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!v&&(i=P),"video"===t.type&&(v||f)&&(i=O,"undefined"!=typeof ReadableStream&&(i=L)),"gif"===t.type&&(i=T),"canvas"===t.type&&(i=x),C()&&i!==x&&i!==T&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(k(e,"video").length||k(e,"audio").length)&&("audio"===t.type?"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(i=P):"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(i=P)),e instanceof Array&&e.length&&(i=D),t.recorderType&&(i=t.recorderType),!t.disableLogs&&i&&i.name&&console.log("Using recorderType:",i.name||i.constructor.name),!i&&m&&(i=P),i}
/**
   * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
   * @summary MRecordRTC stands for "Multiple-RecordRTC".
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef MRecordRTC
   * @class
   * @example
   * var recorder = new MRecordRTC();
   * recorder.addStream(MediaStream);
   * recorder.mediaType = {
   *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
   *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
   *     gif: true    // or GifRecorder
   * };
   * // mimeType is optional and should be set only in advance cases.
   * recorder.mimeType = {
   *     audio: 'audio/wav',
   *     video: 'video/webm',
   *     gif:   'image/gif'
   * };
   * recorder.startRecording();
   * @see For further information:
   * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
   * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
   * @requires {@link RecordRTC}
   */function n(e){this.addStream=function(t){t&&(e=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var i,r=this.mediaType,n=this.mimeType||{audio:null,video:null,gif:null};if("function"!=typeof r.audio&&C()&&!k(e,"audio").length&&(r.audio=!1),"function"!=typeof r.video&&C()&&!k(e,"video").length&&(r.video=!1),"function"!=typeof r.gif&&C()&&!k(e,"video").length&&(r.gif=!1),!r.audio&&!r.video&&!r.gif)throw"MediaStream must have either audio or video tracks.";if(r.audio&&(i=null,"function"==typeof r.audio&&(i=r.audio),this.audioRecorder=new t(e,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:i,mimeType:n.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),r.video||this.audioRecorder.startRecording()),r.video){i=null,"function"==typeof r.video&&(i=r.video);var o=e;if(C()&&r.audio&&"function"==typeof r.audio){var a=k(e,"video")[0];p?((o=new g).addTrack(a),i&&i===O&&(i=P)):(o=new g).addTrack(a)}this.videoRecorder=new t(o,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:i,mimeType:n.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),r.audio||this.videoRecorder.startRecording()}if(r.audio&&r.video){var s=this,c=!0===C();(r.audio instanceof S&&r.video||!0!==r.audio&&!0!==r.video&&r.audio!==r.video)&&(c=!1),!0===c?(s.audioRecorder=null,s.videoRecorder.startRecording()):s.videoRecorder.initRecorder((function(){s.audioRecorder.initRecorder((function(){s.videoRecorder.startRecording(),s.audioRecorder.startRecording()}))}))}r.gif&&(i=null,"function"==typeof r.gif&&(i=r.gif),this.gifRecorder=new t(e,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:i,mimeType:n.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording((function(t){e(t,"audio")})),this.videoRecorder&&this.videoRecorder.stopRecording((function(t){e(t,"video")})),this.gifRecorder&&this.gifRecorder.stopRecording((function(t){e(t,"gif")}))},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){function t(e,t){if("undefined"!=typeof Worker){var i=function(e){var t,i=l.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),r=new Worker(i);if(void 0!==l)t=l;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";t=webkitURL}return t.revokeObjectURL(i),r}((function(e){postMessage((new FileReaderSync).readAsDataURL(e))}));i.onmessage=function(e){t(e.data)},i.postMessage(e)}else{var r=new FileReader;r.readAsDataURL(e),r.onload=function(e){t(e.target.result)}}}this.getBlob((function(i){i.audio&&i.video?t(i.audio,(function(r){t(i.video,(function(t){e({audio:r,video:t})}))})):i.audio?t(i.audio,(function(t){e({audio:t})})):i.video&&t(i.video,(function(t){e({video:t})}))}))},this.writeToDisk=function(){t.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){(e=e||{audio:!0,video:!0,gif:!0}).audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof e.audio?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof e.gif?e.gif:"")}}t.version="5.6.2",e.exports=t,t.getFromDisk=function(e,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+("all"===e?"blobs":e+" blob ")+" from disk!"),E.Fetch((function(i,r){"all"!==e&&r===e+"Blob"&&t&&t(i),"all"===e&&t&&t(i,r.replace("Blob",""))}))},t.writeToDisk=function(e){console.log("Writing recorded blob(s) to disk!"),(e=e||{}).audio&&e.video&&e.gif?e.audio.getDataURL((function(t){e.video.getDataURL((function(i){e.gif.getDataURL((function(e){E.Store({audioBlob:t,videoBlob:i,gifBlob:e})}))}))})):e.audio&&e.video?e.audio.getDataURL((function(t){e.video.getDataURL((function(e){E.Store({audioBlob:t,videoBlob:e})}))})):e.audio&&e.gif?e.audio.getDataURL((function(t){e.gif.getDataURL((function(e){E.Store({audioBlob:t,gifBlob:e})}))})):e.video&&e.gif?e.video.getDataURL((function(t){e.gif.getDataURL((function(e){E.Store({videoBlob:t,gifBlob:e})}))})):e.audio?e.audio.getDataURL((function(e){E.Store({audioBlob:e})})):e.video?e.video.getDataURL((function(e){E.Store({videoBlob:e})})):e.gif&&e.gif.getDataURL((function(e){E.Store({gifBlob:e})}))},n.getFromDisk=t.getFromDisk,n.writeToDisk=t.writeToDisk,t.MRecordRTC=n;var o;(o=void 0!==u?u:null)&&"undefined"==typeof window&&void 0!==u&&(u.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},u.console||(u.console={}),void 0!==u.console.log&&void 0!==u.console.error||(u.console.error=u.console.log=u.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(o.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},o.HTMLVideoElement=function(){}),"undefined"==typeof location&&(o.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(o.screen={width:0,height:0}),void 0===l&&(o.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),o.window=u);var a=window.requestAnimationFrame;if(void 0===a)if("undefined"!=typeof webkitRequestAnimationFrame)a=webkitRequestAnimationFrame;else if("undefined"!=typeof mozRequestAnimationFrame)a=mozRequestAnimationFrame;else if("undefined"!=typeof msRequestAnimationFrame)a=msRequestAnimationFrame;else if(void 0===a){var s=0;a=function(e,t){var i=(new Date).getTime(),r=Math.max(0,16-(i-s)),n=setTimeout((function(){e(i+r)}),r);return s=i+r,n}}var c=window.cancelAnimationFrame;void 0===c&&("undefined"!=typeof webkitCancelAnimationFrame?c=webkitCancelAnimationFrame:"undefined"!=typeof mozCancelAnimationFrame?c=mozCancelAnimationFrame:"undefined"!=typeof msCancelAnimationFrame?c=msCancelAnimationFrame:void 0===c&&(c=function(e){clearTimeout(e)}));var d=window.AudioContext;void 0===d&&("undefined"!=typeof webkitAudioContext&&(d=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(d=mozAudioContext));var l=window.URL;void 0===l&&"undefined"!=typeof webkitURL&&(l=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var h=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),f=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),p=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),v=!f&&!h&&!!navigator.webkitGetUserMedia||w()||-1!==navigator.userAgent.toLowerCase().indexOf("chrome/"),m=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);m&&!v&&-1!==navigator.userAgent.indexOf("CriOS")&&(m=!1,v=!0);var g=window.MediaStream;function y(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}function b(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(e){}var i=(e.type||"video/webm").split("/")[1];if(-1!==i.indexOf(";")&&(i=i.split(";")[0]),t&&-1!==t.indexOf(".")){var r=t.split(".");t=r[0],i=r[1]}var n=(t||Math.round(9999999999*Math.random())+888888888)+"."+i;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,n);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,n);var o=document.createElement("a");o.href=l.createObjectURL(e),o.download=n,o.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(o),"function"==typeof o.click?o.click():(o.target="_blank",o.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),l.revokeObjectURL(o.href)}function w(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}function k(e,t){return e&&e.getTracks?e.getTracks().filter((function(e){return e.kind===(t||"audio")})):[]}function A(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}void 0===g&&"undefined"!=typeof webkitMediaStream&&(g=webkitMediaStream),void 0!==g&&void 0===g.prototype.stop&&(g.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))}),t.invokeSaveAsDialog=b,t.getTracks=k,t.getSeekableBlob=function(e,t){if("undefined"==typeof EBML)throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var i=new EBML.Reader,r=new EBML.Decoder,n=EBML.tools,o=new FileReader;o.onload=function(e){r.decode(this.result).forEach((function(e){i.read(e)})),i.stop();var o=n.makeMetadataSeekable(i.metadatas,i.duration,i.cues),a=this.result.slice(i.metadataSize),s=new Blob([o,a],{type:"video/webm"});t(s)},o.readAsArrayBuffer(e)},t.bytesToSize=y,t.isElectron=w;
/**
   * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @example
   * Storage.AudioContext === webkitAudioContext
   * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   */
var R={};function C(){if(p||m||h)return!0;var e,t,i=navigator.userAgent,r=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10);return(v||f)&&(e=i.indexOf("Chrome"),r=i.substring(e+7)),-1!==(t=r.indexOf(";"))&&(r=r.substring(0,t)),-1!==(t=r.indexOf(" "))&&(r=r.substring(0,t)),n=parseInt(""+r,10),isNaN(n)&&(r=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10)),n>=49}
/**
   * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
   * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://github.com/muaz-khan|Muaz Khan}
   * @typedef MediaStreamRecorder
   * @class
   * @example
   * var config = {
   *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
   *     audioBitsPerSecond : 256 * 8 * 1024,
   *     videoBitsPerSecond : 256 * 8 * 1024,
   *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
   *     checkForInactiveTracks: true,
   *     timeSlice: 1000, // concatenate intervals based blobs
   *     ondataavailable: function() {} // get intervals based blobs
   * }
   * var recorder = new MediaStreamRecorder(mediaStream, config);
   * recorder.record();
   * recorder.stop(function(blob) {
   *     video.src = URL.createObjectURL(blob);
   *
   *     // or
   *     var blob = recorder.blob;
   * });
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
   * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
   * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
   */function P(e,t){var i=this;if(void 0===e)throw'First argument "MediaStream" is required.';if("undefined"==typeof MediaRecorder)throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if("audio"===(t=t||{mimeType:"video/webm"}).type){var r;if(k(e,"video").length&&k(e,"audio").length)navigator.mozGetUserMedia?(r=new g).addTrack(k(e,"audio")[0]):r=new g(k(e,"audio")),e=r;t.mimeType&&-1!==t.mimeType.toString().toLowerCase().indexOf("audio")||(t.mimeType=v?"audio/webm":"audio/ogg"),t.mimeType&&"audio/ogg"!==t.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(t.mimeType="audio/ogg")}var n,o=[];function a(){i.timestamps.push((new Date).getTime()),"function"==typeof t.onTimeStamp&&t.onTimeStamp(i.timestamps[i.timestamps.length-1],i.timestamps)}function s(e){return n&&n.mimeType?n.mimeType:e.mimeType||"video/webm"}function c(){o=[],n=null,i.timestamps=[]}this.getArrayOfBlobs=function(){return o},this.record=function(){i.blob=null,i.clearRecordedData(),i.timestamps=[],u=[],o=[];var r=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",r),n&&(n=null),v&&!C()&&(r="video/vp8"),"function"==typeof MediaRecorder.isTypeSupported&&r.mimeType&&(MediaRecorder.isTypeSupported(r.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",r.mimeType),r.mimeType="audio"===t.type?"audio/webm":"video/webm"));try{n=new MediaRecorder(e,r),t.mimeType=r.mimeType}catch(t){n=new MediaRecorder(e)}r.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in n&&!1===n.canRecordMimeType(r.mimeType)&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",r.mimeType)),n.ondataavailable=function(e){if(e.data&&u.push("ondataavailable: "+y(e.data.size)),"number"!=typeof t.timeSlice)!e.data||!e.data.size||e.data.size<100||i.blob?i.recordingCallback&&(i.recordingCallback(new Blob([],{type:s(r)})),i.recordingCallback=null):(i.blob=t.getNativeBlob?e.data:new Blob([e.data],{type:s(r)}),i.recordingCallback&&(i.recordingCallback(i.blob),i.recordingCallback=null));else if(e.data&&e.data.size&&(o.push(e.data),a(),"function"==typeof t.ondataavailable)){var n=t.getNativeBlob?e.data:new Blob([e.data],{type:s(r)});t.ondataavailable(n)}},n.onstart=function(){u.push("started")},n.onpause=function(){u.push("paused")},n.onresume=function(){u.push("resumed")},n.onstop=function(){u.push("stopped")},n.onerror=function(e){e&&(e.name||(e.name="UnknownError"),u.push("error: "+e),t.disableLogs||(-1!==e.name.toString().toLowerCase().indexOf("invalidstate")?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",e):-1!==e.name.toString().toLowerCase().indexOf("notsupported")?console.error("MIME type (",r.mimeType,") is not supported.",e):-1!==e.name.toString().toLowerCase().indexOf("security")?console.error("MediaRecorder security error",e):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),function(e){if(!i.manuallyStopped&&n&&"inactive"===n.state)return delete t.timeslice,void n.start(6e5);setTimeout(void 0,1e3)}(),"inactive"!==n.state&&"stopped"!==n.state&&n.stop())},"number"==typeof t.timeSlice?(a(),n.start(t.timeSlice)):n.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[],this.stop=function(e){e=e||function(){},i.manuallyStopped=!0,n&&(this.recordingCallback=e,"recording"===n.state&&n.stop(),"number"==typeof t.timeSlice&&setTimeout((function(){i.blob=new Blob(o,{type:s(t)}),i.recordingCallback(i.blob)}),100))},this.pause=function(){n&&"recording"===n.state&&n.pause()},this.resume=function(){n&&"paused"===n.state&&n.resume()},this.clearRecordedData=function(){n&&"recording"===n.state&&i.stop(c),c()},this.getInternalRecorder=function(){return n},this.blob=null,this.getState=function(){return n&&n.state||"inactive"};var u=[];this.getAllStates=function(){return u},void 0===t.checkForInactiveTracks&&(t.checkForInactiveTracks=!1);i=this;!function r(){if(n&&!1!==t.checkForInactiveTracks)return!1===function(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}()?(t.disableLogs||console.log("MediaStream seems stopped."),void i.stop()):void setTimeout(r,1e3)}(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}
/**
   * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
   * @summary JavaScript standalone object for stereo audio recording.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef StereoAudioRecorder
   * @class
   * @example
   * var recorder = new StereoAudioRecorder(MediaStream, {
   *     sampleRate: 44100,
   *     bufferSize: 4096
   * });
   * recorder.record();
   * recorder.stop(function(blob) {
   *     video.src = URL.createObjectURL(blob);
   * });
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
   * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
   */
function S(e,i){if(!k(e,"audio").length)throw"Your stream has no audio tracks.";var r,n=this,o=[],a=[],s=!1,c=0,u=2,d=(i=i||{}).desiredSampRate;function h(){if(!1===i.checkForInactiveTracks)return!0;if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}function f(e,t){function i(e,t){var i,r=e.numberOfAudioChannels,n=e.leftBuffers.slice(0),o=e.rightBuffers.slice(0),a=e.sampleRate,s=e.internalInterleavedLength,c=e.desiredSampRate;function u(e,t,i){var r=Math.round(e.length*(t/i)),n=[],o=Number((e.length-1)/(r-1));n[0]=e[0];for(var a=1;a<r-1;a++){var s=a*o,c=Number(Math.floor(s)).toFixed(),u=Number(Math.ceil(s)).toFixed(),l=s-c;n[a]=d(e[c],e[u],l)}return n[r-1]=e[e.length-1],n}function d(e,t,i){return e+(t-e)*i}function l(e,t){for(var i=new Float64Array(t),r=0,n=e.length,o=0;o<n;o++){var a=e[o];i.set(a,r),r+=a.length}return i}function h(e,t,i){for(var r=i.length,n=0;n<r;n++)e.setUint8(t+n,i.charCodeAt(n))}2===r&&(n=l(n,s),o=l(o,s),c&&(n=u(n,c,a),o=u(o,c,a))),1===r&&(n=l(n,s),c&&(n=u(n,c,a))),c&&(a=c),2===r&&(i=function(e,t){for(var i=e.length+t.length,r=new Float64Array(i),n=0,o=0;o<i;)r[o++]=e[n],r[o++]=t[n],n++;return r}(n,o)),1===r&&(i=n);var f=i.length,p=new ArrayBuffer(44+2*f),v=new DataView(p);h(v,0,"RIFF"),v.setUint32(4,36+2*f,!0),h(v,8,"WAVE"),h(v,12,"fmt "),v.setUint32(16,16,!0),v.setUint16(20,1,!0),v.setUint16(22,r,!0),v.setUint32(24,a,!0),v.setUint32(28,a*r*2,!0),v.setUint16(32,2*r,!0),v.setUint16(34,16,!0),h(v,36,"data"),v.setUint32(40,2*f,!0);for(var m=f,g=44,y=0;y<m;y++)v.setInt16(g,32767*i[y],!0),g+=2;if(t)return t({buffer:p,view:v});postMessage({buffer:p,view:v})}if(e.noWorker)i(e,(function(e){t(e.buffer,e.view)}));else{var r,n,o,a=(r=i,n=l.createObjectURL(new Blob([r.toString(),";this.onmessage =  function (eee) {"+r.name+"(eee.data);}"],{type:"application/javascript"})),(o=new Worker(n)).workerURL=n,o);a.onmessage=function(e){t(e.data.buffer,e.data.view),l.revokeObjectURL(a.workerURL),a.terminate()},a.postMessage(e)}}!0===i.leftChannel&&(u=1),1===i.numberOfAudioChannels&&(u=1),(!u||u<1)&&(u=2),i.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+u),void 0===i.checkForInactiveTracks&&(i.checkForInactiveTracks=!0),this.record=function(){if(!1===h())throw"Please make sure MediaStream is active.";w(),R=b=!1,s=!0,void 0!==i.timeSlice&&P()},this.stop=function(e){e=e||function(){},s=!1,f({desiredSampRate:d,sampleRate:y,numberOfAudioChannels:u,internalInterleavedLength:c,leftBuffers:o,rightBuffers:1===u?[]:a,noWorker:i.noWorker},(function(t,i){n.blob=new Blob([i],{type:"audio/wav"}),n.buffer=new ArrayBuffer(i.buffer.byteLength),n.view=i,n.sampleRate=d||y,n.bufferSize=g,n.length=c,R=!1,e&&e(n.blob)}))},void 0===t.Storage&&(t.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),t.Storage.AudioContextConstructor&&"closed"!==t.Storage.AudioContextConstructor.state||(t.Storage.AudioContextConstructor=new t.Storage.AudioContext);var p=t.Storage.AudioContextConstructor,v=p.createMediaStreamSource(e),m=[0,256,512,1024,2048,4096,8192,16384],g=void 0===i.bufferSize?4096:i.bufferSize;if(-1===m.indexOf(g)&&(i.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(m,null,"\t"))),p.createJavaScriptNode)r=p.createJavaScriptNode(g,u,u);else{if(!p.createScriptProcessor)throw"WebAudio API has no support on this browser.";r=p.createScriptProcessor(g,u,u)}v.connect(r),i.bufferSize||(g=r.bufferSize);var y=void 0!==i.sampleRate?i.sampleRate:p.sampleRate||44100;(y<22050||y>96e3)&&(i.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),i.disableLogs||i.desiredSampRate&&console.log("Desired sample-rate: "+i.desiredSampRate);var b=!1;function w(){o=[],a=[],c=0,R=!1,s=!1,b=!1,p=null,n.leftchannel=o,n.rightchannel=a,n.numberOfAudioChannels=u,n.desiredSampRate=d,n.sampleRate=y,n.recordingLength=c,C={left:[],right:[],recordingLength:0}}function A(){r&&(r.onaudioprocess=null,r.disconnect(),r=null),v&&(v.disconnect(),v=null),w()}this.pause=function(){b=!0},this.resume=function(){if(!1===h())throw"Please make sure MediaStream is active.";if(!s)return i.disableLogs||console.log("Seems recording has been restarted."),void this.record();b=!1},this.clearRecordedData=function(){i.checkForInactiveTracks=!1,s&&this.stop(A),A()},this.name="StereoAudioRecorder",this.toString=function(){return this.name};var R=!1;r.onaudioprocess=function(e){if(!b)if(!1===h()&&(i.disableLogs||console.log("MediaStream seems stopped."),r.disconnect(),s=!1),s){R||(R=!0,i.onAudioProcessStarted&&i.onAudioProcessStarted(),i.initCallback&&i.initCallback());var t=e.inputBuffer.getChannelData(0),d=new Float32Array(t);if(o.push(d),2===u){var l=e.inputBuffer.getChannelData(1),f=new Float32Array(l);a.push(f)}c+=g,n.recordingLength=c,void 0!==i.timeSlice&&(C.recordingLength+=g,C.left.push(d),2===u&&C.right.push(f))}else v&&(v.disconnect(),v=null)},p.createMediaStreamDestination?r.connect(p.createMediaStreamDestination()):r.connect(p.destination),this.leftchannel=o,this.rightchannel=a,this.numberOfAudioChannels=u,this.desiredSampRate=d,this.sampleRate=y,n.recordingLength=c;var C={left:[],right:[],recordingLength:0};function P(){s&&"function"==typeof i.ondataavailable&&void 0!==i.timeSlice&&(C.left.length?(f({desiredSampRate:d,sampleRate:y,numberOfAudioChannels:u,internalInterleavedLength:C.recordingLength,leftBuffers:C.left,rightBuffers:1===u?[]:C.right},(function(e,t){var r=new Blob([t],{type:"audio/wav"});i.ondataavailable(r),setTimeout(P,i.timeSlice)})),C={left:[],right:[],recordingLength:0}):setTimeout(P,i.timeSlice))}}
/**
   * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
   * @summary HTML2Canvas recording into video WebM.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef CanvasRecorder
   * @class
   * @example
   * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
   * recorder.record();
   * recorder.stop(function(blob) {
   *     video.src = URL.createObjectURL(blob);
   * });
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
   * @param {object} config - {disableLogs:true, initCallback: function}
   */
function x(e,t){if("undefined"==typeof html2canvas)throw"Please link: https://www.webrtc-experiment.com/screenshot.js";(t=t||{}).frameInterval||(t.frameInterval=10);var i=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){e in document.createElement("canvas")&&(i=!0)}));var r,n,o,a=!(!window.webkitRTCPeerConnection&&!window.webkitGetUserMedia||!window.chrome),s=50,c=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(a&&c&&c[2]&&(s=parseInt(c[2],10)),a&&s<52&&(i=!1),t.useWhammyRecorder&&(i=!1),i)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),e instanceof HTMLCanvasElement)r=e;else{if(!(e instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";r=e.canvas}else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));this.record=function(){if(o=!0,i&&!t.useWhammyRecorder){var e;"captureStream"in r?e=r.captureStream(25):"mozCaptureStream"in r?e=r.mozCaptureStream(25):"webkitCaptureStream"in r&&(e=r.webkitCaptureStream(25));try{var a=new g;a.addTrack(k(e,"video")[0]),e=a}catch(e){}if(!e)throw"captureStream API are NOT available.";(n=new P(e,{mimeType:t.mimeType||"video/webm"})).record()}else f.frames=[],h=(new Date).getTime(),l();t.initCallback&&t.initCallback()},this.getWebPImages=function(i){if("canvas"===e.nodeName.toLowerCase()){var r=f.frames.length;f.frames.forEach((function(e,i){var n=r-i;t.disableLogs||console.log(n+"/"+r+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(n,r);var o=e.image.toDataURL("image/webp",1);f.frames[i].image=o})),t.disableLogs||console.log("Generating WebM"),i()}else i()},this.stop=function(e){o=!1;var r=this;i&&n?n.stop(e):this.getWebPImages((function(){f.compile((function(i){t.disableLogs||console.log("Recording finished!"),r.blob=i,r.blob.forEach&&(r.blob=new Blob([],{type:"video/webm"})),e&&e(r.blob),f.frames=[]}))}))};var u=!1;function d(){f.frames=[],o=!1,u=!1}function l(){if(u)return h=(new Date).getTime(),setTimeout(l,500);if("canvas"===e.nodeName.toLowerCase()){var i=(new Date).getTime()-h;return h=(new Date).getTime(),f.frames.push({image:(r=document.createElement("canvas"),n=r.getContext("2d"),r.width=e.width,r.height=e.height,n.drawImage(e,0,0),r),duration:i}),void(o&&setTimeout(l,t.frameInterval))}var r,n;html2canvas(e,{grabMouse:void 0===t.showMousePointer||t.showMousePointer,onrendered:function(e){var i=(new Date).getTime()-h;if(!i)return setTimeout(l,t.frameInterval);h=(new Date).getTime(),f.frames.push({image:e.toDataURL("image/webp",1),duration:i}),o&&setTimeout(l,t.frameInterval)}})}this.pause=function(){u=!0,n instanceof P&&n.pause()},this.resume=function(){u=!1,n instanceof P?n.resume():o||this.record()},this.clearRecordedData=function(){o&&this.stop(d),d()},this.name="CanvasRecorder",this.toString=function(){return this.name};var h=(new Date).getTime(),f=new M.Video(100)}
/**
   * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
   * @summary Video recording feature in Chrome.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef WhammyRecorder
   * @class
   * @example
   * var recorder = new WhammyRecorder(mediaStream);
   * recorder.record();
   * recorder.stop(function(blob) {
   *     video.src = URL.createObjectURL(blob);
   * });
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
   * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
   */
function O(e,t){function i(e){e=void 0!==e?e:10;var t=(new Date).getTime()-c;return t?o?(c=(new Date).getTime(),setTimeout(i,100)):(c=(new Date).getTime(),s.paused&&s.play(),l.drawImage(s,0,0,d.width,d.height),u.frames.push({duration:t,image:d.toDataURL("image/webp")}),void(n||setTimeout(i,e,e))):setTimeout(i,e,e)}function r(e,t,i,r,n){var o=document.createElement("canvas");o.width=d.width,o.height=d.height;var a=o.getContext("2d"),s=[],c=-1===t,u=t&&t>0&&t<=e.length?t:e.length,l=0,h=0,f=0,p=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),v=i&&i>=0&&i<=1?i:0,m=r&&r>=0&&r<=1?r:0,g=!1;!function(e){var t=-1,i=e.length;!function r(){++t!==i?setTimeout((function(){e.functionToLoop(r,t)}),1):e.callback()}()}({length:u,functionToLoop:function(t,i){var r,n,o,u=function(){!g&&o-r<=o*m||(c&&(g=!0),s.push(e[i])),t()};if(g)u();else{var y=new Image;y.onload=function(){a.drawImage(y,0,0,d.width,d.height);var e=a.getImageData(0,0,d.width,d.height);r=0,n=e.data.length,o=e.data.length/4;for(var t=0;t<n;t+=4){var i={r:e.data[t],g:e.data[t+1],b:e.data[t+2]};Math.sqrt(Math.pow(i.r-l,2)+Math.pow(i.g-h,2)+Math.pow(i.b-f,2))<=p*v&&r++}u()},y.src=e[i].image}},callback:function(){(s=s.concat(e.slice(u))).length<=0&&s.push(e[e.length-1]),n(s)}})}(t=t||{}).frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),d.width=t.canvas.width||320,d.height=t.canvas.height||240,l=d.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(s=t.video.cloneNode(),t.initCallback&&t.initCallback()):(s=document.createElement("video"),A(e,s),s.onloadedmetadata=function(){t.initCallback&&t.initCallback()},s.width=t.video.width,s.height=t.video.height),s.muted=!0,s.play(),c=(new Date).getTime(),u=new M.Video,t.disableLogs||(console.log("canvas resolutions",d.width,"*",d.height),console.log("video width/height",s.width||d.width,"*",s.height||d.height)),i(t.frameInterval)};var n=!1;this.stop=function(e){e=e||function(){},n=!0;var i=this;setTimeout((function(){r(u.frames,-1,null,null,(function(r){u.frames=r,t.advertisement&&t.advertisement.length&&(u.frames=t.advertisement.concat(u.frames)),u.compile((function(t){i.blob=t,i.blob.forEach&&(i.blob=new Blob([],{type:"video/webm"})),e&&e(i.blob)}))}))}),10)};var o=!1;function a(){u.frames=[],n=!0,o=!1}this.pause=function(){o=!0},this.resume=function(){o=!1,n&&this.record()},this.clearRecordedData=function(){n||this.stop(a),a()},this.name="WhammyRecorder",this.toString=function(){return this.name};var s,c,u,d=document.createElement("canvas"),l=d.getContext("2d")}void 0!==d?R.AudioContext=d:"undefined"!=typeof webkitAudioContext&&(R.AudioContext=webkitAudioContext),t.Storage=R,t.MediaStreamRecorder=P,t.StereoAudioRecorder=S,t.CanvasRecorder=x,t.WhammyRecorder=O;
/**
   * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
   * @summary A real time javascript webm encoder based on a canvas hack.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef Whammy
   * @class
   * @example
   * var recorder = new Whammy().Video(15);
   * recorder.add(context || canvas || dataURL);
   * var output = recorder.compile();
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   */
var M=function(){function e(e){this.frames=[],this.duration=e||1,this.quality=.8}function t(e){function t(e,t,i){return[{data:e,id:231}].concat(i.map((function(e){var i=function(e){var t=0;e.keyframe&&(t|=128);e.invisible&&(t|=8);e.lacing&&(t|=e.lacing<<1);e.discardable&&(t|=1);if(e.trackNum>127)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map((function(e){return String.fromCharCode(e)})).join("")+e.frame}({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:i,id:163}})))}function i(e){for(var t=[];e>0;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function r(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var i=0;i<e.length;i+=8)t.push(parseInt(e.substr(i,8),2));return new Uint8Array(t)}function n(e){for(var t=[],o=0;o<e.length;o++){var a=e[o].data;"object"==typeof a&&(a=n(a)),"number"==typeof a&&(a=r(a.toString(2))),"string"==typeof a&&(a=new Uint8Array(a.split("").map((function(e){return e.charCodeAt(0)}))));var s=a.size||a.byteLength||a.length,c=Math.ceil(Math.ceil(Math.log(s)/Math.log(2))/8),u=s.toString(2),d=new Array(7*c+7+1-u.length).join("0")+u,l=new Array(c).join("0")+"1"+d;t.push(i(e[o].id)),t.push(r(l)),t.push(a)}return new Blob(t,{type:"video/webm"})}function o(e,t){return parseInt(e.substr(t+4,4).split("").map((function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t})).join(""),2)}function a(e){for(var t=0,i={};t<e.length;){var r=e.substr(t,4),n=o(e,t),s=e.substr(t+4+4,n);t+=8+n,i[r]=i[r]||[],"RIFF"===r||"LIST"===r?i[r].push(a(s)):i[r].push(s)}return i}var s=new function(e){var i=function(e){if(!e[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var t=e[0].width,i=e[0].height,r=e[0].duration,n=1;n<e.length;n++)r+=e[n].duration;return{duration:r,width:t,height:i}}(e);if(!i)return[];for(var r,o=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(r=i.duration,[].slice.call(new Uint8Array(new Float64Array([r]).buffer),0).map((function(e){return String.fromCharCode(e)})).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:i.width,id:176},{data:i.height,id:186}]}]}]}]}],a=0,s=0;a<e.length;){var c=[],u=0;do{c.push(e[a]),u+=e[a].duration,a++}while(a<e.length&&u<3e4);var d={id:524531317,data:t(s,0,c)};o[1].data.push(d),s+=u}return n(o)}(e.map((function(e){var t=function(e){for(var t=e.RIFF[0].WEBP[0],i=t.indexOf("*"),r=0,n=[];r<4;r++)n[r]=t.charCodeAt(i+3+r);return{width:16383&(n[1]<<8|n[0]),height:16383&(n[3]<<8|n[2]),data:t,riff:e}}(a(atob(e.image.slice(23))));return t.duration=e.duration,t})));postMessage(s)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var i,r,n,o=(i=t,r=l.createObjectURL(new Blob([i.toString(),"this.onmessage =  function (eee) {"+i.name+"(eee.data);}"],{type:"application/javascript"})),n=new Worker(r),l.revokeObjectURL(r),n);o.onmessage=function(t){t.data.error?console.error(t.data.error):e(t.data)},o.postMessage(this.frames)},{Video:e}}();t.Whammy=M;
/**
   * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
   * @summary Writing blobs into IndexedDB.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @example
   * DiskStorage.Store({
   *     audioBlob: yourAudioBlob,
   *     videoBlob: yourVideoBlob,
   *     gifBlob  : yourGifBlob
   * });
   * DiskStorage.Fetch(function(dataURL, type) {
   *     if(type === 'audioBlob') { }
   *     if(type === 'videoBlob') { }
   *     if(type === 'gifBlob')   { }
   * });
   * // DiskStorage.dataStoreName = 'recordRTC';
   * // DiskStorage.onError = function(error) { };
   * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
   * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
   * @property {function} Store - This method stores blobs in IndexedDB.
   * @property {function} onError - This function is invoked for any known/unknown error.
   * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   */
var E={init:function(){var e=this;if("undefined"!=typeof indexedDB&&void 0!==indexedDB.open){var t,i=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),r=indexedDB.open(i,1);r.onerror=e.onError,r.onsuccess=function(){((t=r.result).onerror=e.onError,t.setVersion)?1!==t.version?t.setVersion(1).onsuccess=function(){n(t),o()}:o():o()},r.onupgradeneeded=function(e){n(e.target.result)}}else console.error("IndexedDB API are not available in this browser.");function n(t){t.createObjectStore(e.dataStoreName)}function o(){var i=t.transaction([e.dataStoreName],"readwrite");function r(t){i.objectStore(e.dataStoreName).get(t).onsuccess=function(i){e.callback&&e.callback(i.target.result,t)}}e.videoBlob&&i.objectStore(e.dataStoreName).put(e.videoBlob,"videoBlob"),e.gifBlob&&i.objectStore(e.dataStoreName).put(e.gifBlob,"gifBlob"),e.audioBlob&&i.objectStore(e.dataStoreName).put(e.audioBlob,"audioBlob"),r("audioBlob"),r("videoBlob"),r("gifBlob")}},Fetch:function(e){return this.callback=e,this.init(),this},Store:function(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function(e){console.error(JSON.stringify(e,null,"\t"))},dataStoreName:"recordRTC",dbName:null};
/**
   * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef GifRecorder
   * @class
   * @example
   * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
   * recorder.record();
   * recorder.stop(function(blob) {
   *     img.src = URL.createObjectURL(blob);
   * });
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
   * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
   */
function T(e,t){if("undefined"==typeof GIFEncoder){var i=document.createElement("script");i.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(i)}t=t||{};var r=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement;this.record=function(){"undefined"!=typeof GIFEncoder&&u?(r||(t.width||(t.width=d.offsetWidth||320),t.height||(t.height=d.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),o.width=t.canvas.width||320,o.height=t.canvas.height||240,d.width=t.video.width||320,d.height=t.video.height||240),(h=new GIFEncoder).setRepeat(0),h.setDelay(t.frameRate||200),h.setQuality(t.quality||10),h.start(),"function"==typeof t.onGifRecordingStarted&&t.onGifRecordingStarted(),f=a((function e(i){if(!0!==p.clearedRecordedData){if(n)return setTimeout((function(){e(i)}),100);f=a(e),void 0===typeof l&&(l=i),i-l<90||(!r&&d.paused&&d.play(),r||s.drawImage(d,0,0,o.width,o.height),t.onGifPreview&&t.onGifPreview(o.toDataURL("image/png")),h.addFrame(s),l=i)}})),t.initCallback&&t.initCallback()):setTimeout(p.record,1e3)},this.stop=function(e){e=e||function(){},f&&c(f),this.blob=new Blob([new Uint8Array(h.stream().bin)],{type:"image/gif"}),e(this.blob),h.stream().bin=[]};var n=!1;this.pause=function(){n=!0},this.resume=function(){n=!1},this.clearRecordedData=function(){p.clearedRecordedData=!0,h&&(h.stream().bin=[])},this.name="GifRecorder",this.toString=function(){return this.name};var o=document.createElement("canvas"),s=o.getContext("2d");r&&(e instanceof CanvasRenderingContext2D?o=(s=e).canvas:e instanceof HTMLCanvasElement&&(s=e.getContext("2d"),o=e));var u=!0;if(!r){var d=document.createElement("video");d.muted=!0,d.autoplay=!0,d.playsInline=!0,u=!1,d.onloadedmetadata=function(){u=!0},A(e,d),d.play()}var l,h,f=null,p=this}function j(e,t){t=t||"multi-streams-mixer";var i=[],r=!1,n=document.createElement("canvas"),o=n.getContext("2d");n.style.opacity=0,n.style.position="absolute",n.style.zIndex=-1,n.style.top="-1000em",n.style.left="-1000em",n.className=t,(document.body||document.documentElement).appendChild(n),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var a=this,s=window.AudioContext;void 0===s&&("undefined"!=typeof webkitAudioContext&&(s=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(s=mozAudioContext));var c=window.URL;void 0===c&&"undefined"!=typeof webkitURL&&(c=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var u=window.MediaStream;void 0===u&&"undefined"!=typeof webkitMediaStream&&(u=webkitMediaStream),void 0!==u&&void 0===u.prototype.stop&&(u.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))});var d={};function l(){if(!r){var e=i.length,t=!1,o=[];if(i.forEach((function(e){e.stream||(e.stream={}),e.stream.fullcanvas?t=e:o.push(e)})),t)n.width=t.stream.width,n.height=t.stream.height;else if(o.length){n.width=e>1?2*o[0].width:o[0].width;var s=1;3!==e&&4!==e||(s=2),5!==e&&6!==e||(s=3),7!==e&&8!==e||(s=4),9!==e&&10!==e||(s=5),n.height=o[0].height*s}else n.width=a.width||360,n.height=a.height||240;t&&t instanceof HTMLVideoElement&&h(t),o.forEach((function(e,t){h(e,t)})),setTimeout(l,a.frameInterval)}}function h(e,t){if(!r){var i=0,n=0,a=e.width,s=e.height;1===t&&(i=e.width),2===t&&(n=e.height),3===t&&(i=e.width,n=e.height),4===t&&(n=2*e.height),5===t&&(i=e.width,n=2*e.height),6===t&&(n=3*e.height),7===t&&(i=e.width,n=3*e.height),void 0!==e.stream.left&&(i=e.stream.left),void 0!==e.stream.top&&(n=e.stream.top),void 0!==e.stream.width&&(a=e.stream.width),void 0!==e.stream.height&&(s=e.stream.height),o.drawImage(e,i,n,a,s),"function"==typeof e.stream.onRender&&e.stream.onRender(o,i,n,a,s,t)}}function f(e){var i=document.createElement("video");return function(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}(e,i),i.className=t,i.muted=!0,i.volume=0,i.width=e.width||a.width||360,i.height=e.height||a.height||240,i.play(),i}function p(t){i=[],(t=t||e).forEach((function(e){if(e.getTracks().filter((function(e){return"video"===e.kind})).length){var t=f(e);t.stream=e,i.push(t)}}))}void 0!==s?d.AudioContext=s:"undefined"!=typeof webkitAudioContext&&(d.AudioContext=webkitAudioContext),this.startDrawingFrames=function(){l()},this.appendStreams=function(t){if(!t)throw"First parameter is required.";t instanceof Array||(t=[t]),t.forEach((function(t){var r=new u;if(t.getTracks().filter((function(e){return"video"===e.kind})).length){var n=f(t);n.stream=t,i.push(n),r.addTrack(t.getTracks().filter((function(e){return"video"===e.kind}))[0])}if(t.getTracks().filter((function(e){return"audio"===e.kind})).length){var o=a.audioContext.createMediaStreamSource(t);a.audioDestination=a.audioContext.createMediaStreamDestination(),o.connect(a.audioDestination),r.addTrack(a.audioDestination.stream.getTracks().filter((function(e){return"audio"===e.kind}))[0])}e.push(r)}))},this.releaseStreams=function(){i=[],r=!0,a.gainNode&&(a.gainNode.disconnect(),a.gainNode=null),a.audioSources.length&&(a.audioSources.forEach((function(e){e.disconnect()})),a.audioSources=[]),a.audioDestination&&(a.audioDestination.disconnect(),a.audioDestination=null),a.audioContext&&a.audioContext.close(),a.audioContext=null,o.clearRect(0,0,n.width,n.height),n.stream&&(n.stream.stop(),n.stream=null)},this.resetVideoStreams=function(e){!e||e instanceof Array||(e=[e]),p(e)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=function(){r=!1;var t=function(){var e;p(),"captureStream"in n?e=n.captureStream():"mozCaptureStream"in n?e=n.mozCaptureStream():a.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var t=new u;return e.getTracks().filter((function(e){return"video"===e.kind})).forEach((function(e){t.addTrack(e)})),n.stream=t,t}(),i=function(){d.AudioContextConstructor||(d.AudioContextConstructor=new d.AudioContext);a.audioContext=d.AudioContextConstructor,a.audioSources=[],!0===a.useGainNode&&(a.gainNode=a.audioContext.createGain(),a.gainNode.connect(a.audioContext.destination),a.gainNode.gain.value=0);var t=0;if(e.forEach((function(e){if(e.getTracks().filter((function(e){return"audio"===e.kind})).length){t++;var i=a.audioContext.createMediaStreamSource(e);!0===a.useGainNode&&i.connect(a.gainNode),a.audioSources.push(i)}})),!t)return;return a.audioDestination=a.audioContext.createMediaStreamDestination(),a.audioSources.forEach((function(e){e.connect(a.audioDestination)})),a.audioDestination.stream}();return i&&i.getTracks().filter((function(e){return"audio"===e.kind})).forEach((function(e){t.addTrack(e)})),e.forEach((function(e){e.fullcanvas})),t}}
/**
   * MultiStreamRecorder can record multiple videos in single container.
   * @summary Multi-videos recorder.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef MultiStreamRecorder
   * @class
   * @example
   * var options = {
   *     mimeType: 'video/webm'
   * }
   * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
   * recorder.record();
   * recorder.stop(function(blob) {
   *     video.src = URL.createObjectURL(blob);
   *
   *     // or
   *     var blob = recorder.blob;
   * });
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {MediaStreams} mediaStreams - Array of MediaStreams.
   * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
   */
function D(e,t){e=e||[];var i,r,n=this;(t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}}).frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){var n;i=new j(e,t.elementClass||"multi-streams-mixer"),(n=[],e.forEach((function(e){k(e,"video").forEach((function(e){n.push(e)}))})),n).length&&(i.frameInterval=t.frameInterval||10,i.width=t.video.width||360,i.height=t.video.height||240,i.startDrawingFrames()),t.previewStream&&"function"==typeof t.previewStream&&t.previewStream(i.getMixedStream()),(r=new P(i.getMixedStream(),t)).record()},this.stop=function(e){r&&r.stop((function(t){n.blob=t,e(t),n.clearRecordedData()}))},this.pause=function(){r&&r.pause()},this.resume=function(){r&&r.resume()},this.clearRecordedData=function(){r&&(r.clearRecordedData(),r=null),i&&(i.releaseStreams(),i=null)},this.addStreams=function(n){if(!n)throw"First parameter is required.";n instanceof Array||(n=[n]),e.concat(n),r&&i&&(i.appendStreams(n),t.previewStream&&"function"==typeof t.previewStream&&t.previewStream(i.getMixedStream()))},this.resetVideoStreams=function(e){i&&(!e||e instanceof Array||(e=[e]),i.resetVideoStreams(e))},this.getMixer=function(){return i},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}
/**
   * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
   * @summary Video recording feature in Chrome, Firefox and maybe Edge.
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef WebAssemblyRecorder
   * @class
   * @example
   * var recorder = new WebAssemblyRecorder(mediaStream);
   * recorder.record();
   * recorder.stop(function(blob) {
   *     video.src = URL.createObjectURL(blob);
   * });
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
   * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
   */
function L(e,t){var i,r,n;function o(){return new ReadableStream({start:function(r){var n=document.createElement("canvas"),o=document.createElement("video"),a=!0;o.srcObject=e,o.muted=!0,o.height=t.height,o.width=t.width,o.volume=0,o.onplaying=function(){n.width=t.width,n.height=t.height;var e=n.getContext("2d"),s=1e3/t.frameRate,c=setInterval((function(){if(i&&(clearInterval(c),r.close()),a&&(a=!1,t.onVideoProcessStarted&&t.onVideoProcessStarted()),e.drawImage(o,0,0),"closed"!==r._controlledReadableStream.state)try{r.enqueue(e.getImageData(0,0,t.width,t.height))}catch(e){}}),s)},o.play()}})}function a(e,c){if(!t.workerPath&&!c)return i=!1,void fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then((function(t){t.arrayBuffer().then((function(t){a(e,t)}))}));if(!t.workerPath&&c instanceof ArrayBuffer){var u=new Blob([c],{type:"text/javascript"});t.workerPath=l.createObjectURL(u)}t.workerPath||console.error("workerPath parameter is missing."),(r=new Worker(t.workerPath)).postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),r.addEventListener("message",(function(e){"READY"===e.data?(r.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:t.realtime}),o().pipeTo(new WritableStream({write:function(e){i?console.error("Got image, but recorder is finished!"):r.postMessage(e.data.buffer,[e.data.buffer])}}))):e.data&&(n||s.push(e.data))}))}"undefined"!=typeof ReadableStream&&"undefined"!=typeof WritableStream||console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),(t=t||{}).width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,t.realtime=t.realtime||!0,this.record=function(){s=[],n=!1,this.blob=null,a(e),"function"==typeof t.initCallback&&t.initCallback()},this.pause=function(){n=!0},this.resume=function(){n=!1};var s=[];this.stop=function(e){i=!0;var t=this;!function(e){r?(r.addEventListener("message",(function(t){null===t.data&&(r.terminate(),r=null,e&&e())})),r.postMessage(null)):e&&e()}((function(){t.blob=new Blob(s,{type:"video/webm"}),e(t.blob)}))},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){s=[],n=!1,this.blob=null},this.blob=null}t.DiskStorage=E,t.GifRecorder=T,t.MultiStreamRecorder=D,t.RecordRTCPromisesHandler=
/**
   * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
   * @summary Promises for {@link RecordRTC}
   * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
   * @author {@link https://MuazKhan.com|Muaz Khan}
   * @typedef RecordRTCPromisesHandler
   * @class
   * @example
   * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
   * recorder.startRecording()
   *         .then(successCB)
   *         .catch(errorCB);
   * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
   * recorder.recordRTC.onStateChanged = function(state) {};
   * recorder.recordRTC.setRecordingDuration(5000);
   * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
   * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
   * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
   * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
   * @requires {@link RecordRTC}
   */
function(e,i){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(void 0===e)throw'First argument "MediaStream" is required.';var r=this;r.recordRTC=new t(e,i),this.startRecording=function(){return new Promise((function(e,t){try{r.recordRTC.startRecording(),e()}catch(e){t(e)}}))},this.stopRecording=function(){return new Promise((function(e,t){try{r.recordRTC.stopRecording((function(i){r.blob=r.recordRTC.getBlob(),r.blob&&r.blob.size?e(i):t("Empty blob.",r.blob)}))}catch(e){t(e)}}))},this.pauseRecording=function(){return new Promise((function(e,t){try{r.recordRTC.pauseRecording(),e()}catch(e){t(e)}}))},this.resumeRecording=function(){return new Promise((function(e,t){try{r.recordRTC.resumeRecording(),e()}catch(e){t(e)}}))},this.getDataURL=function(e){return new Promise((function(e,t){try{r.recordRTC.getDataURL((function(t){e(t)}))}catch(e){t(e)}}))},this.getBlob=function(){return new Promise((function(e,t){try{e(r.recordRTC.getBlob())}catch(e){t(e)}}))},this.getInternalRecorder=function(){return new Promise((function(e,t){try{e(r.recordRTC.getInternalRecorder())}catch(e){t(e)}}))},this.reset=function(){return new Promise((function(e,t){try{e(r.recordRTC.reset())}catch(e){t(e)}}))},this.destroy=function(){return new Promise((function(e,t){try{e(r.recordRTC.destroy())}catch(e){t(e)}}))},this.getState=function(){return new Promise((function(e,t){try{e(r.recordRTC.getState())}catch(e){t(e)}}))},this.blob=null,this.version="5.6.2"},t.WebAssemblyRecorder=L})),h=d(c((function(e,t){
/*!
   * wavesurfer.js 6.2.0 (2022-05-16)
   * https://wavesurfer-js.org
   * @license BSD-3-Clause
   */
var i;self,i=()=>{return e={"./src/drawer.canvasentry.js":
/*!***********************************!*\
            !*** ./src/drawer.canvasentry.js ***!
            \***********************************/
(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(i(
/*! ./util/style */
"./src/util/style.js")),n=o(i(
/*! ./util/get-id */
"./src/util/get-id.js"));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wave=null,this.waveCtx=null,this.progress=null,this.progressCtx=null,this.start=0,this.end=1,this.id=(0,n.default)(void 0!==this.constructor.name?this.constructor.name.toLowerCase()+"_":"canvasentry_"),this.canvasContextAttributes={}}var t,i,o;return t=e,(i=[{key:"initWave",value:function(e){this.wave=e,this.waveCtx=this.wave.getContext("2d",this.canvasContextAttributes)}},{key:"initProgress",value:function(e){this.progress=e,this.progressCtx=this.progress.getContext("2d",this.canvasContextAttributes)}},{key:"updateDimensions",value:function(e,t,i,n){this.start=this.wave.offsetLeft/t||0,this.end=this.start+e/t,this.wave.width=i,this.wave.height=n;var o={width:e+"px"};(0,r.default)(this.wave,o),this.hasProgressCanvas&&(this.progress.width=i,this.progress.height=n,(0,r.default)(this.progress,o))}},{key:"clearWave",value:function(){this.waveCtx.clearRect(0,0,this.waveCtx.canvas.width,this.waveCtx.canvas.height),this.hasProgressCanvas&&this.progressCtx.clearRect(0,0,this.progressCtx.canvas.width,this.progressCtx.canvas.height)}},{key:"setFillStyles",value:function(e,t){this.waveCtx.fillStyle=this.getFillStyle(this.waveCtx,e),this.hasProgressCanvas&&(this.progressCtx.fillStyle=this.getFillStyle(this.progressCtx,t))}},{key:"getFillStyle",value:function(e,t){if("string"==typeof t||t instanceof CanvasGradient)return t;var i=e.createLinearGradient(0,0,0,e.canvas.height);return t.forEach((function(e,r){return i.addColorStop(r/t.length,e)})),i}},{key:"applyCanvasTransforms",value:function(e){e&&(this.waveCtx.setTransform(0,1,1,0,0,0),this.hasProgressCanvas&&this.progressCtx.setTransform(0,1,1,0,0,0))}},{key:"fillRects",value:function(e,t,i,r,n){this.fillRectToContext(this.waveCtx,e,t,i,r,n),this.hasProgressCanvas&&this.fillRectToContext(this.progressCtx,e,t,i,r,n)}},{key:"fillRectToContext",value:function(e,t,i,r,n,o){e&&(o?this.drawRoundedRect(e,t,i,r,n,o):e.fillRect(t,i,r,n))}},{key:"drawRoundedRect",value:function(e,t,i,r,n,o){0!==n&&(n<0&&(i-=n*=-1),e.beginPath(),e.moveTo(t+o,i),e.lineTo(t+r-o,i),e.quadraticCurveTo(t+r,i,t+r,i+o),e.lineTo(t+r,i+n-o),e.quadraticCurveTo(t+r,i+n,t+r-o,i+n),e.lineTo(t+o,i+n),e.quadraticCurveTo(t,i+n,t,i+n-o),e.lineTo(t,i+o),e.quadraticCurveTo(t,i,t+o,i),e.closePath(),e.fill())}},{key:"drawLines",value:function(e,t,i,r,n,o){this.drawLineToContext(this.waveCtx,e,t,i,r,n,o),this.hasProgressCanvas&&this.drawLineToContext(this.progressCtx,e,t,i,r,n,o)}},{key:"drawLineToContext",value:function(e,t,i,r,n,o,a){if(e){var s,c,u,d=t.length/2,l=Math.round(d*this.start),h=l,f=Math.round(d*this.end)+1,p=this.wave.width/(f-h-1),v=r+n,m=i/r;for(e.beginPath(),e.moveTo((h-l)*p,v),e.lineTo((h-l)*p,v-Math.round((t[2*h]||0)/m)),s=h;s<f;s++)c=t[2*s]||0,u=Math.round(c/m),e.lineTo((s-l)*p+this.halfPixel,v-u);for(var g=f-1;g>=h;g--)c=t[2*g+1]||0,u=Math.round(c/m),e.lineTo((g-l)*p+this.halfPixel,v-u);e.lineTo((h-l)*p,v-Math.round((t[2*h+1]||0)/m)),e.closePath(),e.fill()}}},{key:"destroy",value:function(){this.waveCtx=null,this.wave=null,this.progressCtx=null,this.progress=null}},{key:"getImage",value:function(e,t,i){var r=this;return"blob"===i?new Promise((function(i){r.wave.toBlob(i,e,t)})):"dataURL"===i?this.wave.toDataURL(e,t):void 0}}])&&a(t.prototype,i),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=s,e.exports=t.default},"./src/drawer.js":
/*!***********************!*\
            !*** ./src/drawer.js ***!
            \***********************/
(e,t,i)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var i=o(t);if(i&&i.has(e))return i.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var c=a?Object.getOwnPropertyDescriptor(e,s):null;c&&(c.get||c.set)?Object.defineProperty(n,s,c):n[s]=e[s]}return n.default=e,i&&i.set(e,n),n}(i(
/*! ./util */
"./src/util/index.js"));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(o=function(e){return e?i:t})(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=d(e);if(t){var n=d(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return u(this,i)}}function u(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(u,e);var t,i,r,o=c(u);function u(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(i=o.call(this)).container=n.withOrientation(e,t.vertical),i.params=t,i.width=0,i.height=t.height*i.params.pixelRatio,i.lastPos=0,i.wrapper=null,i}return t=u,(i=[{key:"style",value:function(e,t){return n.style(e,t)}},{key:"createWrapper",value:function(){this.wrapper=n.withOrientation(this.container.appendChild(document.createElement("wave")),this.params.vertical),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",cursor:this.params.hideCursor?"none":"auto",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()}},{key:"handleEvent",value:function(e,t){!t&&e.preventDefault();var i,r=n.withOrientation(e.targetTouches?e.targetTouches[0]:e,this.params.vertical).clientX,o=this.wrapper.getBoundingClientRect(),a=this.width,s=this.getWidth(),c=this.getProgressPixels(o,r);return i=!this.params.fillParent&&a<s?c*(this.params.pixelRatio/a)||0:(c+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,n.clamp(i,0,1)}},{key:"getProgressPixels",value:function(e,t){return this.params.rtl?e.right-t:t-e.left}},{key:"setupWrapperEvents",value:function(){var e=this;this.wrapper.addEventListener("click",(function(t){var i=n.withOrientation(t,e.params.vertical),r=e.wrapper.offsetHeight-e.wrapper.clientHeight;if(0!==r){var o=e.wrapper.getBoundingClientRect();if(i.clientY>=o.bottom-r)return}e.params.interact&&e.fireEvent("click",t,e.handleEvent(t))})),this.wrapper.addEventListener("dblclick",(function(t){e.params.interact&&e.fireEvent("dblclick",t,e.handleEvent(t))})),this.wrapper.addEventListener("scroll",(function(t){return e.fireEvent("scroll",t)}))}},{key:"drawPeaks",value:function(e,t,i,r){this.setWidth(t)||this.clearWave(),this.params.barWidth?this.drawBars(e,0,i,r):this.drawWave(e,0,i,r)}},{key:"resetScroll",value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:"recenter",value:function(e){var t=this.wrapper.scrollWidth*e;this.recenterOnPosition(t,!0)}},{key:"recenterOnPosition",value:function(e,t){var i=this.wrapper.scrollLeft,r=~~(this.wrapper.clientWidth/2),n=this.wrapper.scrollWidth-this.wrapper.clientWidth,o=e-r,a=o-i;if(0!=n){if(!t&&-r<=a&&a<r){var s=this.params.autoCenterRate;s/=r,s*=n,o=i+(a=Math.max(-s,Math.min(s,a)))}(o=Math.max(0,Math.min(n,o)))!=i&&(this.wrapper.scrollLeft=o)}}},{key:"getScrollX",value:function(){var e=0;if(this.wrapper){var t=this.params.pixelRatio;if(e=Math.round(this.wrapper.scrollLeft*t),this.params.scrollParent){var i=~~(this.wrapper.scrollWidth*t-this.getWidth());e=Math.min(i,Math.max(0,e))}}return e}},{key:"getWidth",value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:"setWidth",value:function(e){if(this.width==e)return!1;if(this.width=e,this.params.fillParent||this.params.scrollParent)this.style(this.wrapper,{width:""});else{var t=~~(this.width/this.params.pixelRatio)+"px";this.style(this.wrapper,{width:t})}return this.updateSize(),!0}},{key:"setHeight",value:function(e){return e!=this.height&&(this.height=e,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"progress",value:function(e){var t=1/this.params.pixelRatio,i=Math.round(e*this.width)*t;if(i<this.lastPos||i-this.lastPos>=t){if(this.lastPos=i,this.params.scrollParent&&this.params.autoCenter){var r=~~(this.wrapper.scrollWidth*e);this.recenterOnPosition(r,this.params.autoCenterImmediately)}this.updateProgress(i)}}},{key:"destroy",value:function(){this.unAll(),this.wrapper&&(this.wrapper.parentNode==this.container.domElement&&this.container.removeChild(this.wrapper.domElement),this.wrapper=null)}},{key:"updateCursor",value:function(){}},{key:"updateSize",value:function(){}},{key:"drawBars",value:function(e,t,i,r){}},{key:"drawWave",value:function(e,t,i,r){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(e){}}])&&a(t.prototype,i),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(n.Observer);t.default=l,e.exports=t.default},"./src/drawer.multicanvas.js":
/*!***********************************!*\
            !*** ./src/drawer.multicanvas.js ***!
            \***********************************/
(e,t,i)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=c(i(
/*! ./drawer */
"./src/drawer.js")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var i=s(t);if(i&&i.has(e))return i.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(n,a,c):n[a]=e[a]}return n.default=e,i&&i.set(e,n),n}(i(
/*! ./util */
"./src/util/index.js")),a=c(i(
/*! ./drawer.canvasentry */
"./src/drawer.canvasentry.js"));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(s=function(e){return e?i:t})(e)}function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=f(e);if(t){var n=f(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return h(this,i)}}function h(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(s,e);var t,i,r,n=l(s);function s(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(i=n.call(this,e,t)).maxCanvasWidth=t.maxCanvasWidth,i.maxCanvasElementWidth=Math.round(t.maxCanvasWidth/t.pixelRatio),i.hasProgressCanvas=t.waveColor!=t.progressColor,i.halfPixel=.5/t.pixelRatio,i.canvases=[],i.progressWave=null,i.EntryClass=a.default,i.canvasContextAttributes=t.drawingContextAttributes,i.overlap=2*Math.ceil(t.pixelRatio/2),i.barRadius=t.barRadius||0,i.vertical=t.vertical,i}return t=s,(i=[{key:"init",value:function(){this.createWrapper(),this.createElements()}},{key:"createElements",value:function(){this.progressWave=o.withOrientation(this.wrapper.appendChild(document.createElement("wave")),this.params.vertical),this.style(this.progressWave,{position:"absolute",zIndex:3,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",pointerEvents:"none"}),this.addCanvas(),this.updateCursor()}},{key:"updateCursor",value:function(){this.style(this.progressWave,{borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})}},{key:"updateSize",value:function(){for(var e=this,t=Math.round(this.width/this.params.pixelRatio),i=Math.ceil(t/(this.maxCanvasElementWidth+this.overlap));this.canvases.length<i;)this.addCanvas();for(;this.canvases.length>i;)this.removeCanvas();var r=this.maxCanvasWidth+this.overlap,n=this.canvases.length-1;this.canvases.forEach((function(t,i){i==n&&(r=e.width-e.maxCanvasWidth*n),e.updateDimensions(t,r,e.height),t.clearWave()}))}},{key:"addCanvas",value:function(){var e=new this.EntryClass;e.canvasContextAttributes=this.canvasContextAttributes,e.hasProgressCanvas=this.hasProgressCanvas,e.halfPixel=this.halfPixel;var t=this.maxCanvasElementWidth*this.canvases.length,i=o.withOrientation(this.wrapper.appendChild(document.createElement("canvas")),this.params.vertical);if(this.style(i,{position:"absolute",zIndex:2,left:t+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"}),e.initWave(i),this.hasProgressCanvas){var r=o.withOrientation(this.progressWave.appendChild(document.createElement("canvas")),this.params.vertical);this.style(r,{position:"absolute",left:t+"px",top:0,bottom:0,height:"100%"}),e.initProgress(r)}this.canvases.push(e)}},{key:"removeCanvas",value:function(){var e=this.canvases[this.canvases.length-1];e.wave.parentElement.removeChild(e.wave.domElement),this.hasProgressCanvas&&e.progress.parentElement.removeChild(e.progress.domElement),e&&(e.destroy(),e=null),this.canvases.pop()}},{key:"updateDimensions",value:function(e,t,i){var r=Math.round(t/this.params.pixelRatio),n=Math.round(this.width/this.params.pixelRatio);e.updateDimensions(r,n,t,i),this.style(this.progressWave,{display:"block"})}},{key:"clearWave",value:function(){var e=this;o.frame((function(){e.canvases.forEach((function(e){return e.clearWave()}))}))()}},{key:"drawBars",value:function(e,t,i,r){var n=this;return this.prepareDraw(e,t,i,r,(function(e){var t=e.absmax,o=e.hasMinVals;e.height;var a=e.offsetY,s=e.halfH,c=e.peaks,u=e.channelIndex;if(void 0!==i)for(var d=o?2:1,l=c.length/d,h=n.params.barWidth*n.params.pixelRatio,f=h+(null===n.params.barGap?Math.max(n.params.pixelRatio,~~(h/2)):Math.max(n.params.pixelRatio,n.params.barGap*n.params.pixelRatio)),p=l/n.width,v=r,m=i;m<v;m+=f){var g=0,y=Math.floor(m*p)*d,b=Math.floor((m+f)*p)*d;do{var w=Math.abs(c[y]);w>g&&(g=w),y+=d}while(y<b);var k=Math.round(g/t*s);0==k&&n.params.barMinHeight&&(k=n.params.barMinHeight),n.fillRect(m+n.halfPixel,s-k+a,h+n.halfPixel,2*k,n.barRadius,u)}}))}},{key:"drawWave",value:function(e,t,i,r){var n=this;return this.prepareDraw(e,t,i,r,(function(e){var t=e.absmax,o=e.hasMinVals;e.height;var a=e.offsetY,s=e.halfH,c=e.peaks,u=e.channelIndex;if(!o){for(var d=[],l=c.length,h=0;h<l;h++)d[2*h]=c[h],d[2*h+1]=-c[h];c=d}void 0!==i&&n.drawLine(c,t,s,a,i,r,u),n.fillRect(0,s+a-n.halfPixel,n.width,n.halfPixel,n.barRadius,u)}))}},{key:"drawLine",value:function(e,t,i,r,n,o,a){var s=this,c=this.params.splitChannelsOptions.channelColors[a]||{},u=c.waveColor,d=c.progressColor;this.canvases.forEach((function(a,c){s.setFillStyles(a,u,d),s.applyCanvasTransforms(a,s.params.vertical),a.drawLines(e,t,i,r,n,o)}))}},{key:"fillRect",value:function(e,t,i,r,n,o){for(var a=Math.floor(e/this.maxCanvasWidth),s=Math.min(Math.ceil((e+i)/this.maxCanvasWidth)+1,this.canvases.length),c=a;c<s;c++){var u=this.canvases[c],d=c*this.maxCanvasWidth,l={x1:Math.max(e,c*this.maxCanvasWidth),y1:t,x2:Math.min(e+i,c*this.maxCanvasWidth+u.wave.width),y2:t+r};if(l.x1<l.x2){var h=this.params.splitChannelsOptions.channelColors[o]||{},f=h.waveColor,p=h.progressColor;this.setFillStyles(u,f,p),this.applyCanvasTransforms(u,this.params.vertical),u.fillRects(l.x1-d,l.y1,l.x2-l.x1,l.y2-l.y1,n)}}}},{key:"hideChannel",value:function(e){return this.params.splitChannels&&this.params.splitChannelsOptions.filterChannels.includes(e)}},{key:"prepareDraw",value:function(e,t,i,r,n,a,s){var c=this;return o.frame((function(){if(e[0]instanceof Array){var u=e;if(c.params.splitChannels){var d,l=u.filter((function(e,t){return!c.hideChannel(t)}));return c.params.splitChannelsOptions.overlay||c.setHeight(Math.max(l.length,1)*c.params.height*c.params.pixelRatio),c.params.splitChannelsOptions&&c.params.splitChannelsOptions.relativeNormalization&&(d=o.max(u.map((function(e){return o.absMax(e)})))),u.forEach((function(e,t){return c.prepareDraw(e,t,i,r,n,l.indexOf(e),d)}))}e=u[0]}if(!c.hideChannel(t)){var h=1/c.params.barHeight;c.params.normalize&&(h=void 0===s?o.absMax(e):s);var f=[].some.call(e,(function(e){return e<0})),p=c.params.height*c.params.pixelRatio,v=p/2,m=p*a||0;return c.params.splitChannelsOptions&&c.params.splitChannelsOptions.overlay&&(m=0),n({absmax:h,hasMinVals:f,height:p,offsetY:m,halfH:v,peaks:e,channelIndex:t})}}))()}},{key:"setFillStyles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.params.waveColor,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.params.progressColor;e.setFillStyles(t,i)}},{key:"applyCanvasTransforms",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.applyCanvasTransforms(t)}},{key:"getImage",value:function(e,t,i){if("blob"===i)return Promise.all(this.canvases.map((function(r){return r.getImage(e,t,i)})));if("dataURL"===i){var r=this.canvases.map((function(r){return r.getImage(e,t,i)}));return r.length>1?r:r[0]}}},{key:"updateProgress",value:function(e){this.style(this.progressWave,{width:e+"px"})}}])&&u(t.prototype,i),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.default);t.default=p,e.exports=t.default},"./src/mediaelement-webaudio.js":
/*!**************************************!*\
            !*** ./src/mediaelement-webaudio.js ***!
            \**************************************/
(e,t,i)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n;function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var r=s(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}}).apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=l(e);if(t){var n=l(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return d(this,i)}}function d(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(s,e);var t,i,r,n=u(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=n.call(this,e)).params=e,t.sourceMediaElement=null,t}return t=s,(i=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer(),this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode()}},{key:"_load",value:function(e,t,i){a(l(s.prototype),"_load",this).call(this,e,t,i),this.createMediaElementSource(e)}},{key:"createMediaElementSource",value:function(e){this.sourceMediaElement=this.ac.createMediaElementSource(e),this.sourceMediaElement.connect(this.analyser)}},{key:"play",value:function(e,t){return this.resumeAudioContext(),a(l(s.prototype),"play",this).call(this,e,t)}},{key:"destroy",value:function(){a(l(s.prototype),"destroy",this).call(this),this.destroyWebAudio()}}])&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(((n=i(
/*! ./mediaelement */
"./src/mediaelement.js"))&&n.__esModule?n:{default:n}).default);t.default=h,e.exports=t.default},"./src/mediaelement.js":
/*!*****************************!*\
            !*** ./src/mediaelement.js ***!
            \*****************************/
(e,t,i)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=(n=i(
/*! ./webaudio */
"./src/webaudio.js"))&&n.__esModule?n:{default:n},a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var i=s(t);if(i&&i.has(e))return i.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(n,a,c):n[a]=e[a]}return n.default=e,i&&i.set(e,n),n}(i(
/*! ./util */
"./src/util/index.js"));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(s=function(e){return e?i:t})(e)}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var r=d(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}}).apply(this,arguments)}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=p(e);if(t){var n=p(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return f(this,i)}}function f(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(o,e);var t,i,r,n=h(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).params=e,t.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){},volume:0},t.mediaType=e.mediaType.toLowerCase(),t.elementPosition=e.elementPosition,t.peaks=null,t.playbackRate=1,t.volume=1,t.isMuted=!1,t.buffer=null,t.onPlayEnd=null,t.mediaListeners={},t}return t=o,(i=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer()}},{key:"_setupMediaListeners",value:function(){var e=this;this.mediaListeners.error=function(){e.fireEvent("error","Error loading media element")},this.mediaListeners.canplay=function(){e.fireEvent("canplay")},this.mediaListeners.ended=function(){e.fireEvent("finish")},this.mediaListeners.play=function(){e.fireEvent("play")},this.mediaListeners.pause=function(){e.fireEvent("pause")},this.mediaListeners.seeked=function(t){e.fireEvent("seek")},this.mediaListeners.volumechange=function(t){e.isMuted=e.media.muted,e.isMuted?e.volume=0:e.volume=e.media.volume,e.fireEvent("volume")},Object.keys(this.mediaListeners).forEach((function(t){e.media.removeEventListener(t,e.mediaListeners[t]),e.media.addEventListener(t,e.mediaListeners[t])}))}},{key:"createTimer",value:function(){var e=this;this.on("play",(function t(){e.isPaused()||(e.fireEvent("audioprocess",e.getCurrentTime()),a.frame(t)())})),this.on("pause",(function(){e.fireEvent("audioprocess",e.getCurrentTime())}))}},{key:"load",value:function(e,t,i,r){var n=document.createElement(this.mediaType);n.controls=this.params.mediaControls,n.autoplay=this.params.autoplay||!1,n.preload=null==r?"auto":r,n.src=e,n.style.width="100%";var o=t.querySelector(this.mediaType);o&&t.removeChild(o),t.appendChild(n),this._load(n,i,r)}},{key:"loadElt",value:function(e,t){e.controls=this.params.mediaControls,e.autoplay=this.params.autoplay||!1,this._load(e,t,e.preload)}},{key:"_load",value:function(e,t,i){if(!(e instanceof HTMLMediaElement)||void 0===e.addEventListener)throw new Error("media parameter is not a valid media element");"function"!=typeof e.load||t&&"none"==i||e.load(),this.media=e,this._setupMediaListeners(),this.peaks=t,this.onPlayEnd=null,this.buffer=null,this.isMuted=e.muted,this.setPlaybackRate(this.playbackRate),this.setVolume(this.volume)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){if(this.explicitDuration)return this.explicitDuration;var e=(this.buffer||this.media).duration;return e>=1/0&&(e=this.media.seekable.end(0)),e}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1,this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(e){null==e||isNaN(e)||(this.media.currentTime=e),this.clearPlayEnd()}},{key:"play",value:function(e,t){this.seekTo(e);var i=this.media.play();return t&&this.setPlayEnd(t),i}},{key:"pause",value:function(){var e;return this.media&&(e=this.media.pause()),this.clearPlayEnd(),e}},{key:"setPlayEnd",value:function(e){var t=this;this.clearPlayEnd(),this._onPlayEnd=function(i){i>=e&&(t.pause(),t.seekTo(e))},this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){this._onPlayEnd&&(this.un("audioprocess",this._onPlayEnd),this._onPlayEnd=null)}},{key:"getPeaks",value:function(e,t,i){return this.buffer?u(p(o.prototype),"getPeaks",this).call(this,e,t,i):this.peaks||[]}},{key:"setSinkId",value:function(e){return e?this.media.setSinkId?this.media.setSinkId(e):Promise.reject(new Error("setSinkId is not supported in your browser")):Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(e){this.volume=e,this.media.volume!==this.volume&&(this.media.volume=this.volume)}},{key:"setMute",value:function(e){this.isMuted=this.media.muted=e}},{key:"destroy",value:function(){var e=this;this.pause(),this.unAll(),this.destroyed=!0,Object.keys(this.mediaListeners).forEach((function(t){e.media&&e.media.removeEventListener(t,e.mediaListeners[t])})),this.params.removeMediaElementOnDestroy&&this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}])&&c(t.prototype,i),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(o.default);t.default=v,e.exports=t.default},"./src/peakcache.js":
/*!**************************!*\
            !*** ./src/peakcache.js ***!
            \**************************/
(e,t)=>{function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clearPeakCache()}var t,r,n;return t=e,(r=[{key:"clearPeakCache",value:function(){this.peakCacheRanges=[],this.peakCacheLength=-1}},{key:"addRangeToPeakCache",value:function(e,t,i){e!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=e);for(var r=[],n=0;n<this.peakCacheRanges.length&&this.peakCacheRanges[n]<t;)n++;for(n%2==0&&r.push(t);n<this.peakCacheRanges.length&&this.peakCacheRanges[n]<=i;)r.push(this.peakCacheRanges[n]),n++;n%2==0&&r.push(i),r=r.filter((function(e,t,i){return 0==t?e!=i[t+1]:t==i.length-1?e!=i[t-1]:e!=i[t-1]&&e!=i[t+1]})),this.peakCacheRanges=this.peakCacheRanges.concat(r),this.peakCacheRanges=this.peakCacheRanges.sort((function(e,t){return e-t})).filter((function(e,t,i){return 0==t?e!=i[t+1]:t==i.length-1?e!=i[t-1]:e!=i[t-1]&&e!=i[t+1]}));var o=[];for(n=0;n<r.length;n+=2)o.push([r[n],r[n+1]]);return o}},{key:"getCacheRanges",value:function(){var e,t=[];for(e=0;e<this.peakCacheRanges.length;e+=2)t.push([this.peakCacheRanges[e],this.peakCacheRanges[e+1]]);return t}}])&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=r,e.exports=t.default},"./src/util/absMax.js":
/*!****************************!*\
            !*** ./src/util/absMax.js ***!
            \****************************/
(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,r.default)(e),i=(0,n.default)(e);return-i>t?-i:t};var r=o(i(
/*! ./max */
"./src/util/max.js")),n=o(i(
/*! ./min */
"./src/util/min.js"));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},"./src/util/clamp.js":
/*!***************************!*\
            !*** ./src/util/clamp.js ***!
            \***************************/
(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i){return Math.min(Math.max(t,e),i)},e.exports=t.default},"./src/util/fetch.js":
/*!***************************!*\
            !*** ./src/util/fetch.js ***!
            \***************************/
(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)throw new Error("fetch options missing");if(!e.url)throw new Error("fetch url missing");var t=new n.default,i=new Headers,r=new Request(e.url);t.controller=new AbortController,e&&e.requestHeaders&&e.requestHeaders.forEach((function(e){i.append(e.key,e.value)}));var o=e.responseType||"json",s={method:e.method||"GET",headers:i,mode:e.mode||"cors",credentials:e.credentials||"same-origin",cache:e.cache||"default",redirect:e.redirect||"follow",referrer:e.referrer||"client",signal:t.controller.signal};return fetch(r,s).then((function(e){t.response=e;var i=!0;e.body||(i=!1);var r=e.headers.get("content-length");return null===r&&(i=!1),i?(t.onProgress=function(e){t.fireEvent("progress",e)},new Response(new ReadableStream(new a(t,r,e)),s)):e})).then((function(e){var t;if(e.ok)switch(o){case"arraybuffer":return e.arrayBuffer();case"json":return e.json();case"blob":return e.blob();case"text":return e.text();default:t="Unknown responseType: "+o}throw t||(t="HTTP error status: "+e.status),new Error(t)})).then((function(e){t.fireEvent("success",e)})).catch((function(e){t.fireEvent("error",e)})),t.fetchRequest=r,t};var r,n=(r=i(
/*! ./observer */
"./src/util/observer.js"))&&r.__esModule?r:{default:r};function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.instance._reader=r.body.getReader(),this.total=parseInt(i,10),this.loaded=0}var t,i,r;return t=e,(i=[{key:"start",value:function(e){var t=this;!function i(){t.instance._reader.read().then((function(r){var n=r.done,o=r.value;if(n)return 0===t.total&&t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!1}),void e.close();t.loaded+=o.byteLength,t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!(0===t.total)}),e.enqueue(o),i()})).catch((function(t){e.error(t)}))}()}}])&&o(t.prototype,i),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=t.default},"./src/util/frame.js":
/*!***************************!*\
            !*** ./src/util/frame.js ***!
            \***************************/
(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(0,n.default)((function(){return e.apply(void 0,i)}))}};var r,n=(r=i(
/*! ./request-animation-frame */
"./src/util/request-animation-frame.js"))&&r.__esModule?r:{default:r};e.exports=t.default},"./src/util/get-id.js":
/*!****************************!*\
            !*** ./src/util/get-id.js ***!
            \****************************/
(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return void 0===e&&(e="wavesurfer_"),e+Math.random().toString(32).substring(2)},e.exports=t.default},"./src/util/index.js":
/*!***************************!*\
            !*** ./src/util/index.js ***!
            \***************************/
(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Observer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"absMax",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"clamp",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"fetchFile",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"frame",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"getId",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"ignoreSilenceMode",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"max",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"min",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"preventClick",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"requestAnimationFrame",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"style",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"withOrientation",{enumerable:!0,get:function(){return v.default}});var r=g(i(
/*! ./get-id */
"./src/util/get-id.js")),n=g(i(
/*! ./max */
"./src/util/max.js")),o=g(i(
/*! ./min */
"./src/util/min.js")),a=g(i(
/*! ./absMax */
"./src/util/absMax.js")),s=g(i(
/*! ./observer */
"./src/util/observer.js")),c=g(i(
/*! ./style */
"./src/util/style.js")),u=g(i(
/*! ./request-animation-frame */
"./src/util/request-animation-frame.js")),d=g(i(
/*! ./frame */
"./src/util/frame.js")),l=g(i(
/*! debounce */
"./node_modules/debounce/index.js")),h=g(i(
/*! ./prevent-click */
"./src/util/prevent-click.js")),f=g(i(
/*! ./fetch */
"./src/util/fetch.js")),p=g(i(
/*! ./clamp */
"./src/util/clamp.js")),v=g(i(
/*! ./orientation */
"./src/util/orientation.js")),m=g(i(
/*! ./silence-mode */
"./src/util/silence-mode.js"));function g(e){return e&&e.__esModule?e:{default:e}}},"./src/util/max.js":
/*!*************************!*\
            !*** ./src/util/max.js ***!
            \*************************/
(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=-1/0;return Object.keys(e).forEach((function(i){e[i]>t&&(t=e[i])})),t},e.exports=t.default},"./src/util/min.js":
/*!*************************!*\
            !*** ./src/util/min.js ***!
            \*************************/
(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Number(1/0);return Object.keys(e).forEach((function(i){e[i]<t&&(t=e[i])})),t},e.exports=t.default},"./src/util/observer.js":
/*!******************************!*\
            !*** ./src/util/observer.js ***!
            \******************************/
(e,t)=>{function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._disabledEventEmissions=[],this.handlers=null}var t,r,n;return t=e,(r=[{key:"on",value:function(e,t){var i=this;this.handlers||(this.handlers={});var r=this.handlers[e];return r||(r=this.handlers[e]=[]),r.push(t),{name:e,callback:t,un:function(e,t){return i.un(e,t)}}}},{key:"un",value:function(e,t){if(this.handlers){var i,r=this.handlers[e];if(r)if(t)for(i=r.length-1;i>=0;i--)r[i]==t&&r.splice(i,1);else r.length=0}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(e,t){var i=this;return this.on(e,(function r(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];t.apply(i,o),setTimeout((function(){i.un(e,r)}),0)}))}},{key:"setDisabledEventEmissions",value:function(e){this._disabledEventEmissions=e}},{key:"_isDisabledEventEmission",value:function(e){return this._disabledEventEmissions&&this._disabledEventEmissions.includes(e)}},{key:"fireEvent",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];if(this.handlers&&!this._isDisabledEventEmission(e)){var n=this.handlers[e];n&&n.forEach((function(e){e.apply(void 0,i)}))}}}])&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=r,e.exports=t.default},"./src/util/orientation.js":
/*!*********************************!*\
            !*** ./src/util/orientation.js ***!
            \*********************************/
(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,i){return t[n]?t:new Proxy(t,{get:function(t,o,a){if(o===n)return!0;if("domElement"===o)return t;if("style"===o)return e(t.style,i);if("canvas"===o)return e(t.canvas,i);if("getBoundingClientRect"===o)return function(){return e(t.getBoundingClientRect.apply(t,arguments),i)};if("getContext"===o)return function(){return e(t.getContext.apply(t,arguments),i)};var s=t[r(o,i)];return"function"==typeof s?s.bind(t):s},set:function(e,t,n){return e[r(t,i)]=n,!0}})};var i={width:"height",height:"width",overflowX:"overflowY",overflowY:"overflowX",clientWidth:"clientHeight",clientHeight:"clientWidth",clientX:"clientY",clientY:"clientX",scrollWidth:"scrollHeight",scrollLeft:"scrollTop",offsetLeft:"offsetTop",offsetTop:"offsetLeft",offsetHeight:"offsetWidth",offsetWidth:"offsetHeight",left:"top",right:"bottom",top:"left",bottom:"right",borderRightStyle:"borderBottomStyle",borderRightWidth:"borderBottomWidth",borderRightColor:"borderBottomColor"};function r(e,t){return Object.prototype.hasOwnProperty.call(i,e)&&t?i[e]:e}var n=Symbol("isProxy");e.exports=t.default},"./src/util/prevent-click.js":
/*!***********************************!*\
            !*** ./src/util/prevent-click.js ***!
            \***********************************/
(e,t)=>{function i(e){e.stopPropagation(),document.body.removeEventListener("click",i,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){document.body.addEventListener("click",i,!0)},e.exports=t.default},"./src/util/request-animation-frame.js":
/*!*********************************************!*\
            !*** ./src/util/request-animation-frame.js ***!
            \*********************************************/
(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return setTimeout(e,1e3/60)}).bind(window);t.default=i,e.exports=t.default},"./src/util/silence-mode.js":
/*!**********************************!*\
            !*** ./src/util/silence-mode.js ***!
            \**********************************/
(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=document.createElement("div");e.innerHTML='<audio x-webkit-airplay="deny"></audio>';var t=e.children.item(0);t.src="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA//////////////////////////////////////////////////////////////////8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//sQxAADgnABGiAAQBCqgCRMAAgEAH///////////////7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq//////////////////9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",t.preload="auto",t.type="audio/mpeg",t.disableRemotePlayback=!0,t.play(),t.remove(),e.remove()},e.exports=t.default},"./src/util/style.js":
/*!***************************!*\
            !*** ./src/util/style.js ***!
            \***************************/
(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return Object.keys(t).forEach((function(i){e.style[i]!==t[i]&&(e.style[i]=t[i])})),e},e.exports=t.default},"./src/wavesurfer.js":
/*!***************************!*\
            !*** ./src/wavesurfer.js ***!
            \***************************/
(e,t,i)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var i=l(t);if(i&&i.has(e))return i.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}return n.default=e,i&&i.set(e,n),n}(i(
/*! ./util */
"./src/util/index.js")),o=d(i(
/*! ./drawer.multicanvas */
"./src/drawer.multicanvas.js")),a=d(i(
/*! ./webaudio */
"./src/webaudio.js")),s=d(i(
/*! ./mediaelement */
"./src/mediaelement.js")),c=d(i(
/*! ./peakcache */
"./src/peakcache.js")),u=d(i(
/*! ./mediaelement-webaudio */
"./src/mediaelement-webaudio.js"));function d(e){return e&&e.__esModule?e:{default:e}}function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(l=function(e){return e?i:t})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=m(e);if(t){var n=m(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(l,e);var t,i,r,d=f(l);function l(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),g(v(t=d.call(this)),"defaultParams",{audioContext:null,audioScriptProcessor:null,audioRate:1,autoCenter:!0,autoCenterRate:5,autoCenterImmediately:!1,backend:"WebAudio",backgroundColor:null,barHeight:1,barRadius:0,barGap:null,barMinHeight:null,container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,drawingContextAttributes:{desynchronized:!1},duration:null,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,hideCursor:!1,ignoreSilenceMode:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4e3,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:"#555",removeMediaElementOnDestroy:!0,renderer:o.default,responsive:!1,rtl:!1,scrollParent:!1,skipLength:2,splitChannels:!1,splitChannelsOptions:{overlay:!1,channelColors:{},filterChannels:[],relativeNormalization:!1},vertical:!1,waveColor:"#999",xhr:{}}),g(v(t),"backends",{MediaElement:s.default,WebAudio:a.default,MediaElementWebAudio:u.default}),g(v(t),"util",n),t.params=Object.assign({},t.defaultParams,e),t.params.splitChannelsOptions=Object.assign({},t.defaultParams.splitChannelsOptions,e.splitChannelsOptions),t.container="string"==typeof e.container?document.querySelector(t.params.container):t.params.container,!t.container)throw new Error("Container element not found");if(null==t.params.mediaContainer?t.mediaContainer=t.container:"string"==typeof t.params.mediaContainer?t.mediaContainer=document.querySelector(t.params.mediaContainer):t.mediaContainer=t.params.mediaContainer,!t.mediaContainer)throw new Error("Media Container element not found");if(t.params.maxCanvasWidth<=1)throw new Error("maxCanvasWidth must be greater than 1");if(t.params.maxCanvasWidth%2==1)throw new Error("maxCanvasWidth must be an even number");if(!0===t.params.rtl&&(!0===t.params.vertical?n.style(t.container,{transform:"rotateX(180deg)"}):n.style(t.container,{transform:"rotateY(180deg)"})),t.params.backgroundColor&&t.setBackgroundColor(t.params.backgroundColor),t.savedVolume=0,t.isMuted=!1,t.tmpEvents=[],t.currentRequest=null,t.arraybuffer=null,t.drawer=null,t.backend=null,t.peakCache=null,"function"!=typeof t.params.renderer)throw new Error("Renderer parameter is invalid");t.Drawer=t.params.renderer,"AudioElement"==t.params.backend&&(t.params.backend="MediaElement"),"WebAudio"!=t.params.backend&&"MediaElementWebAudio"!==t.params.backend||a.default.prototype.supportsWebAudio.call(null)||(t.params.backend="MediaElement"),t.Backend=t.backends[t.params.backend],t.initialisedPluginList={},t.isDestroyed=!1,t.isReady=!1;var i=0;return t._onResize=n.debounce((function(){t.drawer.wrapper&&i!=t.drawer.wrapper.clientWidth&&!t.params.scrollParent&&(i=t.drawer.wrapper.clientWidth)&&t.drawer.fireEvent("redraw")}),"number"==typeof t.params.responsive?t.params.responsive:100),p(t,v(t))}return t=l,r=[{key:"create",value:function(e){return new l(e).init()}}],(i=[{key:"init",value:function(){return this.registerPlugins(this.params.plugins),this.createDrawer(),this.createBackend(),this.createPeakCache(),this}},{key:"registerPlugins",value:function(e){var t=this;return e.forEach((function(e){return t.addPlugin(e)})),e.forEach((function(e){e.deferInit||t.initPlugin(e.name)})),this.fireEvent("plugins-registered",e),this}},{key:"getActivePlugins",value:function(){return this.initialisedPluginList}},{key:"addPlugin",value:function(e){var t=this;if(!e.name)throw new Error("Plugin does not have a name!");if(!e.instance)throw new Error("Plugin ".concat(e.name," does not have an instance property!"));e.staticProps&&Object.keys(e.staticProps).forEach((function(i){t[i]=e.staticProps[i]}));var i=e.instance;return Object.getOwnPropertyNames(n.Observer.prototype).forEach((function(e){i.prototype[e]=n.Observer.prototype[e]})),this[e.name]=new i(e.params||{},this),this.fireEvent("plugin-added",e.name),this}},{key:"initPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet!"));return this.initialisedPluginList[e]&&this.destroyPlugin(e),this[e].init(),this.initialisedPluginList[e]=!0,this.fireEvent("plugin-initialised",e),this}},{key:"destroyPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet and cannot be destroyed!"));if(!this.initialisedPluginList[e])throw new Error("Plugin ".concat(e," is not active and cannot be destroyed!"));if("function"!=typeof this[e].destroy)throw new Error("Plugin ".concat(e," does not have a destroy function!"));return this[e].destroy(),delete this.initialisedPluginList[e],this.fireEvent("plugin-destroyed",e),this}},{key:"destroyAllPlugins",value:function(){var e=this;Object.keys(this.initialisedPluginList).forEach((function(t){return e.destroyPlugin(t)}))}},{key:"createDrawer",value:function(){var e=this;this.drawer=new this.Drawer(this.container,this.params),this.drawer.init(),this.fireEvent("drawer-created",this.drawer),!1!==this.params.responsive&&(window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0)),this.drawer.on("redraw",(function(){e.drawBuffer(),e.drawer.progress(e.backend.getPlayedPercents())})),this.drawer.on("click",(function(t,i){setTimeout((function(){return e.seekTo(i)}),0)})),this.drawer.on("scroll",(function(t){e.params.partialRender&&e.drawBuffer(),e.fireEvent("scroll",t)}))}},{key:"createBackend",value:function(){var e=this;this.backend&&this.backend.destroy(),this.backend=new this.Backend(this.params),this.backend.init(),this.fireEvent("backend-created",this.backend),this.backend.on("finish",(function(){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("finish")})),this.backend.on("play",(function(){return e.fireEvent("play")})),this.backend.on("pause",(function(){return e.fireEvent("pause")})),this.backend.on("audioprocess",(function(t){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("audioprocess",t)})),"MediaElement"!==this.params.backend&&"MediaElementWebAudio"!==this.params.backend||(this.backend.on("seek",(function(){e.drawer.progress(e.backend.getPlayedPercents())})),this.backend.on("volume",(function(){var t=e.getVolume();e.fireEvent("volume",t),e.backend.isMuted!==e.isMuted&&(e.isMuted=e.backend.isMuted,e.fireEvent("mute",e.isMuted))})))}},{key:"createPeakCache",value:function(){this.params.partialRender&&(this.peakCache=new c.default)}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(e){e>=this.getDuration()?this.seekTo(1):this.seekTo(e/this.getDuration())}},{key:"play",value:function(e,t){var i=this;return this.params.ignoreSilenceMode&&n.ignoreSilenceMode(),this.fireEvent("interaction",(function(){return i.play(e,t)})),this.backend.play(e,t)}},{key:"setPlayEnd",value:function(e){this.backend.setPlayEnd(e)}},{key:"pause",value:function(){if(!this.backend.isPaused())return this.backend.pause()}},{key:"playPause",value:function(){return this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(e){this.skip(-e||-this.params.skipLength)}},{key:"skipForward",value:function(e){this.skip(e||this.params.skipLength)}},{key:"skip",value:function(e){var t=this.getDuration()||1,i=this.getCurrentTime()||0;i=Math.max(0,Math.min(t,i+(e||0))),this.seekAndCenter(i/t)}},{key:"seekAndCenter",value:function(e){this.seekTo(e),this.drawer.recenter(e)}},{key:"seekTo",value:function(e){var t=this;if("number"!=typeof e||!isFinite(e)||e<0||e>1)throw new Error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!");this.fireEvent("interaction",(function(){return t.seekTo(e)}));var i="WebAudio"===this.params.backend,r=this.backend.isPaused();i&&!r&&this.backend.pause();var n=this.params.scrollParent;this.params.scrollParent=!1,this.backend.seekTo(e*this.getDuration()),this.drawer.progress(e),i&&!r&&this.backend.play(),this.params.scrollParent=n,this.fireEvent("seek",e)}},{key:"stop",value:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)}},{key:"setSinkId",value:function(e){return this.backend.setSinkId(e)}},{key:"setVolume",value:function(e){this.backend.setVolume(e),this.fireEvent("volume",e)}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"setPlaybackRate",value:function(e){this.backend.setPlaybackRate(e)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(e){e!==this.isMuted?(this.backend.setMute?(this.backend.setMute(e),this.isMuted=e):e?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0,this.fireEvent("volume",0)):(this.backend.setVolume(this.savedVolume),this.isMuted=!1,this.fireEvent("volume",this.savedVolume)),this.fireEvent("mute",this.isMuted)):this.fireEvent("mute",this.isMuted)}},{key:"getMute",value:function(){return this.isMuted}},{key:"getFilters",value:function(){return this.backend.filters||[]}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"getWaveColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.params.splitChannelsOptions.channelColors[e]?this.params.splitChannelsOptions.channelColors[e].waveColor:this.params.waveColor}},{key:"setWaveColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.params.splitChannelsOptions.channelColors[t]?this.params.splitChannelsOptions.channelColors[t].waveColor=e:this.params.waveColor=e,this.drawBuffer()}},{key:"getProgressColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.params.splitChannelsOptions.channelColors[e]?this.params.splitChannelsOptions.channelColors[e].progressColor:this.params.progressColor}},{key:"setProgressColor",value:function(e,t){this.params.splitChannelsOptions.channelColors[t]?this.params.splitChannelsOptions.channelColors[t].progressColor=e:this.params.progressColor=e,this.drawBuffer()}},{key:"getBackgroundColor",value:function(){return this.params.backgroundColor}},{key:"setBackgroundColor",value:function(e){this.params.backgroundColor=e,n.style(this.container,{background:this.params.backgroundColor})}},{key:"getCursorColor",value:function(){return this.params.cursorColor}},{key:"setCursorColor",value:function(e){this.params.cursorColor=e,this.drawer.updateCursor()}},{key:"getHeight",value:function(){return this.params.height}},{key:"setHeight",value:function(e){this.params.height=e,this.drawer.setHeight(e*this.params.pixelRatio),this.drawBuffer()}},{key:"setFilteredChannels",value:function(e){this.params.splitChannelsOptions.filterChannels=e,this.drawBuffer()}},{key:"drawBuffer",value:function(){var e,t=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),i=this.drawer.getWidth(),r=t,n=0,o=Math.max(n+i,r);if(this.params.fillParent&&(!this.params.scrollParent||t<i)&&(n=0,o=r=i),this.params.partialRender){var a,s=this.peakCache.addRangeToPeakCache(r,n,o);for(a=0;a<s.length;a++)e=this.backend.getPeaks(r,s[a][0],s[a][1]),this.drawer.drawPeaks(e,r,s[a][0],s[a][1])}else e=this.backend.getPeaks(r,n,o),this.drawer.drawPeaks(e,r,n,o);this.fireEvent("redraw",e,r)}},{key:"zoom",value:function(e){e?(this.params.minPxPerSec=e,this.params.scrollParent=!0):(this.params.minPxPerSec=this.defaultParams.minPxPerSec,this.params.scrollParent=!1),this.drawBuffer(),this.drawer.progress(this.backend.getPlayedPercents()),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",e)}},{key:"loadArrayBuffer",value:function(e){var t=this;this.decodeArrayBuffer(e,(function(e){t.isDestroyed||t.loadDecodedBuffer(e)}))}},{key:"loadDecodedBuffer",value:function(e){this.backend.load(e),this.drawBuffer(),this.isReady=!0,this.fireEvent("ready")}},{key:"loadBlob",value:function(e){var t=this,i=new FileReader;i.addEventListener("progress",(function(e){return t.onProgress(e)})),i.addEventListener("load",(function(e){return t.loadArrayBuffer(e.target.result)})),i.addEventListener("error",(function(){return t.fireEvent("error","Error reading file")})),i.readAsArrayBuffer(e),this.empty()}},{key:"load",value:function(e,t,i,r){if(!e)throw new Error("url parameter cannot be empty");if(this.empty(),i){var n={"Preload is not 'auto', 'none' or 'metadata'":-1===["auto","metadata","none"].indexOf(i),"Peaks are not provided":!t,"Backend is not of type 'MediaElement' or 'MediaElementWebAudio'":-1===["MediaElement","MediaElementWebAudio"].indexOf(this.params.backend),"Url is not of type string":"string"!=typeof e},o=Object.keys(n).filter((function(e){return n[e]}));o.length&&(console.warn("Preload parameter of wavesurfer.load will be ignored because:\n\t- "+o.join("\n\t- ")),i=null)}switch("WebAudio"===this.params.backend&&e instanceof HTMLMediaElement&&(e=e.src),this.params.backend){case"WebAudio":return this.loadBuffer(e,t,r);case"MediaElement":case"MediaElementWebAudio":return this.loadMediaElement(e,t,i,r)}}},{key:"loadBuffer",value:function(e,t,i){var r=this,n=function(t){return t&&r.tmpEvents.push(r.once("ready",t)),r.getArrayBuffer(e,(function(e){return r.loadArrayBuffer(e)}))};if(!t)return n();this.backend.setPeaks(t,i),this.drawBuffer(),this.fireEvent("waveform-ready"),this.tmpEvents.push(this.once("interaction",n))}},{key:"loadMediaElement",value:function(e,t,i,r){var n=this,o=e;if("string"==typeof e)this.backend.load(o,this.mediaContainer,t,i);else{var a=e;this.backend.loadElt(a,t),o=a.src}this.tmpEvents.push(this.backend.once("canplay",(function(){n.backend.destroyed||(n.drawBuffer(),n.isReady=!0,n.fireEvent("ready"))})),this.backend.once("error",(function(e){return n.fireEvent("error",e)}))),t&&(this.backend.setPeaks(t,r),this.drawBuffer(),this.fireEvent("waveform-ready")),t&&!this.params.forceDecode||!this.backend.supportsWebAudio()||this.getArrayBuffer(o,(function(e){n.decodeArrayBuffer(e,(function(e){n.backend.buffer=e,n.backend.setPeaks(null),n.drawBuffer(),n.fireEvent("waveform-ready")}))}))}},{key:"decodeArrayBuffer",value:function(e,t){var i=this;this.isDestroyed||(this.arraybuffer=e,this.backend.decodeArrayBuffer(e,(function(r){i.isDestroyed||i.arraybuffer!=e||(t(r),i.arraybuffer=null)}),(function(){return i.fireEvent("error","Error decoding audiobuffer")})))}},{key:"getArrayBuffer",value:function(e,t){var i=this,r=Object.assign({url:e,responseType:"arraybuffer"},this.params.xhr),o=n.fetchFile(r);return this.currentRequest=o,this.tmpEvents.push(o.on("progress",(function(e){i.onProgress(e)})),o.on("success",(function(e){t(e),i.currentRequest=null})),o.on("error",(function(e){i.fireEvent("error",e),i.currentRequest=null}))),o}},{key:"onProgress",value:function(e){var t;t=e.lengthComputable?e.loaded/e.total:e.loaded/(e.loaded+1e6),this.fireEvent("loading",Math.round(100*t),e.target)}},{key:"exportPCM",value:function(e,t,i,r,n){e=e||1024,r=r||0,t=t||1e4,i=i||!1;var o=this.backend.getPeaks(e,r,n),a=[].map.call(o,(function(e){return Math.round(e*t)/t}));return new Promise((function(e,t){if(!i){var r=new Blob([JSON.stringify(a)],{type:"application/json;charset=utf-8"}),n=URL.createObjectURL(r);window.open(n),URL.revokeObjectURL(n)}e(a)}))}},{key:"exportImage",value:function(e,t,i){return e||(e="image/png"),t||(t=1),i||(i="dataURL"),this.drawer.getImage(e,t,i)}},{key:"cancelAjax",value:function(){this.currentRequest&&this.currentRequest.controller&&(this.currentRequest._reader&&this.currentRequest._reader.cancel().catch((function(e){})),this.currentRequest.controller.abort(),this.currentRequest=null)}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach((function(e){return e.un()}))}},{key:"empty",value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.isReady=!1,this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:"destroy",value:function(){this.destroyAllPlugins(),this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),!1!==this.params.responsive&&(window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0)),this.backend&&(this.backend.destroy(),this.backend=null),this.drawer&&this.drawer.destroy(),this.isDestroyed=!0,this.isReady=!1,this.arraybuffer=null}}])&&y(t.prototype,i),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n.Observer);t.default=b,g(b,"VERSION","6.2.0"),g(b,"util",n),e.exports=t.default},"./src/webaudio.js":
/*!*************************!*\
            !*** ./src/webaudio.js ***!
            \*************************/
(e,t,i)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var i=o(t);if(i&&i.has(e))return i.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var c=a?Object.getOwnPropertyDescriptor(e,s):null;c&&(c.get||c.set)?Object.defineProperty(n,s,c):n[s]=e[s]}return n.default=e,i&&i.set(e,n),n}(i(
/*! ./util */
"./src/util/index.js"));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(o=function(e){return e?i:t})(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=l(e);if(t){var n=l(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return u(this,i)}}function u(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var f="playing",p="paused",v="finished",m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(o,e);var t,i,r,n=c(o);function o(e){var t,i,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),h(d(r=n.call(this)),"audioContext",null),h(d(r),"offlineAudioContext",null),h(d(r),"stateBehaviors",(h(t={},f,{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),h(t,p,{init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition}}),h(t,v,{init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),t)),r.params=e,r.ac=e.audioContext||(r.supportsWebAudio()?r.getAudioContext():{}),r.lastPlay=r.ac.currentTime,r.startPosition=0,r.scheduledPause=null,r.states=(h(i={},f,Object.create(r.stateBehaviors.playing)),h(i,p,Object.create(r.stateBehaviors.paused)),h(i,v,Object.create(r.stateBehaviors.finished)),i),r.buffer=null,r.filters=[],r.gainNode=null,r.mergedPeaks=null,r.offlineAc=null,r.peaks=null,r.playbackRate=1,r.analyser=null,r.scriptNode=null,r.source=null,r.splitPeaks=[],r.state=null,r.explicitDuration=e.duration,r.sinkStreamDestination=null,r.sinkAudioElement=null,r.destroyed=!1,r}return t=o,(i=[{key:"supportsWebAudio",value:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"getAudioContext",value:function(){return window.WaveSurferAudioContext||(window.WaveSurferAudioContext=new(window.AudioContext||window.webkitAudioContext)),window.WaveSurferAudioContext}},{key:"getOfflineAudioContext",value:function(e){return window.WaveSurferOfflineAudioContext||(window.WaveSurferOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,e)),window.WaveSurferOfflineAudioContext}},{key:"init",value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(p),this.setPlaybackRate(this.params.audioRate),this.setLength(0)}},{key:"disconnectFilters",value:function(){this.filters&&(this.filters.forEach((function(e){e&&e.disconnect()})),this.filters=null,this.analyser.connect(this.gainNode))}},{key:"setState",value:function(e){this.state!==this.states[e]&&(this.state=this.states[e],this.state.init.call(this))}},{key:"setFilter",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.setFilters(t)}},{key:"setFilters",value:function(e){this.disconnectFilters(),e&&e.length&&(this.filters=e,this.analyser.disconnect(),e.reduce((function(e,t){return e.connect(t),t}),this.analyser).connect(this.gainNode))}},{key:"createScriptNode",value:function(){this.params.audioScriptProcessor?this.scriptNode=this.params.audioScriptProcessor:this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(o.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(o.scriptBufferSize),this.scriptNode.connect(this.ac.destination)}},{key:"addOnAudioProcess",value:function(){var e=this;this.scriptNode.onaudioprocess=function(){var t=e.getCurrentTime();t>=e.getDuration()?(e.setState(v),e.fireEvent("pause")):t>=e.scheduledPause?e.pause():e.state===e.states.playing&&e.fireEvent("audioprocess",t)}}},{key:"removeOnAudioProcess",value:function(){this.scriptNode.onaudioprocess=null}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)}},{key:"createVolumeNode",value:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)}},{key:"setSinkId",value:function(e){return e?(this.sinkAudioElement||(this.sinkAudioElement=new window.Audio,this.sinkAudioElement.autoplay=!0),this.sinkAudioElement.setSinkId?(this.sinkStreamDestination||(this.sinkStreamDestination=this.ac.createMediaStreamDestination()),this.gainNode.disconnect(),this.gainNode.connect(this.sinkStreamDestination),this.sinkAudioElement.srcObject=this.sinkStreamDestination.stream,this.sinkAudioElement.setSinkId(e)):Promise.reject(new Error("setSinkId is not supported in your browser"))):Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"setVolume",value:function(e){this.gainNode.gain.setValueAtTime(e,this.ac.currentTime)}},{key:"getVolume",value:function(){return this.gainNode.gain.value}},{key:"decodeArrayBuffer",value:function(e,t,i){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac&&this.ac.sampleRate?this.ac.sampleRate:44100)),"webkitAudioContext"in window?this.offlineAc.decodeAudioData(e,(function(e){return t(e)}),i):this.offlineAc.decodeAudioData(e).then((function(e){return t(e)})).catch((function(e){return i(e)}))}},{key:"setPeaks",value:function(e,t){null!=t&&(this.explicitDuration=t),this.peaks=e}},{key:"setLength",value:function(e){if(!this.mergedPeaks||e!=2*this.mergedPeaks.length-1+2){this.splitPeaks=[],this.mergedPeaks=[];var t,i=this.buffer?this.buffer.numberOfChannels:1;for(t=0;t<i;t++)this.splitPeaks[t]=[],this.splitPeaks[t][2*(e-1)]=0,this.splitPeaks[t][2*(e-1)+1]=0;this.mergedPeaks[2*(e-1)]=0,this.mergedPeaks[2*(e-1)+1]=0}}},{key:"getPeaks",value:function(e,t,i){if(this.peaks)return this.peaks;if(!this.buffer)return[];if(t=t||0,i=i||e-1,this.setLength(e),!this.buffer)return this.params.splitChannels?this.splitPeaks:this.mergedPeaks;if(!this.buffer.length){var r=this.createBuffer(1,4096,this.sampleRate);this.buffer=r.buffer}var n,o=this.buffer.length/e,a=~~(o/10)||1,s=this.buffer.numberOfChannels;for(n=0;n<s;n++){var c=this.splitPeaks[n],u=this.buffer.getChannelData(n),d=void 0;for(d=t;d<=i;d++){var l=~~(d*o),h=~~(l+o),f=u[l],p=f,v=void 0;for(v=l;v<h;v+=a){var m=u[v];m>p&&(p=m),m<f&&(f=m)}c[2*d]=p,c[2*d+1]=f,(0==n||p>this.mergedPeaks[2*d])&&(this.mergedPeaks[2*d]=p),(0==n||f<this.mergedPeaks[2*d+1])&&(this.mergedPeaks[2*d+1]=f)}}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){this.source&&this.source.disconnect()}},{key:"destroyWebAudio",value:function(){this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.closeAudioContext&&("function"==typeof this.ac.close&&"closed"!=this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.WaveSurferAudioContext=null,window.WaveSurferOfflineAudioContext=null),this.sinkStreamDestination&&(this.sinkAudioElement.pause(),this.sinkAudioElement.srcObject=null,this.sinkStreamDestination.disconnect(),this.sinkStreamDestination=null)}},{key:"destroy",value:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.destroyed=!0,this.destroyWebAudio()}},{key:"load",value:function(e){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=e,this.createSource()}},{key:"createSource",value:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.setPlaybackRate(this.playbackRate),this.source.buffer=this.buffer,this.source.connect(this.analyser)}},{key:"resumeAudioContext",value:function(){"suspended"==this.ac.state&&this.ac.resume&&this.ac.resume()}},{key:"isPaused",value:function(){return this.state!==this.states.playing}},{key:"getDuration",value:function(){return this.explicitDuration?this.explicitDuration:this.buffer?this.buffer.duration:0}},{key:"seekTo",value:function(e,t){if(this.buffer)return this.scheduledPause=null,null==e&&(e=this.getCurrentTime())>=this.getDuration()&&(e=0),null==t&&(t=this.getDuration()),this.startPosition=e,this.lastPlay=this.ac.currentTime,this.state===this.states.finished&&this.setState(p),{start:e,end:t}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(e,t){if(this.buffer){this.createSource();var i=this.seekTo(e,t);e=i.start,t=i.end,this.scheduledPause=t,this.source.start(0,e),this.resumeAudioContext(),this.setState(f),this.fireEvent("play")}}},{key:"pause",value:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime();try{this.source&&this.source.stop(0)}catch(e){}this.setState(p),this.fireEvent("pause")}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1,this.source&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.ac.currentTime)}},{key:"setPlayEnd",value:function(e){this.scheduledPause=e}}])&&a(t.prototype,i),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.Observer);t.default=m,h(m,"scriptBufferSize",256),e.exports=t.default},"./node_modules/debounce/index.js":
/*!****************************************!*\
            !*** ./node_modules/debounce/index.js ***!
            \****************************************/
e=>{function t(e,t,i){var r,n,o,a,s;function c(){var u=Date.now()-a;u<t&&u>=0?r=setTimeout(c,t-u):(r=null,i||(s=e.apply(o,n),o=n=null))}null==t&&(t=100);var u=function(){o=this,n=arguments,a=Date.now();var u=i&&!r;return r||(r=setTimeout(c,t)),u&&(s=e.apply(o,n),o=n=null),s};return u.clear=function(){r&&(clearTimeout(r),r=null)},u.flush=function(){r&&(s=e.apply(o,n),o=n=null,clearTimeout(r),r=null)},u}t.debounce=t,e.exports=t}},t={},function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,i),o.exports}("./src/wavesurfer.js");var e,t},e.exports=i()}))),f=c((function(e,t){
/*!
   * wavesurfer.js microphone plugin 6.2.0 (2022-05-16)
   * https://wavesurfer-js.org
   * @license BSD-3-Clause
   */
!function(t,i){e.exports=i()}(self,(()=>(()=>{var e={872:(e,t)=>{function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(t,i){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.params=t,this.wavesurfer=i,this.active=!1,this.paused=!1,this.browser=this.detectBrowser(),this.reloadBufferFunction=function(e){return r.reloadBuffer(e)},void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e,t,i){var r=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return r?new Promise((function(t,i){r.call(navigator,e,t,i)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),this.constraints=this.params.constraints||{video:!1,audio:!0},this.bufferSize=this.params.bufferSize||4096,this.numberOfInputChannels=this.params.numberOfInputChannels||1,this.numberOfOutputChannels=this.params.numberOfOutputChannels||1,this._onBackendCreated=function(){r.micContext=r.wavesurfer.backend.getAudioContext()}}var t,r,n;return t=e,n=[{key:"create",value:function(t){return{name:"microphone",deferInit:!(!t||!t.deferInit)&&t.deferInit,params:t,instance:e}}}],(r=[{key:"init",value:function(){this.wavesurfer.on("backend-created",this._onBackendCreated),this.wavesurfer.backend&&this._onBackendCreated()}},{key:"destroy",value:function(){this.paused=!0,this.wavesurfer.un("backend-created",this._onBackendCreated),this.stop()}},{key:"start",value:function(){var e=this;navigator.mediaDevices.getUserMedia(this.constraints).then((function(t){return e.gotStream(t)})).catch((function(t){return e.deviceError(t)}))}},{key:"togglePlay",value:function(){this.active?(this.paused=!this.paused,this.paused?this.pause():this.play()):this.start()}},{key:"play",value:function(){this.paused=!1,this.connect()}},{key:"pause",value:function(){this.paused=!0,this.disconnect()}},{key:"stop",value:function(){this.active&&(this.stopDevice(),this.wavesurfer.empty())}},{key:"stopDevice",value:function(){this.active=!1,this.disconnect(),this.stream&&this.stream.getTracks&&this.stream.getTracks().forEach((function(e){return e.stop()}))}},{key:"connect",value:function(){void 0!==this.stream&&("edge"===this.browser.browser&&(this.localAudioBuffer=this.micContext.createBuffer(this.numberOfInputChannels,this.bufferSize,this.micContext.sampleRate)),this.mediaStreamSource=this.micContext.createMediaStreamSource(this.stream),this.levelChecker=this.micContext.createScriptProcessor(this.bufferSize,this.numberOfInputChannels,this.numberOfOutputChannels),this.mediaStreamSource.connect(this.levelChecker),this.levelChecker.connect(this.micContext.destination),this.levelChecker.onaudioprocess=this.reloadBufferFunction)}},{key:"disconnect",value:function(){void 0!==this.mediaStreamSource&&this.mediaStreamSource.disconnect(),void 0!==this.levelChecker&&(this.levelChecker.disconnect(),this.levelChecker.onaudioprocess=void 0),void 0!==this.localAudioBuffer&&(this.localAudioBuffer=void 0)}},{key:"reloadBuffer",value:function(e){if(!this.paused)if(this.wavesurfer.empty(),"edge"===this.browser.browser){var t,i;for(t=0,i=Math.min(this.localAudioBuffer.numberOfChannels,e.inputBuffer.numberOfChannels);t<i;t++)this.localAudioBuffer.getChannelData(t).set(e.inputBuffer.getChannelData(t));this.wavesurfer.loadDecodedBuffer(this.localAudioBuffer)}else this.wavesurfer.loadDecodedBuffer(e.inputBuffer)}},{key:"gotStream",value:function(e){this.stream=e,this.active=!0,this.play(),this.fireEvent("deviceReady",e)}},{key:"deviceError",value:function(e){this.fireEvent("deviceError",e)}},{key:"extractVersion",value:function(e,t,i){var r=e.match(t);return r&&r.length>=i&&parseInt(r[i],10)}},{key:"detectBrowser",value:function(){var e={browser:null,version:null,minVersion:null};return"undefined"!=typeof window&&window.navigator?navigator.mozGetUserMedia?(e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/(\d+)\./,1),e.minVersion=31,e):navigator.webkitGetUserMedia?(e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/(\d+)\./,2),e.minVersion=38,e):navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),e.minVersion=10547,e):window.RTCPeerConnection&&navigator.userAgent.match(/AppleWebKit\/(\d+)\./)?(e.browser="safari",e.minVersion=11,e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/(\d+)\./,1),e):(e.browser="Not a supported browser.",e):(e.browser="Not a supported browser.",e)}}])&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=r,e.exports=t.default}},t={};return function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,i),o.exports}(872)})()))})),p=d(f);f.WaveSurfer;let v=class extends e{constructor(){super(...arguments),this.audioRecording=!1,this.videoRecording=!1,this.maxLength=5,this.recordingFinished=!1,this.isRecording=!1,this.rememberDevice=!1,this.previewActive=!1,this.recordSecondsLeft=0,this.videoAspect="portrait",this.selectedAudioDeviceId=null,this.selectedVideoDeviceId=null}static get styles(){return[super.styles,t`mwc-dialog{background-color:#fff}#dialog[audio-recording]{width:430px}.mainbuttons{width:100%;margin-top:8px;margin-bottom:8px}.recording{color:red;animation-name:pulse;animation-duration:1.3s;animation-iteration-count:infinite;animation-timing-function:linear}.recordingTime{color:red;animation-name:pulse;animation-duration:1s;animation-iteration-count:infinite;animation-timing-function:linear}@keyframes pulse{from{opacity:1}to{opacity:.5}}.buttonText{margin-left:6px}.actionButton{color:var(--accent-color)}.iconButtons{margin-top:2px}#secondsLeft{margin-top:12px;margin-left:4px;margin-right:4px}.mainContainer{padding:0 24px}@media (max-width:640px){#dialog{padding:0;margin:0}.mainContainer{padding:0 0}.mainbuttons{position:absolute;bottom:0;left:0;width:100%;background-color:rgba(240,240,240,.5)}#dialog{min-height:242px;min-width:320px;width:100%}}@media (max-width:360px){.uploadFileText{display:none}}.rememberBox{margin-top:8px}#checkBox{margin-left:6px}.header{font-weight:700;font-size:18px;margin-bottom:10px}#waveform{height:128px}[hidden]{display:none!important}`]}render(){return i` <mwc-dialog id="dialog" modal ?audioRecording="${this.audioRecording}"> <div class="layout vertical no-padding mainContainer"> ${this.videoRecording?i` <video id="videoRecorder" class="videoRecorder" ?hidden="${this.previewActive}"></video> <video id="videoPreviewer" preload="auto" class="videoRecorder" ?hidden="${!this.previewActive}"></video> `:i``} ${this.audioRecording?i` <div class="layout vertical center-center"> <div class="layout horizontal center-center header"> ${this.t("voiceRecorder")} </div> <div id="waveform" ?hidden="${null!=this.recordedData}"></div> <audio id="audioRecorder" class="audioRecorder" ?hidden></audio> <audio id="audioPreviewer" controls preload="auto" class="audioRecorder" ?hidden="${!this.previewActive}"></audio> </div> `:i``} <div class="layout horizontal mainbuttons" slot="primaryAction"> <mwc-icon-button .label="${this.t("closeRecordingWindow")}" icon="clear" class="iconButtons" @click="${this._close}"></mwc-icon-button> <div class="layout layout horizontal" ?hidden="${!this.recorder}"> <mwc-icon-button .label="${this.t("deleteRecordedMedia")}" icon="delete" class="iconButtons" @click="${this._deleteRecording}" ?hidden="${!this.recordedData}"></mwc-icon-button> <mwc-button @click="${this._startRecording}" class="buttonText" .label="${this.t("record")}" ?hidden="${null!=this.recordedData}" icon="fiber_manual_record"> <iron-icon id="recordingIcon"></iron-icon> </mwc-button> <div id="secondsLeft" ?hidden="${null!=this.recordedData}"> ${this.recordSecondsLeft} ${this.t("seconds")} </div> <mwc-button @click="${this._stopRecording}" class="buttonText" .label="${this.t("stop")}" ?hidden="${!this.isRecording}" icon="stop"> </mwc-button> </div> <span ?hidden="${this.isRecording||this.audioRecording}"> <div class="layout horizontal"> <mwc-button id="uploadFileButton" icon="file-upload" class="uploadFileButton" .label="${this.t("uploadFile")}" @click="${this._uploadFile}" ?hidden="${null!=this.recordedData}"> <div class="buttonText uploadFileText"></div> </mwc-button> <mwc-formfield label="landscape"> <mwc-radio name="videoAspect" @change="${this._setVideoAspect}" value="landscape"> </mwc-radio> </mwc-formfield> <mwc-formfield label="portrait"> <mwc-radio name="videoAspect" @change="${this._setVideoAspect}" value="portrait"> </mwc-radio> </mwc-formfield> </div> </span> <mwc-button @click="${this._sendBack}" class="buttonText actionButton" .label="${this.t("send")}" ?hidden="${!this.recordedData}" icon="send"> </mwc-button> </div> </div> <div ?hidden="${!this.error}"> ${this.error} </div> </mwc-dialog> ${this.allDevices?i` <mwc-dialog id="selectDevices" modal> <h2>${this.selectDeviceTitle}</h2> <mwc-select id="deviceListBox"> ${this.allDevices.map((e=>i` <mwc-list-item @click="${this.selectDeviceFunction}" id="${e.deviceId}">${e.label}</mwc-list-item> `))} </mwc-select> <div class="layout horizontal rememberBox"> <div> ${this.t("rememberDevice")} </div> <input id="checkBox" type="checkbox"> </div> </mwc-dialog> `:r} <mwc-dialog id="noDevices"> <h2>${this.t("noDevicesFound")}</h2> <div class="button layout horizontal center-center"> <mwc-button slot="action" raised .label="${this.t("ok")}"></mwc-button> </div> </mwc-dialog> `}_setVideoAspect(e){this.videoAspect=e.target.value}_selectAudioDevice(e){const t=e.target;t.id&&(this.selectedAudioDeviceId=t.id),this.$$("#checkBox").checked&&localStorage.setItem("selectedAudioDeviceId",this.selectedAudioDeviceId),this.$$("#selectDevices").open=!1,this._openMediaSession(this.captureCallback)}_selectVideoDevice(e){e.target.id&&(this.selectedVideoDeviceId=e.target.id),this.$$("#checkBox").checked&&localStorage.setItem("selectedVideoDeviceId",this.selectedVideoDeviceId),this.$$("#selectDevices").open=!1,this._checkAudioDevices()}async _checkAudioDevices(){this.audioDevices&&this.audioDevices.length>1?localStorage.getItem("selectedAudioDeviceId")?(this.selectedAudioDeviceId=localStorage.getItem("selectedAudioDeviceId"),this._openMediaSession(this.captureCallback)):(this.selectDeviceTitle=this.t("selectAudioDevice"),this.selectDeviceFunction=this._selectAudioDevice.bind(this),this.allDevices=this.audioDevices,await this.updateComplete,this.$$("#checkBox").checked=!1,this.$$("#selectDevices").open=!0):this._openMediaSession(this.captureCallback)}async _checkVideoDevices(){this.videoRecording&&this.videoDevices&&this.videoDevices.length>1?localStorage.getItem("selectedVideoDeviceId")?(this.selectedVideoDeviceId=localStorage.getItem("selectedVideoDeviceId"),await this._checkAudioDevices()):(this.selectDeviceTitle=this.t("selectVideoDevice"),this.rememberDevice=!1,this.selectDeviceFunction=this._selectVideoDevice.bind(this),this.allDevices=this.videoDevices,await this.updateComplete,this.$$("#checkBox").checked=!1,this.$$("#selectDevices").open=!0):await this._checkAudioDevices()}_close(){this.mediaStream&&this.mediaStream.getTracks().forEach((function(e){e.stop()})),this.surfer&&(this.surfer.microphone.stop(),this.surfer.destroy()),this.previewActive=!1,this.$$("#dialog").open=!1}_uploadFile(){this._close(),this.uploadFileFunction(this.videoAspect)}_sendBack(){this.callbackFunction&&this.recorder?(this.callbackFunction(this.recordedData),this.recordedData=void 0,this.recorder.clearRecordedData(),this.recorder.reset(),this.recorder=void 0,this._close()):console.error("No callback function for media player")}checkDevices(){navigator.mediaDevices.enumerateDevices().then((e=>{this.audioDevices=e.filter((e=>"audioinput"===e.kind)),this.videoDevices=e.filter((e=>"videoinput"===e.kind));let t=!1;this.videoDevices.forEach((function(e){e.label&&""!=e.label&&(t=!0)})),t||(this.videoDevices=void 0,this.audioDevices=void 0),this._checkVideoDevices()}))}connectedCallback(){super.connectedCallback(),window.innerHeight>window.innerWidth?this.videoAspect="portrait":this.videoAspect="landscape"}captureUserMedia(e){this.captureCallback=e,this.checkDevices()}_openMediaSession(e){if(e){this.selectedVideoDeviceId&&(this.videoSettings.deviceId=this.selectedVideoDeviceId);const t={audio:!this.selectedAudioDeviceId||{deviceId:this.selectedAudioDeviceId},video:this.videoRecording?this.videoSettings:void 0};navigator.mediaDevices.getUserMedia(t).then((t=>{t.getTracks().forEach((function(e){console.info(e.getCapabilities())})),e(t)})).catch((function(t){console.error(t),e(null)}))}}async open(e){if(this.callbackFunction=e.callbackFunction,this.recordingFinished=!1,this.error=void 0,this.audioRecording=!1,this.videoRecording=!1,e.videoRecording?this.videoRecording=!0:e.audioRecording&&(this.audioRecording=!0),this.maxLength=e.maxLength,this.uploadFileFunction=e.uploadFileFunction,this.$$("#secondsLeft").className="",await this.requestUpdate(),this.videoRecording){const e=this.shadowRoot.querySelector("#videoRecorder"),t=this.shadowRoot.querySelector("#videoPreviewer");let i,r;if(window.innerHeight>window.innerWidth)this.videoSettings={width:720,height:1280},r=Math.min(1280,Math.abs(window.innerHeight)).toFixed(),i=Math.min(720,Math.abs(.5625*parseInt(r))).toFixed(),console.info("Portrait - width: "+i+" height: "+r+" video width: 720 height: 1280");else{this.videoSettings={width:1280,height:720};let e=.8;window.innerHeight<700&&(e=.7),window.innerHeight<500&&(e=.6),r=Math.min(720,Math.abs(window.innerHeight*e)).toFixed(),i=Math.min(1280,Math.abs(1.77777777778*parseInt(r))).toFixed(),console.info("Landscape - width: "+i+" height: "+r)}e.style.height=r+"px",e.style.width=i+"px",t.style.height=(.8*parseInt(r)).toFixed()+"px",t.style.width=(.8*parseInt(i)).toFixed()+"px",setTimeout((()=>{this.$$("#dialog").open=!0}))}else this.audioRecording&&setTimeout((()=>{this.$$("#dialog").open=!0}));this.setupRecorders()}_generateRandomString(){if(window.crypto){const e=window.crypto.getRandomValues(new Uint32Array(3));let t="";for(let i=0,r=e.length;i<r;i++)t+=e[i].toString(36);return t}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}_startRecording(){this.isRecording?this._stopRecording():(this.recorder.startRecording(),this.recordSecondsLeft=this.maxLength,this.isRecording=!0,this.$$("#recordingIcon").className="recording",this._recordingTimer())}_stopRecording(){this.$$("#recordingIcon").className="",this.isRecording=!1,this.recorder.stopRecording(this._storeRecordedData.bind(this)),this.$$("#secondsLeft").className=""}_deleteRecording(){this.recorder.reset(),this.previewActive=!1,this.recordedData=void 0,this.recordSecondsLeft=this.maxLength,this.$$("#secondsLeft").className="",this.$$("#recordingIcon").className=""}_storeRecordedData(){const e=this.recorder.getBlob();let t;if(this.videoRecording){const i=this.shadowRoot.querySelector("#videoRecorder"),r=this.shadowRoot.querySelector("#videoPreviewer");t=this._generateRandomString()+".webm",this.recordedData=new File([e],t,{type:"video/webm"}),i.controls=!0,this.recorder.reset(),r.src=window.URL.createObjectURL(this.recordedData),r.controls=!0,this.previewActive=!0}else if(this.audioRecording){const i=this.shadowRoot.querySelector("#audioRecorder"),r=this.shadowRoot.querySelector("#audioPreviewer");t=this._generateRandomString()+".mp3",this.recordedData=new File([e],t,{type:"audio/mp3"}),i.controls=!0,i.pause(),r.src=window.URL.createObjectURL(this.recordedData),r.controls=!0,this.previewActive=!0}}_recordingTimer(){this.isRecording?setTimeout((()=>{this.isRecording&&(this.recordSecondsLeft>0?this._recordingTimer():this._stopRecording(),this.recordSecondsLeft>0&&(this.recordSecondsLeft-=1),this.recordSecondsLeft<=5&&(this.$$("#secondsLeft").className="recordingTime"))}),1e3):console.error("_recordingTimer called without in recording mode")}setupRecorders(){if(this.recordSecondsLeft=this.maxLength,this.videoRecording){const e=this.shadowRoot.querySelector("#videoRecorder");this.captureUserMedia((t=>{if(t){this.mediaStream=t;try{e.srcObject=t}catch(i){console.error(i),e.src=window.URL.createObjectURL(t)}e.play(),e.muted=!0,e.controls=!1,this.recorder=new l(t,{type:"video"})}else console.error("Can't find stream"),this.$$("#noDevices").open=!0,this.$$("#uploadFileButton").style.color="#F00"}))}else if(this.audioRecording){const e=this.shadowRoot.querySelector("#audioRecorder");this.captureUserMedia((t=>{if(t){this.mediaStream=t;try{e.srcObject=t}catch(i){console.error(i),e.src=window.URL.createObjectURL(t)}e.play(),e.muted=!0,e.controls=!1,this.surfer=h.create({container:this.$$("#waveform"),waveColor:"#ff3d00",progressColor:"#ff3d00",cursorWidth:0,plugins:[p.create({stream:this.mediaStream})]}),this.surfer.microphone.play(),this.recorder=new l(t,{type:"audio"})}else console.error("Can't find stream"),this.$$("#noDevices").open=!0,this.$$("#uploadFileButton").style.color="#F00"}))}setTimeout((()=>{}))}};n([o({type:Object})],v.prototype,"recorder",void 0),n([o({type:Object})],v.prototype,"mediaStream",void 0),n([o({type:Object})],v.prototype,"captureStream",void 0),n([o({type:Boolean})],v.prototype,"audioRecording",void 0),n([o({type:Boolean})],v.prototype,"videoRecording",void 0),n([o({type:Number})],v.prototype,"maxLength",void 0),n([o({type:Object})],v.prototype,"recordedData",void 0),n([o({type:Boolean})],v.prototype,"recordingFinished",void 0),n([o({type:Boolean})],v.prototype,"isRecording",void 0),n([o({type:Boolean})],v.prototype,"rememberDevice",void 0),n([o({type:Boolean})],v.prototype,"previewActive",void 0),n([o({type:Object})],v.prototype,"callbackFunction",void 0),n([o({type:Object})],v.prototype,"captureCallback",void 0),n([o({type:Object})],v.prototype,"uploadFileFunction",void 0),n([o({type:Object})],v.prototype,"selectDeviceFunction",void 0),n([o({type:String})],v.prototype,"error",void 0),n([o({type:String})],v.prototype,"selectDeviceTitle",void 0),n([o({type:Number})],v.prototype,"recordSecondsLeft",void 0),n([o({type:Array})],v.prototype,"audioDevices",void 0),n([o({type:Array})],v.prototype,"videoDevices",void 0),n([o({type:Array})],v.prototype,"allDevices",void 0),n([o({type:Object})],v.prototype,"videoOptions",void 0),n([o({type:Object})],v.prototype,"surfer",void 0),n([a()],v.prototype,"videoAspect",void 0),v=n([s("yp-media-recorder")],v);export{v as YpMediaRecorder};
