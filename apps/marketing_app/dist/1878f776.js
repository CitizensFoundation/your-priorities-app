import{I as t,J as e,K as o,L as n,M as i,N as s}from"./dcd19838.js";var r=t`
@keyframes sp-overlay-fade-in{0%{opacity:0;transform:var(--sp-overlay-from)}to{opacity:1;transform:translate(0)}}@keyframes sp-overlay-fade-out{0%{opacity:1;transform:translate(0)}to{opacity:0;transform:var(--sp-overlay-from)}}:host{display:inline-block;left:-9999em;pointer-events:none;position:absolute;top:-9999em;z-index:1000}:host(:focus){outline:none}:host([placement=none]){height:100vh;height:-webkit-fill-available;height:fill-available;left:0;max-height:var(--swc-visual-viewport-height);position:fixed;top:0}#contents,sp-theme{height:100%}#contents{--swc-overlay-animation-distance:var(
--spectrum-picker-m-texticon-popover-offset-y,var(--spectrum-global-dimension-size-75)
);animation-duration:var(
--swc-test-duration,var(--spectrum-global-animation-duration-200,.16s)
);animation-timing-function:var(
--spectrum-global-animation-ease-out,ease-out
);box-sizing:border-box;display:inline-block;opacity:1;pointer-events:none;visibility:visible}:host([actual-placement*=top]) #contents{--sp-overlay-from:translateY(var(--spectrum-global-dimension-size-75));align-items:flex-end;display:inline-flex;padding-top:var(--swc-overlay-animation-distance)}:host([actual-placement*=right]) #contents{--sp-overlay-from:translateX(calc(var(--spectrum-global-dimension-size-75)*-1));padding-right:var(--swc-overlay-animation-distance)}:host([actual-placement*=bottom]) #contents{--sp-overlay-from:translateY(calc(var(--spectrum-global-dimension-size-75)*-1));padding-bottom:var(--swc-overlay-animation-distance)}:host([actual-placement*=left]) #contents{--sp-overlay-from:translateX(var(--spectrum-global-dimension-size-75));padding-left:var(--swc-overlay-animation-distance)}:host([animating]) ::slotted(*){pointer-events:none}:host(:not([animating])) ::slotted(*){pointer-events:auto}#contents ::slotted(*){position:relative}
`;const a=t=>{if(!t)return null;const e=t.closest("active-overlay");if(e)return e;const o=t.getRootNode();return o.host?a(o.host):null},l=(t,e)=>{const o=[];if(!t)return[];for(const n of e)!n.root||a(n.root)===t&&(o.push(n),o.push(...l(n,e)));return o};function c(t){return t.split("-")[0]}function h(t){return t.split("-")[1]}function d(t){return["top","bottom"].includes(c(t))?"x":"y"}function p(t){return"y"===t?"height":"width"}function u(t,e,o){let{reference:n,floating:i}=t;const s=n.x+n.width/2-i.width/2,r=n.y+n.height/2-i.height/2,a=d(e),l=p(a),u=n[l]/2-i[l]/2,m="x"===a;let f;switch(c(e)){case"top":f={x:s,y:n.y-i.height};break;case"bottom":f={x:s,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:r};break;case"left":f={x:n.x-i.width,y:r};break;default:f={x:n.x,y:n.y}}switch(h(e)){case"start":f[a]-=u*(o&&m?-1:1);break;case"end":f[a]+=u*(o&&m?-1:1)}return f}function m(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function f(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function v(t,e){var o;void 0===e&&(e={});const{x:n,y:i,platform:s,rects:r,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:d="floating",altBoundary:p=!1,padding:u=0}=e,v=m(u),g=a[p?"floating"===d?"reference":"floating":d],y=f(await s.getClippingRect({element:null==(o=await(null==s.isElement?void 0:s.isElement(g)))||o?g:g.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:h,strategy:l})),b=f(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===d?{...r.floating,x:n,y:i}:r.reference,offsetParent:await(null==s.getOffsetParent?void 0:s.getOffsetParent(a.floating)),strategy:l}):r[d]);return{top:y.top-b.top+v.top,bottom:b.bottom-y.bottom+v.bottom,left:y.left-b.left+v.left,right:b.right-y.right+v.right}}const g=Math.min,y=Math.max;function b(t,e,o){return y(t,g(e,o))}const w={left:"right",right:"left",bottom:"top",top:"bottom"};function C(t){return t.replace(/left|right|bottom|top/g,(t=>w[t]))}const x={start:"end",end:"start"};function T(t){return t.replace(/start|end/g,(t=>x[t]))}const O=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var o;const{placement:n,middlewareData:i,rects:s,initialPlacement:r,platform:a,elements:l}=e,{mainAxis:u=!0,crossAxis:m=!0,fallbackPlacements:f,fallbackStrategy:g="bestFit",flipAlignment:y=!0,...b}=t,w=c(n),x=[r,...f||(w===r||!y?[C(r)]:function(t){const e=C(t);return[T(t),e,T(e)]}(r))],O=await v(e,b),E=[];let R=(null==(o=i.flip)?void 0:o.overflows)||[];if(u&&E.push(O[w]),m){const{main:t,cross:e}=function(t,e,o){void 0===o&&(o=!1);const n=h(t),i=d(t),s=p(i);let r="x"===i?n===(o?"end":"start")?"right":"left":"start"===n?"bottom":"top";return e.reference[s]>e.floating[s]&&(r=C(r)),{main:r,cross:C(r)}}(n,s,await(null==a.isRTL?void 0:a.isRTL(l.floating)));E.push(O[t],O[e])}if(R=[...R,{placement:n,overflows:E}],!E.every((t=>t<=0))){var A,P;const t=(null!=(A=null==(P=i.flip)?void 0:P.index)?A:0)+1,e=x[t];if(e)return{data:{index:t,overflows:R},reset:{placement:e}};let o="bottom";switch(g){case"bestFit":{var k;const t=null==(k=R.map((t=>[t,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:k[0].placement;t&&(o=t);break}case"initialPlacement":o=r}if(n!==o)return{reset:{placement:o}}}return{}}}};const E=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){const{x:o,y:n}=e,i=await async function(t,e){const{placement:o,platform:n,elements:i}=t,s=await(null==n.isRTL?void 0:n.isRTL(i.floating)),r=c(o),a=h(o),l="x"===d(o),p=["left","top"].includes(r)?-1:1,u=s&&l?-1:1,m="function"==typeof e?e(t):e;let{mainAxis:f,crossAxis:v,alignmentAxis:g}="number"==typeof m?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...m};return a&&"number"==typeof g&&(v="end"===a?-1*g:g),l?{x:v*u,y:f*p}:{x:f*p,y:v*u}}(e,t);return{x:o+i.x,y:n+i.y,data:i}}}};const R=function(t){return void 0===t&&(t={}),{name:"size",options:t,async fn(e){const{placement:o,rects:n,platform:i,elements:s}=e,{apply:r,...a}=t,l=await v(e,a),d=c(o),p=h(o);let u,m;"top"===d||"bottom"===d?(u=d,m=p===(await(null==i.isRTL?void 0:i.isRTL(s.floating))?"start":"end")?"left":"right"):(m=d,u="end"===p?"top":"bottom");const f=y(l.left,0),g=y(l.right,0),b=y(l.top,0),w=y(l.bottom,0),C={availableHeight:n.floating.height-(["left","right"].includes(o)?2*(0!==b||0!==w?b+w:y(l.top,l.bottom)):l[u]),availableWidth:n.floating.width-(["top","bottom"].includes(o)?2*(0!==f||0!==g?f+g:y(l.left,l.right)):l[m])},x=await i.getDimensions(s.floating);null==r||r({...e,...C});const T=await i.getDimensions(s.floating);return x.width!==T.width||x.height!==T.height?{reset:{rects:!0}}:{}}}};function A(t){return t&&t.document&&t.location&&t.alert&&t.setInterval}function P(t){if(null==t)return window;if(!A(t)){const e=t.ownerDocument;return e&&e.defaultView||window}return t}function k(t){return P(t).getComputedStyle(t)}function L(t){return A(t)?"":t?(t.nodeName||"").toLowerCase():""}function F(){const t=navigator.userAgentData;return null!=t&&t.brands?t.brands.map((t=>t.brand+"/"+t.version)).join(" "):navigator.userAgent}function D(t){return t instanceof P(t).HTMLElement}function M(t){return t instanceof P(t).Element}function N(t){if("undefined"==typeof ShadowRoot)return!1;return t instanceof P(t).ShadowRoot||t instanceof ShadowRoot}function W(t){const{overflow:e,overflowX:o,overflowY:n}=k(t);return/auto|scroll|overlay|hidden/.test(e+n+o)}function H(t){return["table","td","th"].includes(L(t))}function I(t){const e=/firefox/i.test(F()),o=k(t);return"none"!==o.transform||"none"!==o.perspective||"paint"===o.contain||["transform","perspective"].includes(o.willChange)||e&&"filter"===o.willChange||e&&!!o.filter&&"none"!==o.filter}function _(){return!/^((?!chrome|android).)*safari/i.test(F())}const S=Math.min,z=Math.max,$=Math.round;function U(t,e,o){var n,i,s,r;void 0===e&&(e=!1),void 0===o&&(o=!1);const a=t.getBoundingClientRect();let l=1,c=1;e&&D(t)&&(l=t.offsetWidth>0&&$(a.width)/t.offsetWidth||1,c=t.offsetHeight>0&&$(a.height)/t.offsetHeight||1);const h=M(t)?P(t):window,d=!_()&&o,p=(a.left+(d&&null!=(n=null==(i=h.visualViewport)?void 0:i.offsetLeft)?n:0))/l,u=(a.top+(d&&null!=(s=null==(r=h.visualViewport)?void 0:r.offsetTop)?s:0))/c,m=a.width/l,f=a.height/c;return{width:m,height:f,top:u,right:p+m,bottom:u+f,left:p,x:p,y:u}}function j(t){return(e=t,(e instanceof P(e).Node?t.ownerDocument:t.document)||window.document).documentElement;var e}function B(t){return M(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function K(t){return U(j(t)).left+B(t).scrollLeft}function q(t,e,o){const n=D(e),i=j(e),s=U(t,n&&function(t){const e=U(t);return $(e.width)!==t.offsetWidth||$(e.height)!==t.offsetHeight}(e),"fixed"===o);let r={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(n||!n&&"fixed"!==o)if(("body"!==L(e)||W(i))&&(r=B(e)),D(e)){const t=U(e,!0);a.x=t.x+e.clientLeft,a.y=t.y+e.clientTop}else i&&(a.x=K(i));return{x:s.left+r.scrollLeft-a.x,y:s.top+r.scrollTop-a.y,width:s.width,height:s.height}}function V(t){return"html"===L(t)?t:t.assignedSlot||t.parentNode||(N(t)?t.host:null)||j(t)}function X(t){return D(t)&&"fixed"!==getComputedStyle(t).position?t.offsetParent:null}function Y(t){const e=P(t);let o=X(t);for(;o&&H(o)&&"static"===getComputedStyle(o).position;)o=X(o);return o&&("html"===L(o)||"body"===L(o)&&"static"===getComputedStyle(o).position&&!I(o))?e:o||function(t){let e=V(t);for(N(e)&&(e=e.host);D(e)&&!["html","body"].includes(L(e));){if(I(e))return e;e=e.parentNode}return null}(t)||e}function J(t){if(D(t))return{width:t.offsetWidth,height:t.offsetHeight};const e=U(t);return{width:e.width,height:e.height}}function G(t){const e=V(t);return["html","body","#document"].includes(L(e))?t.ownerDocument.body:D(e)&&W(e)?e:G(e)}function Q(t,e){var o;void 0===e&&(e=[]);const n=G(t),i=n===(null==(o=t.ownerDocument)?void 0:o.body),s=P(n),r=i?[s].concat(s.visualViewport||[],W(n)?n:[]):n,a=e.concat(r);return i?a:a.concat(Q(r))}function Z(t,e,o){return"viewport"===e?f(function(t,e){const o=P(t),n=j(t),i=o.visualViewport;let s=n.clientWidth,r=n.clientHeight,a=0,l=0;if(i){s=i.width,r=i.height;const t=_();(t||!t&&"fixed"===e)&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:r,x:a,y:l}}(t,o)):M(e)?function(t,e){const o=U(t,!1,"fixed"===e),n=o.top+t.clientTop,i=o.left+t.clientLeft;return{top:n,left:i,x:i,y:n,right:i+t.clientWidth,bottom:n+t.clientHeight,width:t.clientWidth,height:t.clientHeight}}(e,o):f(function(t){var e;const o=j(t),n=B(t),i=null==(e=t.ownerDocument)?void 0:e.body,s=z(o.scrollWidth,o.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=z(o.scrollHeight,o.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0);let a=-n.scrollLeft+K(t);const l=-n.scrollTop;return"rtl"===k(i||o).direction&&(a+=z(o.clientWidth,i?i.clientWidth:0)-s),{width:s,height:r,x:a,y:l}}(j(t)))}function tt(t){const e=Q(t),o=["absolute","fixed"].includes(k(t).position)&&D(t)?Y(t):t;return M(o)?e.filter((t=>M(t)&&function(t,e){const o=null==e.getRootNode?void 0:e.getRootNode();if(t.contains(e))return!0;if(o&&N(o)){let o=e;do{if(o&&t===o)return!0;o=o.parentNode||o.host}while(o)}return!1}(t,o)&&"body"!==L(t))):[]}const et={getClippingRect:function(t){let{element:e,boundary:o,rootBoundary:n,strategy:i}=t;const s=[..."clippingAncestors"===o?tt(e):[].concat(o),n],r=s[0],a=s.reduce(((t,o)=>{const n=Z(e,o,i);return t.top=z(n.top,t.top),t.right=S(n.right,t.right),t.bottom=S(n.bottom,t.bottom),t.left=z(n.left,t.left),t}),Z(e,r,i));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:o,strategy:n}=t;const i=D(o),s=j(o);if(o===s)return e;let r={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if((i||!i&&"fixed"!==n)&&(("body"!==L(o)||W(s))&&(r=B(o)),D(o))){const t=U(o,!0);a.x=t.x+o.clientLeft,a.y=t.y+o.clientTop}return{...e,x:e.x-r.scrollLeft+a.x,y:e.y-r.scrollTop+a.y}},isElement:M,getDimensions:J,getOffsetParent:Y,getDocumentElement:j,getElementRects:t=>{let{reference:e,floating:o,strategy:n}=t;return{reference:q(e,Y(o),n),floating:{...J(o),x:0,y:0}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>"rtl"===k(t).direction},ot=(t,e,o)=>(async(t,e,o)=>{const{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:r}=o,a=await(null==r.isRTL?void 0:r.isRTL(e));if("production"!==process.env.NODE_ENV&&(null==r&&console.error(["Floating UI: `platform` property was not passed to config. If you","want to use Floating UI on the web, install @floating-ui/dom","instead of the /core package. Otherwise, you can create your own","`platform`: https://floating-ui.com/docs/platform"].join(" ")),s.filter((t=>{let{name:e}=t;return"autoPlacement"===e||"flip"===e})).length>1))throw new Error(["Floating UI: duplicate `flip` and/or `autoPlacement`","middleware detected. This will lead to an infinite loop. Ensure only","one of either has been passed to the `middleware` array."].join(" "));let l=await r.getElementRects({reference:t,floating:e,strategy:i}),{x:c,y:h}=u(l,n,a),d=n,p={},m=0;for(let o=0;o<s.length;o++){const{name:f,fn:v}=s[o],{x:g,y:y,data:b,reset:w}=await v({x:c,y:h,initialPlacement:n,placement:d,strategy:i,middlewareData:p,rects:l,platform:r,elements:{reference:t,floating:e}});c=null!=g?g:c,h=null!=y?y:h,p={...p,[f]:{...p[f],...b}},"production"!==process.env.NODE_ENV&&m>50&&console.warn(["Floating UI: The middleware lifecycle appears to be running in an","infinite loop. This is usually caused by a `reset` continually","being returned without a break condition."].join(" ")),w&&m<=50&&(m++,"object"==typeof w&&(w.placement&&(d=w.placement),w.rects&&(l=!0===w.rects?await r.getElementRects({reference:t,floating:e,strategy:i}):w.rects),({x:c,y:h}=u(l,d,a))),o=-1)}return{x:c,y:h,placement:d,strategy:i,middlewareData:p}})(t,e,{platform:et,...o});var nt=Object.defineProperty,it=Object.getOwnPropertyDescriptor,st=(t,e,o,n)=>{for(var i,s=n>1?void 0:n?it(e,o):e,r=t.length-1;r>=0;r--)(i=t[r])&&(s=(n?i(e,o,s):i(s))||s);return n&&s&&nt(e,o,s),s};const rt={initial:"idle",states:{idle:{on:{active:"active"}},active:{on:{hiding:"hiding",idle:"idle"}},hiding:{on:{dispose:"dispose"}},dispose:{on:{disposed:"disposed"}},disposed:{on:{}}}},at=(t,e)=>t?e&&rt.states[t].on[e]||t:rt.initial,lt=t=>{var e;return null!=(e={left:["right","bottom","top"],"left-start":["right-start","bottom","top"],"left-end":["right-end","bottom","top"],right:["left","bottom","top"],"right-start":["left-start","bottom","top"],"right-end":["left-end","bottom","top"],top:["bottom","left","right"],"top-start":["bottom-start","left","right"],"top-end":["bottom-end","left","right"],bottom:["top","left","right"],"bottom-start":["top-start","left","right"],"bottom-end":["top-end","left","right"]}[t])?e:[t]},ct=class extends o{constructor(){super(),this._state=at(),this.animating=!1,this.theme={},this.tabbingAway=!1,this.offset=6,this.skidding=0,this.interaction="hover",this.positionAnimationFrame=0,this.willNotifyClosed=!1,this.isConstrained=!1,this.updateOverlayPosition=async()=>{if(!this.placement||"none"===this.placement)return;function t(t){const e=window.devicePixelRatio||1;return Math.round(t*e)/e||-1e4}await(document.fonts?document.fonts.ready:Promise.resolve());const e=this.virtualTrigger?O({padding:8,fallbackPlacements:lt(this.placement)}):O({padding:8}),o=[E({mainAxis:this.offset,crossAxis:this.skidding}),(n={padding:8},void 0===n&&(n={}),{name:"shift",options:n,async fn(t){const{x:e,y:o,placement:i}=t,{mainAxis:s=!0,crossAxis:r=!1,limiter:a={fn:t=>{let{x:e,y:o}=t;return{x:e,y:o}}},...l}=n,h={x:e,y:o},p=await v(t,l),u=d(c(i)),m="x"===u?"y":"x";let f=h[u],g=h[m];if(s){const t="y"===u?"bottom":"right";f=b(f+p["y"===u?"top":"left"],f,f-p[t])}if(r){const t="y"===m?"bottom":"right";g=b(g+p["y"===m?"top":"left"],g,g-p[t])}const y=a.fn({...t,[u]:f,[m]:g});return{...y,data:{x:y.x-e,y:y.y-o}}}}),e,R({padding:8,apply:({availableWidth:t,availableHeight:e,rects:{floating:o}})=>{const n=Math.max(100,Math.floor(e)),i=o.height;this.initialHeight=(this.isConstrained||this.virtualTrigger)&&this.initialHeight||i,this.isConstrained=i<this.initialHeight||n<=i;const s=this.isConstrained?`${n}px`:"";Object.assign(this.style,{maxWidth:`${Math.floor(t)}px`,maxHeight:s,height:s})}})];var n;this.overlayContentTip&&o.push((t=>({name:"arrow",options:t,async fn(e){const{element:o,padding:n=0}=null!=t?t:{},{x:i,y:s,placement:r,rects:a,platform:l}=e;if(null==o)return"production"!==process.env.NODE_ENV&&console.warn("Floating UI: No `element` was passed to the `arrow` middleware."),{};const c=m(n),u={x:i,y:s},f=d(r),v=h(r),g=p(f),y=await l.getDimensions(o),w="y"===f?"top":"left",C="y"===f?"bottom":"right",x=a.reference[g]+a.reference[f]-u[f]-a.floating[g],T=u[f]-a.reference[f],O=await(null==l.getOffsetParent?void 0:l.getOffsetParent(o));let E=O?"y"===f?O.clientHeight||0:O.clientWidth||0:0;0===E&&(E=a.floating[g]);const R=x/2-T/2,A=c[w],P=E-y[g]-c[C],k=E/2-y[g]/2+R,L=b(A,k,P),F=("start"===v?c[w]:c[C])>0&&k!==L&&a.reference[g]<=a.floating[g];return{[f]:u[f]-(F?k<A?A-k:P-k:0),data:{[f]:L,centerOffset:k-L}}}}))({element:this.overlayContentTip}));const{x:i,y:s,placement:r,middlewareData:a}=await ot(this.virtualTrigger||this.trigger,this,{placement:this.placement,middleware:o});if(Object.assign(this.style,{top:"0px",left:"0px",transform:`translate(${t(i)}px, ${t(s)}px)`}),r!==this.getAttribute("actual-placement")&&(this.setAttribute("actual-placement",r),this.overlayContent.setAttribute("placement",r)),this.overlayContentTip&&a.arrow){const{x:e,y:o}=a.arrow;Object.assign(this.overlayContentTip.style,{left:null!=e?`${t(e)}px`:"",top:null!=o?`${t(o)}px`:"",right:"",bottom:""})}},this.handleInlineTriggerKeydown=t=>{const{code:e,shiftKey:o}=t;if("Tab"===e){if(o)return this.tabbingAway=!0,void this.dispatchEvent(new Event("close"));t.stopPropagation(),t.preventDefault(),this.focus()}},this.stealOverlayContentPromise=Promise.resolve(),this.stealOverlayContentPromise=new Promise((t=>this.stealOverlayContentResolver=t))}get state(){return this._state}set state(t){const e=at(this.state,t);e!==this.state&&(this._state=e,"active"===this.state||"hiding"===this.state?this.setAttribute("state",this.state):this.removeAttribute("state"))}async focus(){const t=(t=>t.querySelector('button:not([tabindex="-1"]), [href]:not([tabindex="-1"]), input:not([tabindex="-1"]), select:not([tabindex="-1"]), textarea:not([tabindex="-1"]), [tabindex]:not([tabindex="-1"]), [focusable]:not([tabindex="-1"])'))(this);if(t){t.updateComplete&&await t.updateComplete;const e=this.getRootNode().activeElement;(e===this||!this.contains(e))&&t.focus()}else super.focus();this.removeAttribute("tabindex")}get hasTheme(){return!!this.theme.color||!!this.theme.scale||!!this.theme.lang}static get styles(){return[r]}get hasModalRoot(){return!!this._modalRoot}feature(){this.tabIndex=-1;const t=a(this.trigger);t&&"open"===t.slot&&(this._modalRoot=t._modalRoot||t),("modal"===this.interaction||this._modalRoot)&&(this.slot="open","modal"===this.interaction&&this.setAttribute("aria-modal","true"),this._modalRoot&&(null==t||t.feature()))}obscure(t){if(this.slot&&"modal"===t){if(this.removeAttribute("slot"),this.removeAttribute("aria-modal"),"modal"!==this.interaction){const e=a(this.trigger);return this._modalRoot=null==e?void 0:e.obscure(t),this._modalRoot}return this}}async willUpdate(){if(this.hasUpdated||!this.overlayContent||!this.trigger)return;this.stealOverlayContent(this.overlayContent),this.state="active",this.feature(),"none"===this.placement?this.style.setProperty("--swc-visual-viewport-height",`${window.innerHeight}px`):this.placement&&(await this.updateOverlayPosition(),document.addEventListener("sp-update-overlays",this.updateOverlayPosition),window.addEventListener("scroll",this.updateOverlayPosition));const t=[];this.placement&&"none"!==this.placement&&t.push(this.applyContentAnimation("sp-overlay-fade-in")),void 0!==this.overlayContent.updateComplete&&t.push(this.overlayContent.updateComplete),this.childrenReady=Promise.all(t)}async openCallback(t){await this.updateComplete,this.receivesFocus&&await this.focus(),await t(),this.trigger.dispatchEvent(new CustomEvent("sp-opened",{bubbles:!0,composed:!0,cancelable:!0,detail:{interaction:this.interaction}}))}open(t){this.extractDetail(t)}extractDetail(t){this.overlayContent=t.content,this.overlayContentTip=t.contentTip,this.trigger=t.trigger,this.virtualTrigger=t.virtualTrigger,this.placement=t.placement,this.offset=t.offset,this.skidding=t.skidding||0,this.interaction=t.interaction,this.theme=t.theme,this.receivesFocus=t.receivesFocus,this.root=t.root}dispose(){"dispose"===this.state&&(this.timeout&&(clearTimeout(this.timeout),delete this.timeout),this.trigger.removeEventListener("keydown",this.handleInlineTriggerKeydown),this.returnOverlayContent(),this.state="disposed",this.willNotifyClosed&&(this.overlayContent.dispatchEvent(new Event("sp-overlay-closed")),this.willNotifyClosed=!1))}stealOverlayContent(t){this.originalPlacement=t.getAttribute("placement"),this.restoreContent=n([t],this,{position:"beforeend",prepareCallback:t=>{const e=t.slot,o=t.placement;return t.removeAttribute("slot"),t=>{t.slot=e,t.placement=o}}}),this.stealOverlayContentResolver()}returnOverlayContent(){if(!this.restoreContent)return;const[t]=this.restoreContent();this.restoreContent=void 0,this.willNotifyClosed=!0,this.originalPlacement&&(t.setAttribute("placement",this.originalPlacement),delete this.originalPlacement)}async hide(t=!0){this.state="hiding",t&&await this.applyContentAnimation("sp-overlay-fade-out"),this.state="dispose"}schedulePositionUpdate(){cancelAnimationFrame(this.positionAnimationFrame),this.positionAnimationFrame=requestAnimationFrame((()=>this.updateOverlayPosition()))}onSlotChange(){this.schedulePositionUpdate()}applyContentAnimation(t){return"none"===this.placement?Promise.resolve(!0):new Promise((e=>{const o=this.shadowRoot.querySelector("#contents"),n=i=>{t===i.animationName&&(o.removeEventListener("animationend",n),o.removeEventListener("animationcancel",n),this.animating=!1,e("animationcancel"===i.type))};o.addEventListener("animationend",n),o.addEventListener("animationcancel",n),o.style.animationName=t,this.animating=!0}))}renderTheme(t){const{color:e,scale:o,lang:n,theme:r}=this.theme;return i`
            <sp-theme
                theme=${s(r)}
                color=${s(e)}
                scale=${s(o)}
                lang=${s(n)}
                part="theme"
            >
                ${t}
            </sp-theme>
        `}render(){const t=i`
            <div id="contents">
                <slot @slotchange=${this.onSlotChange}></slot>
            </div>
        `;return this.hasTheme?this.renderTheme(t):t}static create(t){const e=new ct;return t.content&&e.open(t),e}async getUpdateComplete(){const t=[super.getUpdateComplete(),this.stealOverlayContentPromise];this.childrenReady&&t.push(this.childrenReady);const[e]=await Promise.all(t);return e}disconnectedCallback(){document.removeEventListener("sp-update-overlays",this.updateOverlayPosition),window.removeEventListener("scroll",this.updateOverlayPosition),super.disconnectedCallback()}};let ht=ct;st([e()],ht.prototype,"_state",2),st([e({reflect:!0,type:Boolean})],ht.prototype,"animating",2),st([e({reflect:!0})],ht.prototype,"placement",2),st([e({attribute:!1})],ht.prototype,"theme",2),st([e({attribute:!1})],ht.prototype,"receivesFocus",2);class dt{constructor(t={}){this.warmUpDelay=1e3,this.coolDownDelay=1e3,this.isWarm=!1,this.timeout=0,Object.assign(this,t)}async openTimer(t){if(this.cancelCooldownTimer(),!this.component||t!==this.component)return this.component&&(this.close(this.component),this.cancelCooldownTimer()),this.component=t,!this.isWarm&&(this.promise=new Promise((t=>{this.resolve=t,this.timeout=window.setTimeout((()=>{this.resolve&&(this.resolve(!1),this.isWarm=!0)}),this.warmUpDelay)})),this.promise);if(this.promise)return this.promise;throw new Error("Inconsistent state")}close(t){this.component&&this.component===t&&(this.resetCooldownTimer(),this.timeout>0&&(clearTimeout(this.timeout),this.timeout=0),this.resolve&&(this.resolve(!0),delete this.resolve),delete this.promise,delete this.component)}resetCooldownTimer(){this.isWarm&&(this.cooldownTimeout&&window.clearTimeout(this.cooldownTimeout),this.cooldownTimeout=window.setTimeout((()=>{this.isWarm=!1,delete this.cooldownTimeout}),this.coolDownDelay))}cancelCooldownTimer(){this.cooldownTimeout&&window.clearTimeout(this.cooldownTimeout),delete this.cooldownTimeout}}customElements.define("active-overlay",ht);const pt=class{constructor(t,e,o){this.isOpen=!1,this.owner=t,this.overlayElement=o,this.interaction=e}static async open(t,e,o,n){const i=new pt(t,e,o);return await i.open(n),()=>{i.close()}}static update(){const t=new CustomEvent("sp-update-overlays",{bubbles:!0,composed:!0,cancelable:!0});document.dispatchEvent(t)}async open({abortPromise:t,delayed:e,offset:o=0,placement:n="top",receivesFocus:i,notImmediatelyClosable:s,virtualTrigger:r,root:a}){if(this.isOpen)return!0;void 0===e&&(e=this.overlayElement.hasAttribute("delayed"));const l={color:void 0,scale:void 0,lang:void 0,theme:void 0},c=new CustomEvent("sp-query-theme",{bubbles:!0,composed:!0,detail:l,cancelable:!0});this.owner.dispatchEvent(c);const h={},d=new CustomEvent("sp-overlay-query",{bubbles:!0,composed:!0,detail:h,cancelable:!0});return this.overlayElement.dispatchEvent(d),await pt.overlayStack.openOverlay({abortPromise:t,content:this.overlayElement,contentTip:h.overlayContentTipElement,delayed:e,offset:o,placement:n,trigger:this.owner,interaction:this.interaction,theme:l,receivesFocus:i,root:a,notImmediatelyClosable:s,virtualTrigger:r,...h}),this.isOpen=!0,!0}close(){pt.overlayStack.closeOverlay(this.overlayElement)}};let ut=pt;ut.overlayStack=new class{constructor(){this.overlays=[],this.preventMouseRootClose=!1,this.root=document.body,this.handlingResize=!1,this.overlayTimer=new dt,this.canTabTrap=!0,this.trappingInited=!1,this._eventsAreBound=!1,this._bodyMarginsApplied=!1,this.forwardContextmenuEvent=async t=>{var e;const o=this.overlays[this.overlays.length-1];!this.trappingInited||"modal"!==o.interaction||t.target!==this.overlayHolder||(t.stopPropagation(),t.preventDefault(),await this.closeTopOverlay(),null==(e=((t,e)=>{let o=document.elementFromPoint(t,e);for(;null!=o&&o.shadowRoot;){const n=o.shadowRoot.elementFromPoint(t,e);if(!n||n===o)break;o=n}return o})(t.clientX,t.clientY))||e.dispatchEvent(new MouseEvent("contextmenu",t)))},this.handleOverlayClose=t=>{const{root:e}=t;!e||this.closeOverlaysForRoot(e)},this.handleMouseCapture=t=>{const e=this.topOverlay;var o;if(t.target&&e&&e.overlayContent&&!((o=t).metaKey||o.altKey||o.ctrlKey||o.shiftKey)&&function(t){return 0===t.button}(t)){if(t.target instanceof Node){if(t.composedPath().indexOf(e.overlayContent)>=0)return void(this.preventMouseRootClose=!0);this.preventMouseRootClose=!1}}else this.preventMouseRootClose=!0},this._doesNotCloseOnFirstClick=!1,this.handleMouse=t=>{var e;if(this._doesNotCloseOnFirstClick)return void(this._doesNotCloseOnFirstClick=!1);if(this.preventMouseRootClose||t.defaultPrevented)return;this.closeTopOverlay();const o=[];let n=null==(e=this.topOverlay)?void 0:e.root,i=a(n);for(;n&&i;)o.push(i),i=a(n),n=null==i?void 0:i.root;i&&o.push(i),o.forEach((t=>this.hideAndCloseOverlay(t)))},this.handleKeyUp=t=>{"Escape"===t.code&&this.closeTopOverlay()},this.handleResize=()=>{this.handlingResize||(this.handlingResize=!0,requestAnimationFrame((async()=>{const t=this.overlays.map((t=>t.updateOverlayPosition()));await Promise.all(t),this.handlingResize=!1})))}}initTabTrapping(){if(this.trappingInited)return;if(this.trappingInited=!0,this.document.body.shadowRoot)return void(this.canTabTrap=!1);if(this.document.body.attachShadow({mode:"open"}),!this.document.body.shadowRoot)return;const t=this.document.body.shadowRoot;t.innerHTML='\n            <style>\n            :host {\n                position: relative;\n            }\n            #actual {\n                position: relative;\n                height: calc(100% - var(--swc-body-margins-block, 0px));\n                z-index: 0;\n                min-height: calc(100vh - var(--swc-body-margins-block, 0px));\n            }\n            #holder {\n                display: none;\n                align-items: center;\n                justify-content: center;\n                flex-flow: column;\n                width: 100%;\n                height: 100%;\n                position: absolute;\n                top: 0;\n                left: 0;\n            }\n            [name="open"]::slotted(*) {\n                pointer-events: all;\n            }\n            #actual[aria-hidden] + #holder {\n                display: flex;\n            }\n            </style>\n            <div id="actual"><slot></slot></div>\n            <div id="holder"><slot name="open"></slot></div>\n        ',this.tabTrapper=t.querySelector("#actual"),this.overlayHolder=t.querySelector("#holder"),this.tabTrapper.attachShadow({mode:"open"}),this.tabTrapper.shadowRoot&&(this.tabTrapper.shadowRoot.innerHTML="<slot></slot>"),this.overlayHolder.addEventListener("contextmenu",this.forwardContextmenuEvent,!0),requestAnimationFrame((()=>{this.applyBodyMargins(),new ResizeObserver((()=>{this.applyBodyMargins()})).observe(document.body)}))}applyBodyMargins(){const{marginLeft:t,marginRight:e,marginTop:o,marginBottom:n}=getComputedStyle(document.body),i=0===parseFloat(t)&&0===parseFloat(e)&&0===parseFloat(o)&&0===parseFloat(n);i&&!this._bodyMarginsApplied||(this.tabTrapper.style.setProperty("--swc-body-margins-inline",`calc(${t} + ${e})`),this.tabTrapper.style.setProperty("--swc-body-margins-block",`calc(${o} + ${n})`),this._bodyMarginsApplied=!i)}startTabTrapping(){this.initTabTrapping(),this.canTabTrap&&(this.tabTrapper.tabIndex=-1,this.tabTrapper.setAttribute("aria-hidden","true"))}stopTabTrapping(){!this.canTabTrap||!this.trappingInited||(this.tabTrapper.removeAttribute("tabindex"),this.tabTrapper.removeAttribute("aria-hidden"))}get document(){return this.root.ownerDocument||document}get topOverlay(){return this.overlays.slice(-1)[0]}findOverlayForContent(t){for(const e of this.overlays)if(t===e.overlayContent)return e}addEventListeners(){this._eventsAreBound||(this._eventsAreBound=!0,this.document.addEventListener("click",this.handleMouseCapture,!0),this.document.addEventListener("click",this.handleMouse),this.document.addEventListener("keyup",this.handleKeyUp),this.document.addEventListener("sp-overlay-close",this.handleOverlayClose),window.addEventListener("resize",this.handleResize))}isClickOverlayActiveForTrigger(t){return this.overlays.some((e=>t===e.trigger&&"click"===e.interaction))}async openOverlay(t){if(this.addEventListeners(),this.findOverlayForContent(t.content))return!1;t.notImmediatelyClosable&&(this._doesNotCloseOnFirstClick=!0),"modal"===t.interaction&&this.startTabTrapping();const e=t.content;if(e.overlayWillOpenCallback){const{trigger:o}=t;e.overlayWillOpenCallback({trigger:o})}if(t.delayed){const o=[this.overlayTimer.openTimer(t.content)];t.abortPromise&&o.push(t.abortPromise);const n=await Promise.race(o);if(n){if(e.overlayOpenCancelledCallback){const{trigger:o}=t;e.overlayOpenCancelledCallback({trigger:o})}return n}}if(t.root&&this.closeOverlaysForRoot(t.root),"click"===t.interaction)this.closeAllHoverOverlays();else if("hover"===t.interaction&&this.isClickOverlayActiveForTrigger(t.trigger))return!0;const o=ht.create(t);return this.overlays.length&&this.overlays[this.overlays.length-1].obscure(o.interaction),document.body.appendChild(o),new Promise((t=>requestAnimationFrame(t))).then((async()=>{this.overlays.push(o),await o.updateComplete,this.addOverlayEventListeners(o),void 0!==e.open&&(e.open=!0);let t=()=>{};if(e.overlayOpenCallback){const{trigger:n}=o,{overlayOpenCallback:i}=e;t=async()=>await i({trigger:n})}return await o.openCallback(t),!1}))}addOverlayEventListeners(t){switch(t.addEventListener("close",(()=>{this.hideAndCloseOverlay(t,!0)})),t.interaction){case"replace":this.addReplaceOverlayEventListeners(t);break;case"inline":this.addInlineOverlayEventListeners(t)}}addReplaceOverlayEventListeners(t){t.addEventListener("keydown",(e=>{const{code:o}=e;"Tab"===o&&(e.stopPropagation(),this.closeOverlay(t.overlayContent),t.tabbingAway=!0,t.trigger.focus(),t.trigger.dispatchEvent(new KeyboardEvent("keydown",e)))}))}addInlineOverlayEventListeners(t){t.trigger.addEventListener("keydown",t.handleInlineTriggerKeydown),t.addEventListener("keydown",(e=>{const{code:o,shiftKey:n}=e;if("Tab"!==o)return;if(t.tabbingAway=!0,n){const e=document.createElement("span");return e.tabIndex=-1,t.trigger.hasAttribute("slot")&&(e.slot=t.trigger.slot),t.trigger.insertAdjacentElement("afterend",e),e.focus(),void e.remove()}e.stopPropagation();const i=t.trigger;void 0!==i.open&&(i.open=!1),this.closeOverlay(t.overlayContent),t.trigger.focus()}))}closeOverlay(t){this.overlayTimer.close(t),requestAnimationFrame((()=>{const e=this.findOverlayForContent(t),o=[e];o.push(...l(e,this.overlays)),o.forEach((t=>this.hideAndCloseOverlay(t)))}))}closeAllHoverOverlays(){for(const t of this.overlays)"hover"===t.interaction&&this.hideAndCloseOverlay(t,!1)}closeOverlaysForRoot(t){const e=[];for(const o of this.overlays)o.root&&o.root===t&&(e.push(o),e.push(...l(o,this.overlays)));e.forEach((t=>this.hideAndCloseOverlay(t,!0,!0)))}async manageFocusAfterCloseWhenOverlaysRemain(t){const e=this.overlays[this.overlays.length-1];if(e.feature(),"modal"===e.interaction||e.hasModalRoot){if(t)return;await e.focus()}else this.stopTabTrapping()}manageFocusAfterCloseWhenLastOverlay(t){this.stopTabTrapping();const e="modal"===t.interaction,o="auto"===t.receivesFocus,n="replace"===t.interaction,i="inline"===t.interaction,s=(n||i)&&!t.tabbingAway;if(t.tabbingAway=!1,!e&&!o&&!s)return;const r=t.overlayContent.getRootNode().activeElement;let a,l;(e||t.overlayContent.contains(r)||(a=t.trigger.getRootNode(),l=a.activeElement,a.contains(l))||a.host&&a.host===l)&&t.trigger.focus()}async hideAndCloseOverlay(t,e,o){if(!t)return;const n=t.overlayContent;if(void 0!==n.overlayWillCloseCallback){const{trigger:e}=t;if(n.overlayWillCloseCallback({trigger:e}))return}if(await t.hide(e),void 0!==n.open&&(n.open=!1),n.overlayCloseCallback){const{trigger:e}=t;await n.overlayCloseCallback({trigger:e})}if("dispose"!=t.state)return;const i=this.overlays.indexOf(t);i>=0&&this.overlays.splice(i,1),this.overlays.length?await this.manageFocusAfterCloseWhenOverlaysRemain(o):this.manageFocusAfterCloseWhenLastOverlay(t),t.remove(),t.dispose(),t.trigger.dispatchEvent(new CustomEvent("sp-closed",{bubbles:!0,composed:!0,cancelable:!0,detail:{interaction:t.interaction}}))}closeTopOverlay(){return this.hideAndCloseOverlay(this.topOverlay,!0)}};export{ut as Overlay};
