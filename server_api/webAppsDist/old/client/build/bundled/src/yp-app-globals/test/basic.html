<!doctypehtml><meta charset="UTF-8"><title>yp-app-globals tests</title><meta name="viewport"content="width=device-width,initial-scale=1,maximum-scale=1"><script>window.customElements||document.write("\x3c!--")</script><script src="../../../bower_components/webcomponentsjs/custom-elements-es5-adapter.js"></script><!--! do not remove --><script src="../../../bower_components/webcomponentsjs/webcomponents-lite.js"></script><script src="../../../bower_components/web-component-tester/browser.js"></script><script src="../../../bower_components/test-fixture/test-fixture-mocha.js"></script><link rel="import"href="../../../bower_components/test-fixture/test-fixture.html"><script src="../../i18next-1.7.4.min.js"></script><link rel="import"href="../yp-app-globals.html"><style include="iron-flex iron-flex-alignment">body{margin:0;padding:0;}</style><body><test-fixture id="basic"><template><yp-app-globals></yp-app-globals></template></test-fixture><test-fixture id="resetSeenWelcome"><template><yp-app-globals reset-seen-welcome=""></yp-app-globals></template></test-fixture><script>suite("basic",function(){var o,e={json:{"Content-Type":"application/json"}};setup(function(){(o=sinon.fakeServer.create()).respondWith("GET",/\/activity-stream\/activity\/?timestamp=*/,[200,e,'{"status":"ok"}']),o.autoRespond=!0,i18n.init({lng:"en"}),window.i18n=i18n}),teardown(function(){o.restore()}),test("can access through window.global",function(){fixture("basic");var e=window.appGlobals;expect(e.localName).to.be.ok,expect(e.localName).to.be.equal("yp-app-globals")}),test("automatically open welcome dialog when new",function(t){var o=fixture("resetSeenWelcome");this.async(function(){var e=o.querySelector("#welcomeDialog");expect(e.opened).to.be.equal(!0),o.querySelector("#seenWelcomeButton").click(),this.async(function(){expect(e.opened).to.be.equal(!1),t()})})}),test("welcome dialog closed on second use",function(t){var o=fixture("basic");this.async(function(){var e=o.querySelector("#welcomeDialog");expect(e.opened).to.be.equal(!1),t()})}),test("can send activity",function(t){fixture("basic");window.appGlobals.activity("actor","verb","object","context"),this.async(function(){var e=o.requests[2];expect(e.requestBody).to.include("actor"),expect(e.requestBody).to.include("verb"),expect(e.requestBody).to.include("object"),expect(e.requestBody).to.include("context"),t()})}),test("can open default dialogue and close it",function(e){var t=fixture("basic"),o=t.querySelector("#dialog");t.openDialog("this.is.test"),this.async(function(){expect(o.opened).to.be.equal(!0),expect(o.innerHTML).to.include("this.is.test"),t.querySelector("#defaultOkButton").click(),this.async(function(){expect(o.opened).to.be.equal(!1),e()})})})})</script>